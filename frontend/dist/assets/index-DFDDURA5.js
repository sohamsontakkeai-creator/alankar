function MT(e,r){for(var s=0;s<r.length;s++){const a=r[s];if(typeof a!="string"&&!Array.isArray(a)){for(const n in a)if(n!=="default"&&!(n in e)){const o=Object.getOwnPropertyDescriptor(a,n);o&&Object.defineProperty(e,n,o.get?o:{enumerable:!0,get:()=>a[n]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}})();function yi(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Fh={exports:{}},Io={},Ih={exports:{}},Qt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wg;function LT(){if(Wg)return Qt;Wg=1;var e=Symbol.for("react.element"),r=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.iterator;function g(M){return M===null||typeof M!="object"?null:(M=p&&M[p]||M["@@iterator"],typeof M=="function"?M:null)}var N={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,w={};function b(M,_,ne){this.props=M,this.context=_,this.refs=w,this.updater=ne||N}b.prototype.isReactComponent={},b.prototype.setState=function(M,_){if(typeof M!="object"&&typeof M!="function"&&M!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,M,_,"setState")},b.prototype.forceUpdate=function(M){this.updater.enqueueForceUpdate(this,M,"forceUpdate")};function C(){}C.prototype=b.prototype;function A(M,_,ne){this.props=M,this.context=_,this.refs=w,this.updater=ne||N}var E=A.prototype=new C;E.constructor=A,y(E,b.prototype),E.isPureReactComponent=!0;var R=Array.isArray,V=Object.prototype.hasOwnProperty,P={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function z(M,_,ne){var ae,G={},ie=null,Me=null;if(_!=null)for(ae in _.ref!==void 0&&(Me=_.ref),_.key!==void 0&&(ie=""+_.key),_)V.call(_,ae)&&!k.hasOwnProperty(ae)&&(G[ae]=_[ae]);var Ee=arguments.length-2;if(Ee===1)G.children=ne;else if(1<Ee){for(var ye=Array(Ee),je=0;je<Ee;je++)ye[je]=arguments[je+2];G.children=ye}if(M&&M.defaultProps)for(ae in Ee=M.defaultProps,Ee)G[ae]===void 0&&(G[ae]=Ee[ae]);return{$$typeof:e,type:M,key:ie,ref:Me,props:G,_owner:P.current}}function W(M,_){return{$$typeof:e,type:M.type,key:_,ref:M.ref,props:M.props,_owner:M._owner}}function te(M){return typeof M=="object"&&M!==null&&M.$$typeof===e}function de(M){var _={"=":"=0",":":"=2"};return"$"+M.replace(/[=:]/g,function(ne){return _[ne]})}var H=/\/+/g;function ue(M,_){return typeof M=="object"&&M!==null&&M.key!=null?de(""+M.key):_.toString(36)}function I(M,_,ne,ae,G){var ie=typeof M;(ie==="undefined"||ie==="boolean")&&(M=null);var Me=!1;if(M===null)Me=!0;else switch(ie){case"string":case"number":Me=!0;break;case"object":switch(M.$$typeof){case e:case r:Me=!0}}if(Me)return Me=M,G=G(Me),M=ae===""?"."+ue(Me,0):ae,R(G)?(ne="",M!=null&&(ne=M.replace(H,"$&/")+"/"),I(G,_,ne,"",function(je){return je})):G!=null&&(te(G)&&(G=W(G,ne+(!G.key||Me&&Me.key===G.key?"":(""+G.key).replace(H,"$&/")+"/")+M)),_.push(G)),1;if(Me=0,ae=ae===""?".":ae+":",R(M))for(var Ee=0;Ee<M.length;Ee++){ie=M[Ee];var ye=ae+ue(ie,Ee);Me+=I(ie,_,ne,ye,G)}else if(ye=g(M),typeof ye=="function")for(M=ye.call(M),Ee=0;!(ie=M.next()).done;)ie=ie.value,ye=ae+ue(ie,Ee++),Me+=I(ie,_,ne,ye,G);else if(ie==="object")throw _=String(M),Error("Objects are not valid as a React child (found: "+(_==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":_)+"). If you meant to render a collection of children, use an array instead.");return Me}function X(M,_,ne){if(M==null)return M;var ae=[],G=0;return I(M,ae,"","",function(ie){return _.call(ne,ie,G++)}),ae}function oe(M){if(M._status===-1){var _=M._result;_=_(),_.then(function(ne){(M._status===0||M._status===-1)&&(M._status=1,M._result=ne)},function(ne){(M._status===0||M._status===-1)&&(M._status=2,M._result=ne)}),M._status===-1&&(M._status=0,M._result=_)}if(M._status===1)return M._result.default;throw M._result}var xe={current:null},he={transition:null},F={ReactCurrentDispatcher:xe,ReactCurrentBatchConfig:he,ReactCurrentOwner:P};function ee(){throw Error("act(...) is not supported in production builds of React.")}return Qt.Children={map:X,forEach:function(M,_,ne){X(M,function(){_.apply(this,arguments)},ne)},count:function(M){var _=0;return X(M,function(){_++}),_},toArray:function(M){return X(M,function(_){return _})||[]},only:function(M){if(!te(M))throw Error("React.Children.only expected to receive a single React element child.");return M}},Qt.Component=b,Qt.Fragment=s,Qt.Profiler=n,Qt.PureComponent=A,Qt.StrictMode=a,Qt.Suspense=h,Qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=F,Qt.act=ee,Qt.cloneElement=function(M,_,ne){if(M==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+M+".");var ae=y({},M.props),G=M.key,ie=M.ref,Me=M._owner;if(_!=null){if(_.ref!==void 0&&(ie=_.ref,Me=P.current),_.key!==void 0&&(G=""+_.key),M.type&&M.type.defaultProps)var Ee=M.type.defaultProps;for(ye in _)V.call(_,ye)&&!k.hasOwnProperty(ye)&&(ae[ye]=_[ye]===void 0&&Ee!==void 0?Ee[ye]:_[ye])}var ye=arguments.length-2;if(ye===1)ae.children=ne;else if(1<ye){Ee=Array(ye);for(var je=0;je<ye;je++)Ee[je]=arguments[je+2];ae.children=Ee}return{$$typeof:e,type:M.type,key:G,ref:ie,props:ae,_owner:Me}},Qt.createContext=function(M){return M={$$typeof:c,_currentValue:M,_currentValue2:M,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},M.Provider={$$typeof:o,_context:M},M.Consumer=M},Qt.createElement=z,Qt.createFactory=function(M){var _=z.bind(null,M);return _.type=M,_},Qt.createRef=function(){return{current:null}},Qt.forwardRef=function(M){return{$$typeof:d,render:M}},Qt.isValidElement=te,Qt.lazy=function(M){return{$$typeof:f,_payload:{_status:-1,_result:M},_init:oe}},Qt.memo=function(M,_){return{$$typeof:m,type:M,compare:_===void 0?null:_}},Qt.startTransition=function(M){var _=he.transition;he.transition={};try{M()}finally{he.transition=_}},Qt.unstable_act=ee,Qt.useCallback=function(M,_){return xe.current.useCallback(M,_)},Qt.useContext=function(M){return xe.current.useContext(M)},Qt.useDebugValue=function(){},Qt.useDeferredValue=function(M){return xe.current.useDeferredValue(M)},Qt.useEffect=function(M,_){return xe.current.useEffect(M,_)},Qt.useId=function(){return xe.current.useId()},Qt.useImperativeHandle=function(M,_,ne){return xe.current.useImperativeHandle(M,_,ne)},Qt.useInsertionEffect=function(M,_){return xe.current.useInsertionEffect(M,_)},Qt.useLayoutEffect=function(M,_){return xe.current.useLayoutEffect(M,_)},Qt.useMemo=function(M,_){return xe.current.useMemo(M,_)},Qt.useReducer=function(M,_,ne){return xe.current.useReducer(M,_,ne)},Qt.useRef=function(M){return xe.current.useRef(M)},Qt.useState=function(M){return xe.current.useState(M)},Qt.useSyncExternalStore=function(M,_,ne){return xe.current.useSyncExternalStore(M,_,ne)},Qt.useTransition=function(){return xe.current.useTransition()},Qt.version="18.3.1",Qt}var zg;function Iu(){return zg||(zg=1,Ih.exports=LT()),Ih.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kg;function BT(){if(Kg)return Io;Kg=1;var e=Iu(),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,n=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function c(d,h,m){var f,p={},g=null,N=null;m!==void 0&&(g=""+m),h.key!==void 0&&(g=""+h.key),h.ref!==void 0&&(N=h.ref);for(f in h)a.call(h,f)&&!o.hasOwnProperty(f)&&(p[f]=h[f]);if(d&&d.defaultProps)for(f in h=d.defaultProps,h)p[f]===void 0&&(p[f]=h[f]);return{$$typeof:r,type:d,key:g,ref:N,props:p,_owner:n.current}}return Io.Fragment=s,Io.jsx=c,Io.jsxs=c,Io}var Xg;function HT(){return Xg||(Xg=1,Fh.exports=BT()),Fh.exports}var t=HT(),T=Iu();const Kt=yi(T),mf=MT({__proto__:null,default:Kt},[T]);var Wd={},Mh={exports:{}},sa={},Lh={exports:{}},Bh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qg;function VT(){return qg||(qg=1,(function(e){function r(he,F){var ee=he.length;he.push(F);e:for(;0<ee;){var M=ee-1>>>1,_=he[M];if(0<n(_,F))he[M]=F,he[ee]=_,ee=M;else break e}}function s(he){return he.length===0?null:he[0]}function a(he){if(he.length===0)return null;var F=he[0],ee=he.pop();if(ee!==F){he[0]=ee;e:for(var M=0,_=he.length,ne=_>>>1;M<ne;){var ae=2*(M+1)-1,G=he[ae],ie=ae+1,Me=he[ie];if(0>n(G,ee))ie<_&&0>n(Me,G)?(he[M]=Me,he[ie]=ee,M=ie):(he[M]=G,he[ae]=ee,M=ae);else if(ie<_&&0>n(Me,ee))he[M]=Me,he[ie]=ee,M=ie;else break e}}return F}function n(he,F){var ee=he.sortIndex-F.sortIndex;return ee!==0?ee:he.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var c=Date,d=c.now();e.unstable_now=function(){return c.now()-d}}var h=[],m=[],f=1,p=null,g=3,N=!1,y=!1,w=!1,b=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(he){for(var F=s(m);F!==null;){if(F.callback===null)a(m);else if(F.startTime<=he)a(m),F.sortIndex=F.expirationTime,r(h,F);else break;F=s(m)}}function R(he){if(w=!1,E(he),!y)if(s(h)!==null)y=!0,oe(V);else{var F=s(m);F!==null&&xe(R,F.startTime-he)}}function V(he,F){y=!1,w&&(w=!1,C(z),z=-1),N=!0;var ee=g;try{for(E(F),p=s(h);p!==null&&(!(p.expirationTime>F)||he&&!de());){var M=p.callback;if(typeof M=="function"){p.callback=null,g=p.priorityLevel;var _=M(p.expirationTime<=F);F=e.unstable_now(),typeof _=="function"?p.callback=_:p===s(h)&&a(h),E(F)}else a(h);p=s(h)}if(p!==null)var ne=!0;else{var ae=s(m);ae!==null&&xe(R,ae.startTime-F),ne=!1}return ne}finally{p=null,g=ee,N=!1}}var P=!1,k=null,z=-1,W=5,te=-1;function de(){return!(e.unstable_now()-te<W)}function H(){if(k!==null){var he=e.unstable_now();te=he;var F=!0;try{F=k(!0,he)}finally{F?ue():(P=!1,k=null)}}else P=!1}var ue;if(typeof A=="function")ue=function(){A(H)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,X=I.port2;I.port1.onmessage=H,ue=function(){X.postMessage(null)}}else ue=function(){b(H,0)};function oe(he){k=he,P||(P=!0,ue())}function xe(he,F){z=b(function(){he(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(he){he.callback=null},e.unstable_continueExecution=function(){y||N||(y=!0,oe(V))},e.unstable_forceFrameRate=function(he){0>he||125<he?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<he?Math.floor(1e3/he):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return s(h)},e.unstable_next=function(he){switch(g){case 1:case 2:case 3:var F=3;break;default:F=g}var ee=g;g=F;try{return he()}finally{g=ee}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(he,F){switch(he){case 1:case 2:case 3:case 4:case 5:break;default:he=3}var ee=g;g=he;try{return F()}finally{g=ee}},e.unstable_scheduleCallback=function(he,F,ee){var M=e.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?M+ee:M):ee=M,he){case 1:var _=-1;break;case 2:_=250;break;case 5:_=1073741823;break;case 4:_=1e4;break;default:_=5e3}return _=ee+_,he={id:f++,callback:F,priorityLevel:he,startTime:ee,expirationTime:_,sortIndex:-1},ee>M?(he.sortIndex=ee,r(m,he),s(h)===null&&he===s(m)&&(w?(C(z),z=-1):w=!0,xe(R,ee-M))):(he.sortIndex=_,r(h,he),y||N||(y=!0,oe(V))),he},e.unstable_shouldYield=de,e.unstable_wrapCallback=function(he){var F=g;return function(){var ee=g;g=F;try{return he.apply(this,arguments)}finally{g=ee}}}})(Bh)),Bh}var Yg;function UT(){return Yg||(Yg=1,Lh.exports=VT()),Lh.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jg;function $T(){if(Jg)return sa;Jg=1;var e=Iu(),r=UT();function s(i){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+i,u=1;u<arguments.length;u++)l+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+i+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,n={};function o(i,l){c(i,l),c(i+"Capture",l)}function c(i,l){for(n[i]=l,i=0;i<l.length;i++)a.add(l[i])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function g(i){return h.call(p,i)?!0:h.call(f,i)?!1:m.test(i)?p[i]=!0:(f[i]=!0,!1)}function N(i,l,u,x){if(u!==null&&u.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return x?!1:u!==null?!u.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function y(i,l,u,x){if(l===null||typeof l>"u"||N(i,l,u,x))return!0;if(x)return!1;if(u!==null)switch(u.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function w(i,l,u,x,v,j,D){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=x,this.attributeNamespace=v,this.mustUseProperty=u,this.propertyName=i,this.type=l,this.sanitizeURL=j,this.removeEmptyString=D}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){b[i]=new w(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var l=i[0];b[l]=new w(l,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){b[i]=new w(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){b[i]=new w(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){b[i]=new w(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){b[i]=new w(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){b[i]=new w(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){b[i]=new w(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){b[i]=new w(i,5,!1,i.toLowerCase(),null,!1,!1)});var C=/[\-:]([a-z])/g;function A(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var l=i.replace(C,A);b[l]=new w(l,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var l=i.replace(C,A);b[l]=new w(l,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var l=i.replace(C,A);b[l]=new w(l,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){b[i]=new w(i,1,!1,i.toLowerCase(),null,!1,!1)}),b.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){b[i]=new w(i,1,!1,i.toLowerCase(),null,!0,!0)});function E(i,l,u,x){var v=b.hasOwnProperty(l)?b[l]:null;(v!==null?v.type!==0:x||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(y(l,u,v,x)&&(u=null),x||v===null?g(l)&&(u===null?i.removeAttribute(l):i.setAttribute(l,""+u)):v.mustUseProperty?i[v.propertyName]=u===null?v.type===3?!1:"":u:(l=v.attributeName,x=v.attributeNamespace,u===null?i.removeAttribute(l):(v=v.type,u=v===3||v===4&&u===!0?"":""+u,x?i.setAttributeNS(x,l,u):i.setAttribute(l,u))))}var R=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,V=Symbol.for("react.element"),P=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),z=Symbol.for("react.strict_mode"),W=Symbol.for("react.profiler"),te=Symbol.for("react.provider"),de=Symbol.for("react.context"),H=Symbol.for("react.forward_ref"),ue=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),X=Symbol.for("react.memo"),oe=Symbol.for("react.lazy"),xe=Symbol.for("react.offscreen"),he=Symbol.iterator;function F(i){return i===null||typeof i!="object"?null:(i=he&&i[he]||i["@@iterator"],typeof i=="function"?i:null)}var ee=Object.assign,M;function _(i){if(M===void 0)try{throw Error()}catch(u){var l=u.stack.trim().match(/\n( *(at )?)/);M=l&&l[1]||""}return`
`+M+i}var ne=!1;function ae(i,l){if(!i||ne)return"";ne=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(Ie){var x=Ie}Reflect.construct(i,[],l)}else{try{l.call()}catch(Ie){x=Ie}i.call(l.prototype)}else{try{throw Error()}catch(Ie){x=Ie}i()}}catch(Ie){if(Ie&&x&&typeof Ie.stack=="string"){for(var v=Ie.stack.split(`
`),j=x.stack.split(`
`),D=v.length-1,le=j.length-1;1<=D&&0<=le&&v[D]!==j[le];)le--;for(;1<=D&&0<=le;D--,le--)if(v[D]!==j[le]){if(D!==1||le!==1)do if(D--,le--,0>le||v[D]!==j[le]){var fe=`
`+v[D].replace(" at new "," at ");return i.displayName&&fe.includes("<anonymous>")&&(fe=fe.replace("<anonymous>",i.displayName)),fe}while(1<=D&&0<=le);break}}}finally{ne=!1,Error.prepareStackTrace=u}return(i=i?i.displayName||i.name:"")?_(i):""}function G(i){switch(i.tag){case 5:return _(i.type);case 16:return _("Lazy");case 13:return _("Suspense");case 19:return _("SuspenseList");case 0:case 2:case 15:return i=ae(i.type,!1),i;case 11:return i=ae(i.type.render,!1),i;case 1:return i=ae(i.type,!0),i;default:return""}}function ie(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case k:return"Fragment";case P:return"Portal";case W:return"Profiler";case z:return"StrictMode";case ue:return"Suspense";case I:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case de:return(i.displayName||"Context")+".Consumer";case te:return(i._context.displayName||"Context")+".Provider";case H:var l=i.render;return i=i.displayName,i||(i=l.displayName||l.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case X:return l=i.displayName||null,l!==null?l:ie(i.type)||"Memo";case oe:l=i._payload,i=i._init;try{return ie(i(l))}catch{}}return null}function Me(i){var l=i.type;switch(i.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=l.render,i=i.displayName||i.name||"",l.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ie(l);case 8:return l===z?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function Ee(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function ye(i){var l=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function je(i){var l=ye(i)?"checked":"value",u=Object.getOwnPropertyDescriptor(i.constructor.prototype,l),x=""+i[l];if(!i.hasOwnProperty(l)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var v=u.get,j=u.set;return Object.defineProperty(i,l,{configurable:!0,get:function(){return v.call(this)},set:function(D){x=""+D,j.call(this,D)}}),Object.defineProperty(i,l,{enumerable:u.enumerable}),{getValue:function(){return x},setValue:function(D){x=""+D},stopTracking:function(){i._valueTracker=null,delete i[l]}}}}function We(i){i._valueTracker||(i._valueTracker=je(i))}function Y(i){if(!i)return!1;var l=i._valueTracker;if(!l)return!0;var u=l.getValue(),x="";return i&&(x=ye(i)?i.checked?"true":"false":i.value),i=x,i!==u?(l.setValue(i),!0):!1}function Dt(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function we(i,l){var u=l.checked;return ee({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??i._wrapperState.initialChecked})}function ot(i,l){var u=l.defaultValue==null?"":l.defaultValue,x=l.checked!=null?l.checked:l.defaultChecked;u=Ee(l.value!=null?l.value:u),i._wrapperState={initialChecked:x,initialValue:u,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function Ye(i,l){l=l.checked,l!=null&&E(i,"checked",l,!1)}function Ue(i,l){Ye(i,l);var u=Ee(l.value),x=l.type;if(u!=null)x==="number"?(u===0&&i.value===""||i.value!=u)&&(i.value=""+u):i.value!==""+u&&(i.value=""+u);else if(x==="submit"||x==="reset"){i.removeAttribute("value");return}l.hasOwnProperty("value")?qe(i,l.type,u):l.hasOwnProperty("defaultValue")&&qe(i,l.type,Ee(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(i.defaultChecked=!!l.defaultChecked)}function Nt(i,l,u){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var x=l.type;if(!(x!=="submit"&&x!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+i._wrapperState.initialValue,u||l===i.value||(i.value=l),i.defaultValue=l}u=i.name,u!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,u!==""&&(i.name=u)}function qe(i,l,u){(l!=="number"||Dt(i.ownerDocument)!==i)&&(u==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+u&&(i.defaultValue=""+u))}var Bt=Array.isArray;function jt(i,l,u,x){if(i=i.options,l){l={};for(var v=0;v<u.length;v++)l["$"+u[v]]=!0;for(u=0;u<i.length;u++)v=l.hasOwnProperty("$"+i[u].value),i[u].selected!==v&&(i[u].selected=v),v&&x&&(i[u].defaultSelected=!0)}else{for(u=""+Ee(u),l=null,v=0;v<i.length;v++){if(i[v].value===u){i[v].selected=!0,x&&(i[v].defaultSelected=!0);return}l!==null||i[v].disabled||(l=i[v])}l!==null&&(l.selected=!0)}}function Ze(i,l){if(l.dangerouslySetInnerHTML!=null)throw Error(s(91));return ee({},l,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function Xt(i,l){var u=l.value;if(u==null){if(u=l.children,l=l.defaultValue,u!=null){if(l!=null)throw Error(s(92));if(Bt(u)){if(1<u.length)throw Error(s(93));u=u[0]}l=u}l==null&&(l=""),u=l}i._wrapperState={initialValue:Ee(u)}}function ze(i,l){var u=Ee(l.value),x=Ee(l.defaultValue);u!=null&&(u=""+u,u!==i.value&&(i.value=u),l.defaultValue==null&&i.defaultValue!==u&&(i.defaultValue=u)),x!=null&&(i.defaultValue=""+x)}function ht(i){var l=i.textContent;l===i._wrapperState.initialValue&&l!==""&&l!==null&&(i.value=l)}function nt(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ot(i,l){return i==null||i==="http://www.w3.org/1999/xhtml"?nt(l):i==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var lt,Jt=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,u,x,v){MSApp.execUnsafeLocalFunction(function(){return i(l,u,x,v)})}:i})(function(i,l){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=l;else{for(lt=lt||document.createElement("div"),lt.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=lt.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;l.firstChild;)i.appendChild(l.firstChild)}});function et(i,l){if(l){var u=i.firstChild;if(u&&u===i.lastChild&&u.nodeType===3){u.nodeValue=l;return}}i.textContent=l}var Ft={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},kt=["Webkit","ms","Moz","O"];Object.keys(Ft).forEach(function(i){kt.forEach(function(l){l=l+i.charAt(0).toUpperCase()+i.substring(1),Ft[l]=Ft[i]})});function er(i,l,u){return l==null||typeof l=="boolean"||l===""?"":u||typeof l!="number"||l===0||Ft.hasOwnProperty(i)&&Ft[i]?(""+l).trim():l+"px"}function B(i,l){i=i.style;for(var u in l)if(l.hasOwnProperty(u)){var x=u.indexOf("--")===0,v=er(u,l[u],x);u==="float"&&(u="cssFloat"),x?i.setProperty(u,v):i[u]=v}}var me=ee({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Je(i,l){if(l){if(me[i]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(s(137,i));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(s(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(s(61))}if(l.style!=null&&typeof l.style!="object")throw Error(s(62))}}function mt(i,l){if(i.indexOf("-")===-1)return typeof l.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wt=null;function Et(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var $t=null,Vt=null,qt=null;function ls(i){if(i=wo(i)){if(typeof $t!="function")throw Error(s(280));var l=i.stateNode;l&&(l=id(l),$t(i.stateNode,i.type,l))}}function Oe(i){Vt?qt?qt.push(i):qt=[i]:Vt=i}function U(){if(Vt){var i=Vt,l=qt;if(qt=Vt=null,ls(i),l)for(i=0;i<l.length;i++)ls(l[i])}}function ve(i,l){return i(l)}function ct(){}var vt=!1;function L(i,l,u){if(vt)return i(l,u);vt=!0;try{return ve(i,l,u)}finally{vt=!1,(Vt!==null||qt!==null)&&(ct(),U())}}function ce(i,l){var u=i.stateNode;if(u===null)return null;var x=id(u);if(x===null)return null;u=x[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(i=i.type,x=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!x;break e;default:i=!1}if(i)return null;if(u&&typeof u!="function")throw Error(s(231,l,typeof u));return u}var Be=!1;if(d)try{var Pt={};Object.defineProperty(Pt,"passive",{get:function(){Be=!0}}),window.addEventListener("test",Pt,Pt),window.removeEventListener("test",Pt,Pt)}catch{Be=!1}function ar(i,l,u,x,v,j,D,le,fe){var Ie=Array.prototype.slice.call(arguments,3);try{l.apply(u,Ie)}catch(Ge){this.onError(Ge)}}var $r=!1,ws=null,O=!1,J=null,K={onError:function(i){$r=!0,ws=i}};function q(i,l,u,x,v,j,D,le,fe){$r=!1,ws=null,ar.apply(K,arguments)}function Z(i,l,u,x,v,j,D,le,fe){if(q.apply(this,arguments),$r){if($r){var Ie=ws;$r=!1,ws=null}else throw Error(s(198));O||(O=!0,J=Ie)}}function se(i){var l=i,u=i;if(i.alternate)for(;l.return;)l=l.return;else{i=l;do l=i,(l.flags&4098)!==0&&(u=l.return),i=l.return;while(i)}return l.tag===3?u:null}function Ae(i){if(i.tag===13){var l=i.memoizedState;if(l===null&&(i=i.alternate,i!==null&&(l=i.memoizedState)),l!==null)return l.dehydrated}return null}function Le(i){if(se(i)!==i)throw Error(s(188))}function Ce(i){var l=i.alternate;if(!l){if(l=se(i),l===null)throw Error(s(188));return l!==i?null:i}for(var u=i,x=l;;){var v=u.return;if(v===null)break;var j=v.alternate;if(j===null){if(x=v.return,x!==null){u=x;continue}break}if(v.child===j.child){for(j=v.child;j;){if(j===u)return Le(v),i;if(j===x)return Le(v),l;j=j.sibling}throw Error(s(188))}if(u.return!==x.return)u=v,x=j;else{for(var D=!1,le=v.child;le;){if(le===u){D=!0,u=v,x=j;break}if(le===x){D=!0,x=v,u=j;break}le=le.sibling}if(!D){for(le=j.child;le;){if(le===u){D=!0,u=j,x=v;break}if(le===x){D=!0,x=j,u=v;break}le=le.sibling}if(!D)throw Error(s(189))}}if(u.alternate!==x)throw Error(s(190))}if(u.tag!==3)throw Error(s(188));return u.stateNode.current===u?i:l}function _e(i){return i=Ce(i),i!==null?De(i):null}function De(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var l=De(i);if(l!==null)return l;i=i.sibling}return null}var Ke=r.unstable_scheduleCallback,it=r.unstable_cancelCallback,S=r.unstable_shouldYield,re=r.unstable_requestPaint,Ne=r.unstable_now,Te=r.unstable_getCurrentPriorityLevel,Qe=r.unstable_ImmediatePriority,St=r.unstable_UserBlockingPriority,Yt=r.unstable_NormalPriority,cr=r.unstable_LowPriority,Yr=r.unstable_IdlePriority,ur=null,ut=null;function Ir(i){if(ut&&typeof ut.onCommitFiberRoot=="function")try{ut.onCommitFiberRoot(ur,i,void 0,(i.current.flags&128)===128)}catch{}}var nr=Math.clz32?Math.clz32:ji,dl=Math.log,Dn=Math.LN2;function ji(i){return i>>>=0,i===0?32:31-(dl(i)/Dn|0)|0}var Uc=64,$c=4194304;function ro(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function Gc(i,l){var u=i.pendingLanes;if(u===0)return 0;var x=0,v=i.suspendedLanes,j=i.pingedLanes,D=u&268435455;if(D!==0){var le=D&~v;le!==0?x=ro(le):(j&=D,j!==0&&(x=ro(j)))}else D=u&~v,D!==0?x=ro(D):j!==0&&(x=ro(j));if(x===0)return 0;if(l!==0&&l!==x&&(l&v)===0&&(v=x&-x,j=l&-l,v>=j||v===16&&(j&4194240)!==0))return l;if((x&4)!==0&&(x|=u&16),l=i.entangledLanes,l!==0)for(i=i.entanglements,l&=x;0<l;)u=31-nr(l),v=1<<u,x|=i[u],l&=~v;return x}function rE(i,l){switch(i){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sE(i,l){for(var u=i.suspendedLanes,x=i.pingedLanes,v=i.expirationTimes,j=i.pendingLanes;0<j;){var D=31-nr(j),le=1<<D,fe=v[D];fe===-1?((le&u)===0||(le&x)!==0)&&(v[D]=rE(le,l)):fe<=l&&(i.expiredLanes|=le),j&=~le}}function r0(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function bx(){var i=Uc;return Uc<<=1,(Uc&4194240)===0&&(Uc=64),i}function s0(i){for(var l=[],u=0;31>u;u++)l.push(i);return l}function so(i,l,u){i.pendingLanes|=l,l!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,l=31-nr(l),i[l]=u}function aE(i,l){var u=i.pendingLanes&~l;i.pendingLanes=l,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=l,i.mutableReadLanes&=l,i.entangledLanes&=l,l=i.entanglements;var x=i.eventTimes;for(i=i.expirationTimes;0<u;){var v=31-nr(u),j=1<<v;l[v]=0,x[v]=-1,i[v]=-1,u&=~j}}function a0(i,l){var u=i.entangledLanes|=l;for(i=i.entanglements;u;){var x=31-nr(u),v=1<<x;v&l|i[x]&l&&(i[x]|=l),u&=~v}}var hr=0;function jx(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var Ex,n0,Tx,Sx,Ax,i0=!1,Wc=[],On=null,Fn=null,In=null,ao=new Map,no=new Map,Mn=[],nE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Cx(i,l){switch(i){case"focusin":case"focusout":On=null;break;case"dragenter":case"dragleave":Fn=null;break;case"mouseover":case"mouseout":In=null;break;case"pointerover":case"pointerout":ao.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":no.delete(l.pointerId)}}function io(i,l,u,x,v,j){return i===null||i.nativeEvent!==j?(i={blockedOn:l,domEventName:u,eventSystemFlags:x,nativeEvent:j,targetContainers:[v]},l!==null&&(l=wo(l),l!==null&&n0(l)),i):(i.eventSystemFlags|=x,l=i.targetContainers,v!==null&&l.indexOf(v)===-1&&l.push(v),i)}function iE(i,l,u,x,v){switch(l){case"focusin":return On=io(On,i,l,u,x,v),!0;case"dragenter":return Fn=io(Fn,i,l,u,x,v),!0;case"mouseover":return In=io(In,i,l,u,x,v),!0;case"pointerover":var j=v.pointerId;return ao.set(j,io(ao.get(j)||null,i,l,u,x,v)),!0;case"gotpointercapture":return j=v.pointerId,no.set(j,io(no.get(j)||null,i,l,u,x,v)),!0}return!1}function kx(i){var l=Ei(i.target);if(l!==null){var u=se(l);if(u!==null){if(l=u.tag,l===13){if(l=Ae(u),l!==null){i.blockedOn=l,Ax(i.priority,function(){Tx(u)});return}}else if(l===3&&u.stateNode.current.memoizedState.isDehydrated){i.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}i.blockedOn=null}function zc(i){if(i.blockedOn!==null)return!1;for(var l=i.targetContainers;0<l.length;){var u=o0(i.domEventName,i.eventSystemFlags,l[0],i.nativeEvent);if(u===null){u=i.nativeEvent;var x=new u.constructor(u.type,u);wt=x,u.target.dispatchEvent(x),wt=null}else return l=wo(u),l!==null&&n0(l),i.blockedOn=u,!1;l.shift()}return!0}function Px(i,l,u){zc(i)&&u.delete(l)}function lE(){i0=!1,On!==null&&zc(On)&&(On=null),Fn!==null&&zc(Fn)&&(Fn=null),In!==null&&zc(In)&&(In=null),ao.forEach(Px),no.forEach(Px)}function lo(i,l){i.blockedOn===l&&(i.blockedOn=null,i0||(i0=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,lE)))}function oo(i){function l(v){return lo(v,i)}if(0<Wc.length){lo(Wc[0],i);for(var u=1;u<Wc.length;u++){var x=Wc[u];x.blockedOn===i&&(x.blockedOn=null)}}for(On!==null&&lo(On,i),Fn!==null&&lo(Fn,i),In!==null&&lo(In,i),ao.forEach(l),no.forEach(l),u=0;u<Mn.length;u++)x=Mn[u],x.blockedOn===i&&(x.blockedOn=null);for(;0<Mn.length&&(u=Mn[0],u.blockedOn===null);)kx(u),u.blockedOn===null&&Mn.shift()}var ul=R.ReactCurrentBatchConfig,Kc=!0;function oE(i,l,u,x){var v=hr,j=ul.transition;ul.transition=null;try{hr=1,l0(i,l,u,x)}finally{hr=v,ul.transition=j}}function cE(i,l,u,x){var v=hr,j=ul.transition;ul.transition=null;try{hr=4,l0(i,l,u,x)}finally{hr=v,ul.transition=j}}function l0(i,l,u,x){if(Kc){var v=o0(i,l,u,x);if(v===null)T0(i,l,x,Xc,u),Cx(i,x);else if(iE(v,i,l,u,x))x.stopPropagation();else if(Cx(i,x),l&4&&-1<nE.indexOf(i)){for(;v!==null;){var j=wo(v);if(j!==null&&Ex(j),j=o0(i,l,u,x),j===null&&T0(i,l,x,Xc,u),j===v)break;v=j}v!==null&&x.stopPropagation()}else T0(i,l,x,null,u)}}var Xc=null;function o0(i,l,u,x){if(Xc=null,i=Et(x),i=Ei(i),i!==null)if(l=se(i),l===null)i=null;else if(u=l.tag,u===13){if(i=Ae(l),i!==null)return i;i=null}else if(u===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;i=null}else l!==i&&(i=null);return Xc=i,null}function Rx(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Te()){case Qe:return 1;case St:return 4;case Yt:case cr:return 16;case Yr:return 536870912;default:return 16}default:return 16}}var Ln=null,c0=null,qc=null;function _x(){if(qc)return qc;var i,l=c0,u=l.length,x,v="value"in Ln?Ln.value:Ln.textContent,j=v.length;for(i=0;i<u&&l[i]===v[i];i++);var D=u-i;for(x=1;x<=D&&l[u-x]===v[j-x];x++);return qc=v.slice(i,1<x?1-x:void 0)}function Yc(i){var l=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&l===13&&(i=13)):i=l,i===10&&(i=13),32<=i||i===13?i:0}function Jc(){return!0}function Dx(){return!1}function la(i){function l(u,x,v,j,D){this._reactName=u,this._targetInst=v,this.type=x,this.nativeEvent=j,this.target=D,this.currentTarget=null;for(var le in i)i.hasOwnProperty(le)&&(u=i[le],this[le]=u?u(j):j[le]);return this.isDefaultPrevented=(j.defaultPrevented!=null?j.defaultPrevented:j.returnValue===!1)?Jc:Dx,this.isPropagationStopped=Dx,this}return ee(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Jc)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Jc)},persist:function(){},isPersistent:Jc}),l}var hl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},d0=la(hl),co=ee({},hl,{view:0,detail:0}),dE=la(co),u0,h0,uo,Qc=ee({},co,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:f0,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==uo&&(uo&&i.type==="mousemove"?(u0=i.screenX-uo.screenX,h0=i.screenY-uo.screenY):h0=u0=0,uo=i),u0)},movementY:function(i){return"movementY"in i?i.movementY:h0}}),Ox=la(Qc),uE=ee({},Qc,{dataTransfer:0}),hE=la(uE),mE=ee({},co,{relatedTarget:0}),m0=la(mE),fE=ee({},hl,{animationName:0,elapsedTime:0,pseudoElement:0}),xE=la(fE),pE=ee({},hl,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),gE=la(pE),vE=ee({},hl,{data:0}),Fx=la(vE),yE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},NE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bE(i){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(i):(i=wE[i])?!!l[i]:!1}function f0(){return bE}var jE=ee({},co,{key:function(i){if(i.key){var l=yE[i.key]||i.key;if(l!=="Unidentified")return l}return i.type==="keypress"?(i=Yc(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?NE[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:f0,charCode:function(i){return i.type==="keypress"?Yc(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Yc(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),EE=la(jE),TE=ee({},Qc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ix=la(TE),SE=ee({},co,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:f0}),AE=la(SE),CE=ee({},hl,{propertyName:0,elapsedTime:0,pseudoElement:0}),kE=la(CE),PE=ee({},Qc,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),RE=la(PE),_E=[9,13,27,32],x0=d&&"CompositionEvent"in window,ho=null;d&&"documentMode"in document&&(ho=document.documentMode);var DE=d&&"TextEvent"in window&&!ho,Mx=d&&(!x0||ho&&8<ho&&11>=ho),Lx=" ",Bx=!1;function Hx(i,l){switch(i){case"keyup":return _E.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vx(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ml=!1;function OE(i,l){switch(i){case"compositionend":return Vx(l);case"keypress":return l.which!==32?null:(Bx=!0,Lx);case"textInput":return i=l.data,i===Lx&&Bx?null:i;default:return null}}function FE(i,l){if(ml)return i==="compositionend"||!x0&&Hx(i,l)?(i=_x(),qc=c0=Ln=null,ml=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Mx&&l.locale!=="ko"?null:l.data;default:return null}}var IE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ux(i){var l=i&&i.nodeName&&i.nodeName.toLowerCase();return l==="input"?!!IE[i.type]:l==="textarea"}function $x(i,l,u,x){Oe(x),l=sd(l,"onChange"),0<l.length&&(u=new d0("onChange","change",null,u,x),i.push({event:u,listeners:l}))}var mo=null,fo=null;function ME(i){lp(i,0)}function Zc(i){var l=vl(i);if(Y(l))return i}function LE(i,l){if(i==="change")return l}var Gx=!1;if(d){var p0;if(d){var g0="oninput"in document;if(!g0){var Wx=document.createElement("div");Wx.setAttribute("oninput","return;"),g0=typeof Wx.oninput=="function"}p0=g0}else p0=!1;Gx=p0&&(!document.documentMode||9<document.documentMode)}function zx(){mo&&(mo.detachEvent("onpropertychange",Kx),fo=mo=null)}function Kx(i){if(i.propertyName==="value"&&Zc(fo)){var l=[];$x(l,fo,i,Et(i)),L(ME,l)}}function BE(i,l,u){i==="focusin"?(zx(),mo=l,fo=u,mo.attachEvent("onpropertychange",Kx)):i==="focusout"&&zx()}function HE(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Zc(fo)}function VE(i,l){if(i==="click")return Zc(l)}function UE(i,l){if(i==="input"||i==="change")return Zc(l)}function $E(i,l){return i===l&&(i!==0||1/i===1/l)||i!==i&&l!==l}var ka=typeof Object.is=="function"?Object.is:$E;function xo(i,l){if(ka(i,l))return!0;if(typeof i!="object"||i===null||typeof l!="object"||l===null)return!1;var u=Object.keys(i),x=Object.keys(l);if(u.length!==x.length)return!1;for(x=0;x<u.length;x++){var v=u[x];if(!h.call(l,v)||!ka(i[v],l[v]))return!1}return!0}function Xx(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function qx(i,l){var u=Xx(i);i=0;for(var x;u;){if(u.nodeType===3){if(x=i+u.textContent.length,i<=l&&x>=l)return{node:u,offset:l-i};i=x}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Xx(u)}}function Yx(i,l){return i&&l?i===l?!0:i&&i.nodeType===3?!1:l&&l.nodeType===3?Yx(i,l.parentNode):"contains"in i?i.contains(l):i.compareDocumentPosition?!!(i.compareDocumentPosition(l)&16):!1:!1}function Jx(){for(var i=window,l=Dt();l instanceof i.HTMLIFrameElement;){try{var u=typeof l.contentWindow.location.href=="string"}catch{u=!1}if(u)i=l.contentWindow;else break;l=Dt(i.document)}return l}function v0(i){var l=i&&i.nodeName&&i.nodeName.toLowerCase();return l&&(l==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||l==="textarea"||i.contentEditable==="true")}function GE(i){var l=Jx(),u=i.focusedElem,x=i.selectionRange;if(l!==u&&u&&u.ownerDocument&&Yx(u.ownerDocument.documentElement,u)){if(x!==null&&v0(u)){if(l=x.start,i=x.end,i===void 0&&(i=l),"selectionStart"in u)u.selectionStart=l,u.selectionEnd=Math.min(i,u.value.length);else if(i=(l=u.ownerDocument||document)&&l.defaultView||window,i.getSelection){i=i.getSelection();var v=u.textContent.length,j=Math.min(x.start,v);x=x.end===void 0?j:Math.min(x.end,v),!i.extend&&j>x&&(v=x,x=j,j=v),v=qx(u,j);var D=qx(u,x);v&&D&&(i.rangeCount!==1||i.anchorNode!==v.node||i.anchorOffset!==v.offset||i.focusNode!==D.node||i.focusOffset!==D.offset)&&(l=l.createRange(),l.setStart(v.node,v.offset),i.removeAllRanges(),j>x?(i.addRange(l),i.extend(D.node,D.offset)):(l.setEnd(D.node,D.offset),i.addRange(l)))}}for(l=[],i=u;i=i.parentNode;)i.nodeType===1&&l.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<l.length;u++)i=l[u],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var WE=d&&"documentMode"in document&&11>=document.documentMode,fl=null,y0=null,po=null,N0=!1;function Qx(i,l,u){var x=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;N0||fl==null||fl!==Dt(x)||(x=fl,"selectionStart"in x&&v0(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),po&&xo(po,x)||(po=x,x=sd(y0,"onSelect"),0<x.length&&(l=new d0("onSelect","select",null,l,u),i.push({event:l,listeners:x}),l.target=fl)))}function ed(i,l){var u={};return u[i.toLowerCase()]=l.toLowerCase(),u["Webkit"+i]="webkit"+l,u["Moz"+i]="moz"+l,u}var xl={animationend:ed("Animation","AnimationEnd"),animationiteration:ed("Animation","AnimationIteration"),animationstart:ed("Animation","AnimationStart"),transitionend:ed("Transition","TransitionEnd")},w0={},Zx={};d&&(Zx=document.createElement("div").style,"AnimationEvent"in window||(delete xl.animationend.animation,delete xl.animationiteration.animation,delete xl.animationstart.animation),"TransitionEvent"in window||delete xl.transitionend.transition);function td(i){if(w0[i])return w0[i];if(!xl[i])return i;var l=xl[i],u;for(u in l)if(l.hasOwnProperty(u)&&u in Zx)return w0[i]=l[u];return i}var ep=td("animationend"),tp=td("animationiteration"),rp=td("animationstart"),sp=td("transitionend"),ap=new Map,np="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bn(i,l){ap.set(i,l),o(l,[i])}for(var b0=0;b0<np.length;b0++){var j0=np[b0],zE=j0.toLowerCase(),KE=j0[0].toUpperCase()+j0.slice(1);Bn(zE,"on"+KE)}Bn(ep,"onAnimationEnd"),Bn(tp,"onAnimationIteration"),Bn(rp,"onAnimationStart"),Bn("dblclick","onDoubleClick"),Bn("focusin","onFocus"),Bn("focusout","onBlur"),Bn(sp,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var go="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),XE=new Set("cancel close invalid load scroll toggle".split(" ").concat(go));function ip(i,l,u){var x=i.type||"unknown-event";i.currentTarget=u,Z(x,l,void 0,i),i.currentTarget=null}function lp(i,l){l=(l&4)!==0;for(var u=0;u<i.length;u++){var x=i[u],v=x.event;x=x.listeners;e:{var j=void 0;if(l)for(var D=x.length-1;0<=D;D--){var le=x[D],fe=le.instance,Ie=le.currentTarget;if(le=le.listener,fe!==j&&v.isPropagationStopped())break e;ip(v,le,Ie),j=fe}else for(D=0;D<x.length;D++){if(le=x[D],fe=le.instance,Ie=le.currentTarget,le=le.listener,fe!==j&&v.isPropagationStopped())break e;ip(v,le,Ie),j=fe}}}if(O)throw i=J,O=!1,J=null,i}function Rr(i,l){var u=l[R0];u===void 0&&(u=l[R0]=new Set);var x=i+"__bubble";u.has(x)||(op(l,i,2,!1),u.add(x))}function E0(i,l,u){var x=0;l&&(x|=4),op(u,i,x,l)}var rd="_reactListening"+Math.random().toString(36).slice(2);function vo(i){if(!i[rd]){i[rd]=!0,a.forEach(function(u){u!=="selectionchange"&&(XE.has(u)||E0(u,!1,i),E0(u,!0,i))});var l=i.nodeType===9?i:i.ownerDocument;l===null||l[rd]||(l[rd]=!0,E0("selectionchange",!1,l))}}function op(i,l,u,x){switch(Rx(l)){case 1:var v=oE;break;case 4:v=cE;break;default:v=l0}u=v.bind(null,l,u,i),v=void 0,!Be||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(v=!0),x?v!==void 0?i.addEventListener(l,u,{capture:!0,passive:v}):i.addEventListener(l,u,!0):v!==void 0?i.addEventListener(l,u,{passive:v}):i.addEventListener(l,u,!1)}function T0(i,l,u,x,v){var j=x;if((l&1)===0&&(l&2)===0&&x!==null)e:for(;;){if(x===null)return;var D=x.tag;if(D===3||D===4){var le=x.stateNode.containerInfo;if(le===v||le.nodeType===8&&le.parentNode===v)break;if(D===4)for(D=x.return;D!==null;){var fe=D.tag;if((fe===3||fe===4)&&(fe=D.stateNode.containerInfo,fe===v||fe.nodeType===8&&fe.parentNode===v))return;D=D.return}for(;le!==null;){if(D=Ei(le),D===null)return;if(fe=D.tag,fe===5||fe===6){x=j=D;continue e}le=le.parentNode}}x=x.return}L(function(){var Ie=j,Ge=Et(u),Xe=[];e:{var $e=ap.get(i);if($e!==void 0){var ft=d0,yt=i;switch(i){case"keypress":if(Yc(u)===0)break e;case"keydown":case"keyup":ft=EE;break;case"focusin":yt="focus",ft=m0;break;case"focusout":yt="blur",ft=m0;break;case"beforeblur":case"afterblur":ft=m0;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ft=Ox;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ft=hE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ft=AE;break;case ep:case tp:case rp:ft=xE;break;case sp:ft=kE;break;case"scroll":ft=dE;break;case"wheel":ft=RE;break;case"copy":case"cut":case"paste":ft=gE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ft=Ix}var bt=(l&4)!==0,Jr=!bt&&i==="scroll",Se=bt?$e!==null?$e+"Capture":null:$e;bt=[];for(var ge=Ie,ke;ge!==null;){ke=ge;var tt=ke.stateNode;if(ke.tag===5&&tt!==null&&(ke=tt,Se!==null&&(tt=ce(ge,Se),tt!=null&&bt.push(yo(ge,tt,ke)))),Jr)break;ge=ge.return}0<bt.length&&($e=new ft($e,yt,null,u,Ge),Xe.push({event:$e,listeners:bt}))}}if((l&7)===0){e:{if($e=i==="mouseover"||i==="pointerover",ft=i==="mouseout"||i==="pointerout",$e&&u!==wt&&(yt=u.relatedTarget||u.fromElement)&&(Ei(yt)||yt[cn]))break e;if((ft||$e)&&($e=Ge.window===Ge?Ge:($e=Ge.ownerDocument)?$e.defaultView||$e.parentWindow:window,ft?(yt=u.relatedTarget||u.toElement,ft=Ie,yt=yt?Ei(yt):null,yt!==null&&(Jr=se(yt),yt!==Jr||yt.tag!==5&&yt.tag!==6)&&(yt=null)):(ft=null,yt=Ie),ft!==yt)){if(bt=Ox,tt="onMouseLeave",Se="onMouseEnter",ge="mouse",(i==="pointerout"||i==="pointerover")&&(bt=Ix,tt="onPointerLeave",Se="onPointerEnter",ge="pointer"),Jr=ft==null?$e:vl(ft),ke=yt==null?$e:vl(yt),$e=new bt(tt,ge+"leave",ft,u,Ge),$e.target=Jr,$e.relatedTarget=ke,tt=null,Ei(Ge)===Ie&&(bt=new bt(Se,ge+"enter",yt,u,Ge),bt.target=ke,bt.relatedTarget=Jr,tt=bt),Jr=tt,ft&&yt)t:{for(bt=ft,Se=yt,ge=0,ke=bt;ke;ke=pl(ke))ge++;for(ke=0,tt=Se;tt;tt=pl(tt))ke++;for(;0<ge-ke;)bt=pl(bt),ge--;for(;0<ke-ge;)Se=pl(Se),ke--;for(;ge--;){if(bt===Se||Se!==null&&bt===Se.alternate)break t;bt=pl(bt),Se=pl(Se)}bt=null}else bt=null;ft!==null&&cp(Xe,$e,ft,bt,!1),yt!==null&&Jr!==null&&cp(Xe,Jr,yt,bt,!0)}}e:{if($e=Ie?vl(Ie):window,ft=$e.nodeName&&$e.nodeName.toLowerCase(),ft==="select"||ft==="input"&&$e.type==="file")var Tt=LE;else if(Ux($e))if(Gx)Tt=UE;else{Tt=HE;var Rt=BE}else(ft=$e.nodeName)&&ft.toLowerCase()==="input"&&($e.type==="checkbox"||$e.type==="radio")&&(Tt=VE);if(Tt&&(Tt=Tt(i,Ie))){$x(Xe,Tt,u,Ge);break e}Rt&&Rt(i,$e,Ie),i==="focusout"&&(Rt=$e._wrapperState)&&Rt.controlled&&$e.type==="number"&&qe($e,"number",$e.value)}switch(Rt=Ie?vl(Ie):window,i){case"focusin":(Ux(Rt)||Rt.contentEditable==="true")&&(fl=Rt,y0=Ie,po=null);break;case"focusout":po=y0=fl=null;break;case"mousedown":N0=!0;break;case"contextmenu":case"mouseup":case"dragend":N0=!1,Qx(Xe,u,Ge);break;case"selectionchange":if(WE)break;case"keydown":case"keyup":Qx(Xe,u,Ge)}var _t;if(x0)e:{switch(i){case"compositionstart":var Ht="onCompositionStart";break e;case"compositionend":Ht="onCompositionEnd";break e;case"compositionupdate":Ht="onCompositionUpdate";break e}Ht=void 0}else ml?Hx(i,u)&&(Ht="onCompositionEnd"):i==="keydown"&&u.keyCode===229&&(Ht="onCompositionStart");Ht&&(Mx&&u.locale!=="ko"&&(ml||Ht!=="onCompositionStart"?Ht==="onCompositionEnd"&&ml&&(_t=_x()):(Ln=Ge,c0="value"in Ln?Ln.value:Ln.textContent,ml=!0)),Rt=sd(Ie,Ht),0<Rt.length&&(Ht=new Fx(Ht,i,null,u,Ge),Xe.push({event:Ht,listeners:Rt}),_t?Ht.data=_t:(_t=Vx(u),_t!==null&&(Ht.data=_t)))),(_t=DE?OE(i,u):FE(i,u))&&(Ie=sd(Ie,"onBeforeInput"),0<Ie.length&&(Ge=new Fx("onBeforeInput","beforeinput",null,u,Ge),Xe.push({event:Ge,listeners:Ie}),Ge.data=_t))}lp(Xe,l)})}function yo(i,l,u){return{instance:i,listener:l,currentTarget:u}}function sd(i,l){for(var u=l+"Capture",x=[];i!==null;){var v=i,j=v.stateNode;v.tag===5&&j!==null&&(v=j,j=ce(i,u),j!=null&&x.unshift(yo(i,j,v)),j=ce(i,l),j!=null&&x.push(yo(i,j,v))),i=i.return}return x}function pl(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function cp(i,l,u,x,v){for(var j=l._reactName,D=[];u!==null&&u!==x;){var le=u,fe=le.alternate,Ie=le.stateNode;if(fe!==null&&fe===x)break;le.tag===5&&Ie!==null&&(le=Ie,v?(fe=ce(u,j),fe!=null&&D.unshift(yo(u,fe,le))):v||(fe=ce(u,j),fe!=null&&D.push(yo(u,fe,le)))),u=u.return}D.length!==0&&i.push({event:l,listeners:D})}var qE=/\r\n?/g,YE=/\u0000|\uFFFD/g;function dp(i){return(typeof i=="string"?i:""+i).replace(qE,`
`).replace(YE,"")}function ad(i,l,u){if(l=dp(l),dp(i)!==l&&u)throw Error(s(425))}function nd(){}var S0=null,A0=null;function C0(i,l){return i==="textarea"||i==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var k0=typeof setTimeout=="function"?setTimeout:void 0,JE=typeof clearTimeout=="function"?clearTimeout:void 0,up=typeof Promise=="function"?Promise:void 0,QE=typeof queueMicrotask=="function"?queueMicrotask:typeof up<"u"?function(i){return up.resolve(null).then(i).catch(ZE)}:k0;function ZE(i){setTimeout(function(){throw i})}function P0(i,l){var u=l,x=0;do{var v=u.nextSibling;if(i.removeChild(u),v&&v.nodeType===8)if(u=v.data,u==="/$"){if(x===0){i.removeChild(v),oo(l);return}x--}else u!=="$"&&u!=="$?"&&u!=="$!"||x++;u=v}while(u);oo(l)}function Hn(i){for(;i!=null;i=i.nextSibling){var l=i.nodeType;if(l===1||l===3)break;if(l===8){if(l=i.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return i}function hp(i){i=i.previousSibling;for(var l=0;i;){if(i.nodeType===8){var u=i.data;if(u==="$"||u==="$!"||u==="$?"){if(l===0)return i;l--}else u==="/$"&&l++}i=i.previousSibling}return null}var gl=Math.random().toString(36).slice(2),Xa="__reactFiber$"+gl,No="__reactProps$"+gl,cn="__reactContainer$"+gl,R0="__reactEvents$"+gl,eT="__reactListeners$"+gl,tT="__reactHandles$"+gl;function Ei(i){var l=i[Xa];if(l)return l;for(var u=i.parentNode;u;){if(l=u[cn]||u[Xa]){if(u=l.alternate,l.child!==null||u!==null&&u.child!==null)for(i=hp(i);i!==null;){if(u=i[Xa])return u;i=hp(i)}return l}i=u,u=i.parentNode}return null}function wo(i){return i=i[Xa]||i[cn],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function vl(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(s(33))}function id(i){return i[No]||null}var _0=[],yl=-1;function Vn(i){return{current:i}}function _r(i){0>yl||(i.current=_0[yl],_0[yl]=null,yl--)}function wr(i,l){yl++,_0[yl]=i.current,i.current=l}var Un={},As=Vn(Un),Qs=Vn(!1),Ti=Un;function Nl(i,l){var u=i.type.contextTypes;if(!u)return Un;var x=i.stateNode;if(x&&x.__reactInternalMemoizedUnmaskedChildContext===l)return x.__reactInternalMemoizedMaskedChildContext;var v={},j;for(j in u)v[j]=l[j];return x&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=l,i.__reactInternalMemoizedMaskedChildContext=v),v}function Zs(i){return i=i.childContextTypes,i!=null}function ld(){_r(Qs),_r(As)}function mp(i,l,u){if(As.current!==Un)throw Error(s(168));wr(As,l),wr(Qs,u)}function fp(i,l,u){var x=i.stateNode;if(l=l.childContextTypes,typeof x.getChildContext!="function")return u;x=x.getChildContext();for(var v in x)if(!(v in l))throw Error(s(108,Me(i)||"Unknown",v));return ee({},u,x)}function od(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Un,Ti=As.current,wr(As,i),wr(Qs,Qs.current),!0}function xp(i,l,u){var x=i.stateNode;if(!x)throw Error(s(169));u?(i=fp(i,l,Ti),x.__reactInternalMemoizedMergedChildContext=i,_r(Qs),_r(As),wr(As,i)):_r(Qs),wr(Qs,u)}var dn=null,cd=!1,D0=!1;function pp(i){dn===null?dn=[i]:dn.push(i)}function rT(i){cd=!0,pp(i)}function $n(){if(!D0&&dn!==null){D0=!0;var i=0,l=hr;try{var u=dn;for(hr=1;i<u.length;i++){var x=u[i];do x=x(!0);while(x!==null)}dn=null,cd=!1}catch(v){throw dn!==null&&(dn=dn.slice(i+1)),Ke(Qe,$n),v}finally{hr=l,D0=!1}}return null}var wl=[],bl=0,dd=null,ud=0,pa=[],ga=0,Si=null,un=1,hn="";function Ai(i,l){wl[bl++]=ud,wl[bl++]=dd,dd=i,ud=l}function gp(i,l,u){pa[ga++]=un,pa[ga++]=hn,pa[ga++]=Si,Si=i;var x=un;i=hn;var v=32-nr(x)-1;x&=~(1<<v),u+=1;var j=32-nr(l)+v;if(30<j){var D=v-v%5;j=(x&(1<<D)-1).toString(32),x>>=D,v-=D,un=1<<32-nr(l)+v|u<<v|x,hn=j+i}else un=1<<j|u<<v|x,hn=i}function O0(i){i.return!==null&&(Ai(i,1),gp(i,1,0))}function F0(i){for(;i===dd;)dd=wl[--bl],wl[bl]=null,ud=wl[--bl],wl[bl]=null;for(;i===Si;)Si=pa[--ga],pa[ga]=null,hn=pa[--ga],pa[ga]=null,un=pa[--ga],pa[ga]=null}var oa=null,ca=null,Mr=!1,Pa=null;function vp(i,l){var u=wa(5,null,null,0);u.elementType="DELETED",u.stateNode=l,u.return=i,l=i.deletions,l===null?(i.deletions=[u],i.flags|=16):l.push(u)}function yp(i,l){switch(i.tag){case 5:var u=i.type;return l=l.nodeType!==1||u.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(i.stateNode=l,oa=i,ca=Hn(l.firstChild),!0):!1;case 6:return l=i.pendingProps===""||l.nodeType!==3?null:l,l!==null?(i.stateNode=l,oa=i,ca=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(u=Si!==null?{id:un,overflow:hn}:null,i.memoizedState={dehydrated:l,treeContext:u,retryLane:1073741824},u=wa(18,null,null,0),u.stateNode=l,u.return=i,i.child=u,oa=i,ca=null,!0):!1;default:return!1}}function I0(i){return(i.mode&1)!==0&&(i.flags&128)===0}function M0(i){if(Mr){var l=ca;if(l){var u=l;if(!yp(i,l)){if(I0(i))throw Error(s(418));l=Hn(u.nextSibling);var x=oa;l&&yp(i,l)?vp(x,u):(i.flags=i.flags&-4097|2,Mr=!1,oa=i)}}else{if(I0(i))throw Error(s(418));i.flags=i.flags&-4097|2,Mr=!1,oa=i}}}function Np(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;oa=i}function hd(i){if(i!==oa)return!1;if(!Mr)return Np(i),Mr=!0,!1;var l;if((l=i.tag!==3)&&!(l=i.tag!==5)&&(l=i.type,l=l!=="head"&&l!=="body"&&!C0(i.type,i.memoizedProps)),l&&(l=ca)){if(I0(i))throw wp(),Error(s(418));for(;l;)vp(i,l),l=Hn(l.nextSibling)}if(Np(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(317));e:{for(i=i.nextSibling,l=0;i;){if(i.nodeType===8){var u=i.data;if(u==="/$"){if(l===0){ca=Hn(i.nextSibling);break e}l--}else u!=="$"&&u!=="$!"&&u!=="$?"||l++}i=i.nextSibling}ca=null}}else ca=oa?Hn(i.stateNode.nextSibling):null;return!0}function wp(){for(var i=ca;i;)i=Hn(i.nextSibling)}function jl(){ca=oa=null,Mr=!1}function L0(i){Pa===null?Pa=[i]:Pa.push(i)}var sT=R.ReactCurrentBatchConfig;function bo(i,l,u){if(i=u.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(s(309));var x=u.stateNode}if(!x)throw Error(s(147,i));var v=x,j=""+i;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===j?l.ref:(l=function(D){var le=v.refs;D===null?delete le[j]:le[j]=D},l._stringRef=j,l)}if(typeof i!="string")throw Error(s(284));if(!u._owner)throw Error(s(290,i))}return i}function md(i,l){throw i=Object.prototype.toString.call(l),Error(s(31,i==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":i))}function bp(i){var l=i._init;return l(i._payload)}function jp(i){function l(Se,ge){if(i){var ke=Se.deletions;ke===null?(Se.deletions=[ge],Se.flags|=16):ke.push(ge)}}function u(Se,ge){if(!i)return null;for(;ge!==null;)l(Se,ge),ge=ge.sibling;return null}function x(Se,ge){for(Se=new Map;ge!==null;)ge.key!==null?Se.set(ge.key,ge):Se.set(ge.index,ge),ge=ge.sibling;return Se}function v(Se,ge){return Se=Jn(Se,ge),Se.index=0,Se.sibling=null,Se}function j(Se,ge,ke){return Se.index=ke,i?(ke=Se.alternate,ke!==null?(ke=ke.index,ke<ge?(Se.flags|=2,ge):ke):(Se.flags|=2,ge)):(Se.flags|=1048576,ge)}function D(Se){return i&&Se.alternate===null&&(Se.flags|=2),Se}function le(Se,ge,ke,tt){return ge===null||ge.tag!==6?(ge=kh(ke,Se.mode,tt),ge.return=Se,ge):(ge=v(ge,ke),ge.return=Se,ge)}function fe(Se,ge,ke,tt){var Tt=ke.type;return Tt===k?Ge(Se,ge,ke.props.children,tt,ke.key):ge!==null&&(ge.elementType===Tt||typeof Tt=="object"&&Tt!==null&&Tt.$$typeof===oe&&bp(Tt)===ge.type)?(tt=v(ge,ke.props),tt.ref=bo(Se,ge,ke),tt.return=Se,tt):(tt=Md(ke.type,ke.key,ke.props,null,Se.mode,tt),tt.ref=bo(Se,ge,ke),tt.return=Se,tt)}function Ie(Se,ge,ke,tt){return ge===null||ge.tag!==4||ge.stateNode.containerInfo!==ke.containerInfo||ge.stateNode.implementation!==ke.implementation?(ge=Ph(ke,Se.mode,tt),ge.return=Se,ge):(ge=v(ge,ke.children||[]),ge.return=Se,ge)}function Ge(Se,ge,ke,tt,Tt){return ge===null||ge.tag!==7?(ge=Fi(ke,Se.mode,tt,Tt),ge.return=Se,ge):(ge=v(ge,ke),ge.return=Se,ge)}function Xe(Se,ge,ke){if(typeof ge=="string"&&ge!==""||typeof ge=="number")return ge=kh(""+ge,Se.mode,ke),ge.return=Se,ge;if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case V:return ke=Md(ge.type,ge.key,ge.props,null,Se.mode,ke),ke.ref=bo(Se,null,ge),ke.return=Se,ke;case P:return ge=Ph(ge,Se.mode,ke),ge.return=Se,ge;case oe:var tt=ge._init;return Xe(Se,tt(ge._payload),ke)}if(Bt(ge)||F(ge))return ge=Fi(ge,Se.mode,ke,null),ge.return=Se,ge;md(Se,ge)}return null}function $e(Se,ge,ke,tt){var Tt=ge!==null?ge.key:null;if(typeof ke=="string"&&ke!==""||typeof ke=="number")return Tt!==null?null:le(Se,ge,""+ke,tt);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case V:return ke.key===Tt?fe(Se,ge,ke,tt):null;case P:return ke.key===Tt?Ie(Se,ge,ke,tt):null;case oe:return Tt=ke._init,$e(Se,ge,Tt(ke._payload),tt)}if(Bt(ke)||F(ke))return Tt!==null?null:Ge(Se,ge,ke,tt,null);md(Se,ke)}return null}function ft(Se,ge,ke,tt,Tt){if(typeof tt=="string"&&tt!==""||typeof tt=="number")return Se=Se.get(ke)||null,le(ge,Se,""+tt,Tt);if(typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case V:return Se=Se.get(tt.key===null?ke:tt.key)||null,fe(ge,Se,tt,Tt);case P:return Se=Se.get(tt.key===null?ke:tt.key)||null,Ie(ge,Se,tt,Tt);case oe:var Rt=tt._init;return ft(Se,ge,ke,Rt(tt._payload),Tt)}if(Bt(tt)||F(tt))return Se=Se.get(ke)||null,Ge(ge,Se,tt,Tt,null);md(ge,tt)}return null}function yt(Se,ge,ke,tt){for(var Tt=null,Rt=null,_t=ge,Ht=ge=0,ps=null;_t!==null&&Ht<ke.length;Ht++){_t.index>Ht?(ps=_t,_t=null):ps=_t.sibling;var or=$e(Se,_t,ke[Ht],tt);if(or===null){_t===null&&(_t=ps);break}i&&_t&&or.alternate===null&&l(Se,_t),ge=j(or,ge,Ht),Rt===null?Tt=or:Rt.sibling=or,Rt=or,_t=ps}if(Ht===ke.length)return u(Se,_t),Mr&&Ai(Se,Ht),Tt;if(_t===null){for(;Ht<ke.length;Ht++)_t=Xe(Se,ke[Ht],tt),_t!==null&&(ge=j(_t,ge,Ht),Rt===null?Tt=_t:Rt.sibling=_t,Rt=_t);return Mr&&Ai(Se,Ht),Tt}for(_t=x(Se,_t);Ht<ke.length;Ht++)ps=ft(_t,Se,Ht,ke[Ht],tt),ps!==null&&(i&&ps.alternate!==null&&_t.delete(ps.key===null?Ht:ps.key),ge=j(ps,ge,Ht),Rt===null?Tt=ps:Rt.sibling=ps,Rt=ps);return i&&_t.forEach(function(Qn){return l(Se,Qn)}),Mr&&Ai(Se,Ht),Tt}function bt(Se,ge,ke,tt){var Tt=F(ke);if(typeof Tt!="function")throw Error(s(150));if(ke=Tt.call(ke),ke==null)throw Error(s(151));for(var Rt=Tt=null,_t=ge,Ht=ge=0,ps=null,or=ke.next();_t!==null&&!or.done;Ht++,or=ke.next()){_t.index>Ht?(ps=_t,_t=null):ps=_t.sibling;var Qn=$e(Se,_t,or.value,tt);if(Qn===null){_t===null&&(_t=ps);break}i&&_t&&Qn.alternate===null&&l(Se,_t),ge=j(Qn,ge,Ht),Rt===null?Tt=Qn:Rt.sibling=Qn,Rt=Qn,_t=ps}if(or.done)return u(Se,_t),Mr&&Ai(Se,Ht),Tt;if(_t===null){for(;!or.done;Ht++,or=ke.next())or=Xe(Se,or.value,tt),or!==null&&(ge=j(or,ge,Ht),Rt===null?Tt=or:Rt.sibling=or,Rt=or);return Mr&&Ai(Se,Ht),Tt}for(_t=x(Se,_t);!or.done;Ht++,or=ke.next())or=ft(_t,Se,Ht,or.value,tt),or!==null&&(i&&or.alternate!==null&&_t.delete(or.key===null?Ht:or.key),ge=j(or,ge,Ht),Rt===null?Tt=or:Rt.sibling=or,Rt=or);return i&&_t.forEach(function(IT){return l(Se,IT)}),Mr&&Ai(Se,Ht),Tt}function Jr(Se,ge,ke,tt){if(typeof ke=="object"&&ke!==null&&ke.type===k&&ke.key===null&&(ke=ke.props.children),typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case V:e:{for(var Tt=ke.key,Rt=ge;Rt!==null;){if(Rt.key===Tt){if(Tt=ke.type,Tt===k){if(Rt.tag===7){u(Se,Rt.sibling),ge=v(Rt,ke.props.children),ge.return=Se,Se=ge;break e}}else if(Rt.elementType===Tt||typeof Tt=="object"&&Tt!==null&&Tt.$$typeof===oe&&bp(Tt)===Rt.type){u(Se,Rt.sibling),ge=v(Rt,ke.props),ge.ref=bo(Se,Rt,ke),ge.return=Se,Se=ge;break e}u(Se,Rt);break}else l(Se,Rt);Rt=Rt.sibling}ke.type===k?(ge=Fi(ke.props.children,Se.mode,tt,ke.key),ge.return=Se,Se=ge):(tt=Md(ke.type,ke.key,ke.props,null,Se.mode,tt),tt.ref=bo(Se,ge,ke),tt.return=Se,Se=tt)}return D(Se);case P:e:{for(Rt=ke.key;ge!==null;){if(ge.key===Rt)if(ge.tag===4&&ge.stateNode.containerInfo===ke.containerInfo&&ge.stateNode.implementation===ke.implementation){u(Se,ge.sibling),ge=v(ge,ke.children||[]),ge.return=Se,Se=ge;break e}else{u(Se,ge);break}else l(Se,ge);ge=ge.sibling}ge=Ph(ke,Se.mode,tt),ge.return=Se,Se=ge}return D(Se);case oe:return Rt=ke._init,Jr(Se,ge,Rt(ke._payload),tt)}if(Bt(ke))return yt(Se,ge,ke,tt);if(F(ke))return bt(Se,ge,ke,tt);md(Se,ke)}return typeof ke=="string"&&ke!==""||typeof ke=="number"?(ke=""+ke,ge!==null&&ge.tag===6?(u(Se,ge.sibling),ge=v(ge,ke),ge.return=Se,Se=ge):(u(Se,ge),ge=kh(ke,Se.mode,tt),ge.return=Se,Se=ge),D(Se)):u(Se,ge)}return Jr}var El=jp(!0),Ep=jp(!1),fd=Vn(null),xd=null,Tl=null,B0=null;function H0(){B0=Tl=xd=null}function V0(i){var l=fd.current;_r(fd),i._currentValue=l}function U0(i,l,u){for(;i!==null;){var x=i.alternate;if((i.childLanes&l)!==l?(i.childLanes|=l,x!==null&&(x.childLanes|=l)):x!==null&&(x.childLanes&l)!==l&&(x.childLanes|=l),i===u)break;i=i.return}}function Sl(i,l){xd=i,B0=Tl=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&l)!==0&&(ea=!0),i.firstContext=null)}function va(i){var l=i._currentValue;if(B0!==i)if(i={context:i,memoizedValue:l,next:null},Tl===null){if(xd===null)throw Error(s(308));Tl=i,xd.dependencies={lanes:0,firstContext:i}}else Tl=Tl.next=i;return l}var Ci=null;function $0(i){Ci===null?Ci=[i]:Ci.push(i)}function Tp(i,l,u,x){var v=l.interleaved;return v===null?(u.next=u,$0(l)):(u.next=v.next,v.next=u),l.interleaved=u,mn(i,x)}function mn(i,l){i.lanes|=l;var u=i.alternate;for(u!==null&&(u.lanes|=l),u=i,i=i.return;i!==null;)i.childLanes|=l,u=i.alternate,u!==null&&(u.childLanes|=l),u=i,i=i.return;return u.tag===3?u.stateNode:null}var Gn=!1;function G0(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Sp(i,l){i=i.updateQueue,l.updateQueue===i&&(l.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function fn(i,l){return{eventTime:i,lane:l,tag:0,payload:null,callback:null,next:null}}function Wn(i,l,u){var x=i.updateQueue;if(x===null)return null;if(x=x.shared,(ir&2)!==0){var v=x.pending;return v===null?l.next=l:(l.next=v.next,v.next=l),x.pending=l,mn(i,u)}return v=x.interleaved,v===null?(l.next=l,$0(x)):(l.next=v.next,v.next=l),x.interleaved=l,mn(i,u)}function pd(i,l,u){if(l=l.updateQueue,l!==null&&(l=l.shared,(u&4194240)!==0)){var x=l.lanes;x&=i.pendingLanes,u|=x,l.lanes=u,a0(i,u)}}function Ap(i,l){var u=i.updateQueue,x=i.alternate;if(x!==null&&(x=x.updateQueue,u===x)){var v=null,j=null;if(u=u.firstBaseUpdate,u!==null){do{var D={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};j===null?v=j=D:j=j.next=D,u=u.next}while(u!==null);j===null?v=j=l:j=j.next=l}else v=j=l;u={baseState:x.baseState,firstBaseUpdate:v,lastBaseUpdate:j,shared:x.shared,effects:x.effects},i.updateQueue=u;return}i=u.lastBaseUpdate,i===null?u.firstBaseUpdate=l:i.next=l,u.lastBaseUpdate=l}function gd(i,l,u,x){var v=i.updateQueue;Gn=!1;var j=v.firstBaseUpdate,D=v.lastBaseUpdate,le=v.shared.pending;if(le!==null){v.shared.pending=null;var fe=le,Ie=fe.next;fe.next=null,D===null?j=Ie:D.next=Ie,D=fe;var Ge=i.alternate;Ge!==null&&(Ge=Ge.updateQueue,le=Ge.lastBaseUpdate,le!==D&&(le===null?Ge.firstBaseUpdate=Ie:le.next=Ie,Ge.lastBaseUpdate=fe))}if(j!==null){var Xe=v.baseState;D=0,Ge=Ie=fe=null,le=j;do{var $e=le.lane,ft=le.eventTime;if((x&$e)===$e){Ge!==null&&(Ge=Ge.next={eventTime:ft,lane:0,tag:le.tag,payload:le.payload,callback:le.callback,next:null});e:{var yt=i,bt=le;switch($e=l,ft=u,bt.tag){case 1:if(yt=bt.payload,typeof yt=="function"){Xe=yt.call(ft,Xe,$e);break e}Xe=yt;break e;case 3:yt.flags=yt.flags&-65537|128;case 0:if(yt=bt.payload,$e=typeof yt=="function"?yt.call(ft,Xe,$e):yt,$e==null)break e;Xe=ee({},Xe,$e);break e;case 2:Gn=!0}}le.callback!==null&&le.lane!==0&&(i.flags|=64,$e=v.effects,$e===null?v.effects=[le]:$e.push(le))}else ft={eventTime:ft,lane:$e,tag:le.tag,payload:le.payload,callback:le.callback,next:null},Ge===null?(Ie=Ge=ft,fe=Xe):Ge=Ge.next=ft,D|=$e;if(le=le.next,le===null){if(le=v.shared.pending,le===null)break;$e=le,le=$e.next,$e.next=null,v.lastBaseUpdate=$e,v.shared.pending=null}}while(!0);if(Ge===null&&(fe=Xe),v.baseState=fe,v.firstBaseUpdate=Ie,v.lastBaseUpdate=Ge,l=v.shared.interleaved,l!==null){v=l;do D|=v.lane,v=v.next;while(v!==l)}else j===null&&(v.shared.lanes=0);Ri|=D,i.lanes=D,i.memoizedState=Xe}}function Cp(i,l,u){if(i=l.effects,l.effects=null,i!==null)for(l=0;l<i.length;l++){var x=i[l],v=x.callback;if(v!==null){if(x.callback=null,x=u,typeof v!="function")throw Error(s(191,v));v.call(x)}}}var jo={},qa=Vn(jo),Eo=Vn(jo),To=Vn(jo);function ki(i){if(i===jo)throw Error(s(174));return i}function W0(i,l){switch(wr(To,l),wr(Eo,i),wr(qa,jo),i=l.nodeType,i){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:Ot(null,"");break;default:i=i===8?l.parentNode:l,l=i.namespaceURI||null,i=i.tagName,l=Ot(l,i)}_r(qa),wr(qa,l)}function Al(){_r(qa),_r(Eo),_r(To)}function kp(i){ki(To.current);var l=ki(qa.current),u=Ot(l,i.type);l!==u&&(wr(Eo,i),wr(qa,u))}function z0(i){Eo.current===i&&(_r(qa),_r(Eo))}var Hr=Vn(0);function vd(i){for(var l=i;l!==null;){if(l.tag===13){var u=l.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var K0=[];function X0(){for(var i=0;i<K0.length;i++)K0[i]._workInProgressVersionPrimary=null;K0.length=0}var yd=R.ReactCurrentDispatcher,q0=R.ReactCurrentBatchConfig,Pi=0,Vr=null,os=null,fs=null,Nd=!1,So=!1,Ao=0,aT=0;function Cs(){throw Error(s(321))}function Y0(i,l){if(l===null)return!1;for(var u=0;u<l.length&&u<i.length;u++)if(!ka(i[u],l[u]))return!1;return!0}function J0(i,l,u,x,v,j){if(Pi=j,Vr=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,yd.current=i===null||i.memoizedState===null?oT:cT,i=u(x,v),So){j=0;do{if(So=!1,Ao=0,25<=j)throw Error(s(301));j+=1,fs=os=null,l.updateQueue=null,yd.current=dT,i=u(x,v)}while(So)}if(yd.current=jd,l=os!==null&&os.next!==null,Pi=0,fs=os=Vr=null,Nd=!1,l)throw Error(s(300));return i}function Q0(){var i=Ao!==0;return Ao=0,i}function Ya(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fs===null?Vr.memoizedState=fs=i:fs=fs.next=i,fs}function ya(){if(os===null){var i=Vr.alternate;i=i!==null?i.memoizedState:null}else i=os.next;var l=fs===null?Vr.memoizedState:fs.next;if(l!==null)fs=l,os=i;else{if(i===null)throw Error(s(310));os=i,i={memoizedState:os.memoizedState,baseState:os.baseState,baseQueue:os.baseQueue,queue:os.queue,next:null},fs===null?Vr.memoizedState=fs=i:fs=fs.next=i}return fs}function Co(i,l){return typeof l=="function"?l(i):l}function Z0(i){var l=ya(),u=l.queue;if(u===null)throw Error(s(311));u.lastRenderedReducer=i;var x=os,v=x.baseQueue,j=u.pending;if(j!==null){if(v!==null){var D=v.next;v.next=j.next,j.next=D}x.baseQueue=v=j,u.pending=null}if(v!==null){j=v.next,x=x.baseState;var le=D=null,fe=null,Ie=j;do{var Ge=Ie.lane;if((Pi&Ge)===Ge)fe!==null&&(fe=fe.next={lane:0,action:Ie.action,hasEagerState:Ie.hasEagerState,eagerState:Ie.eagerState,next:null}),x=Ie.hasEagerState?Ie.eagerState:i(x,Ie.action);else{var Xe={lane:Ge,action:Ie.action,hasEagerState:Ie.hasEagerState,eagerState:Ie.eagerState,next:null};fe===null?(le=fe=Xe,D=x):fe=fe.next=Xe,Vr.lanes|=Ge,Ri|=Ge}Ie=Ie.next}while(Ie!==null&&Ie!==j);fe===null?D=x:fe.next=le,ka(x,l.memoizedState)||(ea=!0),l.memoizedState=x,l.baseState=D,l.baseQueue=fe,u.lastRenderedState=x}if(i=u.interleaved,i!==null){v=i;do j=v.lane,Vr.lanes|=j,Ri|=j,v=v.next;while(v!==i)}else v===null&&(u.lanes=0);return[l.memoizedState,u.dispatch]}function eh(i){var l=ya(),u=l.queue;if(u===null)throw Error(s(311));u.lastRenderedReducer=i;var x=u.dispatch,v=u.pending,j=l.memoizedState;if(v!==null){u.pending=null;var D=v=v.next;do j=i(j,D.action),D=D.next;while(D!==v);ka(j,l.memoizedState)||(ea=!0),l.memoizedState=j,l.baseQueue===null&&(l.baseState=j),u.lastRenderedState=j}return[j,x]}function Pp(){}function Rp(i,l){var u=Vr,x=ya(),v=l(),j=!ka(x.memoizedState,v);if(j&&(x.memoizedState=v,ea=!0),x=x.queue,th(Op.bind(null,u,x,i),[i]),x.getSnapshot!==l||j||fs!==null&&fs.memoizedState.tag&1){if(u.flags|=2048,ko(9,Dp.bind(null,u,x,v,l),void 0,null),xs===null)throw Error(s(349));(Pi&30)!==0||_p(u,l,v)}return v}function _p(i,l,u){i.flags|=16384,i={getSnapshot:l,value:u},l=Vr.updateQueue,l===null?(l={lastEffect:null,stores:null},Vr.updateQueue=l,l.stores=[i]):(u=l.stores,u===null?l.stores=[i]:u.push(i))}function Dp(i,l,u,x){l.value=u,l.getSnapshot=x,Fp(l)&&Ip(i)}function Op(i,l,u){return u(function(){Fp(l)&&Ip(i)})}function Fp(i){var l=i.getSnapshot;i=i.value;try{var u=l();return!ka(i,u)}catch{return!0}}function Ip(i){var l=mn(i,1);l!==null&&Oa(l,i,1,-1)}function Mp(i){var l=Ya();return typeof i=="function"&&(i=i()),l.memoizedState=l.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Co,lastRenderedState:i},l.queue=i,i=i.dispatch=lT.bind(null,Vr,i),[l.memoizedState,i]}function ko(i,l,u,x){return i={tag:i,create:l,destroy:u,deps:x,next:null},l=Vr.updateQueue,l===null?(l={lastEffect:null,stores:null},Vr.updateQueue=l,l.lastEffect=i.next=i):(u=l.lastEffect,u===null?l.lastEffect=i.next=i:(x=u.next,u.next=i,i.next=x,l.lastEffect=i)),i}function Lp(){return ya().memoizedState}function wd(i,l,u,x){var v=Ya();Vr.flags|=i,v.memoizedState=ko(1|l,u,void 0,x===void 0?null:x)}function bd(i,l,u,x){var v=ya();x=x===void 0?null:x;var j=void 0;if(os!==null){var D=os.memoizedState;if(j=D.destroy,x!==null&&Y0(x,D.deps)){v.memoizedState=ko(l,u,j,x);return}}Vr.flags|=i,v.memoizedState=ko(1|l,u,j,x)}function Bp(i,l){return wd(8390656,8,i,l)}function th(i,l){return bd(2048,8,i,l)}function Hp(i,l){return bd(4,2,i,l)}function Vp(i,l){return bd(4,4,i,l)}function Up(i,l){if(typeof l=="function")return i=i(),l(i),function(){l(null)};if(l!=null)return i=i(),l.current=i,function(){l.current=null}}function $p(i,l,u){return u=u!=null?u.concat([i]):null,bd(4,4,Up.bind(null,l,i),u)}function rh(){}function Gp(i,l){var u=ya();l=l===void 0?null:l;var x=u.memoizedState;return x!==null&&l!==null&&Y0(l,x[1])?x[0]:(u.memoizedState=[i,l],i)}function Wp(i,l){var u=ya();l=l===void 0?null:l;var x=u.memoizedState;return x!==null&&l!==null&&Y0(l,x[1])?x[0]:(i=i(),u.memoizedState=[i,l],i)}function zp(i,l,u){return(Pi&21)===0?(i.baseState&&(i.baseState=!1,ea=!0),i.memoizedState=u):(ka(u,l)||(u=bx(),Vr.lanes|=u,Ri|=u,i.baseState=!0),l)}function nT(i,l){var u=hr;hr=u!==0&&4>u?u:4,i(!0);var x=q0.transition;q0.transition={};try{i(!1),l()}finally{hr=u,q0.transition=x}}function Kp(){return ya().memoizedState}function iT(i,l,u){var x=qn(i);if(u={lane:x,action:u,hasEagerState:!1,eagerState:null,next:null},Xp(i))qp(l,u);else if(u=Tp(i,l,u,x),u!==null){var v=Vs();Oa(u,i,x,v),Yp(u,l,x)}}function lT(i,l,u){var x=qn(i),v={lane:x,action:u,hasEagerState:!1,eagerState:null,next:null};if(Xp(i))qp(l,v);else{var j=i.alternate;if(i.lanes===0&&(j===null||j.lanes===0)&&(j=l.lastRenderedReducer,j!==null))try{var D=l.lastRenderedState,le=j(D,u);if(v.hasEagerState=!0,v.eagerState=le,ka(le,D)){var fe=l.interleaved;fe===null?(v.next=v,$0(l)):(v.next=fe.next,fe.next=v),l.interleaved=v;return}}catch{}finally{}u=Tp(i,l,v,x),u!==null&&(v=Vs(),Oa(u,i,x,v),Yp(u,l,x))}}function Xp(i){var l=i.alternate;return i===Vr||l!==null&&l===Vr}function qp(i,l){So=Nd=!0;var u=i.pending;u===null?l.next=l:(l.next=u.next,u.next=l),i.pending=l}function Yp(i,l,u){if((u&4194240)!==0){var x=l.lanes;x&=i.pendingLanes,u|=x,l.lanes=u,a0(i,u)}}var jd={readContext:va,useCallback:Cs,useContext:Cs,useEffect:Cs,useImperativeHandle:Cs,useInsertionEffect:Cs,useLayoutEffect:Cs,useMemo:Cs,useReducer:Cs,useRef:Cs,useState:Cs,useDebugValue:Cs,useDeferredValue:Cs,useTransition:Cs,useMutableSource:Cs,useSyncExternalStore:Cs,useId:Cs,unstable_isNewReconciler:!1},oT={readContext:va,useCallback:function(i,l){return Ya().memoizedState=[i,l===void 0?null:l],i},useContext:va,useEffect:Bp,useImperativeHandle:function(i,l,u){return u=u!=null?u.concat([i]):null,wd(4194308,4,Up.bind(null,l,i),u)},useLayoutEffect:function(i,l){return wd(4194308,4,i,l)},useInsertionEffect:function(i,l){return wd(4,2,i,l)},useMemo:function(i,l){var u=Ya();return l=l===void 0?null:l,i=i(),u.memoizedState=[i,l],i},useReducer:function(i,l,u){var x=Ya();return l=u!==void 0?u(l):l,x.memoizedState=x.baseState=l,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:l},x.queue=i,i=i.dispatch=iT.bind(null,Vr,i),[x.memoizedState,i]},useRef:function(i){var l=Ya();return i={current:i},l.memoizedState=i},useState:Mp,useDebugValue:rh,useDeferredValue:function(i){return Ya().memoizedState=i},useTransition:function(){var i=Mp(!1),l=i[0];return i=nT.bind(null,i[1]),Ya().memoizedState=i,[l,i]},useMutableSource:function(){},useSyncExternalStore:function(i,l,u){var x=Vr,v=Ya();if(Mr){if(u===void 0)throw Error(s(407));u=u()}else{if(u=l(),xs===null)throw Error(s(349));(Pi&30)!==0||_p(x,l,u)}v.memoizedState=u;var j={value:u,getSnapshot:l};return v.queue=j,Bp(Op.bind(null,x,j,i),[i]),x.flags|=2048,ko(9,Dp.bind(null,x,j,u,l),void 0,null),u},useId:function(){var i=Ya(),l=xs.identifierPrefix;if(Mr){var u=hn,x=un;u=(x&~(1<<32-nr(x)-1)).toString(32)+u,l=":"+l+"R"+u,u=Ao++,0<u&&(l+="H"+u.toString(32)),l+=":"}else u=aT++,l=":"+l+"r"+u.toString(32)+":";return i.memoizedState=l},unstable_isNewReconciler:!1},cT={readContext:va,useCallback:Gp,useContext:va,useEffect:th,useImperativeHandle:$p,useInsertionEffect:Hp,useLayoutEffect:Vp,useMemo:Wp,useReducer:Z0,useRef:Lp,useState:function(){return Z0(Co)},useDebugValue:rh,useDeferredValue:function(i){var l=ya();return zp(l,os.memoizedState,i)},useTransition:function(){var i=Z0(Co)[0],l=ya().memoizedState;return[i,l]},useMutableSource:Pp,useSyncExternalStore:Rp,useId:Kp,unstable_isNewReconciler:!1},dT={readContext:va,useCallback:Gp,useContext:va,useEffect:th,useImperativeHandle:$p,useInsertionEffect:Hp,useLayoutEffect:Vp,useMemo:Wp,useReducer:eh,useRef:Lp,useState:function(){return eh(Co)},useDebugValue:rh,useDeferredValue:function(i){var l=ya();return os===null?l.memoizedState=i:zp(l,os.memoizedState,i)},useTransition:function(){var i=eh(Co)[0],l=ya().memoizedState;return[i,l]},useMutableSource:Pp,useSyncExternalStore:Rp,useId:Kp,unstable_isNewReconciler:!1};function Ra(i,l){if(i&&i.defaultProps){l=ee({},l),i=i.defaultProps;for(var u in i)l[u]===void 0&&(l[u]=i[u]);return l}return l}function sh(i,l,u,x){l=i.memoizedState,u=u(x,l),u=u==null?l:ee({},l,u),i.memoizedState=u,i.lanes===0&&(i.updateQueue.baseState=u)}var Ed={isMounted:function(i){return(i=i._reactInternals)?se(i)===i:!1},enqueueSetState:function(i,l,u){i=i._reactInternals;var x=Vs(),v=qn(i),j=fn(x,v);j.payload=l,u!=null&&(j.callback=u),l=Wn(i,j,v),l!==null&&(Oa(l,i,v,x),pd(l,i,v))},enqueueReplaceState:function(i,l,u){i=i._reactInternals;var x=Vs(),v=qn(i),j=fn(x,v);j.tag=1,j.payload=l,u!=null&&(j.callback=u),l=Wn(i,j,v),l!==null&&(Oa(l,i,v,x),pd(l,i,v))},enqueueForceUpdate:function(i,l){i=i._reactInternals;var u=Vs(),x=qn(i),v=fn(u,x);v.tag=2,l!=null&&(v.callback=l),l=Wn(i,v,x),l!==null&&(Oa(l,i,x,u),pd(l,i,x))}};function Jp(i,l,u,x,v,j,D){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(x,j,D):l.prototype&&l.prototype.isPureReactComponent?!xo(u,x)||!xo(v,j):!0}function Qp(i,l,u){var x=!1,v=Un,j=l.contextType;return typeof j=="object"&&j!==null?j=va(j):(v=Zs(l)?Ti:As.current,x=l.contextTypes,j=(x=x!=null)?Nl(i,v):Un),l=new l(u,j),i.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=Ed,i.stateNode=l,l._reactInternals=i,x&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=v,i.__reactInternalMemoizedMaskedChildContext=j),l}function Zp(i,l,u,x){i=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(u,x),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(u,x),l.state!==i&&Ed.enqueueReplaceState(l,l.state,null)}function ah(i,l,u,x){var v=i.stateNode;v.props=u,v.state=i.memoizedState,v.refs={},G0(i);var j=l.contextType;typeof j=="object"&&j!==null?v.context=va(j):(j=Zs(l)?Ti:As.current,v.context=Nl(i,j)),v.state=i.memoizedState,j=l.getDerivedStateFromProps,typeof j=="function"&&(sh(i,l,j,u),v.state=i.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(l=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),l!==v.state&&Ed.enqueueReplaceState(v,v.state,null),gd(i,u,v,x),v.state=i.memoizedState),typeof v.componentDidMount=="function"&&(i.flags|=4194308)}function Cl(i,l){try{var u="",x=l;do u+=G(x),x=x.return;while(x);var v=u}catch(j){v=`
Error generating stack: `+j.message+`
`+j.stack}return{value:i,source:l,stack:v,digest:null}}function nh(i,l,u){return{value:i,source:null,stack:u??null,digest:l??null}}function ih(i,l){try{console.error(l.value)}catch(u){setTimeout(function(){throw u})}}var uT=typeof WeakMap=="function"?WeakMap:Map;function eg(i,l,u){u=fn(-1,u),u.tag=3,u.payload={element:null};var x=l.value;return u.callback=function(){Rd||(Rd=!0,wh=x),ih(i,l)},u}function tg(i,l,u){u=fn(-1,u),u.tag=3;var x=i.type.getDerivedStateFromError;if(typeof x=="function"){var v=l.value;u.payload=function(){return x(v)},u.callback=function(){ih(i,l)}}var j=i.stateNode;return j!==null&&typeof j.componentDidCatch=="function"&&(u.callback=function(){ih(i,l),typeof x!="function"&&(Kn===null?Kn=new Set([this]):Kn.add(this));var D=l.stack;this.componentDidCatch(l.value,{componentStack:D!==null?D:""})}),u}function rg(i,l,u){var x=i.pingCache;if(x===null){x=i.pingCache=new uT;var v=new Set;x.set(l,v)}else v=x.get(l),v===void 0&&(v=new Set,x.set(l,v));v.has(u)||(v.add(u),i=TT.bind(null,i,l,u),l.then(i,i))}function sg(i){do{var l;if((l=i.tag===13)&&(l=i.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return i;i=i.return}while(i!==null);return null}function ag(i,l,u,x,v){return(i.mode&1)===0?(i===l?i.flags|=65536:(i.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(l=fn(-1,1),l.tag=2,Wn(u,l,1))),u.lanes|=1),i):(i.flags|=65536,i.lanes=v,i)}var hT=R.ReactCurrentOwner,ea=!1;function Hs(i,l,u,x){l.child=i===null?Ep(l,null,u,x):El(l,i.child,u,x)}function ng(i,l,u,x,v){u=u.render;var j=l.ref;return Sl(l,v),x=J0(i,l,u,x,j,v),u=Q0(),i!==null&&!ea?(l.updateQueue=i.updateQueue,l.flags&=-2053,i.lanes&=~v,xn(i,l,v)):(Mr&&u&&O0(l),l.flags|=1,Hs(i,l,x,v),l.child)}function ig(i,l,u,x,v){if(i===null){var j=u.type;return typeof j=="function"&&!Ch(j)&&j.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(l.tag=15,l.type=j,lg(i,l,j,x,v)):(i=Md(u.type,null,x,l,l.mode,v),i.ref=l.ref,i.return=l,l.child=i)}if(j=i.child,(i.lanes&v)===0){var D=j.memoizedProps;if(u=u.compare,u=u!==null?u:xo,u(D,x)&&i.ref===l.ref)return xn(i,l,v)}return l.flags|=1,i=Jn(j,x),i.ref=l.ref,i.return=l,l.child=i}function lg(i,l,u,x,v){if(i!==null){var j=i.memoizedProps;if(xo(j,x)&&i.ref===l.ref)if(ea=!1,l.pendingProps=x=j,(i.lanes&v)!==0)(i.flags&131072)!==0&&(ea=!0);else return l.lanes=i.lanes,xn(i,l,v)}return lh(i,l,u,x,v)}function og(i,l,u){var x=l.pendingProps,v=x.children,j=i!==null?i.memoizedState:null;if(x.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},wr(Pl,da),da|=u;else{if((u&1073741824)===0)return i=j!==null?j.baseLanes|u:u,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:i,cachePool:null,transitions:null},l.updateQueue=null,wr(Pl,da),da|=i,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},x=j!==null?j.baseLanes:u,wr(Pl,da),da|=x}else j!==null?(x=j.baseLanes|u,l.memoizedState=null):x=u,wr(Pl,da),da|=x;return Hs(i,l,v,u),l.child}function cg(i,l){var u=l.ref;(i===null&&u!==null||i!==null&&i.ref!==u)&&(l.flags|=512,l.flags|=2097152)}function lh(i,l,u,x,v){var j=Zs(u)?Ti:As.current;return j=Nl(l,j),Sl(l,v),u=J0(i,l,u,x,j,v),x=Q0(),i!==null&&!ea?(l.updateQueue=i.updateQueue,l.flags&=-2053,i.lanes&=~v,xn(i,l,v)):(Mr&&x&&O0(l),l.flags|=1,Hs(i,l,u,v),l.child)}function dg(i,l,u,x,v){if(Zs(u)){var j=!0;od(l)}else j=!1;if(Sl(l,v),l.stateNode===null)Sd(i,l),Qp(l,u,x),ah(l,u,x,v),x=!0;else if(i===null){var D=l.stateNode,le=l.memoizedProps;D.props=le;var fe=D.context,Ie=u.contextType;typeof Ie=="object"&&Ie!==null?Ie=va(Ie):(Ie=Zs(u)?Ti:As.current,Ie=Nl(l,Ie));var Ge=u.getDerivedStateFromProps,Xe=typeof Ge=="function"||typeof D.getSnapshotBeforeUpdate=="function";Xe||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(le!==x||fe!==Ie)&&Zp(l,D,x,Ie),Gn=!1;var $e=l.memoizedState;D.state=$e,gd(l,x,D,v),fe=l.memoizedState,le!==x||$e!==fe||Qs.current||Gn?(typeof Ge=="function"&&(sh(l,u,Ge,x),fe=l.memoizedState),(le=Gn||Jp(l,u,le,x,$e,fe,Ie))?(Xe||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(l.flags|=4194308)):(typeof D.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=x,l.memoizedState=fe),D.props=x,D.state=fe,D.context=Ie,x=le):(typeof D.componentDidMount=="function"&&(l.flags|=4194308),x=!1)}else{D=l.stateNode,Sp(i,l),le=l.memoizedProps,Ie=l.type===l.elementType?le:Ra(l.type,le),D.props=Ie,Xe=l.pendingProps,$e=D.context,fe=u.contextType,typeof fe=="object"&&fe!==null?fe=va(fe):(fe=Zs(u)?Ti:As.current,fe=Nl(l,fe));var ft=u.getDerivedStateFromProps;(Ge=typeof ft=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(le!==Xe||$e!==fe)&&Zp(l,D,x,fe),Gn=!1,$e=l.memoizedState,D.state=$e,gd(l,x,D,v);var yt=l.memoizedState;le!==Xe||$e!==yt||Qs.current||Gn?(typeof ft=="function"&&(sh(l,u,ft,x),yt=l.memoizedState),(Ie=Gn||Jp(l,u,Ie,x,$e,yt,fe)||!1)?(Ge||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(x,yt,fe),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(x,yt,fe)),typeof D.componentDidUpdate=="function"&&(l.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof D.componentDidUpdate!="function"||le===i.memoizedProps&&$e===i.memoizedState||(l.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||le===i.memoizedProps&&$e===i.memoizedState||(l.flags|=1024),l.memoizedProps=x,l.memoizedState=yt),D.props=x,D.state=yt,D.context=fe,x=Ie):(typeof D.componentDidUpdate!="function"||le===i.memoizedProps&&$e===i.memoizedState||(l.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||le===i.memoizedProps&&$e===i.memoizedState||(l.flags|=1024),x=!1)}return oh(i,l,u,x,j,v)}function oh(i,l,u,x,v,j){cg(i,l);var D=(l.flags&128)!==0;if(!x&&!D)return v&&xp(l,u,!1),xn(i,l,j);x=l.stateNode,hT.current=l;var le=D&&typeof u.getDerivedStateFromError!="function"?null:x.render();return l.flags|=1,i!==null&&D?(l.child=El(l,i.child,null,j),l.child=El(l,null,le,j)):Hs(i,l,le,j),l.memoizedState=x.state,v&&xp(l,u,!0),l.child}function ug(i){var l=i.stateNode;l.pendingContext?mp(i,l.pendingContext,l.pendingContext!==l.context):l.context&&mp(i,l.context,!1),W0(i,l.containerInfo)}function hg(i,l,u,x,v){return jl(),L0(v),l.flags|=256,Hs(i,l,u,x),l.child}var ch={dehydrated:null,treeContext:null,retryLane:0};function dh(i){return{baseLanes:i,cachePool:null,transitions:null}}function mg(i,l,u){var x=l.pendingProps,v=Hr.current,j=!1,D=(l.flags&128)!==0,le;if((le=D)||(le=i!==null&&i.memoizedState===null?!1:(v&2)!==0),le?(j=!0,l.flags&=-129):(i===null||i.memoizedState!==null)&&(v|=1),wr(Hr,v&1),i===null)return M0(l),i=l.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((l.mode&1)===0?l.lanes=1:i.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(D=x.children,i=x.fallback,j?(x=l.mode,j=l.child,D={mode:"hidden",children:D},(x&1)===0&&j!==null?(j.childLanes=0,j.pendingProps=D):j=Ld(D,x,0,null),i=Fi(i,x,u,null),j.return=l,i.return=l,j.sibling=i,l.child=j,l.child.memoizedState=dh(u),l.memoizedState=ch,i):uh(l,D));if(v=i.memoizedState,v!==null&&(le=v.dehydrated,le!==null))return mT(i,l,D,x,le,v,u);if(j){j=x.fallback,D=l.mode,v=i.child,le=v.sibling;var fe={mode:"hidden",children:x.children};return(D&1)===0&&l.child!==v?(x=l.child,x.childLanes=0,x.pendingProps=fe,l.deletions=null):(x=Jn(v,fe),x.subtreeFlags=v.subtreeFlags&14680064),le!==null?j=Jn(le,j):(j=Fi(j,D,u,null),j.flags|=2),j.return=l,x.return=l,x.sibling=j,l.child=x,x=j,j=l.child,D=i.child.memoizedState,D=D===null?dh(u):{baseLanes:D.baseLanes|u,cachePool:null,transitions:D.transitions},j.memoizedState=D,j.childLanes=i.childLanes&~u,l.memoizedState=ch,x}return j=i.child,i=j.sibling,x=Jn(j,{mode:"visible",children:x.children}),(l.mode&1)===0&&(x.lanes=u),x.return=l,x.sibling=null,i!==null&&(u=l.deletions,u===null?(l.deletions=[i],l.flags|=16):u.push(i)),l.child=x,l.memoizedState=null,x}function uh(i,l){return l=Ld({mode:"visible",children:l},i.mode,0,null),l.return=i,i.child=l}function Td(i,l,u,x){return x!==null&&L0(x),El(l,i.child,null,u),i=uh(l,l.pendingProps.children),i.flags|=2,l.memoizedState=null,i}function mT(i,l,u,x,v,j,D){if(u)return l.flags&256?(l.flags&=-257,x=nh(Error(s(422))),Td(i,l,D,x)):l.memoizedState!==null?(l.child=i.child,l.flags|=128,null):(j=x.fallback,v=l.mode,x=Ld({mode:"visible",children:x.children},v,0,null),j=Fi(j,v,D,null),j.flags|=2,x.return=l,j.return=l,x.sibling=j,l.child=x,(l.mode&1)!==0&&El(l,i.child,null,D),l.child.memoizedState=dh(D),l.memoizedState=ch,j);if((l.mode&1)===0)return Td(i,l,D,null);if(v.data==="$!"){if(x=v.nextSibling&&v.nextSibling.dataset,x)var le=x.dgst;return x=le,j=Error(s(419)),x=nh(j,x,void 0),Td(i,l,D,x)}if(le=(D&i.childLanes)!==0,ea||le){if(x=xs,x!==null){switch(D&-D){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=(v&(x.suspendedLanes|D))!==0?0:v,v!==0&&v!==j.retryLane&&(j.retryLane=v,mn(i,v),Oa(x,i,v,-1))}return Ah(),x=nh(Error(s(421))),Td(i,l,D,x)}return v.data==="$?"?(l.flags|=128,l.child=i.child,l=ST.bind(null,i),v._reactRetry=l,null):(i=j.treeContext,ca=Hn(v.nextSibling),oa=l,Mr=!0,Pa=null,i!==null&&(pa[ga++]=un,pa[ga++]=hn,pa[ga++]=Si,un=i.id,hn=i.overflow,Si=l),l=uh(l,x.children),l.flags|=4096,l)}function fg(i,l,u){i.lanes|=l;var x=i.alternate;x!==null&&(x.lanes|=l),U0(i.return,l,u)}function hh(i,l,u,x,v){var j=i.memoizedState;j===null?i.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:x,tail:u,tailMode:v}:(j.isBackwards=l,j.rendering=null,j.renderingStartTime=0,j.last=x,j.tail=u,j.tailMode=v)}function xg(i,l,u){var x=l.pendingProps,v=x.revealOrder,j=x.tail;if(Hs(i,l,x.children,u),x=Hr.current,(x&2)!==0)x=x&1|2,l.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=l.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&fg(i,u,l);else if(i.tag===19)fg(i,u,l);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===l)break e;for(;i.sibling===null;){if(i.return===null||i.return===l)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}x&=1}if(wr(Hr,x),(l.mode&1)===0)l.memoizedState=null;else switch(v){case"forwards":for(u=l.child,v=null;u!==null;)i=u.alternate,i!==null&&vd(i)===null&&(v=u),u=u.sibling;u=v,u===null?(v=l.child,l.child=null):(v=u.sibling,u.sibling=null),hh(l,!1,v,u,j);break;case"backwards":for(u=null,v=l.child,l.child=null;v!==null;){if(i=v.alternate,i!==null&&vd(i)===null){l.child=v;break}i=v.sibling,v.sibling=u,u=v,v=i}hh(l,!0,u,null,j);break;case"together":hh(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function Sd(i,l){(l.mode&1)===0&&i!==null&&(i.alternate=null,l.alternate=null,l.flags|=2)}function xn(i,l,u){if(i!==null&&(l.dependencies=i.dependencies),Ri|=l.lanes,(u&l.childLanes)===0)return null;if(i!==null&&l.child!==i.child)throw Error(s(153));if(l.child!==null){for(i=l.child,u=Jn(i,i.pendingProps),l.child=u,u.return=l;i.sibling!==null;)i=i.sibling,u=u.sibling=Jn(i,i.pendingProps),u.return=l;u.sibling=null}return l.child}function fT(i,l,u){switch(l.tag){case 3:ug(l),jl();break;case 5:kp(l);break;case 1:Zs(l.type)&&od(l);break;case 4:W0(l,l.stateNode.containerInfo);break;case 10:var x=l.type._context,v=l.memoizedProps.value;wr(fd,x._currentValue),x._currentValue=v;break;case 13:if(x=l.memoizedState,x!==null)return x.dehydrated!==null?(wr(Hr,Hr.current&1),l.flags|=128,null):(u&l.child.childLanes)!==0?mg(i,l,u):(wr(Hr,Hr.current&1),i=xn(i,l,u),i!==null?i.sibling:null);wr(Hr,Hr.current&1);break;case 19:if(x=(u&l.childLanes)!==0,(i.flags&128)!==0){if(x)return xg(i,l,u);l.flags|=128}if(v=l.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),wr(Hr,Hr.current),x)break;return null;case 22:case 23:return l.lanes=0,og(i,l,u)}return xn(i,l,u)}var pg,mh,gg,vg;pg=function(i,l){for(var u=l.child;u!==null;){if(u.tag===5||u.tag===6)i.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return;u=u.return}u.sibling.return=u.return,u=u.sibling}},mh=function(){},gg=function(i,l,u,x){var v=i.memoizedProps;if(v!==x){i=l.stateNode,ki(qa.current);var j=null;switch(u){case"input":v=we(i,v),x=we(i,x),j=[];break;case"select":v=ee({},v,{value:void 0}),x=ee({},x,{value:void 0}),j=[];break;case"textarea":v=Ze(i,v),x=Ze(i,x),j=[];break;default:typeof v.onClick!="function"&&typeof x.onClick=="function"&&(i.onclick=nd)}Je(u,x);var D;u=null;for(Ie in v)if(!x.hasOwnProperty(Ie)&&v.hasOwnProperty(Ie)&&v[Ie]!=null)if(Ie==="style"){var le=v[Ie];for(D in le)le.hasOwnProperty(D)&&(u||(u={}),u[D]="")}else Ie!=="dangerouslySetInnerHTML"&&Ie!=="children"&&Ie!=="suppressContentEditableWarning"&&Ie!=="suppressHydrationWarning"&&Ie!=="autoFocus"&&(n.hasOwnProperty(Ie)?j||(j=[]):(j=j||[]).push(Ie,null));for(Ie in x){var fe=x[Ie];if(le=v?.[Ie],x.hasOwnProperty(Ie)&&fe!==le&&(fe!=null||le!=null))if(Ie==="style")if(le){for(D in le)!le.hasOwnProperty(D)||fe&&fe.hasOwnProperty(D)||(u||(u={}),u[D]="");for(D in fe)fe.hasOwnProperty(D)&&le[D]!==fe[D]&&(u||(u={}),u[D]=fe[D])}else u||(j||(j=[]),j.push(Ie,u)),u=fe;else Ie==="dangerouslySetInnerHTML"?(fe=fe?fe.__html:void 0,le=le?le.__html:void 0,fe!=null&&le!==fe&&(j=j||[]).push(Ie,fe)):Ie==="children"?typeof fe!="string"&&typeof fe!="number"||(j=j||[]).push(Ie,""+fe):Ie!=="suppressContentEditableWarning"&&Ie!=="suppressHydrationWarning"&&(n.hasOwnProperty(Ie)?(fe!=null&&Ie==="onScroll"&&Rr("scroll",i),j||le===fe||(j=[])):(j=j||[]).push(Ie,fe))}u&&(j=j||[]).push("style",u);var Ie=j;(l.updateQueue=Ie)&&(l.flags|=4)}},vg=function(i,l,u,x){u!==x&&(l.flags|=4)};function Po(i,l){if(!Mr)switch(i.tailMode){case"hidden":l=i.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?i.tail=null:u.sibling=null;break;case"collapsed":u=i.tail;for(var x=null;u!==null;)u.alternate!==null&&(x=u),u=u.sibling;x===null?l||i.tail===null?i.tail=null:i.tail.sibling=null:x.sibling=null}}function ks(i){var l=i.alternate!==null&&i.alternate.child===i.child,u=0,x=0;if(l)for(var v=i.child;v!==null;)u|=v.lanes|v.childLanes,x|=v.subtreeFlags&14680064,x|=v.flags&14680064,v.return=i,v=v.sibling;else for(v=i.child;v!==null;)u|=v.lanes|v.childLanes,x|=v.subtreeFlags,x|=v.flags,v.return=i,v=v.sibling;return i.subtreeFlags|=x,i.childLanes=u,l}function xT(i,l,u){var x=l.pendingProps;switch(F0(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ks(l),null;case 1:return Zs(l.type)&&ld(),ks(l),null;case 3:return x=l.stateNode,Al(),_r(Qs),_r(As),X0(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(i===null||i.child===null)&&(hd(l)?l.flags|=4:i===null||i.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Pa!==null&&(Eh(Pa),Pa=null))),mh(i,l),ks(l),null;case 5:z0(l);var v=ki(To.current);if(u=l.type,i!==null&&l.stateNode!=null)gg(i,l,u,x,v),i.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!x){if(l.stateNode===null)throw Error(s(166));return ks(l),null}if(i=ki(qa.current),hd(l)){x=l.stateNode,u=l.type;var j=l.memoizedProps;switch(x[Xa]=l,x[No]=j,i=(l.mode&1)!==0,u){case"dialog":Rr("cancel",x),Rr("close",x);break;case"iframe":case"object":case"embed":Rr("load",x);break;case"video":case"audio":for(v=0;v<go.length;v++)Rr(go[v],x);break;case"source":Rr("error",x);break;case"img":case"image":case"link":Rr("error",x),Rr("load",x);break;case"details":Rr("toggle",x);break;case"input":ot(x,j),Rr("invalid",x);break;case"select":x._wrapperState={wasMultiple:!!j.multiple},Rr("invalid",x);break;case"textarea":Xt(x,j),Rr("invalid",x)}Je(u,j),v=null;for(var D in j)if(j.hasOwnProperty(D)){var le=j[D];D==="children"?typeof le=="string"?x.textContent!==le&&(j.suppressHydrationWarning!==!0&&ad(x.textContent,le,i),v=["children",le]):typeof le=="number"&&x.textContent!==""+le&&(j.suppressHydrationWarning!==!0&&ad(x.textContent,le,i),v=["children",""+le]):n.hasOwnProperty(D)&&le!=null&&D==="onScroll"&&Rr("scroll",x)}switch(u){case"input":We(x),Nt(x,j,!0);break;case"textarea":We(x),ht(x);break;case"select":case"option":break;default:typeof j.onClick=="function"&&(x.onclick=nd)}x=v,l.updateQueue=x,x!==null&&(l.flags|=4)}else{D=v.nodeType===9?v:v.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=nt(u)),i==="http://www.w3.org/1999/xhtml"?u==="script"?(i=D.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof x.is=="string"?i=D.createElement(u,{is:x.is}):(i=D.createElement(u),u==="select"&&(D=i,x.multiple?D.multiple=!0:x.size&&(D.size=x.size))):i=D.createElementNS(i,u),i[Xa]=l,i[No]=x,pg(i,l,!1,!1),l.stateNode=i;e:{switch(D=mt(u,x),u){case"dialog":Rr("cancel",i),Rr("close",i),v=x;break;case"iframe":case"object":case"embed":Rr("load",i),v=x;break;case"video":case"audio":for(v=0;v<go.length;v++)Rr(go[v],i);v=x;break;case"source":Rr("error",i),v=x;break;case"img":case"image":case"link":Rr("error",i),Rr("load",i),v=x;break;case"details":Rr("toggle",i),v=x;break;case"input":ot(i,x),v=we(i,x),Rr("invalid",i);break;case"option":v=x;break;case"select":i._wrapperState={wasMultiple:!!x.multiple},v=ee({},x,{value:void 0}),Rr("invalid",i);break;case"textarea":Xt(i,x),v=Ze(i,x),Rr("invalid",i);break;default:v=x}Je(u,v),le=v;for(j in le)if(le.hasOwnProperty(j)){var fe=le[j];j==="style"?B(i,fe):j==="dangerouslySetInnerHTML"?(fe=fe?fe.__html:void 0,fe!=null&&Jt(i,fe)):j==="children"?typeof fe=="string"?(u!=="textarea"||fe!=="")&&et(i,fe):typeof fe=="number"&&et(i,""+fe):j!=="suppressContentEditableWarning"&&j!=="suppressHydrationWarning"&&j!=="autoFocus"&&(n.hasOwnProperty(j)?fe!=null&&j==="onScroll"&&Rr("scroll",i):fe!=null&&E(i,j,fe,D))}switch(u){case"input":We(i),Nt(i,x,!1);break;case"textarea":We(i),ht(i);break;case"option":x.value!=null&&i.setAttribute("value",""+Ee(x.value));break;case"select":i.multiple=!!x.multiple,j=x.value,j!=null?jt(i,!!x.multiple,j,!1):x.defaultValue!=null&&jt(i,!!x.multiple,x.defaultValue,!0);break;default:typeof v.onClick=="function"&&(i.onclick=nd)}switch(u){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}}x&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return ks(l),null;case 6:if(i&&l.stateNode!=null)vg(i,l,i.memoizedProps,x);else{if(typeof x!="string"&&l.stateNode===null)throw Error(s(166));if(u=ki(To.current),ki(qa.current),hd(l)){if(x=l.stateNode,u=l.memoizedProps,x[Xa]=l,(j=x.nodeValue!==u)&&(i=oa,i!==null))switch(i.tag){case 3:ad(x.nodeValue,u,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&ad(x.nodeValue,u,(i.mode&1)!==0)}j&&(l.flags|=4)}else x=(u.nodeType===9?u:u.ownerDocument).createTextNode(x),x[Xa]=l,l.stateNode=x}return ks(l),null;case 13:if(_r(Hr),x=l.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(Mr&&ca!==null&&(l.mode&1)!==0&&(l.flags&128)===0)wp(),jl(),l.flags|=98560,j=!1;else if(j=hd(l),x!==null&&x.dehydrated!==null){if(i===null){if(!j)throw Error(s(318));if(j=l.memoizedState,j=j!==null?j.dehydrated:null,!j)throw Error(s(317));j[Xa]=l}else jl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;ks(l),j=!1}else Pa!==null&&(Eh(Pa),Pa=null),j=!0;if(!j)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=u,l):(x=x!==null,x!==(i!==null&&i.memoizedState!==null)&&x&&(l.child.flags|=8192,(l.mode&1)!==0&&(i===null||(Hr.current&1)!==0?cs===0&&(cs=3):Ah())),l.updateQueue!==null&&(l.flags|=4),ks(l),null);case 4:return Al(),mh(i,l),i===null&&vo(l.stateNode.containerInfo),ks(l),null;case 10:return V0(l.type._context),ks(l),null;case 17:return Zs(l.type)&&ld(),ks(l),null;case 19:if(_r(Hr),j=l.memoizedState,j===null)return ks(l),null;if(x=(l.flags&128)!==0,D=j.rendering,D===null)if(x)Po(j,!1);else{if(cs!==0||i!==null&&(i.flags&128)!==0)for(i=l.child;i!==null;){if(D=vd(i),D!==null){for(l.flags|=128,Po(j,!1),x=D.updateQueue,x!==null&&(l.updateQueue=x,l.flags|=4),l.subtreeFlags=0,x=u,u=l.child;u!==null;)j=u,i=x,j.flags&=14680066,D=j.alternate,D===null?(j.childLanes=0,j.lanes=i,j.child=null,j.subtreeFlags=0,j.memoizedProps=null,j.memoizedState=null,j.updateQueue=null,j.dependencies=null,j.stateNode=null):(j.childLanes=D.childLanes,j.lanes=D.lanes,j.child=D.child,j.subtreeFlags=0,j.deletions=null,j.memoizedProps=D.memoizedProps,j.memoizedState=D.memoizedState,j.updateQueue=D.updateQueue,j.type=D.type,i=D.dependencies,j.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),u=u.sibling;return wr(Hr,Hr.current&1|2),l.child}i=i.sibling}j.tail!==null&&Ne()>Rl&&(l.flags|=128,x=!0,Po(j,!1),l.lanes=4194304)}else{if(!x)if(i=vd(D),i!==null){if(l.flags|=128,x=!0,u=i.updateQueue,u!==null&&(l.updateQueue=u,l.flags|=4),Po(j,!0),j.tail===null&&j.tailMode==="hidden"&&!D.alternate&&!Mr)return ks(l),null}else 2*Ne()-j.renderingStartTime>Rl&&u!==1073741824&&(l.flags|=128,x=!0,Po(j,!1),l.lanes=4194304);j.isBackwards?(D.sibling=l.child,l.child=D):(u=j.last,u!==null?u.sibling=D:l.child=D,j.last=D)}return j.tail!==null?(l=j.tail,j.rendering=l,j.tail=l.sibling,j.renderingStartTime=Ne(),l.sibling=null,u=Hr.current,wr(Hr,x?u&1|2:u&1),l):(ks(l),null);case 22:case 23:return Sh(),x=l.memoizedState!==null,i!==null&&i.memoizedState!==null!==x&&(l.flags|=8192),x&&(l.mode&1)!==0?(da&1073741824)!==0&&(ks(l),l.subtreeFlags&6&&(l.flags|=8192)):ks(l),null;case 24:return null;case 25:return null}throw Error(s(156,l.tag))}function pT(i,l){switch(F0(l),l.tag){case 1:return Zs(l.type)&&ld(),i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 3:return Al(),_r(Qs),_r(As),X0(),i=l.flags,(i&65536)!==0&&(i&128)===0?(l.flags=i&-65537|128,l):null;case 5:return z0(l),null;case 13:if(_r(Hr),i=l.memoizedState,i!==null&&i.dehydrated!==null){if(l.alternate===null)throw Error(s(340));jl()}return i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 19:return _r(Hr),null;case 4:return Al(),null;case 10:return V0(l.type._context),null;case 22:case 23:return Sh(),null;case 24:return null;default:return null}}var Ad=!1,Ps=!1,gT=typeof WeakSet=="function"?WeakSet:Set,pt=null;function kl(i,l){var u=i.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(x){Gr(i,l,x)}else u.current=null}function fh(i,l,u){try{u()}catch(x){Gr(i,l,x)}}var yg=!1;function vT(i,l){if(S0=Kc,i=Jx(),v0(i)){if("selectionStart"in i)var u={start:i.selectionStart,end:i.selectionEnd};else e:{u=(u=i.ownerDocument)&&u.defaultView||window;var x=u.getSelection&&u.getSelection();if(x&&x.rangeCount!==0){u=x.anchorNode;var v=x.anchorOffset,j=x.focusNode;x=x.focusOffset;try{u.nodeType,j.nodeType}catch{u=null;break e}var D=0,le=-1,fe=-1,Ie=0,Ge=0,Xe=i,$e=null;t:for(;;){for(var ft;Xe!==u||v!==0&&Xe.nodeType!==3||(le=D+v),Xe!==j||x!==0&&Xe.nodeType!==3||(fe=D+x),Xe.nodeType===3&&(D+=Xe.nodeValue.length),(ft=Xe.firstChild)!==null;)$e=Xe,Xe=ft;for(;;){if(Xe===i)break t;if($e===u&&++Ie===v&&(le=D),$e===j&&++Ge===x&&(fe=D),(ft=Xe.nextSibling)!==null)break;Xe=$e,$e=Xe.parentNode}Xe=ft}u=le===-1||fe===-1?null:{start:le,end:fe}}else u=null}u=u||{start:0,end:0}}else u=null;for(A0={focusedElem:i,selectionRange:u},Kc=!1,pt=l;pt!==null;)if(l=pt,i=l.child,(l.subtreeFlags&1028)!==0&&i!==null)i.return=l,pt=i;else for(;pt!==null;){l=pt;try{var yt=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(yt!==null){var bt=yt.memoizedProps,Jr=yt.memoizedState,Se=l.stateNode,ge=Se.getSnapshotBeforeUpdate(l.elementType===l.type?bt:Ra(l.type,bt),Jr);Se.__reactInternalSnapshotBeforeUpdate=ge}break;case 3:var ke=l.stateNode.containerInfo;ke.nodeType===1?ke.textContent="":ke.nodeType===9&&ke.documentElement&&ke.removeChild(ke.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(s(163))}}catch(tt){Gr(l,l.return,tt)}if(i=l.sibling,i!==null){i.return=l.return,pt=i;break}pt=l.return}return yt=yg,yg=!1,yt}function Ro(i,l,u){var x=l.updateQueue;if(x=x!==null?x.lastEffect:null,x!==null){var v=x=x.next;do{if((v.tag&i)===i){var j=v.destroy;v.destroy=void 0,j!==void 0&&fh(l,u,j)}v=v.next}while(v!==x)}}function Cd(i,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var u=l=l.next;do{if((u.tag&i)===i){var x=u.create;u.destroy=x()}u=u.next}while(u!==l)}}function xh(i){var l=i.ref;if(l!==null){var u=i.stateNode;switch(i.tag){case 5:i=u;break;default:i=u}typeof l=="function"?l(i):l.current=i}}function Ng(i){var l=i.alternate;l!==null&&(i.alternate=null,Ng(l)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(l=i.stateNode,l!==null&&(delete l[Xa],delete l[No],delete l[R0],delete l[eT],delete l[tT])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function wg(i){return i.tag===5||i.tag===3||i.tag===4}function bg(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||wg(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function ph(i,l,u){var x=i.tag;if(x===5||x===6)i=i.stateNode,l?u.nodeType===8?u.parentNode.insertBefore(i,l):u.insertBefore(i,l):(u.nodeType===8?(l=u.parentNode,l.insertBefore(i,u)):(l=u,l.appendChild(i)),u=u._reactRootContainer,u!=null||l.onclick!==null||(l.onclick=nd));else if(x!==4&&(i=i.child,i!==null))for(ph(i,l,u),i=i.sibling;i!==null;)ph(i,l,u),i=i.sibling}function gh(i,l,u){var x=i.tag;if(x===5||x===6)i=i.stateNode,l?u.insertBefore(i,l):u.appendChild(i);else if(x!==4&&(i=i.child,i!==null))for(gh(i,l,u),i=i.sibling;i!==null;)gh(i,l,u),i=i.sibling}var bs=null,_a=!1;function zn(i,l,u){for(u=u.child;u!==null;)jg(i,l,u),u=u.sibling}function jg(i,l,u){if(ut&&typeof ut.onCommitFiberUnmount=="function")try{ut.onCommitFiberUnmount(ur,u)}catch{}switch(u.tag){case 5:Ps||kl(u,l);case 6:var x=bs,v=_a;bs=null,zn(i,l,u),bs=x,_a=v,bs!==null&&(_a?(i=bs,u=u.stateNode,i.nodeType===8?i.parentNode.removeChild(u):i.removeChild(u)):bs.removeChild(u.stateNode));break;case 18:bs!==null&&(_a?(i=bs,u=u.stateNode,i.nodeType===8?P0(i.parentNode,u):i.nodeType===1&&P0(i,u),oo(i)):P0(bs,u.stateNode));break;case 4:x=bs,v=_a,bs=u.stateNode.containerInfo,_a=!0,zn(i,l,u),bs=x,_a=v;break;case 0:case 11:case 14:case 15:if(!Ps&&(x=u.updateQueue,x!==null&&(x=x.lastEffect,x!==null))){v=x=x.next;do{var j=v,D=j.destroy;j=j.tag,D!==void 0&&((j&2)!==0||(j&4)!==0)&&fh(u,l,D),v=v.next}while(v!==x)}zn(i,l,u);break;case 1:if(!Ps&&(kl(u,l),x=u.stateNode,typeof x.componentWillUnmount=="function"))try{x.props=u.memoizedProps,x.state=u.memoizedState,x.componentWillUnmount()}catch(le){Gr(u,l,le)}zn(i,l,u);break;case 21:zn(i,l,u);break;case 22:u.mode&1?(Ps=(x=Ps)||u.memoizedState!==null,zn(i,l,u),Ps=x):zn(i,l,u);break;default:zn(i,l,u)}}function Eg(i){var l=i.updateQueue;if(l!==null){i.updateQueue=null;var u=i.stateNode;u===null&&(u=i.stateNode=new gT),l.forEach(function(x){var v=AT.bind(null,i,x);u.has(x)||(u.add(x),x.then(v,v))})}}function Da(i,l){var u=l.deletions;if(u!==null)for(var x=0;x<u.length;x++){var v=u[x];try{var j=i,D=l,le=D;e:for(;le!==null;){switch(le.tag){case 5:bs=le.stateNode,_a=!1;break e;case 3:bs=le.stateNode.containerInfo,_a=!0;break e;case 4:bs=le.stateNode.containerInfo,_a=!0;break e}le=le.return}if(bs===null)throw Error(s(160));jg(j,D,v),bs=null,_a=!1;var fe=v.alternate;fe!==null&&(fe.return=null),v.return=null}catch(Ie){Gr(v,l,Ie)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)Tg(l,i),l=l.sibling}function Tg(i,l){var u=i.alternate,x=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Da(l,i),Ja(i),x&4){try{Ro(3,i,i.return),Cd(3,i)}catch(bt){Gr(i,i.return,bt)}try{Ro(5,i,i.return)}catch(bt){Gr(i,i.return,bt)}}break;case 1:Da(l,i),Ja(i),x&512&&u!==null&&kl(u,u.return);break;case 5:if(Da(l,i),Ja(i),x&512&&u!==null&&kl(u,u.return),i.flags&32){var v=i.stateNode;try{et(v,"")}catch(bt){Gr(i,i.return,bt)}}if(x&4&&(v=i.stateNode,v!=null)){var j=i.memoizedProps,D=u!==null?u.memoizedProps:j,le=i.type,fe=i.updateQueue;if(i.updateQueue=null,fe!==null)try{le==="input"&&j.type==="radio"&&j.name!=null&&Ye(v,j),mt(le,D);var Ie=mt(le,j);for(D=0;D<fe.length;D+=2){var Ge=fe[D],Xe=fe[D+1];Ge==="style"?B(v,Xe):Ge==="dangerouslySetInnerHTML"?Jt(v,Xe):Ge==="children"?et(v,Xe):E(v,Ge,Xe,Ie)}switch(le){case"input":Ue(v,j);break;case"textarea":ze(v,j);break;case"select":var $e=v._wrapperState.wasMultiple;v._wrapperState.wasMultiple=!!j.multiple;var ft=j.value;ft!=null?jt(v,!!j.multiple,ft,!1):$e!==!!j.multiple&&(j.defaultValue!=null?jt(v,!!j.multiple,j.defaultValue,!0):jt(v,!!j.multiple,j.multiple?[]:"",!1))}v[No]=j}catch(bt){Gr(i,i.return,bt)}}break;case 6:if(Da(l,i),Ja(i),x&4){if(i.stateNode===null)throw Error(s(162));v=i.stateNode,j=i.memoizedProps;try{v.nodeValue=j}catch(bt){Gr(i,i.return,bt)}}break;case 3:if(Da(l,i),Ja(i),x&4&&u!==null&&u.memoizedState.isDehydrated)try{oo(l.containerInfo)}catch(bt){Gr(i,i.return,bt)}break;case 4:Da(l,i),Ja(i);break;case 13:Da(l,i),Ja(i),v=i.child,v.flags&8192&&(j=v.memoizedState!==null,v.stateNode.isHidden=j,!j||v.alternate!==null&&v.alternate.memoizedState!==null||(Nh=Ne())),x&4&&Eg(i);break;case 22:if(Ge=u!==null&&u.memoizedState!==null,i.mode&1?(Ps=(Ie=Ps)||Ge,Da(l,i),Ps=Ie):Da(l,i),Ja(i),x&8192){if(Ie=i.memoizedState!==null,(i.stateNode.isHidden=Ie)&&!Ge&&(i.mode&1)!==0)for(pt=i,Ge=i.child;Ge!==null;){for(Xe=pt=Ge;pt!==null;){switch($e=pt,ft=$e.child,$e.tag){case 0:case 11:case 14:case 15:Ro(4,$e,$e.return);break;case 1:kl($e,$e.return);var yt=$e.stateNode;if(typeof yt.componentWillUnmount=="function"){x=$e,u=$e.return;try{l=x,yt.props=l.memoizedProps,yt.state=l.memoizedState,yt.componentWillUnmount()}catch(bt){Gr(x,u,bt)}}break;case 5:kl($e,$e.return);break;case 22:if($e.memoizedState!==null){Cg(Xe);continue}}ft!==null?(ft.return=$e,pt=ft):Cg(Xe)}Ge=Ge.sibling}e:for(Ge=null,Xe=i;;){if(Xe.tag===5){if(Ge===null){Ge=Xe;try{v=Xe.stateNode,Ie?(j=v.style,typeof j.setProperty=="function"?j.setProperty("display","none","important"):j.display="none"):(le=Xe.stateNode,fe=Xe.memoizedProps.style,D=fe!=null&&fe.hasOwnProperty("display")?fe.display:null,le.style.display=er("display",D))}catch(bt){Gr(i,i.return,bt)}}}else if(Xe.tag===6){if(Ge===null)try{Xe.stateNode.nodeValue=Ie?"":Xe.memoizedProps}catch(bt){Gr(i,i.return,bt)}}else if((Xe.tag!==22&&Xe.tag!==23||Xe.memoizedState===null||Xe===i)&&Xe.child!==null){Xe.child.return=Xe,Xe=Xe.child;continue}if(Xe===i)break e;for(;Xe.sibling===null;){if(Xe.return===null||Xe.return===i)break e;Ge===Xe&&(Ge=null),Xe=Xe.return}Ge===Xe&&(Ge=null),Xe.sibling.return=Xe.return,Xe=Xe.sibling}}break;case 19:Da(l,i),Ja(i),x&4&&Eg(i);break;case 21:break;default:Da(l,i),Ja(i)}}function Ja(i){var l=i.flags;if(l&2){try{e:{for(var u=i.return;u!==null;){if(wg(u)){var x=u;break e}u=u.return}throw Error(s(160))}switch(x.tag){case 5:var v=x.stateNode;x.flags&32&&(et(v,""),x.flags&=-33);var j=bg(i);gh(i,j,v);break;case 3:case 4:var D=x.stateNode.containerInfo,le=bg(i);ph(i,le,D);break;default:throw Error(s(161))}}catch(fe){Gr(i,i.return,fe)}i.flags&=-3}l&4096&&(i.flags&=-4097)}function yT(i,l,u){pt=i,Sg(i)}function Sg(i,l,u){for(var x=(i.mode&1)!==0;pt!==null;){var v=pt,j=v.child;if(v.tag===22&&x){var D=v.memoizedState!==null||Ad;if(!D){var le=v.alternate,fe=le!==null&&le.memoizedState!==null||Ps;le=Ad;var Ie=Ps;if(Ad=D,(Ps=fe)&&!Ie)for(pt=v;pt!==null;)D=pt,fe=D.child,D.tag===22&&D.memoizedState!==null?kg(v):fe!==null?(fe.return=D,pt=fe):kg(v);for(;j!==null;)pt=j,Sg(j),j=j.sibling;pt=v,Ad=le,Ps=Ie}Ag(i)}else(v.subtreeFlags&8772)!==0&&j!==null?(j.return=v,pt=j):Ag(i)}}function Ag(i){for(;pt!==null;){var l=pt;if((l.flags&8772)!==0){var u=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:Ps||Cd(5,l);break;case 1:var x=l.stateNode;if(l.flags&4&&!Ps)if(u===null)x.componentDidMount();else{var v=l.elementType===l.type?u.memoizedProps:Ra(l.type,u.memoizedProps);x.componentDidUpdate(v,u.memoizedState,x.__reactInternalSnapshotBeforeUpdate)}var j=l.updateQueue;j!==null&&Cp(l,j,x);break;case 3:var D=l.updateQueue;if(D!==null){if(u=null,l.child!==null)switch(l.child.tag){case 5:u=l.child.stateNode;break;case 1:u=l.child.stateNode}Cp(l,D,u)}break;case 5:var le=l.stateNode;if(u===null&&l.flags&4){u=le;var fe=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":fe.autoFocus&&u.focus();break;case"img":fe.src&&(u.src=fe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var Ie=l.alternate;if(Ie!==null){var Ge=Ie.memoizedState;if(Ge!==null){var Xe=Ge.dehydrated;Xe!==null&&oo(Xe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(s(163))}Ps||l.flags&512&&xh(l)}catch($e){Gr(l,l.return,$e)}}if(l===i){pt=null;break}if(u=l.sibling,u!==null){u.return=l.return,pt=u;break}pt=l.return}}function Cg(i){for(;pt!==null;){var l=pt;if(l===i){pt=null;break}var u=l.sibling;if(u!==null){u.return=l.return,pt=u;break}pt=l.return}}function kg(i){for(;pt!==null;){var l=pt;try{switch(l.tag){case 0:case 11:case 15:var u=l.return;try{Cd(4,l)}catch(fe){Gr(l,u,fe)}break;case 1:var x=l.stateNode;if(typeof x.componentDidMount=="function"){var v=l.return;try{x.componentDidMount()}catch(fe){Gr(l,v,fe)}}var j=l.return;try{xh(l)}catch(fe){Gr(l,j,fe)}break;case 5:var D=l.return;try{xh(l)}catch(fe){Gr(l,D,fe)}}}catch(fe){Gr(l,l.return,fe)}if(l===i){pt=null;break}var le=l.sibling;if(le!==null){le.return=l.return,pt=le;break}pt=l.return}}var NT=Math.ceil,kd=R.ReactCurrentDispatcher,vh=R.ReactCurrentOwner,Na=R.ReactCurrentBatchConfig,ir=0,xs=null,ts=null,js=0,da=0,Pl=Vn(0),cs=0,_o=null,Ri=0,Pd=0,yh=0,Do=null,ta=null,Nh=0,Rl=1/0,pn=null,Rd=!1,wh=null,Kn=null,_d=!1,Xn=null,Dd=0,Oo=0,bh=null,Od=-1,Fd=0;function Vs(){return(ir&6)!==0?Ne():Od!==-1?Od:Od=Ne()}function qn(i){return(i.mode&1)===0?1:(ir&2)!==0&&js!==0?js&-js:sT.transition!==null?(Fd===0&&(Fd=bx()),Fd):(i=hr,i!==0||(i=window.event,i=i===void 0?16:Rx(i.type)),i)}function Oa(i,l,u,x){if(50<Oo)throw Oo=0,bh=null,Error(s(185));so(i,u,x),((ir&2)===0||i!==xs)&&(i===xs&&((ir&2)===0&&(Pd|=u),cs===4&&Yn(i,js)),ra(i,x),u===1&&ir===0&&(l.mode&1)===0&&(Rl=Ne()+500,cd&&$n()))}function ra(i,l){var u=i.callbackNode;sE(i,l);var x=Gc(i,i===xs?js:0);if(x===0)u!==null&&it(u),i.callbackNode=null,i.callbackPriority=0;else if(l=x&-x,i.callbackPriority!==l){if(u!=null&&it(u),l===1)i.tag===0?rT(Rg.bind(null,i)):pp(Rg.bind(null,i)),QE(function(){(ir&6)===0&&$n()}),u=null;else{switch(jx(x)){case 1:u=Qe;break;case 4:u=St;break;case 16:u=Yt;break;case 536870912:u=Yr;break;default:u=Yt}u=Bg(u,Pg.bind(null,i))}i.callbackPriority=l,i.callbackNode=u}}function Pg(i,l){if(Od=-1,Fd=0,(ir&6)!==0)throw Error(s(327));var u=i.callbackNode;if(_l()&&i.callbackNode!==u)return null;var x=Gc(i,i===xs?js:0);if(x===0)return null;if((x&30)!==0||(x&i.expiredLanes)!==0||l)l=Id(i,x);else{l=x;var v=ir;ir|=2;var j=Dg();(xs!==i||js!==l)&&(pn=null,Rl=Ne()+500,Di(i,l));do try{jT();break}catch(le){_g(i,le)}while(!0);H0(),kd.current=j,ir=v,ts!==null?l=0:(xs=null,js=0,l=cs)}if(l!==0){if(l===2&&(v=r0(i),v!==0&&(x=v,l=jh(i,v))),l===1)throw u=_o,Di(i,0),Yn(i,x),ra(i,Ne()),u;if(l===6)Yn(i,x);else{if(v=i.current.alternate,(x&30)===0&&!wT(v)&&(l=Id(i,x),l===2&&(j=r0(i),j!==0&&(x=j,l=jh(i,j))),l===1))throw u=_o,Di(i,0),Yn(i,x),ra(i,Ne()),u;switch(i.finishedWork=v,i.finishedLanes=x,l){case 0:case 1:throw Error(s(345));case 2:Oi(i,ta,pn);break;case 3:if(Yn(i,x),(x&130023424)===x&&(l=Nh+500-Ne(),10<l)){if(Gc(i,0)!==0)break;if(v=i.suspendedLanes,(v&x)!==x){Vs(),i.pingedLanes|=i.suspendedLanes&v;break}i.timeoutHandle=k0(Oi.bind(null,i,ta,pn),l);break}Oi(i,ta,pn);break;case 4:if(Yn(i,x),(x&4194240)===x)break;for(l=i.eventTimes,v=-1;0<x;){var D=31-nr(x);j=1<<D,D=l[D],D>v&&(v=D),x&=~j}if(x=v,x=Ne()-x,x=(120>x?120:480>x?480:1080>x?1080:1920>x?1920:3e3>x?3e3:4320>x?4320:1960*NT(x/1960))-x,10<x){i.timeoutHandle=k0(Oi.bind(null,i,ta,pn),x);break}Oi(i,ta,pn);break;case 5:Oi(i,ta,pn);break;default:throw Error(s(329))}}}return ra(i,Ne()),i.callbackNode===u?Pg.bind(null,i):null}function jh(i,l){var u=Do;return i.current.memoizedState.isDehydrated&&(Di(i,l).flags|=256),i=Id(i,l),i!==2&&(l=ta,ta=u,l!==null&&Eh(l)),i}function Eh(i){ta===null?ta=i:ta.push.apply(ta,i)}function wT(i){for(var l=i;;){if(l.flags&16384){var u=l.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var x=0;x<u.length;x++){var v=u[x],j=v.getSnapshot;v=v.value;try{if(!ka(j(),v))return!1}catch{return!1}}}if(u=l.child,l.subtreeFlags&16384&&u!==null)u.return=l,l=u;else{if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Yn(i,l){for(l&=~yh,l&=~Pd,i.suspendedLanes|=l,i.pingedLanes&=~l,i=i.expirationTimes;0<l;){var u=31-nr(l),x=1<<u;i[u]=-1,l&=~x}}function Rg(i){if((ir&6)!==0)throw Error(s(327));_l();var l=Gc(i,0);if((l&1)===0)return ra(i,Ne()),null;var u=Id(i,l);if(i.tag!==0&&u===2){var x=r0(i);x!==0&&(l=x,u=jh(i,x))}if(u===1)throw u=_o,Di(i,0),Yn(i,l),ra(i,Ne()),u;if(u===6)throw Error(s(345));return i.finishedWork=i.current.alternate,i.finishedLanes=l,Oi(i,ta,pn),ra(i,Ne()),null}function Th(i,l){var u=ir;ir|=1;try{return i(l)}finally{ir=u,ir===0&&(Rl=Ne()+500,cd&&$n())}}function _i(i){Xn!==null&&Xn.tag===0&&(ir&6)===0&&_l();var l=ir;ir|=1;var u=Na.transition,x=hr;try{if(Na.transition=null,hr=1,i)return i()}finally{hr=x,Na.transition=u,ir=l,(ir&6)===0&&$n()}}function Sh(){da=Pl.current,_r(Pl)}function Di(i,l){i.finishedWork=null,i.finishedLanes=0;var u=i.timeoutHandle;if(u!==-1&&(i.timeoutHandle=-1,JE(u)),ts!==null)for(u=ts.return;u!==null;){var x=u;switch(F0(x),x.tag){case 1:x=x.type.childContextTypes,x!=null&&ld();break;case 3:Al(),_r(Qs),_r(As),X0();break;case 5:z0(x);break;case 4:Al();break;case 13:_r(Hr);break;case 19:_r(Hr);break;case 10:V0(x.type._context);break;case 22:case 23:Sh()}u=u.return}if(xs=i,ts=i=Jn(i.current,null),js=da=l,cs=0,_o=null,yh=Pd=Ri=0,ta=Do=null,Ci!==null){for(l=0;l<Ci.length;l++)if(u=Ci[l],x=u.interleaved,x!==null){u.interleaved=null;var v=x.next,j=u.pending;if(j!==null){var D=j.next;j.next=v,x.next=D}u.pending=x}Ci=null}return i}function _g(i,l){do{var u=ts;try{if(H0(),yd.current=jd,Nd){for(var x=Vr.memoizedState;x!==null;){var v=x.queue;v!==null&&(v.pending=null),x=x.next}Nd=!1}if(Pi=0,fs=os=Vr=null,So=!1,Ao=0,vh.current=null,u===null||u.return===null){cs=1,_o=l,ts=null;break}e:{var j=i,D=u.return,le=u,fe=l;if(l=js,le.flags|=32768,fe!==null&&typeof fe=="object"&&typeof fe.then=="function"){var Ie=fe,Ge=le,Xe=Ge.tag;if((Ge.mode&1)===0&&(Xe===0||Xe===11||Xe===15)){var $e=Ge.alternate;$e?(Ge.updateQueue=$e.updateQueue,Ge.memoizedState=$e.memoizedState,Ge.lanes=$e.lanes):(Ge.updateQueue=null,Ge.memoizedState=null)}var ft=sg(D);if(ft!==null){ft.flags&=-257,ag(ft,D,le,j,l),ft.mode&1&&rg(j,Ie,l),l=ft,fe=Ie;var yt=l.updateQueue;if(yt===null){var bt=new Set;bt.add(fe),l.updateQueue=bt}else yt.add(fe);break e}else{if((l&1)===0){rg(j,Ie,l),Ah();break e}fe=Error(s(426))}}else if(Mr&&le.mode&1){var Jr=sg(D);if(Jr!==null){(Jr.flags&65536)===0&&(Jr.flags|=256),ag(Jr,D,le,j,l),L0(Cl(fe,le));break e}}j=fe=Cl(fe,le),cs!==4&&(cs=2),Do===null?Do=[j]:Do.push(j),j=D;do{switch(j.tag){case 3:j.flags|=65536,l&=-l,j.lanes|=l;var Se=eg(j,fe,l);Ap(j,Se);break e;case 1:le=fe;var ge=j.type,ke=j.stateNode;if((j.flags&128)===0&&(typeof ge.getDerivedStateFromError=="function"||ke!==null&&typeof ke.componentDidCatch=="function"&&(Kn===null||!Kn.has(ke)))){j.flags|=65536,l&=-l,j.lanes|=l;var tt=tg(j,le,l);Ap(j,tt);break e}}j=j.return}while(j!==null)}Fg(u)}catch(Tt){l=Tt,ts===u&&u!==null&&(ts=u=u.return);continue}break}while(!0)}function Dg(){var i=kd.current;return kd.current=jd,i===null?jd:i}function Ah(){(cs===0||cs===3||cs===2)&&(cs=4),xs===null||(Ri&268435455)===0&&(Pd&268435455)===0||Yn(xs,js)}function Id(i,l){var u=ir;ir|=2;var x=Dg();(xs!==i||js!==l)&&(pn=null,Di(i,l));do try{bT();break}catch(v){_g(i,v)}while(!0);if(H0(),ir=u,kd.current=x,ts!==null)throw Error(s(261));return xs=null,js=0,cs}function bT(){for(;ts!==null;)Og(ts)}function jT(){for(;ts!==null&&!S();)Og(ts)}function Og(i){var l=Lg(i.alternate,i,da);i.memoizedProps=i.pendingProps,l===null?Fg(i):ts=l,vh.current=null}function Fg(i){var l=i;do{var u=l.alternate;if(i=l.return,(l.flags&32768)===0){if(u=xT(u,l,da),u!==null){ts=u;return}}else{if(u=pT(u,l),u!==null){u.flags&=32767,ts=u;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{cs=6,ts=null;return}}if(l=l.sibling,l!==null){ts=l;return}ts=l=i}while(l!==null);cs===0&&(cs=5)}function Oi(i,l,u){var x=hr,v=Na.transition;try{Na.transition=null,hr=1,ET(i,l,u,x)}finally{Na.transition=v,hr=x}return null}function ET(i,l,u,x){do _l();while(Xn!==null);if((ir&6)!==0)throw Error(s(327));u=i.finishedWork;var v=i.finishedLanes;if(u===null)return null;if(i.finishedWork=null,i.finishedLanes=0,u===i.current)throw Error(s(177));i.callbackNode=null,i.callbackPriority=0;var j=u.lanes|u.childLanes;if(aE(i,j),i===xs&&(ts=xs=null,js=0),(u.subtreeFlags&2064)===0&&(u.flags&2064)===0||_d||(_d=!0,Bg(Yt,function(){return _l(),null})),j=(u.flags&15990)!==0,(u.subtreeFlags&15990)!==0||j){j=Na.transition,Na.transition=null;var D=hr;hr=1;var le=ir;ir|=4,vh.current=null,vT(i,u),Tg(u,i),GE(A0),Kc=!!S0,A0=S0=null,i.current=u,yT(u),re(),ir=le,hr=D,Na.transition=j}else i.current=u;if(_d&&(_d=!1,Xn=i,Dd=v),j=i.pendingLanes,j===0&&(Kn=null),Ir(u.stateNode),ra(i,Ne()),l!==null)for(x=i.onRecoverableError,u=0;u<l.length;u++)v=l[u],x(v.value,{componentStack:v.stack,digest:v.digest});if(Rd)throw Rd=!1,i=wh,wh=null,i;return(Dd&1)!==0&&i.tag!==0&&_l(),j=i.pendingLanes,(j&1)!==0?i===bh?Oo++:(Oo=0,bh=i):Oo=0,$n(),null}function _l(){if(Xn!==null){var i=jx(Dd),l=Na.transition,u=hr;try{if(Na.transition=null,hr=16>i?16:i,Xn===null)var x=!1;else{if(i=Xn,Xn=null,Dd=0,(ir&6)!==0)throw Error(s(331));var v=ir;for(ir|=4,pt=i.current;pt!==null;){var j=pt,D=j.child;if((pt.flags&16)!==0){var le=j.deletions;if(le!==null){for(var fe=0;fe<le.length;fe++){var Ie=le[fe];for(pt=Ie;pt!==null;){var Ge=pt;switch(Ge.tag){case 0:case 11:case 15:Ro(8,Ge,j)}var Xe=Ge.child;if(Xe!==null)Xe.return=Ge,pt=Xe;else for(;pt!==null;){Ge=pt;var $e=Ge.sibling,ft=Ge.return;if(Ng(Ge),Ge===Ie){pt=null;break}if($e!==null){$e.return=ft,pt=$e;break}pt=ft}}}var yt=j.alternate;if(yt!==null){var bt=yt.child;if(bt!==null){yt.child=null;do{var Jr=bt.sibling;bt.sibling=null,bt=Jr}while(bt!==null)}}pt=j}}if((j.subtreeFlags&2064)!==0&&D!==null)D.return=j,pt=D;else e:for(;pt!==null;){if(j=pt,(j.flags&2048)!==0)switch(j.tag){case 0:case 11:case 15:Ro(9,j,j.return)}var Se=j.sibling;if(Se!==null){Se.return=j.return,pt=Se;break e}pt=j.return}}var ge=i.current;for(pt=ge;pt!==null;){D=pt;var ke=D.child;if((D.subtreeFlags&2064)!==0&&ke!==null)ke.return=D,pt=ke;else e:for(D=ge;pt!==null;){if(le=pt,(le.flags&2048)!==0)try{switch(le.tag){case 0:case 11:case 15:Cd(9,le)}}catch(Tt){Gr(le,le.return,Tt)}if(le===D){pt=null;break e}var tt=le.sibling;if(tt!==null){tt.return=le.return,pt=tt;break e}pt=le.return}}if(ir=v,$n(),ut&&typeof ut.onPostCommitFiberRoot=="function")try{ut.onPostCommitFiberRoot(ur,i)}catch{}x=!0}return x}finally{hr=u,Na.transition=l}}return!1}function Ig(i,l,u){l=Cl(u,l),l=eg(i,l,1),i=Wn(i,l,1),l=Vs(),i!==null&&(so(i,1,l),ra(i,l))}function Gr(i,l,u){if(i.tag===3)Ig(i,i,u);else for(;l!==null;){if(l.tag===3){Ig(l,i,u);break}else if(l.tag===1){var x=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Kn===null||!Kn.has(x))){i=Cl(u,i),i=tg(l,i,1),l=Wn(l,i,1),i=Vs(),l!==null&&(so(l,1,i),ra(l,i));break}}l=l.return}}function TT(i,l,u){var x=i.pingCache;x!==null&&x.delete(l),l=Vs(),i.pingedLanes|=i.suspendedLanes&u,xs===i&&(js&u)===u&&(cs===4||cs===3&&(js&130023424)===js&&500>Ne()-Nh?Di(i,0):yh|=u),ra(i,l)}function Mg(i,l){l===0&&((i.mode&1)===0?l=1:(l=$c,$c<<=1,($c&130023424)===0&&($c=4194304)));var u=Vs();i=mn(i,l),i!==null&&(so(i,l,u),ra(i,u))}function ST(i){var l=i.memoizedState,u=0;l!==null&&(u=l.retryLane),Mg(i,u)}function AT(i,l){var u=0;switch(i.tag){case 13:var x=i.stateNode,v=i.memoizedState;v!==null&&(u=v.retryLane);break;case 19:x=i.stateNode;break;default:throw Error(s(314))}x!==null&&x.delete(l),Mg(i,u)}var Lg;Lg=function(i,l,u){if(i!==null)if(i.memoizedProps!==l.pendingProps||Qs.current)ea=!0;else{if((i.lanes&u)===0&&(l.flags&128)===0)return ea=!1,fT(i,l,u);ea=(i.flags&131072)!==0}else ea=!1,Mr&&(l.flags&1048576)!==0&&gp(l,ud,l.index);switch(l.lanes=0,l.tag){case 2:var x=l.type;Sd(i,l),i=l.pendingProps;var v=Nl(l,As.current);Sl(l,u),v=J0(null,l,x,i,v,u);var j=Q0();return l.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,Zs(x)?(j=!0,od(l)):j=!1,l.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,G0(l),v.updater=Ed,l.stateNode=v,v._reactInternals=l,ah(l,x,i,u),l=oh(null,l,x,!0,j,u)):(l.tag=0,Mr&&j&&O0(l),Hs(null,l,v,u),l=l.child),l;case 16:x=l.elementType;e:{switch(Sd(i,l),i=l.pendingProps,v=x._init,x=v(x._payload),l.type=x,v=l.tag=kT(x),i=Ra(x,i),v){case 0:l=lh(null,l,x,i,u);break e;case 1:l=dg(null,l,x,i,u);break e;case 11:l=ng(null,l,x,i,u);break e;case 14:l=ig(null,l,x,Ra(x.type,i),u);break e}throw Error(s(306,x,""))}return l;case 0:return x=l.type,v=l.pendingProps,v=l.elementType===x?v:Ra(x,v),lh(i,l,x,v,u);case 1:return x=l.type,v=l.pendingProps,v=l.elementType===x?v:Ra(x,v),dg(i,l,x,v,u);case 3:e:{if(ug(l),i===null)throw Error(s(387));x=l.pendingProps,j=l.memoizedState,v=j.element,Sp(i,l),gd(l,x,null,u);var D=l.memoizedState;if(x=D.element,j.isDehydrated)if(j={element:x,isDehydrated:!1,cache:D.cache,pendingSuspenseBoundaries:D.pendingSuspenseBoundaries,transitions:D.transitions},l.updateQueue.baseState=j,l.memoizedState=j,l.flags&256){v=Cl(Error(s(423)),l),l=hg(i,l,x,u,v);break e}else if(x!==v){v=Cl(Error(s(424)),l),l=hg(i,l,x,u,v);break e}else for(ca=Hn(l.stateNode.containerInfo.firstChild),oa=l,Mr=!0,Pa=null,u=Ep(l,null,x,u),l.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(jl(),x===v){l=xn(i,l,u);break e}Hs(i,l,x,u)}l=l.child}return l;case 5:return kp(l),i===null&&M0(l),x=l.type,v=l.pendingProps,j=i!==null?i.memoizedProps:null,D=v.children,C0(x,v)?D=null:j!==null&&C0(x,j)&&(l.flags|=32),cg(i,l),Hs(i,l,D,u),l.child;case 6:return i===null&&M0(l),null;case 13:return mg(i,l,u);case 4:return W0(l,l.stateNode.containerInfo),x=l.pendingProps,i===null?l.child=El(l,null,x,u):Hs(i,l,x,u),l.child;case 11:return x=l.type,v=l.pendingProps,v=l.elementType===x?v:Ra(x,v),ng(i,l,x,v,u);case 7:return Hs(i,l,l.pendingProps,u),l.child;case 8:return Hs(i,l,l.pendingProps.children,u),l.child;case 12:return Hs(i,l,l.pendingProps.children,u),l.child;case 10:e:{if(x=l.type._context,v=l.pendingProps,j=l.memoizedProps,D=v.value,wr(fd,x._currentValue),x._currentValue=D,j!==null)if(ka(j.value,D)){if(j.children===v.children&&!Qs.current){l=xn(i,l,u);break e}}else for(j=l.child,j!==null&&(j.return=l);j!==null;){var le=j.dependencies;if(le!==null){D=j.child;for(var fe=le.firstContext;fe!==null;){if(fe.context===x){if(j.tag===1){fe=fn(-1,u&-u),fe.tag=2;var Ie=j.updateQueue;if(Ie!==null){Ie=Ie.shared;var Ge=Ie.pending;Ge===null?fe.next=fe:(fe.next=Ge.next,Ge.next=fe),Ie.pending=fe}}j.lanes|=u,fe=j.alternate,fe!==null&&(fe.lanes|=u),U0(j.return,u,l),le.lanes|=u;break}fe=fe.next}}else if(j.tag===10)D=j.type===l.type?null:j.child;else if(j.tag===18){if(D=j.return,D===null)throw Error(s(341));D.lanes|=u,le=D.alternate,le!==null&&(le.lanes|=u),U0(D,u,l),D=j.sibling}else D=j.child;if(D!==null)D.return=j;else for(D=j;D!==null;){if(D===l){D=null;break}if(j=D.sibling,j!==null){j.return=D.return,D=j;break}D=D.return}j=D}Hs(i,l,v.children,u),l=l.child}return l;case 9:return v=l.type,x=l.pendingProps.children,Sl(l,u),v=va(v),x=x(v),l.flags|=1,Hs(i,l,x,u),l.child;case 14:return x=l.type,v=Ra(x,l.pendingProps),v=Ra(x.type,v),ig(i,l,x,v,u);case 15:return lg(i,l,l.type,l.pendingProps,u);case 17:return x=l.type,v=l.pendingProps,v=l.elementType===x?v:Ra(x,v),Sd(i,l),l.tag=1,Zs(x)?(i=!0,od(l)):i=!1,Sl(l,u),Qp(l,x,v),ah(l,x,v,u),oh(null,l,x,!0,i,u);case 19:return xg(i,l,u);case 22:return og(i,l,u)}throw Error(s(156,l.tag))};function Bg(i,l){return Ke(i,l)}function CT(i,l,u,x){this.tag=i,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wa(i,l,u,x){return new CT(i,l,u,x)}function Ch(i){return i=i.prototype,!(!i||!i.isReactComponent)}function kT(i){if(typeof i=="function")return Ch(i)?1:0;if(i!=null){if(i=i.$$typeof,i===H)return 11;if(i===X)return 14}return 2}function Jn(i,l){var u=i.alternate;return u===null?(u=wa(i.tag,l,i.key,i.mode),u.elementType=i.elementType,u.type=i.type,u.stateNode=i.stateNode,u.alternate=i,i.alternate=u):(u.pendingProps=l,u.type=i.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=i.flags&14680064,u.childLanes=i.childLanes,u.lanes=i.lanes,u.child=i.child,u.memoizedProps=i.memoizedProps,u.memoizedState=i.memoizedState,u.updateQueue=i.updateQueue,l=i.dependencies,u.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},u.sibling=i.sibling,u.index=i.index,u.ref=i.ref,u}function Md(i,l,u,x,v,j){var D=2;if(x=i,typeof i=="function")Ch(i)&&(D=1);else if(typeof i=="string")D=5;else e:switch(i){case k:return Fi(u.children,v,j,l);case z:D=8,v|=8;break;case W:return i=wa(12,u,l,v|2),i.elementType=W,i.lanes=j,i;case ue:return i=wa(13,u,l,v),i.elementType=ue,i.lanes=j,i;case I:return i=wa(19,u,l,v),i.elementType=I,i.lanes=j,i;case xe:return Ld(u,v,j,l);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case te:D=10;break e;case de:D=9;break e;case H:D=11;break e;case X:D=14;break e;case oe:D=16,x=null;break e}throw Error(s(130,i==null?i:typeof i,""))}return l=wa(D,u,l,v),l.elementType=i,l.type=x,l.lanes=j,l}function Fi(i,l,u,x){return i=wa(7,i,x,l),i.lanes=u,i}function Ld(i,l,u,x){return i=wa(22,i,x,l),i.elementType=xe,i.lanes=u,i.stateNode={isHidden:!1},i}function kh(i,l,u){return i=wa(6,i,null,l),i.lanes=u,i}function Ph(i,l,u){return l=wa(4,i.children!==null?i.children:[],i.key,l),l.lanes=u,l.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},l}function PT(i,l,u,x,v){this.tag=l,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=s0(0),this.expirationTimes=s0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=s0(0),this.identifierPrefix=x,this.onRecoverableError=v,this.mutableSourceEagerHydrationData=null}function Rh(i,l,u,x,v,j,D,le,fe){return i=new PT(i,l,u,le,fe),l===1?(l=1,j===!0&&(l|=8)):l=0,j=wa(3,null,null,l),i.current=j,j.stateNode=i,j.memoizedState={element:x,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},G0(j),i}function RT(i,l,u){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:P,key:x==null?null:""+x,children:i,containerInfo:l,implementation:u}}function Hg(i){if(!i)return Un;i=i._reactInternals;e:{if(se(i)!==i||i.tag!==1)throw Error(s(170));var l=i;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(Zs(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(s(171))}if(i.tag===1){var u=i.type;if(Zs(u))return fp(i,u,l)}return l}function Vg(i,l,u,x,v,j,D,le,fe){return i=Rh(u,x,!0,i,v,j,D,le,fe),i.context=Hg(null),u=i.current,x=Vs(),v=qn(u),j=fn(x,v),j.callback=l??null,Wn(u,j,v),i.current.lanes=v,so(i,v,x),ra(i,x),i}function Bd(i,l,u,x){var v=l.current,j=Vs(),D=qn(v);return u=Hg(u),l.context===null?l.context=u:l.pendingContext=u,l=fn(j,D),l.payload={element:i},x=x===void 0?null:x,x!==null&&(l.callback=x),i=Wn(v,l,D),i!==null&&(Oa(i,v,D,j),pd(i,v,D)),D}function Hd(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function Ug(i,l){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var u=i.retryLane;i.retryLane=u!==0&&u<l?u:l}}function _h(i,l){Ug(i,l),(i=i.alternate)&&Ug(i,l)}function _T(){return null}var $g=typeof reportError=="function"?reportError:function(i){console.error(i)};function Dh(i){this._internalRoot=i}Vd.prototype.render=Dh.prototype.render=function(i){var l=this._internalRoot;if(l===null)throw Error(s(409));Bd(i,l,null,null)},Vd.prototype.unmount=Dh.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var l=i.containerInfo;_i(function(){Bd(null,i,null,null)}),l[cn]=null}};function Vd(i){this._internalRoot=i}Vd.prototype.unstable_scheduleHydration=function(i){if(i){var l=Sx();i={blockedOn:null,target:i,priority:l};for(var u=0;u<Mn.length&&l!==0&&l<Mn[u].priority;u++);Mn.splice(u,0,i),u===0&&kx(i)}};function Oh(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Ud(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function Gg(){}function DT(i,l,u,x,v){if(v){if(typeof x=="function"){var j=x;x=function(){var Ie=Hd(D);j.call(Ie)}}var D=Vg(l,x,i,0,null,!1,!1,"",Gg);return i._reactRootContainer=D,i[cn]=D.current,vo(i.nodeType===8?i.parentNode:i),_i(),D}for(;v=i.lastChild;)i.removeChild(v);if(typeof x=="function"){var le=x;x=function(){var Ie=Hd(fe);le.call(Ie)}}var fe=Rh(i,0,!1,null,null,!1,!1,"",Gg);return i._reactRootContainer=fe,i[cn]=fe.current,vo(i.nodeType===8?i.parentNode:i),_i(function(){Bd(l,fe,u,x)}),fe}function $d(i,l,u,x,v){var j=u._reactRootContainer;if(j){var D=j;if(typeof v=="function"){var le=v;v=function(){var fe=Hd(D);le.call(fe)}}Bd(l,D,i,v)}else D=DT(u,l,i,v,x);return Hd(D)}Ex=function(i){switch(i.tag){case 3:var l=i.stateNode;if(l.current.memoizedState.isDehydrated){var u=ro(l.pendingLanes);u!==0&&(a0(l,u|1),ra(l,Ne()),(ir&6)===0&&(Rl=Ne()+500,$n()))}break;case 13:_i(function(){var x=mn(i,1);if(x!==null){var v=Vs();Oa(x,i,1,v)}}),_h(i,1)}},n0=function(i){if(i.tag===13){var l=mn(i,134217728);if(l!==null){var u=Vs();Oa(l,i,134217728,u)}_h(i,134217728)}},Tx=function(i){if(i.tag===13){var l=qn(i),u=mn(i,l);if(u!==null){var x=Vs();Oa(u,i,l,x)}_h(i,l)}},Sx=function(){return hr},Ax=function(i,l){var u=hr;try{return hr=i,l()}finally{hr=u}},$t=function(i,l,u){switch(l){case"input":if(Ue(i,u),l=u.name,u.type==="radio"&&l!=null){for(u=i;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<u.length;l++){var x=u[l];if(x!==i&&x.form===i.form){var v=id(x);if(!v)throw Error(s(90));Y(x),Ue(x,v)}}}break;case"textarea":ze(i,u);break;case"select":l=u.value,l!=null&&jt(i,!!u.multiple,l,!1)}},ve=Th,ct=_i;var OT={usingClientEntryPoint:!1,Events:[wo,vl,id,Oe,U,Th]},Fo={findFiberByHostInstance:Ei,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},FT={bundleType:Fo.bundleType,version:Fo.version,rendererPackageName:Fo.rendererPackageName,rendererConfig:Fo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:R.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=_e(i),i===null?null:i.stateNode},findFiberByHostInstance:Fo.findFiberByHostInstance||_T,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Gd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Gd.isDisabled&&Gd.supportsFiber)try{ur=Gd.inject(FT),ut=Gd}catch{}}return sa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=OT,sa.createPortal=function(i,l){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Oh(l))throw Error(s(200));return RT(i,l,null,u)},sa.createRoot=function(i,l){if(!Oh(i))throw Error(s(299));var u=!1,x="",v=$g;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(x=l.identifierPrefix),l.onRecoverableError!==void 0&&(v=l.onRecoverableError)),l=Rh(i,1,!1,null,null,u,!1,x,v),i[cn]=l.current,vo(i.nodeType===8?i.parentNode:i),new Dh(l)},sa.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var l=i._reactInternals;if(l===void 0)throw typeof i.render=="function"?Error(s(188)):(i=Object.keys(i).join(","),Error(s(268,i)));return i=_e(l),i=i===null?null:i.stateNode,i},sa.flushSync=function(i){return _i(i)},sa.hydrate=function(i,l,u){if(!Ud(l))throw Error(s(200));return $d(null,i,l,!0,u)},sa.hydrateRoot=function(i,l,u){if(!Oh(i))throw Error(s(405));var x=u!=null&&u.hydratedSources||null,v=!1,j="",D=$g;if(u!=null&&(u.unstable_strictMode===!0&&(v=!0),u.identifierPrefix!==void 0&&(j=u.identifierPrefix),u.onRecoverableError!==void 0&&(D=u.onRecoverableError)),l=Vg(l,null,i,1,u??null,v,!1,j,D),i[cn]=l.current,vo(i),x)for(i=0;i<x.length;i++)u=x[i],v=u._getVersion,v=v(u._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[u,v]:l.mutableSourceEagerHydrationData.push(u,v);return new Vd(l)},sa.render=function(i,l,u){if(!Ud(l))throw Error(s(200));return $d(null,i,l,!1,u)},sa.unmountComponentAtNode=function(i){if(!Ud(i))throw Error(s(40));return i._reactRootContainer?(_i(function(){$d(null,null,i,!1,function(){i._reactRootContainer=null,i[cn]=null})}),!0):!1},sa.unstable_batchedUpdates=Th,sa.unstable_renderSubtreeIntoContainer=function(i,l,u,x){if(!Ud(u))throw Error(s(200));if(i==null||i._reactInternals===void 0)throw Error(s(38));return $d(i,l,u,!1,x)},sa.version="18.3.1-next-f1338f8080-20240426",sa}var Qg;function K1(){if(Qg)return Mh.exports;Qg=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),Mh.exports=$T(),Mh.exports}var Zg;function GT(){if(Zg)return Wd;Zg=1;var e=K1();return Wd.createRoot=e.createRoot,Wd.hydrateRoot=e.hydrateRoot,Wd}var WT=GT();const zT=yi(WT);var ff=K1();const KT=yi(ff);/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function uc(){return uc=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},uc.apply(this,arguments)}var li;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(li||(li={}));const ev="popstate";function XT(e){e===void 0&&(e={});function r(a,n){let{pathname:o,search:c,hash:d}=a.location;return jm("",{pathname:o,search:c,hash:d},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function s(a,n){return typeof n=="string"?n:q1(n)}return YT(r,s,null,e)}function is(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function X1(e,r){if(!e){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function qT(){return Math.random().toString(36).substr(2,8)}function tv(e,r){return{usr:e.state,key:e.key,idx:r}}function jm(e,r,s,a){return s===void 0&&(s=null),uc({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof r=="string"?Yl(r):r,{state:s,key:r&&r.key||a||qT()})}function q1(e){let{pathname:r="/",search:s="",hash:a=""}=e;return s&&s!=="?"&&(r+=s.charAt(0)==="?"?s:"?"+s),a&&a!=="#"&&(r+=a.charAt(0)==="#"?a:"#"+a),r}function Yl(e){let r={};if(e){let s=e.indexOf("#");s>=0&&(r.hash=e.substr(s),e=e.substr(0,s));let a=e.indexOf("?");a>=0&&(r.search=e.substr(a),e=e.substr(0,a)),e&&(r.pathname=e)}return r}function YT(e,r,s,a){a===void 0&&(a={});let{window:n=document.defaultView,v5Compat:o=!1}=a,c=n.history,d=li.Pop,h=null,m=f();m==null&&(m=0,c.replaceState(uc({},c.state,{idx:m}),""));function f(){return(c.state||{idx:null}).idx}function p(){d=li.Pop;let b=f(),C=b==null?null:b-m;m=b,h&&h({action:d,location:w.location,delta:C})}function g(b,C){d=li.Push;let A=jm(w.location,b,C);m=f()+1;let E=tv(A,m),R=w.createHref(A);try{c.pushState(E,"",R)}catch(V){if(V instanceof DOMException&&V.name==="DataCloneError")throw V;n.location.assign(R)}o&&h&&h({action:d,location:w.location,delta:1})}function N(b,C){d=li.Replace;let A=jm(w.location,b,C);m=f();let E=tv(A,m),R=w.createHref(A);c.replaceState(E,"",R),o&&h&&h({action:d,location:w.location,delta:0})}function y(b){let C=n.location.origin!=="null"?n.location.origin:n.location.href,A=typeof b=="string"?b:q1(b);return A=A.replace(/ $/,"%20"),is(C,"No window.location.(origin|href) available to create URL for href: "+A),new URL(A,C)}let w={get action(){return d},get location(){return e(n,c)},listen(b){if(h)throw new Error("A history only accepts one active listener");return n.addEventListener(ev,p),h=b,()=>{n.removeEventListener(ev,p),h=null}},createHref(b){return r(n,b)},createURL:y,encodeLocation(b){let C=y(b);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:g,replace:N,go(b){return c.go(b)}};return w}var rv;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(rv||(rv={}));function JT(e,r,s){return s===void 0&&(s="/"),QT(e,r,s)}function QT(e,r,s,a){let n=typeof r=="string"?Yl(r):r,o=Q1(n.pathname||"/",s);if(o==null)return null;let c=Y1(e);ZT(c);let d=null;for(let h=0;d==null&&h<c.length;++h){let m=uS(o);d=oS(c[h],m)}return d}function Y1(e,r,s,a){r===void 0&&(r=[]),s===void 0&&(s=[]),a===void 0&&(a="");let n=(o,c,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};h.relativePath.startsWith("/")&&(is(h.relativePath.startsWith(a),'Absolute route path "'+h.relativePath+'" nested under path '+('"'+a+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),h.relativePath=h.relativePath.slice(a.length));let m=Gi([a,h.relativePath]),f=s.concat(h);o.children&&o.children.length>0&&(is(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),Y1(o.children,r,f,m)),!(o.path==null&&!o.index)&&r.push({path:m,score:iS(m,o.index),routesMeta:f})};return e.forEach((o,c)=>{var d;if(o.path===""||!((d=o.path)!=null&&d.includes("?")))n(o,c);else for(let h of J1(o.path))n(o,c,h)}),r}function J1(e){let r=e.split("/");if(r.length===0)return[];let[s,...a]=r,n=s.endsWith("?"),o=s.replace(/\?$/,"");if(a.length===0)return n?[o,""]:[o];let c=J1(a.join("/")),d=[];return d.push(...c.map(h=>h===""?o:[o,h].join("/"))),n&&d.push(...c),d.map(h=>e.startsWith("/")&&h===""?"/":h)}function ZT(e){e.sort((r,s)=>r.score!==s.score?s.score-r.score:lS(r.routesMeta.map(a=>a.childrenIndex),s.routesMeta.map(a=>a.childrenIndex)))}const eS=/^:[\w-]+$/,tS=3,rS=2,sS=1,aS=10,nS=-2,sv=e=>e==="*";function iS(e,r){let s=e.split("/"),a=s.length;return s.some(sv)&&(a+=nS),r&&(a+=rS),s.filter(n=>!sv(n)).reduce((n,o)=>n+(eS.test(o)?tS:o===""?sS:aS),a)}function lS(e,r){return e.length===r.length&&e.slice(0,-1).every((a,n)=>a===r[n])?e[e.length-1]-r[r.length-1]:0}function oS(e,r,s){let{routesMeta:a}=e,n={},o="/",c=[];for(let d=0;d<a.length;++d){let h=a[d],m=d===a.length-1,f=o==="/"?r:r.slice(o.length)||"/",p=cS({path:h.relativePath,caseSensitive:h.caseSensitive,end:m},f),g=h.route;if(!p)return null;Object.assign(n,p.params),c.push({params:n,pathname:Gi([o,p.pathname]),pathnameBase:xS(Gi([o,p.pathnameBase])),route:g}),p.pathnameBase!=="/"&&(o=Gi([o,p.pathnameBase]))}return c}function cS(e,r){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[s,a]=dS(e.path,e.caseSensitive,e.end),n=r.match(s);if(!n)return null;let o=n[0],c=o.replace(/(.)\/+$/,"$1"),d=n.slice(1);return{params:a.reduce((m,f,p)=>{let{paramName:g,isOptional:N}=f;if(g==="*"){let w=d[p]||"";c=o.slice(0,o.length-w.length).replace(/(.)\/+$/,"$1")}const y=d[p];return N&&!y?m[g]=void 0:m[g]=(y||"").replace(/%2F/g,"/"),m},{}),pathname:o,pathnameBase:c,pattern:e}}function dS(e,r,s){r===void 0&&(r=!1),s===void 0&&(s=!0),X1(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let a=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,d,h)=>(a.push({paramName:d,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(a.push({paramName:"*"}),n+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?n+="\\/*$":e!==""&&e!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,r?void 0:"i"),a]}function uS(e){try{return e.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return X1(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+r+").")),e}}function Q1(e,r){if(r==="/")return e;if(!e.toLowerCase().startsWith(r.toLowerCase()))return null;let s=r.endsWith("/")?r.length-1:r.length,a=e.charAt(s);return a&&a!=="/"?null:e.slice(s)||"/"}function hS(e,r){r===void 0&&(r="/");let{pathname:s,search:a="",hash:n=""}=typeof e=="string"?Yl(e):e;return{pathname:s?s.startsWith("/")?s:mS(s,r):r,search:pS(a),hash:gS(n)}}function mS(e,r){let s=r.replace(/\/+$/,"").split("/");return e.split("/").forEach(n=>{n===".."?s.length>1&&s.pop():n!=="."&&s.push(n)}),s.length>1?s.join("/"):"/"}function Hh(e,r,s,a){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+r+"` field ["+JSON.stringify(a)+"].  Please separate it out to the ")+("`to."+s+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function fS(e){return e.filter((r,s)=>s===0||r.route.path&&r.route.path.length>0)}function Z1(e,r){let s=fS(e);return r?s.map((a,n)=>n===s.length-1?a.pathname:a.pathnameBase):s.map(a=>a.pathnameBase)}function eN(e,r,s,a){a===void 0&&(a=!1);let n;typeof e=="string"?n=Yl(e):(n=uc({},e),is(!n.pathname||!n.pathname.includes("?"),Hh("?","pathname","search",n)),is(!n.pathname||!n.pathname.includes("#"),Hh("#","pathname","hash",n)),is(!n.search||!n.search.includes("#"),Hh("#","search","hash",n)));let o=e===""||n.pathname==="",c=o?"/":n.pathname,d;if(c==null)d=s;else{let p=r.length-1;if(!a&&c.startsWith("..")){let g=c.split("/");for(;g[0]==="..";)g.shift(),p-=1;n.pathname=g.join("/")}d=p>=0?r[p]:"/"}let h=hS(n,d),m=c&&c!=="/"&&c.endsWith("/"),f=(o||c===".")&&s.endsWith("/");return!h.pathname.endsWith("/")&&(m||f)&&(h.pathname+="/"),h}const Gi=e=>e.join("/").replace(/\/\/+/g,"/"),xS=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),pS=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,gS=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function vS(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const tN=["post","put","patch","delete"];new Set(tN);const yS=["get",...tN];new Set(yS);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function hc(){return hc=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},hc.apply(this,arguments)}const xf=T.createContext(null),NS=T.createContext(null),Ac=T.createContext(null),Mu=T.createContext(null),el=T.createContext({outlet:null,matches:[],isDataRoute:!1}),rN=T.createContext(null);function Cc(){return T.useContext(Mu)!=null}function Jl(){return Cc()||is(!1),T.useContext(Mu).location}function sN(e){T.useContext(Ac).static||T.useLayoutEffect(e)}function Ls(){let{isDataRoute:e}=T.useContext(el);return e?DS():wS()}function wS(){Cc()||is(!1);let e=T.useContext(xf),{basename:r,future:s,navigator:a}=T.useContext(Ac),{matches:n}=T.useContext(el),{pathname:o}=Jl(),c=JSON.stringify(Z1(n,s.v7_relativeSplatPath)),d=T.useRef(!1);return sN(()=>{d.current=!0}),T.useCallback(function(m,f){if(f===void 0&&(f={}),!d.current)return;if(typeof m=="number"){a.go(m);return}let p=eN(m,JSON.parse(c),o,f.relative==="path");e==null&&r!=="/"&&(p.pathname=p.pathname==="/"?r:Gi([r,p.pathname])),(f.replace?a.replace:a.push)(p,f.state,f)},[r,a,c,o,e])}function bS(e,r){return jS(e,r)}function jS(e,r,s,a){Cc()||is(!1);let{navigator:n}=T.useContext(Ac),{matches:o}=T.useContext(el),c=o[o.length-1],d=c?c.params:{};c&&c.pathname;let h=c?c.pathnameBase:"/";c&&c.route;let m=Jl(),f;if(r){var p;let b=typeof r=="string"?Yl(r):r;h==="/"||(p=b.pathname)!=null&&p.startsWith(h)||is(!1),f=b}else f=m;let g=f.pathname||"/",N=g;if(h!=="/"){let b=h.replace(/^\//,"").split("/");N="/"+g.replace(/^\//,"").split("/").slice(b.length).join("/")}let y=JT(e,{pathname:N}),w=CS(y&&y.map(b=>Object.assign({},b,{params:Object.assign({},d,b.params),pathname:Gi([h,n.encodeLocation?n.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?h:Gi([h,n.encodeLocation?n.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),o,s,a);return r&&w?T.createElement(Mu.Provider,{value:{location:hc({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:li.Pop}},w):w}function ES(){let e=_S(),r=vS(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),s=e instanceof Error?e.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return T.createElement(T.Fragment,null,T.createElement("h2",null,"Unexpected Application Error!"),T.createElement("h3",{style:{fontStyle:"italic"}},r),s?T.createElement("pre",{style:n},s):null,null)}const TS=T.createElement(ES,null);class SS extends T.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,s){return s.location!==r.location||s.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:s.error,location:s.location,revalidation:r.revalidation||s.revalidation}}componentDidCatch(r,s){console.error("React Router caught the following error during render",r,s)}render(){return this.state.error!==void 0?T.createElement(el.Provider,{value:this.props.routeContext},T.createElement(rN.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function AS(e){let{routeContext:r,match:s,children:a}=e,n=T.useContext(xf);return n&&n.static&&n.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=s.route.id),T.createElement(el.Provider,{value:r},a)}function CS(e,r,s,a){var n;if(r===void 0&&(r=[]),s===void 0&&(s=null),a===void 0&&(a=null),e==null){var o;if(!s)return null;if(s.errors)e=s.matches;else if((o=a)!=null&&o.v7_partialHydration&&r.length===0&&!s.initialized&&s.matches.length>0)e=s.matches;else return null}let c=e,d=(n=s)==null?void 0:n.errors;if(d!=null){let f=c.findIndex(p=>p.route.id&&d?.[p.route.id]!==void 0);f>=0||is(!1),c=c.slice(0,Math.min(c.length,f+1))}let h=!1,m=-1;if(s&&a&&a.v7_partialHydration)for(let f=0;f<c.length;f++){let p=c[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(m=f),p.route.id){let{loaderData:g,errors:N}=s,y=p.route.loader&&g[p.route.id]===void 0&&(!N||N[p.route.id]===void 0);if(p.route.lazy||y){h=!0,m>=0?c=c.slice(0,m+1):c=[c[0]];break}}}return c.reduceRight((f,p,g)=>{let N,y=!1,w=null,b=null;s&&(N=d&&p.route.id?d[p.route.id]:void 0,w=p.route.errorElement||TS,h&&(m<0&&g===0?(OS("route-fallback"),y=!0,b=null):m===g&&(y=!0,b=p.route.hydrateFallbackElement||null)));let C=r.concat(c.slice(0,g+1)),A=()=>{let E;return N?E=w:y?E=b:p.route.Component?E=T.createElement(p.route.Component,null):p.route.element?E=p.route.element:E=f,T.createElement(AS,{match:p,routeContext:{outlet:f,matches:C,isDataRoute:s!=null},children:E})};return s&&(p.route.ErrorBoundary||p.route.errorElement||g===0)?T.createElement(SS,{location:s.location,revalidation:s.revalidation,component:w,error:N,children:A(),routeContext:{outlet:null,matches:C,isDataRoute:!0}}):A()},null)}var aN=(function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e})(aN||{}),nN=(function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e})(nN||{});function kS(e){let r=T.useContext(xf);return r||is(!1),r}function PS(e){let r=T.useContext(NS);return r||is(!1),r}function RS(e){let r=T.useContext(el);return r||is(!1),r}function iN(e){let r=RS(),s=r.matches[r.matches.length-1];return s.route.id||is(!1),s.route.id}function _S(){var e;let r=T.useContext(rN),s=PS(),a=iN();return r!==void 0?r:(e=s.errors)==null?void 0:e[a]}function DS(){let{router:e}=kS(aN.UseNavigateStable),r=iN(nN.UseNavigateStable),s=T.useRef(!1);return sN(()=>{s.current=!0}),T.useCallback(function(n,o){o===void 0&&(o={}),s.current&&(typeof n=="number"?e.navigate(n):e.navigate(n,hc({fromRouteId:r},o)))},[e,r])}const av={};function OS(e,r,s){av[e]||(av[e]=!0)}function FS(e,r){e?.v7_startTransition,e?.v7_relativeSplatPath}function vn(e){let{to:r,replace:s,state:a,relative:n}=e;Cc()||is(!1);let{future:o,static:c}=T.useContext(Ac),{matches:d}=T.useContext(el),{pathname:h}=Jl(),m=Ls(),f=eN(r,Z1(d,o.v7_relativeSplatPath),h,n==="path"),p=JSON.stringify(f);return T.useEffect(()=>m(JSON.parse(p),{replace:s,state:a,relative:n}),[m,p,n,s,a]),null}function gs(e){is(!1)}function IS(e){let{basename:r="/",children:s=null,location:a,navigationType:n=li.Pop,navigator:o,static:c=!1,future:d}=e;Cc()&&is(!1);let h=r.replace(/^\/*/,"/"),m=T.useMemo(()=>({basename:h,navigator:o,static:c,future:hc({v7_relativeSplatPath:!1},d)}),[h,d,o,c]);typeof a=="string"&&(a=Yl(a));let{pathname:f="/",search:p="",hash:g="",state:N=null,key:y="default"}=a,w=T.useMemo(()=>{let b=Q1(f,h);return b==null?null:{location:{pathname:b,search:p,hash:g,state:N,key:y},navigationType:n}},[h,f,p,g,N,y,n]);return w==null?null:T.createElement(Ac.Provider,{value:m},T.createElement(Mu.Provider,{children:s,value:w}))}function MS(e){let{children:r,location:s}=e;return bS(Em(r),s)}new Promise(()=>{});function Em(e,r){r===void 0&&(r=[]);let s=[];return T.Children.forEach(e,(a,n)=>{if(!T.isValidElement(a))return;let o=[...r,n];if(a.type===T.Fragment){s.push.apply(s,Em(a.props.children,o));return}a.type!==gs&&is(!1),!a.props.index||!a.props.children||is(!1);let c={id:a.props.id||o.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(c.children=Em(a.props.children,o)),s.push(c)}),s}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Tm(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((r,s)=>{let a=e[s];return r.concat(Array.isArray(a)?a.map(n=>[s,n]):[[s,a]])},[]))}function LS(e,r){let s=Tm(e);return r&&r.forEach((a,n)=>{s.has(n)||r.getAll(n).forEach(o=>{s.append(n,o)})}),s}const BS="6";try{window.__reactRouterVersion=BS}catch{}const HS="startTransition",nv=mf[HS];function VS(e){let{basename:r,children:s,future:a,window:n}=e,o=T.useRef();o.current==null&&(o.current=XT({window:n,v5Compat:!0}));let c=o.current,[d,h]=T.useState({action:c.action,location:c.location}),{v7_startTransition:m}=a||{},f=T.useCallback(p=>{m&&nv?nv(()=>h(p)):h(p)},[h,m]);return T.useLayoutEffect(()=>c.listen(f),[c,f]),T.useEffect(()=>FS(a),[a]),T.createElement(IS,{basename:r,children:s,location:d.location,navigationType:d.action,navigator:c,future:a})}var iv;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(iv||(iv={}));var lv;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(lv||(lv={}));function US(e){let r=T.useRef(Tm(e)),s=T.useRef(!1),a=Jl(),n=T.useMemo(()=>LS(a.search,s.current?null:r.current),[a.search]),o=Ls(),c=T.useCallback((d,h)=>{const m=Tm(typeof d=="function"?d(n):d);s.current=!0,o("?"+m,h)},[o,n]);return[n,c]}var Vh={exports:{}},Uh,ov;function $S(){if(ov)return Uh;ov=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Uh=e,Uh}var $h,cv;function GS(){if(cv)return $h;cv=1;var e=$S();function r(){}function s(){}return s.resetWarningCache=r,$h=function(){function a(c,d,h,m,f,p){if(p!==e){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}}a.isRequired=a;function n(){return a}var o={array:a,bigint:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:n,element:a,elementType:a,instanceOf:n,node:a,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:s,resetWarningCache:r};return o.PropTypes=o,o},$h}var dv;function WS(){return dv||(dv=1,Vh.exports=GS()()),Vh.exports}var zS=WS();const Ct=yi(zS);var Gh,uv;function KS(){if(uv)return Gh;uv=1;function e(d){return d&&typeof d=="object"&&"default"in d?d.default:d}var r=Iu(),s=e(r);function a(d,h,m){return h in d?Object.defineProperty(d,h,{value:m,enumerable:!0,configurable:!0,writable:!0}):d[h]=m,d}function n(d,h){d.prototype=Object.create(h.prototype),d.prototype.constructor=d,d.__proto__=h}var o=!!(typeof window<"u"&&window.document&&window.document.createElement);function c(d,h,m){if(typeof d!="function")throw new Error("Expected reducePropsToState to be a function.");if(typeof h!="function")throw new Error("Expected handleStateChangeOnClient to be a function.");if(typeof m<"u"&&typeof m!="function")throw new Error("Expected mapStateOnServer to either be undefined or a function.");function f(p){return p.displayName||p.name||"Component"}return function(g){if(typeof g!="function")throw new Error("Expected WrappedComponent to be a React component.");var N=[],y;function w(){y=d(N.map(function(C){return C.props})),b.canUseDOM?h(y):m&&(y=m(y))}var b=(function(C){n(A,C);function A(){return C.apply(this,arguments)||this}A.peek=function(){return y},A.rewind=function(){if(A.canUseDOM)throw new Error("You may only call rewind() on the server. Call peek() to read the current state.");var V=y;return y=void 0,N=[],V};var E=A.prototype;return E.UNSAFE_componentWillMount=function(){N.push(this),w()},E.componentDidUpdate=function(){w()},E.componentWillUnmount=function(){var V=N.indexOf(this);N.splice(V,1),w()},E.render=function(){return s.createElement(g,this.props)},A})(r.PureComponent);return a(b,"displayName","SideEffect("+f(g)+")"),a(b,"canUseDOM",o),b}}return Gh=c,Gh}var XS=KS();const qS=yi(XS);var Wh,hv;function YS(){if(hv)return Wh;hv=1;var e=typeof Element<"u",r=typeof Map=="function",s=typeof Set=="function",a=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function n(o,c){if(o===c)return!0;if(o&&c&&typeof o=="object"&&typeof c=="object"){if(o.constructor!==c.constructor)return!1;var d,h,m;if(Array.isArray(o)){if(d=o.length,d!=c.length)return!1;for(h=d;h--!==0;)if(!n(o[h],c[h]))return!1;return!0}var f;if(r&&o instanceof Map&&c instanceof Map){if(o.size!==c.size)return!1;for(f=o.entries();!(h=f.next()).done;)if(!c.has(h.value[0]))return!1;for(f=o.entries();!(h=f.next()).done;)if(!n(h.value[1],c.get(h.value[0])))return!1;return!0}if(s&&o instanceof Set&&c instanceof Set){if(o.size!==c.size)return!1;for(f=o.entries();!(h=f.next()).done;)if(!c.has(h.value[0]))return!1;return!0}if(a&&ArrayBuffer.isView(o)&&ArrayBuffer.isView(c)){if(d=o.length,d!=c.length)return!1;for(h=d;h--!==0;)if(o[h]!==c[h])return!1;return!0}if(o.constructor===RegExp)return o.source===c.source&&o.flags===c.flags;if(o.valueOf!==Object.prototype.valueOf&&typeof o.valueOf=="function"&&typeof c.valueOf=="function")return o.valueOf()===c.valueOf();if(o.toString!==Object.prototype.toString&&typeof o.toString=="function"&&typeof c.toString=="function")return o.toString()===c.toString();if(m=Object.keys(o),d=m.length,d!==Object.keys(c).length)return!1;for(h=d;h--!==0;)if(!Object.prototype.hasOwnProperty.call(c,m[h]))return!1;if(e&&o instanceof Element)return!1;for(h=d;h--!==0;)if(!((m[h]==="_owner"||m[h]==="__v"||m[h]==="__o")&&o.$$typeof)&&!n(o[m[h]],c[m[h]]))return!1;return!0}return o!==o&&c!==c}return Wh=function(c,d){try{return n(c,d)}catch(h){if((h.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw h}},Wh}var JS=YS();const QS=yi(JS);/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var zh,mv;function ZS(){if(mv)return zh;mv=1;var e=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;function a(o){if(o==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(o)}function n(){try{if(!Object.assign)return!1;var o=new String("abc");if(o[5]="de",Object.getOwnPropertyNames(o)[0]==="5")return!1;for(var c={},d=0;d<10;d++)c["_"+String.fromCharCode(d)]=d;var h=Object.getOwnPropertyNames(c).map(function(f){return c[f]});if(h.join("")!=="0123456789")return!1;var m={};return"abcdefghijklmnopqrst".split("").forEach(function(f){m[f]=f}),Object.keys(Object.assign({},m)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}return zh=n()?Object.assign:function(o,c){for(var d,h=a(o),m,f=1;f<arguments.length;f++){d=Object(arguments[f]);for(var p in d)r.call(d,p)&&(h[p]=d[p]);if(e){m=e(d);for(var g=0;g<m.length;g++)s.call(d,m[g])&&(h[m[g]]=d[m[g]])}}return h},zh}var eA=ZS();const tA=yi(eA);var Wi={BODY:"bodyAttributes",HTML:"htmlAttributes",TITLE:"titleAttributes"},Wt={BASE:"base",BODY:"body",HEAD:"head",HTML:"html",LINK:"link",META:"meta",NOSCRIPT:"noscript",SCRIPT:"script",STYLE:"style",TITLE:"title"};Object.keys(Wt).map(function(e){return Wt[e]});var Lr={CHARSET:"charset",CSS_TEXT:"cssText",HREF:"href",HTTPEQUIV:"http-equiv",INNER_HTML:"innerHTML",ITEM_PROP:"itemprop",NAME:"name",PROPERTY:"property",REL:"rel",SRC:"src",TARGET:"target"},hu={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},mc={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate"},rA=Object.keys(hu).reduce(function(e,r){return e[hu[r]]=r,e},{}),sA=[Wt.NOSCRIPT,Wt.SCRIPT,Wt.STYLE],Va="data-react-helmet",aA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nA=function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")},iA=(function(){function e(r,s){for(var a=0;a<s.length;a++){var n=s[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}return function(r,s,a){return s&&e(r.prototype,s),a&&e(r,a),r}})(),aa=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},lA=function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)},fv=function(e,r){var s={};for(var a in e)r.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(s[a]=e[a]);return s},oA=function(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r&&(typeof r=="object"||typeof r=="function")?r:e},Sm=function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return s===!1?String(r):String(r).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")},cA=function(r){var s=Ul(r,Wt.TITLE),a=Ul(r,mc.TITLE_TEMPLATE);if(a&&s)return a.replace(/%s/g,function(){return Array.isArray(s)?s.join(""):s});var n=Ul(r,mc.DEFAULT_TITLE);return s||n||void 0},dA=function(r){return Ul(r,mc.ON_CHANGE_CLIENT_STATE)||function(){}},Kh=function(r,s){return s.filter(function(a){return typeof a[r]<"u"}).map(function(a){return a[r]}).reduce(function(a,n){return aa({},a,n)},{})},uA=function(r,s){return s.filter(function(a){return typeof a[Wt.BASE]<"u"}).map(function(a){return a[Wt.BASE]}).reverse().reduce(function(a,n){if(!a.length)for(var o=Object.keys(n),c=0;c<o.length;c++){var d=o[c],h=d.toLowerCase();if(r.indexOf(h)!==-1&&n[h])return a.concat(n)}return a},[])},Mo=function(r,s,a){var n={};return a.filter(function(o){return Array.isArray(o[r])?!0:(typeof o[r]<"u"&&xA("Helmet: "+r+' should be of type "Array". Instead found type "'+aA(o[r])+'"'),!1)}).map(function(o){return o[r]}).reverse().reduce(function(o,c){var d={};c.filter(function(g){for(var N=void 0,y=Object.keys(g),w=0;w<y.length;w++){var b=y[w],C=b.toLowerCase();s.indexOf(C)!==-1&&!(N===Lr.REL&&g[N].toLowerCase()==="canonical")&&!(C===Lr.REL&&g[C].toLowerCase()==="stylesheet")&&(N=C),s.indexOf(b)!==-1&&(b===Lr.INNER_HTML||b===Lr.CSS_TEXT||b===Lr.ITEM_PROP)&&(N=b)}if(!N||!g[N])return!1;var A=g[N].toLowerCase();return n[N]||(n[N]={}),d[N]||(d[N]={}),n[N][A]?!1:(d[N][A]=!0,!0)}).reverse().forEach(function(g){return o.push(g)});for(var h=Object.keys(d),m=0;m<h.length;m++){var f=h[m],p=tA({},n[f],d[f]);n[f]=p}return o},[]).reverse()},Ul=function(r,s){for(var a=r.length-1;a>=0;a--){var n=r[a];if(n.hasOwnProperty(s))return n[s]}return null},hA=function(r){return{baseTag:uA([Lr.HREF,Lr.TARGET],r),bodyAttributes:Kh(Wi.BODY,r),defer:Ul(r,mc.DEFER),encode:Ul(r,mc.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:Kh(Wi.HTML,r),linkTags:Mo(Wt.LINK,[Lr.REL,Lr.HREF],r),metaTags:Mo(Wt.META,[Lr.NAME,Lr.CHARSET,Lr.HTTPEQUIV,Lr.PROPERTY,Lr.ITEM_PROP],r),noscriptTags:Mo(Wt.NOSCRIPT,[Lr.INNER_HTML],r),onChangeClientState:dA(r),scriptTags:Mo(Wt.SCRIPT,[Lr.SRC,Lr.INNER_HTML],r),styleTags:Mo(Wt.STYLE,[Lr.CSS_TEXT],r),title:cA(r),titleAttributes:Kh(Wi.TITLE,r)}},Am=(function(){var e=Date.now();return function(r){var s=Date.now();s-e>16?(e=s,r(s)):setTimeout(function(){Am(r)},0)}})(),xv=function(r){return clearTimeout(r)},mA=typeof window<"u"?window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||Am:global.requestAnimationFrame||Am,fA=typeof window<"u"?window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||xv:global.cancelAnimationFrame||xv,xA=function(r){return console&&typeof console.warn=="function"&&console.warn(r)},Lo=null,pA=function(r){Lo&&fA(Lo),r.defer?Lo=mA(function(){pv(r,function(){Lo=null})}):(pv(r),Lo=null)},pv=function(r,s){var a=r.baseTag,n=r.bodyAttributes,o=r.htmlAttributes,c=r.linkTags,d=r.metaTags,h=r.noscriptTags,m=r.onChangeClientState,f=r.scriptTags,p=r.styleTags,g=r.title,N=r.titleAttributes;Cm(Wt.BODY,n),Cm(Wt.HTML,o),gA(g,N);var y={baseTag:Dl(Wt.BASE,a),linkTags:Dl(Wt.LINK,c),metaTags:Dl(Wt.META,d),noscriptTags:Dl(Wt.NOSCRIPT,h),scriptTags:Dl(Wt.SCRIPT,f),styleTags:Dl(Wt.STYLE,p)},w={},b={};Object.keys(y).forEach(function(C){var A=y[C],E=A.newTags,R=A.oldTags;E.length&&(w[C]=E),R.length&&(b[C]=y[C].oldTags)}),s&&s(),m(r,w,b)},lN=function(r){return Array.isArray(r)?r.join(""):r},gA=function(r,s){typeof r<"u"&&document.title!==r&&(document.title=lN(r)),Cm(Wt.TITLE,s)},Cm=function(r,s){var a=document.getElementsByTagName(r)[0];if(a){for(var n=a.getAttribute(Va),o=n?n.split(","):[],c=[].concat(o),d=Object.keys(s),h=0;h<d.length;h++){var m=d[h],f=s[m]||"";a.getAttribute(m)!==f&&a.setAttribute(m,f),o.indexOf(m)===-1&&o.push(m);var p=c.indexOf(m);p!==-1&&c.splice(p,1)}for(var g=c.length-1;g>=0;g--)a.removeAttribute(c[g]);o.length===c.length?a.removeAttribute(Va):a.getAttribute(Va)!==d.join(",")&&a.setAttribute(Va,d.join(","))}},Dl=function(r,s){var a=document.head||document.querySelector(Wt.HEAD),n=a.querySelectorAll(r+"["+Va+"]"),o=Array.prototype.slice.call(n),c=[],d=void 0;return s&&s.length&&s.forEach(function(h){var m=document.createElement(r);for(var f in h)if(h.hasOwnProperty(f))if(f===Lr.INNER_HTML)m.innerHTML=h.innerHTML;else if(f===Lr.CSS_TEXT)m.styleSheet?m.styleSheet.cssText=h.cssText:m.appendChild(document.createTextNode(h.cssText));else{var p=typeof h[f]>"u"?"":h[f];m.setAttribute(f,p)}m.setAttribute(Va,"true"),o.some(function(g,N){return d=N,m.isEqualNode(g)})?o.splice(d,1):c.push(m)}),o.forEach(function(h){return h.parentNode.removeChild(h)}),c.forEach(function(h){return a.appendChild(h)}),{oldTags:o,newTags:c}},oN=function(r){return Object.keys(r).reduce(function(s,a){var n=typeof r[a]<"u"?a+'="'+r[a]+'"':""+a;return s?s+" "+n:n},"")},vA=function(r,s,a,n){var o=oN(a),c=lN(s);return o?"<"+r+" "+Va+'="true" '+o+">"+Sm(c,n)+"</"+r+">":"<"+r+" "+Va+'="true">'+Sm(c,n)+"</"+r+">"},yA=function(r,s,a){return s.reduce(function(n,o){var c=Object.keys(o).filter(function(m){return!(m===Lr.INNER_HTML||m===Lr.CSS_TEXT)}).reduce(function(m,f){var p=typeof o[f]>"u"?f:f+'="'+Sm(o[f],a)+'"';return m?m+" "+p:p},""),d=o.innerHTML||o.cssText||"",h=sA.indexOf(r)===-1;return n+"<"+r+" "+Va+'="true" '+c+(h?"/>":">"+d+"</"+r+">")},"")},cN=function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.keys(r).reduce(function(a,n){return a[hu[n]||n]=r[n],a},s)},NA=function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.keys(r).reduce(function(a,n){return a[rA[n]||n]=r[n],a},s)},wA=function(r,s,a){var n,o=(n={key:s},n[Va]=!0,n),c=cN(a,o);return[Kt.createElement(Wt.TITLE,c,s)]},bA=function(r,s){return s.map(function(a,n){var o,c=(o={key:n},o[Va]=!0,o);return Object.keys(a).forEach(function(d){var h=hu[d]||d;if(h===Lr.INNER_HTML||h===Lr.CSS_TEXT){var m=a.innerHTML||a.cssText;c.dangerouslySetInnerHTML={__html:m}}else c[h]=a[d]}),Kt.createElement(r,c)})},gn=function(r,s,a){switch(r){case Wt.TITLE:return{toComponent:function(){return wA(r,s.title,s.titleAttributes)},toString:function(){return vA(r,s.title,s.titleAttributes,a)}};case Wi.BODY:case Wi.HTML:return{toComponent:function(){return cN(s)},toString:function(){return oN(s)}};default:return{toComponent:function(){return bA(r,s)},toString:function(){return yA(r,s,a)}}}},dN=function(r){var s=r.baseTag,a=r.bodyAttributes,n=r.encode,o=r.htmlAttributes,c=r.linkTags,d=r.metaTags,h=r.noscriptTags,m=r.scriptTags,f=r.styleTags,p=r.title,g=p===void 0?"":p,N=r.titleAttributes;return{base:gn(Wt.BASE,s,n),bodyAttributes:gn(Wi.BODY,a,n),htmlAttributes:gn(Wi.HTML,o,n),link:gn(Wt.LINK,c,n),meta:gn(Wt.META,d,n),noscript:gn(Wt.NOSCRIPT,h,n),script:gn(Wt.SCRIPT,m,n),style:gn(Wt.STYLE,f,n),title:gn(Wt.TITLE,{title:g,titleAttributes:N},n)}},jA=function(r){var s,a;return a=s=(function(n){lA(o,n);function o(){return nA(this,o),oA(this,n.apply(this,arguments))}return o.prototype.shouldComponentUpdate=function(d){return!QS(this.props,d)},o.prototype.mapNestedChildrenToProps=function(d,h){if(!h)return null;switch(d.type){case Wt.SCRIPT:case Wt.NOSCRIPT:return{innerHTML:h};case Wt.STYLE:return{cssText:h}}throw new Error("<"+d.type+" /> elements are self-closing and can not contain children. Refer to our API for more information.")},o.prototype.flattenArrayTypeChildren=function(d){var h,m=d.child,f=d.arrayTypeChildren,p=d.newChildProps,g=d.nestedChildren;return aa({},f,(h={},h[m.type]=[].concat(f[m.type]||[],[aa({},p,this.mapNestedChildrenToProps(m,g))]),h))},o.prototype.mapObjectTypeChildren=function(d){var h,m,f=d.child,p=d.newProps,g=d.newChildProps,N=d.nestedChildren;switch(f.type){case Wt.TITLE:return aa({},p,(h={},h[f.type]=N,h.titleAttributes=aa({},g),h));case Wt.BODY:return aa({},p,{bodyAttributes:aa({},g)});case Wt.HTML:return aa({},p,{htmlAttributes:aa({},g)})}return aa({},p,(m={},m[f.type]=aa({},g),m))},o.prototype.mapArrayTypeChildrenToProps=function(d,h){var m=aa({},h);return Object.keys(d).forEach(function(f){var p;m=aa({},m,(p={},p[f]=d[f],p))}),m},o.prototype.warnOnInvalidChildren=function(d,h){return!0},o.prototype.mapChildrenToProps=function(d,h){var m=this,f={};return Kt.Children.forEach(d,function(p){if(!(!p||!p.props)){var g=p.props,N=g.children,y=fv(g,["children"]),w=NA(y);switch(m.warnOnInvalidChildren(p,N),p.type){case Wt.LINK:case Wt.META:case Wt.NOSCRIPT:case Wt.SCRIPT:case Wt.STYLE:f=m.flattenArrayTypeChildren({child:p,arrayTypeChildren:f,newChildProps:w,nestedChildren:N});break;default:h=m.mapObjectTypeChildren({child:p,newProps:h,newChildProps:w,nestedChildren:N});break}}}),h=this.mapArrayTypeChildrenToProps(f,h),h},o.prototype.render=function(){var d=this.props,h=d.children,m=fv(d,["children"]),f=aa({},m);return h&&(f=this.mapChildrenToProps(h,f)),Kt.createElement(r,f)},iA(o,null,[{key:"canUseDOM",set:function(d){r.canUseDOM=d}}]),o})(Kt.Component),s.propTypes={base:Ct.object,bodyAttributes:Ct.object,children:Ct.oneOfType([Ct.arrayOf(Ct.node),Ct.node]),defaultTitle:Ct.string,defer:Ct.bool,encodeSpecialCharacters:Ct.bool,htmlAttributes:Ct.object,link:Ct.arrayOf(Ct.object),meta:Ct.arrayOf(Ct.object),noscript:Ct.arrayOf(Ct.object),onChangeClientState:Ct.func,script:Ct.arrayOf(Ct.object),style:Ct.arrayOf(Ct.object),title:Ct.string,titleAttributes:Ct.object,titleTemplate:Ct.string},s.defaultProps={defer:!0,encodeSpecialCharacters:!0},s.peek=r.peek,s.rewind=function(){var n=r.rewind();return n||(n=dN({baseTag:[],bodyAttributes:{},htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}})),n},a},EA=function(){return null},TA=qS(hA,pA,dN)(EA),km=jA(TA);km.renderStatic=km.rewind;function uN(e){var r,s,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var n=e.length;for(r=0;r<n;r++)e[r]&&(s=uN(e[r]))&&(a&&(a+=" "),a+=s)}else for(s in e)e[s]&&(a&&(a+=" "),a+=s);return a}function hN(){for(var e,r,s=0,a="",n=arguments.length;s<n;s++)(e=arguments[s])&&(r=uN(e))&&(a&&(a+=" "),a+=r);return a}function SA(){for(var e=0,r,s,a="";e<arguments.length;)(r=arguments[e++])&&(s=mN(r))&&(a&&(a+=" "),a+=s);return a}function mN(e){if(typeof e=="string")return e;for(var r,s="",a=0;a<e.length;a++)e[a]&&(r=mN(e[a]))&&(s&&(s+=" "),s+=r);return s}var pf="-";function AA(e){var r=kA(e),s=e.conflictingClassGroups,a=e.conflictingClassGroupModifiers,n=a===void 0?{}:a;function o(d){var h=d.split(pf);return h[0]===""&&h.length!==1&&h.shift(),fN(h,r)||CA(d)}function c(d,h){var m=s[d]||[];return h&&n[d]?[].concat(m,n[d]):m}return{getClassGroupId:o,getConflictingClassGroupIds:c}}function fN(e,r){if(e.length===0)return r.classGroupId;var s=e[0],a=r.nextPart.get(s),n=a?fN(e.slice(1),a):void 0;if(n)return n;if(r.validators.length!==0){var o=e.join(pf);return r.validators.find(function(c){var d=c.validator;return d(o)})?.classGroupId}}var gv=/^\[(.+)\]$/;function CA(e){if(gv.test(e)){var r=gv.exec(e)[1],s=r?.substring(0,r.indexOf(":"));if(s)return"arbitrary.."+s}}function kA(e){var r=e.theme,s=e.prefix,a={nextPart:new Map,validators:[]},n=RA(Object.entries(e.classGroups),s);return n.forEach(function(o){var c=o[0],d=o[1];Pm(d,a,c,r)}),a}function Pm(e,r,s,a){e.forEach(function(n){if(typeof n=="string"){var o=n===""?r:vv(r,n);o.classGroupId=s;return}if(typeof n=="function"){if(PA(n)){Pm(n(a),r,s,a);return}r.validators.push({validator:n,classGroupId:s});return}Object.entries(n).forEach(function(c){var d=c[0],h=c[1];Pm(h,vv(r,d),s,a)})})}function vv(e,r){var s=e;return r.split(pf).forEach(function(a){s.nextPart.has(a)||s.nextPart.set(a,{nextPart:new Map,validators:[]}),s=s.nextPart.get(a)}),s}function PA(e){return e.isThemeGetter}function RA(e,r){return r?e.map(function(s){var a=s[0],n=s[1],o=n.map(function(c){return typeof c=="string"?r+c:typeof c=="object"?Object.fromEntries(Object.entries(c).map(function(d){var h=d[0],m=d[1];return[r+h,m]})):c});return[a,o]}):e}function _A(e){if(e<1)return{get:function(){},set:function(){}};var r=0,s=new Map,a=new Map;function n(o,c){s.set(o,c),r++,r>e&&(r=0,a=s,s=new Map)}return{get:function(c){var d=s.get(c);if(d!==void 0)return d;if((d=a.get(c))!==void 0)return n(c,d),d},set:function(c,d){s.has(c)?s.set(c,d):n(c,d)}}}var xN="!";function DA(e){var r=e.separator||":",s=r.length===1,a=r[0],n=r.length;return function(c){for(var d=[],h=0,m=0,f,p=0;p<c.length;p++){var g=c[p];if(h===0){if(g===a&&(s||c.slice(p,p+n)===r)){d.push(c.slice(m,p)),m=p+n;continue}if(g==="/"){f=p;continue}}g==="["?h++:g==="]"&&h--}var N=d.length===0?c:c.substring(m),y=N.startsWith(xN),w=y?N.substring(1):N,b=f&&f>m?f-m:void 0;return{modifiers:d,hasImportantModifier:y,baseClassName:w,maybePostfixModifierPosition:b}}}function OA(e){if(e.length<=1)return e;var r=[],s=[];return e.forEach(function(a){var n=a[0]==="[";n?(r.push.apply(r,s.sort().concat([a])),s=[]):s.push(a)}),r.push.apply(r,s.sort()),r}function FA(e){return{cache:_A(e.cacheSize),splitModifiers:DA(e),...AA(e)}}var IA=/\s+/;function MA(e,r){var s=r.splitModifiers,a=r.getClassGroupId,n=r.getConflictingClassGroupIds,o=new Set;return e.trim().split(IA).map(function(c){var d=s(c),h=d.modifiers,m=d.hasImportantModifier,f=d.baseClassName,p=d.maybePostfixModifierPosition,g=a(p?f.substring(0,p):f),N=!!p;if(!g){if(!p)return{isTailwindClass:!1,originalClassName:c};if(g=a(f),!g)return{isTailwindClass:!1,originalClassName:c};N=!1}var y=OA(h).join(":"),w=m?y+xN:y;return{isTailwindClass:!0,modifierId:w,classGroupId:g,originalClassName:c,hasPostfixModifier:N}}).reverse().filter(function(c){if(!c.isTailwindClass)return!0;var d=c.modifierId,h=c.classGroupId,m=c.hasPostfixModifier,f=d+h;return o.has(f)?!1:(o.add(f),n(h,m).forEach(function(p){return o.add(d+p)}),!0)}).reverse().map(function(c){return c.originalClassName}).join(" ")}function LA(){for(var e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];var a,n,o,c=d;function d(m){var f=r[0],p=r.slice(1),g=p.reduce(function(N,y){return y(N)},f());return a=FA(g),n=a.cache.get,o=a.cache.set,c=h,h(m)}function h(m){var f=n(m);if(f)return f;var p=MA(m,a);return o(m,p),p}return function(){return c(SA.apply(null,arguments))}}function Dr(e){var r=function(a){return a[e]||[]};return r.isThemeGetter=!0,r}var pN=/^\[(?:([a-z-]+):)?(.+)\]$/i,BA=/^\d+\/\d+$/,HA=new Set(["px","full","screen"]),VA=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,UA=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,$A=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function Fa(e){return Hi(e)||HA.has(e)||BA.test(e)||Rm(e)}function Rm(e){return tl(e,"length",qA)}function GA(e){return tl(e,"size",gN)}function WA(e){return tl(e,"position",gN)}function zA(e){return tl(e,"url",YA)}function zd(e){return tl(e,"number",Hi)}function Hi(e){return!Number.isNaN(Number(e))}function KA(e){return e.endsWith("%")&&Hi(e.slice(0,-1))}function Bo(e){return yv(e)||tl(e,"number",yv)}function Zt(e){return pN.test(e)}function Ho(){return!0}function Zn(e){return VA.test(e)}function XA(e){return tl(e,"",JA)}function tl(e,r,s){var a=pN.exec(e);return a?a[1]?a[1]===r:s(a[2]):!1}function qA(e){return UA.test(e)}function gN(){return!1}function YA(e){return e.startsWith("url(")}function yv(e){return Number.isInteger(Number(e))}function JA(e){return $A.test(e)}function QA(){var e=Dr("colors"),r=Dr("spacing"),s=Dr("blur"),a=Dr("brightness"),n=Dr("borderColor"),o=Dr("borderRadius"),c=Dr("borderSpacing"),d=Dr("borderWidth"),h=Dr("contrast"),m=Dr("grayscale"),f=Dr("hueRotate"),p=Dr("invert"),g=Dr("gap"),N=Dr("gradientColorStops"),y=Dr("gradientColorStopPositions"),w=Dr("inset"),b=Dr("margin"),C=Dr("opacity"),A=Dr("padding"),E=Dr("saturate"),R=Dr("scale"),V=Dr("sepia"),P=Dr("skew"),k=Dr("space"),z=Dr("translate"),W=function(){return["auto","contain","none"]},te=function(){return["auto","hidden","clip","visible","scroll"]},de=function(){return["auto",Zt,r]},H=function(){return[Zt,r]},ue=function(){return["",Fa]},I=function(){return["auto",Hi,Zt]},X=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},oe=function(){return["solid","dashed","dotted","double","none"]},xe=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},he=function(){return["start","end","center","between","around","evenly","stretch"]},F=function(){return["","0",Zt]},ee=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},M=function(){return[Hi,zd]},_=function(){return[Hi,Zt]};return{cacheSize:500,theme:{colors:[Ho],spacing:[Fa],blur:["none","",Zn,Zt],brightness:M(),borderColor:[e],borderRadius:["none","","full",Zn,Zt],borderSpacing:H(),borderWidth:ue(),contrast:M(),grayscale:F(),hueRotate:_(),invert:F(),gap:H(),gradientColorStops:[e],gradientColorStopPositions:[KA,Rm],inset:de(),margin:de(),opacity:M(),padding:H(),saturate:M(),scale:M(),sepia:F(),skew:_(),space:H(),translate:H()},classGroups:{aspect:[{aspect:["auto","square","video",Zt]}],container:["container"],columns:[{columns:[Zn]}],"break-after":[{"break-after":ee()}],"break-before":[{"break-before":ee()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(X(),[Zt])}],overflow:[{overflow:te()}],"overflow-x":[{"overflow-x":te()}],"overflow-y":[{"overflow-y":te()}],overscroll:[{overscroll:W()}],"overscroll-x":[{"overscroll-x":W()}],"overscroll-y":[{"overscroll-y":W()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[w]}],"inset-x":[{"inset-x":[w]}],"inset-y":[{"inset-y":[w]}],start:[{start:[w]}],end:[{end:[w]}],top:[{top:[w]}],right:[{right:[w]}],bottom:[{bottom:[w]}],left:[{left:[w]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Bo]}],basis:[{basis:de()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Zt]}],grow:[{grow:F()}],shrink:[{shrink:F()}],order:[{order:["first","last","none",Bo]}],"grid-cols":[{"grid-cols":[Ho]}],"col-start-end":[{col:["auto",{span:["full",Bo]},Zt]}],"col-start":[{"col-start":I()}],"col-end":[{"col-end":I()}],"grid-rows":[{"grid-rows":[Ho]}],"row-start-end":[{row:["auto",{span:[Bo]},Zt]}],"row-start":[{"row-start":I()}],"row-end":[{"row-end":I()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Zt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Zt]}],gap:[{gap:[g]}],"gap-x":[{"gap-x":[g]}],"gap-y":[{"gap-y":[g]}],"justify-content":[{justify:["normal"].concat(he())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(he(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(he(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[A]}],px:[{px:[A]}],py:[{py:[A]}],ps:[{ps:[A]}],pe:[{pe:[A]}],pt:[{pt:[A]}],pr:[{pr:[A]}],pb:[{pb:[A]}],pl:[{pl:[A]}],m:[{m:[b]}],mx:[{mx:[b]}],my:[{my:[b]}],ms:[{ms:[b]}],me:[{me:[b]}],mt:[{mt:[b]}],mr:[{mr:[b]}],mb:[{mb:[b]}],ml:[{ml:[b]}],"space-x":[{"space-x":[k]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[k]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",Zt,r]}],"min-w":[{"min-w":["min","max","fit",Zt,Fa]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[Zn]},Zn,Zt]}],h:[{h:[Zt,r,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",Zt,Fa]}],"max-h":[{"max-h":[Zt,r,"min","max","fit"]}],"font-size":[{text:["base",Zn,Rm]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",zd]}],"font-family":[{font:[Ho]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Zt]}],"line-clamp":[{"line-clamp":["none",Hi,zd]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Zt,Fa]}],"list-image":[{"list-image":["none",Zt]}],"list-style-type":[{list:["none","disc","decimal",Zt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[C]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[C]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(oe(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",Fa]}],"underline-offset":[{"underline-offset":["auto",Zt,Fa]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:H()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Zt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Zt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[C]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(X(),[WA])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",GA]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},zA]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[y]}],"gradient-via-pos":[{via:[y]}],"gradient-to-pos":[{to:[y]}],"gradient-from":[{from:[N]}],"gradient-via":[{via:[N]}],"gradient-to":[{to:[N]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[d]}],"border-w-x":[{"border-x":[d]}],"border-w-y":[{"border-y":[d]}],"border-w-s":[{"border-s":[d]}],"border-w-e":[{"border-e":[d]}],"border-w-t":[{"border-t":[d]}],"border-w-r":[{"border-r":[d]}],"border-w-b":[{"border-b":[d]}],"border-w-l":[{"border-l":[d]}],"border-opacity":[{"border-opacity":[C]}],"border-style":[{border:[].concat(oe(),["hidden"])}],"divide-x":[{"divide-x":[d]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[d]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[C]}],"divide-style":[{divide:oe()}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:[""].concat(oe())}],"outline-offset":[{"outline-offset":[Zt,Fa]}],"outline-w":[{outline:[Fa]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:ue()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[C]}],"ring-offset-w":[{"ring-offset":[Fa]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Zn,XA]}],"shadow-color":[{shadow:[Ho]}],opacity:[{opacity:[C]}],"mix-blend":[{"mix-blend":xe()}],"bg-blend":[{"bg-blend":xe()}],filter:[{filter:["","none"]}],blur:[{blur:[s]}],brightness:[{brightness:[a]}],contrast:[{contrast:[h]}],"drop-shadow":[{"drop-shadow":["","none",Zn,Zt]}],grayscale:[{grayscale:[m]}],"hue-rotate":[{"hue-rotate":[f]}],invert:[{invert:[p]}],saturate:[{saturate:[E]}],sepia:[{sepia:[V]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[s]}],"backdrop-brightness":[{"backdrop-brightness":[a]}],"backdrop-contrast":[{"backdrop-contrast":[h]}],"backdrop-grayscale":[{"backdrop-grayscale":[m]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[f]}],"backdrop-invert":[{"backdrop-invert":[p]}],"backdrop-opacity":[{"backdrop-opacity":[C]}],"backdrop-saturate":[{"backdrop-saturate":[E]}],"backdrop-sepia":[{"backdrop-sepia":[V]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[c]}],"border-spacing-x":[{"border-spacing-x":[c]}],"border-spacing-y":[{"border-spacing-y":[c]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Zt]}],duration:[{duration:_()}],ease:[{ease:["linear","in","out","in-out",Zt]}],delay:[{delay:_()}],animate:[{animate:["none","spin","ping","pulse","bounce",Zt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[R]}],"scale-x":[{"scale-x":[R]}],"scale-y":[{"scale-y":[R]}],rotate:[{rotate:[Bo,Zt]}],"translate-x":[{"translate-x":[z]}],"translate-y":[{"translate-y":[z]}],"skew-x":[{"skew-x":[P]}],"skew-y":[{"skew-y":[P]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Zt]}],accent:[{accent:["auto",e]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Zt]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":H()}],"scroll-mx":[{"scroll-mx":H()}],"scroll-my":[{"scroll-my":H()}],"scroll-ms":[{"scroll-ms":H()}],"scroll-me":[{"scroll-me":H()}],"scroll-mt":[{"scroll-mt":H()}],"scroll-mr":[{"scroll-mr":H()}],"scroll-mb":[{"scroll-mb":H()}],"scroll-ml":[{"scroll-ml":H()}],"scroll-p":[{"scroll-p":H()}],"scroll-px":[{"scroll-px":H()}],"scroll-py":[{"scroll-py":H()}],"scroll-ps":[{"scroll-ps":H()}],"scroll-pe":[{"scroll-pe":H()}],"scroll-pt":[{"scroll-pt":H()}],"scroll-pr":[{"scroll-pr":H()}],"scroll-pb":[{"scroll-pb":H()}],"scroll-pl":[{"scroll-pl":H()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Zt]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Fa,zd]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var ZA=LA(QA);function Pr(...e){return ZA(hN(e))}function Or(e,r,{checkForDefaultPrevented:s=!0}={}){return function(n){if(e?.(n),s===!1||!n.defaultPrevented)return r?.(n)}}function Nv(e,r){if(typeof e=="function")return e(r);e!=null&&(e.current=r)}function vN(...e){return r=>{let s=!1;const a=e.map(n=>{const o=Nv(n,r);return!s&&typeof o=="function"&&(s=!0),o});if(s)return()=>{for(let n=0;n<a.length;n++){const o=a[n];typeof o=="function"?o():Nv(e[n],null)}}}}function za(...e){return T.useCallback(vN(...e),e)}function Ql(e,r=[]){let s=[];function a(o,c){const d=T.createContext(c),h=s.length;s=[...s,c];const m=p=>{const{scope:g,children:N,...y}=p,w=g?.[e]?.[h]||d,b=T.useMemo(()=>y,Object.values(y));return t.jsx(w.Provider,{value:b,children:N})};m.displayName=o+"Provider";function f(p,g){const N=g?.[e]?.[h]||d,y=T.useContext(N);if(y)return y;if(c!==void 0)return c;throw new Error(`\`${p}\` must be used within \`${o}\``)}return[m,f]}const n=()=>{const o=s.map(c=>T.createContext(c));return function(d){const h=d?.[e]||o;return T.useMemo(()=>({[`__scope${e}`]:{...d,[e]:h}}),[d,h])}};return n.scopeName=e,[a,eC(n,...r)]}function eC(...e){const r=e[0];if(e.length===1)return r;const s=()=>{const a=e.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(o){const c=a.reduce((d,{useScope:h,scopeName:m})=>{const p=h(o)[`__scope${m}`];return{...d,...p}},{});return T.useMemo(()=>({[`__scope${r.scopeName}`]:c}),[c])}};return s.scopeName=r.scopeName,s}function mu(e){const r=rC(e),s=T.forwardRef((a,n)=>{const{children:o,...c}=a,d=T.Children.toArray(o),h=d.find(aC);if(h){const m=h.props.children,f=d.map(p=>p===h?T.Children.count(m)>1?T.Children.only(null):T.isValidElement(m)?m.props.children:null:p);return t.jsx(r,{...c,ref:n,children:T.isValidElement(m)?T.cloneElement(m,void 0,f):null})}return t.jsx(r,{...c,ref:n,children:o})});return s.displayName=`${e}.Slot`,s}var tC=mu("Slot");function rC(e){const r=T.forwardRef((s,a)=>{const{children:n,...o}=s;if(T.isValidElement(n)){const c=iC(n),d=nC(o,n.props);return n.type!==T.Fragment&&(d.ref=a?vN(a,c):c),T.cloneElement(n,d)}return T.Children.count(n)>1?T.Children.only(null):null});return r.displayName=`${e}.SlotClone`,r}var sC=Symbol("radix.slottable");function aC(e){return T.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===sC}function nC(e,r){const s={...r};for(const a in r){const n=e[a],o=r[a];/^on[A-Z]/.test(a)?n&&o?s[a]=(...d)=>{const h=o(...d);return n(...d),h}:n&&(s[a]=n):a==="style"?s[a]={...n,...o}:a==="className"&&(s[a]=[n,o].filter(Boolean).join(" "))}return{...e,...s}}function iC(e){let r=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,s=r&&"isReactWarning"in r&&r.isReactWarning;return s?e.ref:(r=Object.getOwnPropertyDescriptor(e,"ref")?.get,s=r&&"isReactWarning"in r&&r.isReactWarning,s?e.props.ref:e.props.ref||e.ref)}function yN(e){const r=e+"CollectionProvider",[s,a]=Ql(r),[n,o]=s(r,{collectionRef:{current:null},itemMap:new Map}),c=w=>{const{scope:b,children:C}=w,A=Kt.useRef(null),E=Kt.useRef(new Map).current;return t.jsx(n,{scope:b,itemMap:E,collectionRef:A,children:C})};c.displayName=r;const d=e+"CollectionSlot",h=mu(d),m=Kt.forwardRef((w,b)=>{const{scope:C,children:A}=w,E=o(d,C),R=za(b,E.collectionRef);return t.jsx(h,{ref:R,children:A})});m.displayName=d;const f=e+"CollectionItemSlot",p="data-radix-collection-item",g=mu(f),N=Kt.forwardRef((w,b)=>{const{scope:C,children:A,...E}=w,R=Kt.useRef(null),V=za(b,R),P=o(f,C);return Kt.useEffect(()=>(P.itemMap.set(R,{ref:R,...E}),()=>void P.itemMap.delete(R))),t.jsx(g,{[p]:"",ref:V,children:A})});N.displayName=f;function y(w){const b=o(e+"CollectionConsumer",w);return Kt.useCallback(()=>{const A=b.collectionRef.current;if(!A)return[];const E=Array.from(A.querySelectorAll(`[${p}]`));return Array.from(b.itemMap.values()).sort((P,k)=>E.indexOf(P.ref.current)-E.indexOf(k.ref.current))},[b.collectionRef,b.itemMap])}return[{Provider:c,Slot:m,ItemSlot:N},y,a]}var lC=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],es=lC.reduce((e,r)=>{const s=mu(`Primitive.${r}`),a=T.forwardRef((n,o)=>{const{asChild:c,...d}=n,h=c?s:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),t.jsx(h,{...d,ref:o})});return a.displayName=`Primitive.${r}`,{...e,[r]:a}},{});function NN(e,r){e&&ff.flushSync(()=>e.dispatchEvent(r))}function mi(e){const r=T.useRef(e);return T.useEffect(()=>{r.current=e}),T.useMemo(()=>(...s)=>r.current?.(...s),[])}function oC(e,r=globalThis?.document){const s=mi(e);T.useEffect(()=>{const a=n=>{n.key==="Escape"&&s(n)};return r.addEventListener("keydown",a,{capture:!0}),()=>r.removeEventListener("keydown",a,{capture:!0})},[s,r])}var cC="DismissableLayer",_m="dismissableLayer.update",dC="dismissableLayer.pointerDownOutside",uC="dismissableLayer.focusOutside",wv,wN=T.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),bN=T.forwardRef((e,r)=>{const{disableOutsidePointerEvents:s=!1,onEscapeKeyDown:a,onPointerDownOutside:n,onFocusOutside:o,onInteractOutside:c,onDismiss:d,...h}=e,m=T.useContext(wN),[f,p]=T.useState(null),g=f?.ownerDocument??globalThis?.document,[,N]=T.useState({}),y=za(r,k=>p(k)),w=Array.from(m.layers),[b]=[...m.layersWithOutsidePointerEventsDisabled].slice(-1),C=w.indexOf(b),A=f?w.indexOf(f):-1,E=m.layersWithOutsidePointerEventsDisabled.size>0,R=A>=C,V=mC(k=>{const z=k.target,W=[...m.branches].some(te=>te.contains(z));!R||W||(n?.(k),c?.(k),k.defaultPrevented||d?.())},g),P=fC(k=>{const z=k.target;[...m.branches].some(te=>te.contains(z))||(o?.(k),c?.(k),k.defaultPrevented||d?.())},g);return oC(k=>{A===m.layers.size-1&&(a?.(k),!k.defaultPrevented&&d&&(k.preventDefault(),d()))},g),T.useEffect(()=>{if(f)return s&&(m.layersWithOutsidePointerEventsDisabled.size===0&&(wv=g.body.style.pointerEvents,g.body.style.pointerEvents="none"),m.layersWithOutsidePointerEventsDisabled.add(f)),m.layers.add(f),bv(),()=>{s&&m.layersWithOutsidePointerEventsDisabled.size===1&&(g.body.style.pointerEvents=wv)}},[f,g,s,m]),T.useEffect(()=>()=>{f&&(m.layers.delete(f),m.layersWithOutsidePointerEventsDisabled.delete(f),bv())},[f,m]),T.useEffect(()=>{const k=()=>N({});return document.addEventListener(_m,k),()=>document.removeEventListener(_m,k)},[]),t.jsx(es.div,{...h,ref:y,style:{pointerEvents:E?R?"auto":"none":void 0,...e.style},onFocusCapture:Or(e.onFocusCapture,P.onFocusCapture),onBlurCapture:Or(e.onBlurCapture,P.onBlurCapture),onPointerDownCapture:Or(e.onPointerDownCapture,V.onPointerDownCapture)})});bN.displayName=cC;var hC="DismissableLayerBranch",jN=T.forwardRef((e,r)=>{const s=T.useContext(wN),a=T.useRef(null),n=za(r,a);return T.useEffect(()=>{const o=a.current;if(o)return s.branches.add(o),()=>{s.branches.delete(o)}},[s.branches]),t.jsx(es.div,{...e,ref:n})});jN.displayName=hC;function mC(e,r=globalThis?.document){const s=mi(e),a=T.useRef(!1),n=T.useRef(()=>{});return T.useEffect(()=>{const o=d=>{if(d.target&&!a.current){let h=function(){EN(dC,s,m,{discrete:!0})};const m={originalEvent:d};d.pointerType==="touch"?(r.removeEventListener("click",n.current),n.current=h,r.addEventListener("click",n.current,{once:!0})):h()}else r.removeEventListener("click",n.current);a.current=!1},c=window.setTimeout(()=>{r.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(c),r.removeEventListener("pointerdown",o),r.removeEventListener("click",n.current)}},[r,s]),{onPointerDownCapture:()=>a.current=!0}}function fC(e,r=globalThis?.document){const s=mi(e),a=T.useRef(!1);return T.useEffect(()=>{const n=o=>{o.target&&!a.current&&EN(uC,s,{originalEvent:o},{discrete:!1})};return r.addEventListener("focusin",n),()=>r.removeEventListener("focusin",n)},[r,s]),{onFocusCapture:()=>a.current=!0,onBlurCapture:()=>a.current=!1}}function bv(){const e=new CustomEvent(_m);document.dispatchEvent(e)}function EN(e,r,s,{discrete:a}){const n=s.originalEvent.target,o=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:s});r&&n.addEventListener(e,r,{once:!0}),a?NN(n,o):n.dispatchEvent(o)}var xC=bN,pC=jN,Yi=globalThis?.document?T.useLayoutEffect:()=>{},gC="Portal",TN=T.forwardRef((e,r)=>{const{container:s,...a}=e,[n,o]=T.useState(!1);Yi(()=>o(!0),[]);const c=s||n&&globalThis?.document?.body;return c?KT.createPortal(t.jsx(es.div,{...a,ref:r}),c):null});TN.displayName=gC;function vC(e,r){return T.useReducer((s,a)=>r[s][a]??s,e)}var Lu=e=>{const{present:r,children:s}=e,a=yC(r),n=typeof s=="function"?s({present:a.isPresent}):T.Children.only(s),o=za(a.ref,NC(n));return typeof s=="function"||a.isPresent?T.cloneElement(n,{ref:o}):null};Lu.displayName="Presence";function yC(e){const[r,s]=T.useState(),a=T.useRef(null),n=T.useRef(e),o=T.useRef("none"),c=e?"mounted":"unmounted",[d,h]=vC(c,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return T.useEffect(()=>{const m=Kd(a.current);o.current=d==="mounted"?m:"none"},[d]),Yi(()=>{const m=a.current,f=n.current;if(f!==e){const g=o.current,N=Kd(m);e?h("MOUNT"):N==="none"||m?.display==="none"?h("UNMOUNT"):h(f&&g!==N?"ANIMATION_OUT":"UNMOUNT"),n.current=e}},[e,h]),Yi(()=>{if(r){let m;const f=r.ownerDocument.defaultView??window,p=N=>{const w=Kd(a.current).includes(CSS.escape(N.animationName));if(N.target===r&&w&&(h("ANIMATION_END"),!n.current)){const b=r.style.animationFillMode;r.style.animationFillMode="forwards",m=f.setTimeout(()=>{r.style.animationFillMode==="forwards"&&(r.style.animationFillMode=b)})}},g=N=>{N.target===r&&(o.current=Kd(a.current))};return r.addEventListener("animationstart",g),r.addEventListener("animationcancel",p),r.addEventListener("animationend",p),()=>{f.clearTimeout(m),r.removeEventListener("animationstart",g),r.removeEventListener("animationcancel",p),r.removeEventListener("animationend",p)}}else h("ANIMATION_END")},[r,h]),{isPresent:["mounted","unmountSuspended"].includes(d),ref:T.useCallback(m=>{a.current=m?getComputedStyle(m):null,s(m)},[])}}function Kd(e){return e?.animationName||"none"}function NC(e){let r=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,s=r&&"isReactWarning"in r&&r.isReactWarning;return s?e.ref:(r=Object.getOwnPropertyDescriptor(e,"ref")?.get,s=r&&"isReactWarning"in r&&r.isReactWarning,s?e.props.ref:e.props.ref||e.ref)}var wC=mf[" useInsertionEffect ".trim().toString()]||Yi;function Bu({prop:e,defaultProp:r,onChange:s=()=>{},caller:a}){const[n,o,c]=bC({defaultProp:r,onChange:s}),d=e!==void 0,h=d?e:n;{const f=T.useRef(e!==void 0);T.useEffect(()=>{const p=f.current;p!==d&&console.warn(`${a} is changing from ${p?"controlled":"uncontrolled"} to ${d?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),f.current=d},[d,a])}const m=T.useCallback(f=>{if(d){const p=jC(f)?f(e):f;p!==e&&c.current?.(p)}else o(f)},[d,e,o,c]);return[h,m]}function bC({defaultProp:e,onChange:r}){const[s,a]=T.useState(e),n=T.useRef(s),o=T.useRef(r);return wC(()=>{o.current=r},[r]),T.useEffect(()=>{n.current!==s&&(o.current?.(s),n.current=s)},[s,n]),[s,a,o]}function jC(e){return typeof e=="function"}var EC=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),TC="VisuallyHidden",gf=T.forwardRef((e,r)=>t.jsx(es.span,{...e,ref:r,style:{...EC,...e.style}}));gf.displayName=TC;var vf="ToastProvider",[yf,SC,AC]=yN("Toast"),[SN,M5]=Ql("Toast",[AC]),[CC,Hu]=SN(vf),AN=e=>{const{__scopeToast:r,label:s="Notification",duration:a=5e3,swipeDirection:n="right",swipeThreshold:o=50,children:c}=e,[d,h]=T.useState(null),[m,f]=T.useState(0),p=T.useRef(!1),g=T.useRef(!1);return s.trim()||console.error(`Invalid prop \`label\` supplied to \`${vf}\`. Expected non-empty \`string\`.`),t.jsx(yf.Provider,{scope:r,children:t.jsx(CC,{scope:r,label:s,duration:a,swipeDirection:n,swipeThreshold:o,toastCount:m,viewport:d,onViewportChange:h,onToastAdd:T.useCallback(()=>f(N=>N+1),[]),onToastRemove:T.useCallback(()=>f(N=>N-1),[]),isFocusedToastEscapeKeyDownRef:p,isClosePausedRef:g,children:c})})};AN.displayName=vf;var CN="ToastViewport",kC=["F8"],Dm="toast.viewportPause",Om="toast.viewportResume",kN=T.forwardRef((e,r)=>{const{__scopeToast:s,hotkey:a=kC,label:n="Notifications ({hotkey})",...o}=e,c=Hu(CN,s),d=SC(s),h=T.useRef(null),m=T.useRef(null),f=T.useRef(null),p=T.useRef(null),g=za(r,p,c.onViewportChange),N=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),y=c.toastCount>0;T.useEffect(()=>{const b=C=>{a.length!==0&&a.every(E=>C[E]||C.code===E)&&p.current?.focus()};return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[a]),T.useEffect(()=>{const b=h.current,C=p.current;if(y&&b&&C){const A=()=>{if(!c.isClosePausedRef.current){const P=new CustomEvent(Dm);C.dispatchEvent(P),c.isClosePausedRef.current=!0}},E=()=>{if(c.isClosePausedRef.current){const P=new CustomEvent(Om);C.dispatchEvent(P),c.isClosePausedRef.current=!1}},R=P=>{!b.contains(P.relatedTarget)&&E()},V=()=>{b.contains(document.activeElement)||E()};return b.addEventListener("focusin",A),b.addEventListener("focusout",R),b.addEventListener("pointermove",A),b.addEventListener("pointerleave",V),window.addEventListener("blur",A),window.addEventListener("focus",E),()=>{b.removeEventListener("focusin",A),b.removeEventListener("focusout",R),b.removeEventListener("pointermove",A),b.removeEventListener("pointerleave",V),window.removeEventListener("blur",A),window.removeEventListener("focus",E)}}},[y,c.isClosePausedRef]);const w=T.useCallback(({tabbingDirection:b})=>{const A=d().map(E=>{const R=E.ref.current,V=[R,...UC(R)];return b==="forwards"?V:V.reverse()});return(b==="forwards"?A.reverse():A).flat()},[d]);return T.useEffect(()=>{const b=p.current;if(b){const C=A=>{const E=A.altKey||A.ctrlKey||A.metaKey;if(A.key==="Tab"&&!E){const V=document.activeElement,P=A.shiftKey;if(A.target===b&&P){m.current?.focus();return}const W=w({tabbingDirection:P?"backwards":"forwards"}),te=W.findIndex(de=>de===V);Xh(W.slice(te+1))?A.preventDefault():P?m.current?.focus():f.current?.focus()}};return b.addEventListener("keydown",C),()=>b.removeEventListener("keydown",C)}},[d,w]),t.jsxs(pC,{ref:h,role:"region","aria-label":n.replace("{hotkey}",N),tabIndex:-1,style:{pointerEvents:y?void 0:"none"},children:[y&&t.jsx(Fm,{ref:m,onFocusFromOutsideViewport:()=>{const b=w({tabbingDirection:"forwards"});Xh(b)}}),t.jsx(yf.Slot,{scope:s,children:t.jsx(es.ol,{tabIndex:-1,...o,ref:g})}),y&&t.jsx(Fm,{ref:f,onFocusFromOutsideViewport:()=>{const b=w({tabbingDirection:"backwards"});Xh(b)}})]})});kN.displayName=CN;var PN="ToastFocusProxy",Fm=T.forwardRef((e,r)=>{const{__scopeToast:s,onFocusFromOutsideViewport:a,...n}=e,o=Hu(PN,s);return t.jsx(gf,{tabIndex:0,...n,ref:r,style:{position:"fixed"},onFocus:c=>{const d=c.relatedTarget;!o.viewport?.contains(d)&&a()}})});Fm.displayName=PN;var kc="Toast",PC="toast.swipeStart",RC="toast.swipeMove",_C="toast.swipeCancel",DC="toast.swipeEnd",RN=T.forwardRef((e,r)=>{const{forceMount:s,open:a,defaultOpen:n,onOpenChange:o,...c}=e,[d,h]=Bu({prop:a,defaultProp:n??!0,onChange:o,caller:kc});return t.jsx(Lu,{present:s||d,children:t.jsx(IC,{open:d,...c,ref:r,onClose:()=>h(!1),onPause:mi(e.onPause),onResume:mi(e.onResume),onSwipeStart:Or(e.onSwipeStart,m=>{m.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Or(e.onSwipeMove,m=>{const{x:f,y:p}=m.detail.delta;m.currentTarget.setAttribute("data-swipe","move"),m.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${f}px`),m.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${p}px`)}),onSwipeCancel:Or(e.onSwipeCancel,m=>{m.currentTarget.setAttribute("data-swipe","cancel"),m.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),m.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),m.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),m.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Or(e.onSwipeEnd,m=>{const{x:f,y:p}=m.detail.delta;m.currentTarget.setAttribute("data-swipe","end"),m.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),m.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),m.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${f}px`),m.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${p}px`),h(!1)})})})});RN.displayName=kc;var[OC,FC]=SN(kc,{onClose(){}}),IC=T.forwardRef((e,r)=>{const{__scopeToast:s,type:a="foreground",duration:n,open:o,onClose:c,onEscapeKeyDown:d,onPause:h,onResume:m,onSwipeStart:f,onSwipeMove:p,onSwipeCancel:g,onSwipeEnd:N,...y}=e,w=Hu(kc,s),[b,C]=T.useState(null),A=za(r,I=>C(I)),E=T.useRef(null),R=T.useRef(null),V=n||w.duration,P=T.useRef(0),k=T.useRef(V),z=T.useRef(0),{onToastAdd:W,onToastRemove:te}=w,de=mi(()=>{b?.contains(document.activeElement)&&w.viewport?.focus(),c()}),H=T.useCallback(I=>{!I||I===1/0||(window.clearTimeout(z.current),P.current=new Date().getTime(),z.current=window.setTimeout(de,I))},[de]);T.useEffect(()=>{const I=w.viewport;if(I){const X=()=>{H(k.current),m?.()},oe=()=>{const xe=new Date().getTime()-P.current;k.current=k.current-xe,window.clearTimeout(z.current),h?.()};return I.addEventListener(Dm,oe),I.addEventListener(Om,X),()=>{I.removeEventListener(Dm,oe),I.removeEventListener(Om,X)}}},[w.viewport,V,h,m,H]),T.useEffect(()=>{o&&!w.isClosePausedRef.current&&H(V)},[o,V,w.isClosePausedRef,H]),T.useEffect(()=>(W(),()=>te()),[W,te]);const ue=T.useMemo(()=>b?LN(b):null,[b]);return w.viewport?t.jsxs(t.Fragment,{children:[ue&&t.jsx(MC,{__scopeToast:s,role:"status","aria-live":a==="foreground"?"assertive":"polite",children:ue}),t.jsx(OC,{scope:s,onClose:de,children:ff.createPortal(t.jsx(yf.ItemSlot,{scope:s,children:t.jsx(xC,{asChild:!0,onEscapeKeyDown:Or(d,()=>{w.isFocusedToastEscapeKeyDownRef.current||de(),w.isFocusedToastEscapeKeyDownRef.current=!1}),children:t.jsx(es.li,{tabIndex:0,"data-state":o?"open":"closed","data-swipe-direction":w.swipeDirection,...y,ref:A,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:Or(e.onKeyDown,I=>{I.key==="Escape"&&(d?.(I.nativeEvent),I.nativeEvent.defaultPrevented||(w.isFocusedToastEscapeKeyDownRef.current=!0,de()))}),onPointerDown:Or(e.onPointerDown,I=>{I.button===0&&(E.current={x:I.clientX,y:I.clientY})}),onPointerMove:Or(e.onPointerMove,I=>{if(!E.current)return;const X=I.clientX-E.current.x,oe=I.clientY-E.current.y,xe=!!R.current,he=["left","right"].includes(w.swipeDirection),F=["left","up"].includes(w.swipeDirection)?Math.min:Math.max,ee=he?F(0,X):0,M=he?0:F(0,oe),_=I.pointerType==="touch"?10:2,ne={x:ee,y:M},ae={originalEvent:I,delta:ne};xe?(R.current=ne,Xd(RC,p,ae,{discrete:!1})):jv(ne,w.swipeDirection,_)?(R.current=ne,Xd(PC,f,ae,{discrete:!1}),I.target.setPointerCapture(I.pointerId)):(Math.abs(X)>_||Math.abs(oe)>_)&&(E.current=null)}),onPointerUp:Or(e.onPointerUp,I=>{const X=R.current,oe=I.target;if(oe.hasPointerCapture(I.pointerId)&&oe.releasePointerCapture(I.pointerId),R.current=null,E.current=null,X){const xe=I.currentTarget,he={originalEvent:I,delta:X};jv(X,w.swipeDirection,w.swipeThreshold)?Xd(DC,N,he,{discrete:!0}):Xd(_C,g,he,{discrete:!0}),xe.addEventListener("click",F=>F.preventDefault(),{once:!0})}})})})}),w.viewport)})]}):null}),MC=e=>{const{__scopeToast:r,children:s,...a}=e,n=Hu(kc,r),[o,c]=T.useState(!1),[d,h]=T.useState(!1);return HC(()=>c(!0)),T.useEffect(()=>{const m=window.setTimeout(()=>h(!0),1e3);return()=>window.clearTimeout(m)},[]),d?null:t.jsx(TN,{asChild:!0,children:t.jsx(gf,{...a,children:o&&t.jsxs(t.Fragment,{children:[n.label," ",s]})})})},LC="ToastTitle",_N=T.forwardRef((e,r)=>{const{__scopeToast:s,...a}=e;return t.jsx(es.div,{...a,ref:r})});_N.displayName=LC;var BC="ToastDescription",DN=T.forwardRef((e,r)=>{const{__scopeToast:s,...a}=e;return t.jsx(es.div,{...a,ref:r})});DN.displayName=BC;var ON="ToastAction",FN=T.forwardRef((e,r)=>{const{altText:s,...a}=e;return s.trim()?t.jsx(MN,{altText:s,asChild:!0,children:t.jsx(Nf,{...a,ref:r})}):(console.error(`Invalid prop \`altText\` supplied to \`${ON}\`. Expected non-empty \`string\`.`),null)});FN.displayName=ON;var IN="ToastClose",Nf=T.forwardRef((e,r)=>{const{__scopeToast:s,...a}=e,n=FC(IN,s);return t.jsx(MN,{asChild:!0,children:t.jsx(es.button,{type:"button",...a,ref:r,onClick:Or(e.onClick,n.onClose)})})});Nf.displayName=IN;var MN=T.forwardRef((e,r)=>{const{__scopeToast:s,altText:a,...n}=e;return t.jsx(es.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":a||void 0,...n,ref:r})});function LN(e){const r=[];return Array.from(e.childNodes).forEach(a=>{if(a.nodeType===a.TEXT_NODE&&a.textContent&&r.push(a.textContent),VC(a)){const n=a.ariaHidden||a.hidden||a.style.display==="none",o=a.dataset.radixToastAnnounceExclude==="";if(!n)if(o){const c=a.dataset.radixToastAnnounceAlt;c&&r.push(c)}else r.push(...LN(a))}}),r}function Xd(e,r,s,{discrete:a}){const n=s.originalEvent.currentTarget,o=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:s});r&&n.addEventListener(e,r,{once:!0}),a?NN(n,o):n.dispatchEvent(o)}var jv=(e,r,s=0)=>{const a=Math.abs(e.x),n=Math.abs(e.y),o=a>n;return r==="left"||r==="right"?o&&a>s:!o&&n>s};function HC(e=()=>{}){const r=mi(e);Yi(()=>{let s=0,a=0;return s=window.requestAnimationFrame(()=>a=window.requestAnimationFrame(r)),()=>{window.cancelAnimationFrame(s),window.cancelAnimationFrame(a)}},[r])}function VC(e){return e.nodeType===e.ELEMENT_NODE}function UC(e){const r=[],s=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:a=>{const n=a.tagName==="INPUT"&&a.type==="hidden";return a.disabled||a.hidden||n?NodeFilter.FILTER_SKIP:a.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;s.nextNode();)r.push(s.currentNode);return r}function Xh(e){const r=document.activeElement;return e.some(s=>s===r?!0:(s.focus(),document.activeElement!==r))}var $C=AN,BN=kN,HN=RN,VN=_N,UN=DN,$N=FN,GN=Nf;const Ev=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,Tv=hN,Vu=(e,r)=>s=>{var a;if(r?.variants==null)return Tv(e,s?.class,s?.className);const{variants:n,defaultVariants:o}=r,c=Object.keys(n).map(m=>{const f=s?.[m],p=o?.[m];if(f===null)return null;const g=Ev(f)||Ev(p);return n[m][g]}),d=s&&Object.entries(s).reduce((m,f)=>{let[p,g]=f;return g===void 0||(m[p]=g),m},{}),h=r==null||(a=r.compoundVariants)===null||a===void 0?void 0:a.reduce((m,f)=>{let{class:p,className:g,...N}=f;return Object.entries(N).every(y=>{let[w,b]=y;return Array.isArray(b)?b.includes({...o,...d}[w]):{...o,...d}[w]===b})?[...m,p,g]:m},[]);return Tv(e,c,h,s?.class,s?.className)};var GC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const WC=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),gt=(e,r)=>{const s=T.forwardRef(({color:a="currentColor",size:n=24,strokeWidth:o=2,absoluteStrokeWidth:c,children:d,...h},m)=>T.createElement("svg",{ref:m,...GC,width:n,height:n,stroke:a,strokeWidth:c?Number(o)*24/Number(n):o,className:`lucide lucide-${WC(e)}`,...h},[...r.map(([f,p])=>T.createElement(f,p)),...(Array.isArray(d)?d:[d])||[]]));return s.displayName=`${e}`,s},Sr=gt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),WN=gt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),qs=gt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),zC=gt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),KC=gt("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),fu=gt("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),Sv=gt("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),wf=gt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),zN=gt("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),tn=gt("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),XC=gt("CameraOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16",key:"qmtpty"}],["path",{d:"M9.5 4h5L17 7h3a2 2 0 0 1 2 2v7.5",key:"1ufyfc"}],["path",{d:"M14.121 15.121A3 3 0 1 1 9.88 10.88",key:"11zox6"}]]),qh=gt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),dr=gt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),qC=gt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Av=gt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),YC=gt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),KN=gt("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]),Cv=gt("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]),Ka=gt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),JC=gt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),An=gt("IndianRupee",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),Vi=gt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),ni=gt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),fc=gt("Factory",[["path",{d:"M2 20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8l-7 5V8l-7 5V4a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"159hny"}],["path",{d:"M17 18h1",key:"uldtlt"}],["path",{d:"M12 18h1",key:"s9uhes"}],["path",{d:"M7 18h1",key:"1neino"}]]),Ga=gt("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),QC=gt("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]),kv=gt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),Pv=gt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),Rv=gt("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),xu=gt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),Im=gt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),_v=gt("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Ks=gt("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),Dv=gt("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]),zi=gt("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),ZC=gt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),qd=gt("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),Mm=gt("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),ri=gt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Cr=gt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),bf=gt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),fi=gt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),ek=gt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),yn=gt("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),di=gt("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),Il=gt("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]),Yo=gt("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Yh=gt("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5h0c-1.4 0-2.5-1.1-2.5-2.5V2",key:"187lwq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]),Lm=gt("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]),jf=gt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),tk=gt("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),Cn=gt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),rn=gt("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]),rk=gt("Undo2",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5v0a5.5 5.5 0 0 1-5.5 5.5H11",key:"llx8ln"}]]),sk=gt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),$o=gt("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),pu=gt("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),Bm=gt("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),Nn=gt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Nr=gt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),XN=gt("Warehouse",[["path",{d:"M22 8.35V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8.35A2 2 0 0 1 3.26 6.5l8-3.2a2 2 0 0 1 1.48 0l8 3.2A2 2 0 0 1 22 8.35Z",key:"gksnxg"}],["path",{d:"M6 18h12",key:"9pbo8z"}],["path",{d:"M6 14h12",key:"4cwo0f"}],["rect",{width:"12",height:"12",x:"6",y:"10",key:"apd30q"}]]),Jo=gt("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]),en=gt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Ef=gt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ak=gt("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),nk=$C,qN=Kt.forwardRef(({className:e,...r},s)=>t.jsx(BN,{ref:s,className:Pr("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...r}));qN.displayName=BN.displayName;const ik=Vu("data-[swipe=move]:transition-none group relative pointer-events-auto flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full data-[state=closed]:slide-out-to-right-full",{variants:{variant:{default:"bg-background border",destructive:"group destructive border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),YN=Kt.forwardRef(({className:e,variant:r,...s},a)=>t.jsx(HN,{ref:a,className:Pr(ik({variant:r}),e),...s}));YN.displayName=HN.displayName;const lk=Kt.forwardRef(({className:e,...r},s)=>t.jsx($N,{ref:s,className:Pr("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-destructive/30 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...r}));lk.displayName=$N.displayName;const JN=Kt.forwardRef(({className:e,...r},s)=>t.jsx(GN,{ref:s,className:Pr("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...r,children:t.jsx(Ef,{className:"h-4 w-4"})}));JN.displayName=GN.displayName;const QN=Kt.forwardRef(({className:e,...r},s)=>t.jsx(VN,{ref:s,className:Pr("text-sm font-semibold",e),...r}));QN.displayName=VN.displayName;const ZN=Kt.forwardRef(({className:e,...r},s)=>t.jsx(UN,{ref:s,className:Pr("text-sm opacity-90",e),...r}));ZN.displayName=UN.displayName;const ok=1;let Jh=0;function ck(){return Jh=(Jh+1)%Number.MAX_VALUE,Jh.toString()}const Us={state:{toasts:[]},listeners:[],getState:()=>Us.state,setState:e=>{typeof e=="function"?Us.state=e(Us.state):Us.state={...Us.state,...e},Us.listeners.forEach(r=>r(Us.state))},subscribe:e=>(Us.listeners.push(e),()=>{Us.listeners=Us.listeners.filter(r=>r!==e)})},dt=({...e})=>{const r=ck(),s=n=>Us.setState(o=>({...o,toasts:o.toasts.map(c=>c.id===r?{...c,...n}:c)})),a=()=>Us.setState(n=>({...n,toasts:n.toasts.filter(o=>o.id!==r)}));return Us.setState(n=>({...n,toasts:[{...e,id:r,dismiss:a},...n.toasts].slice(0,ok)})),{id:r,dismiss:a,update:s}};function Ni(){const[e,r]=T.useState(Us.getState());return T.useEffect(()=>Us.subscribe(a=>{r(a)}),[]),T.useEffect(()=>{const s=[];return e.toasts.forEach(a=>{if(a.duration===1/0)return;const n=setTimeout(()=>{a.dismiss()},a.duration||5e3);s.push(n)}),()=>{s.forEach(a=>clearTimeout(a))}},[e.toasts]),{toast:dt,toasts:e.toasts}}function dk(){const{toasts:e}=Ni();return t.jsxs(nk,{children:[e.map(({id:r,title:s,description:a,action:n,dismiss:o,...c})=>t.jsxs(YN,{...c,children:[t.jsxs("div",{className:"grid gap-1",children:[s&&t.jsx(QN,{children:s}),a&&t.jsx(ZN,{children:a})]}),n,t.jsx(JN,{})]},r)),t.jsx(qN,{})]})}const ew=T.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),Uu=T.createContext({}),Tf=T.createContext(null),$u=typeof document<"u",uk=$u?T.useLayoutEffect:T.useEffect,tw=T.createContext({strict:!1}),Sf=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),hk="framerAppearId",rw="data-"+Sf(hk);function mk(e,r,s,a){const{visualElement:n}=T.useContext(Uu),o=T.useContext(tw),c=T.useContext(Tf),d=T.useContext(ew).reducedMotion,h=T.useRef();a=a||o.renderer,!h.current&&a&&(h.current=a(e,{visualState:r,parent:n,props:s,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:d}));const m=h.current;T.useInsertionEffect(()=>{m&&m.update(s,c)});const f=T.useRef(!!(s[rw]&&!window.HandoffComplete));return uk(()=>{m&&(m.render(),f.current&&m.animationState&&m.animationState.animateChanges())}),T.useEffect(()=>{m&&(m.updateFeatures(),!f.current&&m.animationState&&m.animationState.animateChanges(),f.current&&(f.current=!1,window.HandoffComplete=!0))}),m}function Ml(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function fk(e,r,s){return T.useCallback(a=>{a&&e.mount&&e.mount(a),r&&(a?r.mount(a):r.unmount()),s&&(typeof s=="function"?s(a):Ml(s)&&(s.current=a))},[r])}function xc(e){return typeof e=="string"||Array.isArray(e)}function Gu(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const Af=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Cf=["initial",...Af];function Wu(e){return Gu(e.animate)||Cf.some(r=>xc(e[r]))}function sw(e){return!!(Wu(e)||e.variants)}function xk(e,r){if(Wu(e)){const{initial:s,animate:a}=e;return{initial:s===!1||xc(s)?s:void 0,animate:xc(a)?a:void 0}}return e.inherit!==!1?r:{}}function pk(e){const{initial:r,animate:s}=xk(e,T.useContext(Uu));return T.useMemo(()=>({initial:r,animate:s}),[Ov(r),Ov(s)])}function Ov(e){return Array.isArray(e)?e.join(" "):e}const Fv={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},pc={};for(const e in Fv)pc[e]={isEnabled:r=>Fv[e].some(s=>!!r[s])};function gk(e){for(const r in e)pc[r]={...pc[r],...e[r]}}const aw=T.createContext({}),nw=T.createContext({}),vk=Symbol.for("motionComponentSymbol");function yk({preloadedFeatures:e,createVisualElement:r,useRender:s,useVisualState:a,Component:n}){e&&gk(e);function o(d,h){let m;const f={...T.useContext(ew),...d,layoutId:Nk(d)},{isStatic:p}=f,g=pk(d),N=a(d,p);if(!p&&$u){g.visualElement=mk(n,N,f,r);const y=T.useContext(nw),w=T.useContext(tw).strict;g.visualElement&&(m=g.visualElement.loadFeatures(f,w,e,y))}return T.createElement(Uu.Provider,{value:g},m&&g.visualElement?T.createElement(m,{visualElement:g.visualElement,...f}):null,s(n,d,fk(N,g.visualElement,h),N,p,g.visualElement))}const c=T.forwardRef(o);return c[vk]=n,c}function Nk({layoutId:e}){const r=T.useContext(aw).id;return r&&e!==void 0?r+"-"+e:e}function wk(e){function r(a,n={}){return yk(e(a,n))}if(typeof Proxy>"u")return r;const s=new Map;return new Proxy(r,{get:(a,n)=>(s.has(n)||s.set(n,r(n)),s.get(n))})}const bk=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function kf(e){return typeof e!="string"||e.includes("-")?!1:!!(bk.indexOf(e)>-1||/[A-Z]/.test(e))}const gu={};function jk(e){Object.assign(gu,e)}const Pc=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],rl=new Set(Pc);function iw(e,{layout:r,layoutId:s}){return rl.has(e)||e.startsWith("origin")||(r||s!==void 0)&&(!!gu[e]||e==="opacity")}const ia=e=>!!(e&&e.getVelocity),Ek={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Tk=Pc.length;function Sk(e,{enableHardwareAcceleration:r=!0,allowTransformNone:s=!0},a,n){let o="";for(let c=0;c<Tk;c++){const d=Pc[c];if(e[d]!==void 0){const h=Ek[d]||d;o+=`${h}(${e[d]}) `}}return r&&!e.z&&(o+="translateZ(0)"),o=o.trim(),n?o=n(e,a?"":o):s&&a&&(o="none"),o}const lw=e=>r=>typeof r=="string"&&r.startsWith(e),ow=lw("--"),Hm=lw("var(--"),Ak=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,Ck=(e,r)=>r&&typeof e=="number"?r.transform(e):e,xi=(e,r,s)=>Math.min(Math.max(s,e),r),sl={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Qo={...sl,transform:e=>xi(0,1,e)},Yd={...sl,default:1},Zo=e=>Math.round(e*1e5)/1e5,zu=/(-)?([\d]*\.?[\d])+/g,cw=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,kk=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Rc(e){return typeof e=="string"}const _c=e=>({test:r=>Rc(r)&&r.endsWith(e)&&r.split(" ").length===1,parse:parseFloat,transform:r=>`${r}${e}`}),ti=_c("deg"),sn=_c("%"),It=_c("px"),Pk=_c("vh"),Rk=_c("vw"),Iv={...sn,parse:e=>sn.parse(e)/100,transform:e=>sn.transform(e*100)},Mv={...sl,transform:Math.round},dw={borderWidth:It,borderTopWidth:It,borderRightWidth:It,borderBottomWidth:It,borderLeftWidth:It,borderRadius:It,radius:It,borderTopLeftRadius:It,borderTopRightRadius:It,borderBottomRightRadius:It,borderBottomLeftRadius:It,width:It,maxWidth:It,height:It,maxHeight:It,size:It,top:It,right:It,bottom:It,left:It,padding:It,paddingTop:It,paddingRight:It,paddingBottom:It,paddingLeft:It,margin:It,marginTop:It,marginRight:It,marginBottom:It,marginLeft:It,rotate:ti,rotateX:ti,rotateY:ti,rotateZ:ti,scale:Yd,scaleX:Yd,scaleY:Yd,scaleZ:Yd,skew:ti,skewX:ti,skewY:ti,distance:It,translateX:It,translateY:It,translateZ:It,x:It,y:It,z:It,perspective:It,transformPerspective:It,opacity:Qo,originX:Iv,originY:Iv,originZ:It,zIndex:Mv,fillOpacity:Qo,strokeOpacity:Qo,numOctaves:Mv};function Pf(e,r,s,a){const{style:n,vars:o,transform:c,transformOrigin:d}=e;let h=!1,m=!1,f=!0;for(const p in r){const g=r[p];if(ow(p)){o[p]=g;continue}const N=dw[p],y=Ck(g,N);if(rl.has(p)){if(h=!0,c[p]=y,!f)continue;g!==(N.default||0)&&(f=!1)}else p.startsWith("origin")?(m=!0,d[p]=y):n[p]=y}if(r.transform||(h||a?n.transform=Sk(e.transform,s,f,a):n.transform&&(n.transform="none")),m){const{originX:p="50%",originY:g="50%",originZ:N=0}=d;n.transformOrigin=`${p} ${g} ${N}`}}const Rf=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function uw(e,r,s){for(const a in r)!ia(r[a])&&!iw(a,s)&&(e[a]=r[a])}function _k({transformTemplate:e},r,s){return T.useMemo(()=>{const a=Rf();return Pf(a,r,{enableHardwareAcceleration:!s},e),Object.assign({},a.vars,a.style)},[r])}function Dk(e,r,s){const a=e.style||{},n={};return uw(n,a,e),Object.assign(n,_k(e,r,s)),e.transformValues?e.transformValues(n):n}function Ok(e,r,s){const a={},n=Dk(e,r,s);return e.drag&&e.dragListener!==!1&&(a.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(a.tabIndex=0),a.style=n,a}const Fk=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function vu(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||Fk.has(e)}let hw=e=>!vu(e);function Ik(e){e&&(hw=r=>r.startsWith("on")?!vu(r):e(r))}try{Ik(require("@emotion/is-prop-valid").default)}catch{}function Mk(e,r,s){const a={};for(const n in e)n==="values"&&typeof e.values=="object"||(hw(n)||s===!0&&vu(n)||!r&&!vu(n)||e.draggable&&n.startsWith("onDrag"))&&(a[n]=e[n]);return a}function Lv(e,r,s){return typeof e=="string"?e:It.transform(r+s*e)}function Lk(e,r,s){const a=Lv(r,e.x,e.width),n=Lv(s,e.y,e.height);return`${a} ${n}`}const Bk={offset:"stroke-dashoffset",array:"stroke-dasharray"},Hk={offset:"strokeDashoffset",array:"strokeDasharray"};function Vk(e,r,s=1,a=0,n=!0){e.pathLength=1;const o=n?Bk:Hk;e[o.offset]=It.transform(-a);const c=It.transform(r),d=It.transform(s);e[o.array]=`${c} ${d}`}function _f(e,{attrX:r,attrY:s,attrScale:a,originX:n,originY:o,pathLength:c,pathSpacing:d=1,pathOffset:h=0,...m},f,p,g){if(Pf(e,m,f,g),p){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:N,style:y,dimensions:w}=e;N.transform&&(w&&(y.transform=N.transform),delete N.transform),w&&(n!==void 0||o!==void 0||y.transform)&&(y.transformOrigin=Lk(w,n!==void 0?n:.5,o!==void 0?o:.5)),r!==void 0&&(N.x=r),s!==void 0&&(N.y=s),a!==void 0&&(N.scale=a),c!==void 0&&Vk(N,c,d,h,!1)}const mw=()=>({...Rf(),attrs:{}}),Df=e=>typeof e=="string"&&e.toLowerCase()==="svg";function Uk(e,r,s,a){const n=T.useMemo(()=>{const o=mw();return _f(o,r,{enableHardwareAcceleration:!1},Df(a),e.transformTemplate),{...o.attrs,style:{...o.style}}},[r]);if(e.style){const o={};uw(o,e.style,e),n.style={...o,...n.style}}return n}function $k(e=!1){return(s,a,n,{latestValues:o},c)=>{const h=(kf(s)?Uk:Ok)(a,o,c,s),f={...Mk(a,typeof s=="string",e),...h,ref:n},{children:p}=a,g=T.useMemo(()=>ia(p)?p.get():p,[p]);return T.createElement(s,{...f,children:g})}}function fw(e,{style:r,vars:s},a,n){Object.assign(e.style,r,n&&n.getProjectionStyles(a));for(const o in s)e.style.setProperty(o,s[o])}const xw=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function pw(e,r,s,a){fw(e,r,void 0,a);for(const n in r.attrs)e.setAttribute(xw.has(n)?n:Sf(n),r.attrs[n])}function Of(e,r){const{style:s}=e,a={};for(const n in s)(ia(s[n])||r.style&&ia(r.style[n])||iw(n,e))&&(a[n]=s[n]);return a}function gw(e,r){const s=Of(e,r);for(const a in e)if(ia(e[a])||ia(r[a])){const n=Pc.indexOf(a)!==-1?"attr"+a.charAt(0).toUpperCase()+a.substring(1):a;s[n]=e[a]}return s}function Ff(e,r,s,a={},n={}){return typeof r=="function"&&(r=r(s!==void 0?s:e.custom,a,n)),typeof r=="string"&&(r=e.variants&&e.variants[r]),typeof r=="function"&&(r=r(s!==void 0?s:e.custom,a,n)),r}function Gk(e){const r=T.useRef(null);return r.current===null&&(r.current=e()),r.current}const yu=e=>Array.isArray(e),Wk=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),zk=e=>yu(e)?e[e.length-1]||0:e;function du(e){const r=ia(e)?e.get():e;return Wk(r)?r.toValue():r}function Kk({scrapeMotionValuesFromProps:e,createRenderState:r,onMount:s},a,n,o){const c={latestValues:Xk(a,n,o,e),renderState:r()};return s&&(c.mount=d=>s(a,d,c)),c}const vw=e=>(r,s)=>{const a=T.useContext(Uu),n=T.useContext(Tf),o=()=>Kk(e,r,a,n);return s?o():Gk(o)};function Xk(e,r,s,a){const n={},o=a(e,{});for(const g in o)n[g]=du(o[g]);let{initial:c,animate:d}=e;const h=Wu(e),m=sw(e);r&&m&&!h&&e.inherit!==!1&&(c===void 0&&(c=r.initial),d===void 0&&(d=r.animate));let f=s?s.initial===!1:!1;f=f||c===!1;const p=f?d:c;return p&&typeof p!="boolean"&&!Gu(p)&&(Array.isArray(p)?p:[p]).forEach(N=>{const y=Ff(e,N);if(!y)return;const{transitionEnd:w,transition:b,...C}=y;for(const A in C){let E=C[A];if(Array.isArray(E)){const R=f?E.length-1:0;E=E[R]}E!==null&&(n[A]=E)}for(const A in w)n[A]=w[A]}),n}const Zr=e=>e;class Bv{constructor(){this.order=[],this.scheduled=new Set}add(r){if(!this.scheduled.has(r))return this.scheduled.add(r),this.order.push(r),!0}remove(r){const s=this.order.indexOf(r);s!==-1&&(this.order.splice(s,1),this.scheduled.delete(r))}clear(){this.order.length=0,this.scheduled.clear()}}function qk(e){let r=new Bv,s=new Bv,a=0,n=!1,o=!1;const c=new WeakSet,d={schedule:(h,m=!1,f=!1)=>{const p=f&&n,g=p?r:s;return m&&c.add(h),g.add(h)&&p&&n&&(a=r.order.length),h},cancel:h=>{s.remove(h),c.delete(h)},process:h=>{if(n){o=!0;return}if(n=!0,[r,s]=[s,r],s.clear(),a=r.order.length,a)for(let m=0;m<a;m++){const f=r.order[m];f(h),c.has(f)&&(d.schedule(f),e())}n=!1,o&&(o=!1,d.process(h))}};return d}const Jd=["prepare","read","update","preRender","render","postRender"],Yk=40;function Jk(e,r){let s=!1,a=!0;const n={delta:0,timestamp:0,isProcessing:!1},o=Jd.reduce((p,g)=>(p[g]=qk(()=>s=!0),p),{}),c=p=>o[p].process(n),d=()=>{const p=performance.now();s=!1,n.delta=a?1e3/60:Math.max(Math.min(p-n.timestamp,Yk),1),n.timestamp=p,n.isProcessing=!0,Jd.forEach(c),n.isProcessing=!1,s&&r&&(a=!1,e(d))},h=()=>{s=!0,a=!0,n.isProcessing||e(d)};return{schedule:Jd.reduce((p,g)=>{const N=o[g];return p[g]=(y,w=!1,b=!1)=>(s||h(),N.schedule(y,w,b)),p},{}),cancel:p=>Jd.forEach(g=>o[g].cancel(p)),state:n,steps:o}}const{schedule:Fr,cancel:kn,state:_s,steps:Qh}=Jk(typeof requestAnimationFrame<"u"?requestAnimationFrame:Zr,!0),Qk={useVisualState:vw({scrapeMotionValuesFromProps:gw,createRenderState:mw,onMount:(e,r,{renderState:s,latestValues:a})=>{Fr.read(()=>{try{s.dimensions=typeof r.getBBox=="function"?r.getBBox():r.getBoundingClientRect()}catch{s.dimensions={x:0,y:0,width:0,height:0}}}),Fr.render(()=>{_f(s,a,{enableHardwareAcceleration:!1},Df(r.tagName),e.transformTemplate),pw(r,s)})}})},Zk={useVisualState:vw({scrapeMotionValuesFromProps:Of,createRenderState:Rf})};function e4(e,{forwardMotionProps:r=!1},s,a){return{...kf(e)?Qk:Zk,preloadedFeatures:s,useRender:$k(r),createVisualElement:a,Component:e}}function wn(e,r,s,a={passive:!0}){return e.addEventListener(r,s,a),()=>e.removeEventListener(r,s)}const yw=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function Ku(e,r="page"){return{point:{x:e[r+"X"],y:e[r+"Y"]}}}const t4=e=>r=>yw(r)&&e(r,Ku(r));function jn(e,r,s,a){return wn(e,r,t4(s),a)}const r4=(e,r)=>s=>r(e(s)),ui=(...e)=>e.reduce(r4);function Nw(e){let r=null;return()=>{const s=()=>{r=null};return r===null?(r=e,s):!1}}const Hv=Nw("dragHorizontal"),Vv=Nw("dragVertical");function ww(e){let r=!1;if(e==="y")r=Vv();else if(e==="x")r=Hv();else{const s=Hv(),a=Vv();s&&a?r=()=>{s(),a()}:(s&&s(),a&&a())}return r}function bw(){const e=ww(!0);return e?(e(),!1):!0}class wi{constructor(r){this.isMounted=!1,this.node=r}update(){}}function Uv(e,r){const s="pointer"+(r?"enter":"leave"),a="onHover"+(r?"Start":"End"),n=(o,c)=>{if(o.pointerType==="touch"||bw())return;const d=e.getProps();e.animationState&&d.whileHover&&e.animationState.setActive("whileHover",r),d[a]&&Fr.update(()=>d[a](o,c))};return jn(e.current,s,n,{passive:!e.getProps()[a]})}class s4 extends wi{mount(){this.unmount=ui(Uv(this.node,!0),Uv(this.node,!1))}unmount(){}}class a4 extends wi{constructor(){super(...arguments),this.isActive=!1}onFocus(){let r=!1;try{r=this.node.current.matches(":focus-visible")}catch{r=!0}!r||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=ui(wn(this.node.current,"focus",()=>this.onFocus()),wn(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const jw=(e,r)=>r?e===r?!0:jw(e,r.parentElement):!1;function Zh(e,r){if(!r)return;const s=new PointerEvent("pointer"+e);r(s,Ku(s))}class n4 extends wi{constructor(){super(...arguments),this.removeStartListeners=Zr,this.removeEndListeners=Zr,this.removeAccessibleListeners=Zr,this.startPointerPress=(r,s)=>{if(this.isPressing)return;this.removeEndListeners();const a=this.node.getProps(),o=jn(window,"pointerup",(d,h)=>{if(!this.checkPressEnd())return;const{onTap:m,onTapCancel:f,globalTapTarget:p}=this.node.getProps();Fr.update(()=>{!p&&!jw(this.node.current,d.target)?f&&f(d,h):m&&m(d,h)})},{passive:!(a.onTap||a.onPointerUp)}),c=jn(window,"pointercancel",(d,h)=>this.cancelPress(d,h),{passive:!(a.onTapCancel||a.onPointerCancel)});this.removeEndListeners=ui(o,c),this.startPress(r,s)},this.startAccessiblePress=()=>{const r=o=>{if(o.key!=="Enter"||this.isPressing)return;const c=d=>{d.key!=="Enter"||!this.checkPressEnd()||Zh("up",(h,m)=>{const{onTap:f}=this.node.getProps();f&&Fr.update(()=>f(h,m))})};this.removeEndListeners(),this.removeEndListeners=wn(this.node.current,"keyup",c),Zh("down",(d,h)=>{this.startPress(d,h)})},s=wn(this.node.current,"keydown",r),a=()=>{this.isPressing&&Zh("cancel",(o,c)=>this.cancelPress(o,c))},n=wn(this.node.current,"blur",a);this.removeAccessibleListeners=ui(s,n)}}startPress(r,s){this.isPressing=!0;const{onTapStart:a,whileTap:n}=this.node.getProps();n&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),a&&Fr.update(()=>a(r,s))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!bw()}cancelPress(r,s){if(!this.checkPressEnd())return;const{onTapCancel:a}=this.node.getProps();a&&Fr.update(()=>a(r,s))}mount(){const r=this.node.getProps(),s=jn(r.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(r.onTapStart||r.onPointerStart)}),a=wn(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=ui(s,a)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const Vm=new WeakMap,em=new WeakMap,i4=e=>{const r=Vm.get(e.target);r&&r(e)},l4=e=>{e.forEach(i4)};function o4({root:e,...r}){const s=e||document;em.has(s)||em.set(s,{});const a=em.get(s),n=JSON.stringify(r);return a[n]||(a[n]=new IntersectionObserver(l4,{root:e,...r})),a[n]}function c4(e,r,s){const a=o4(r);return Vm.set(e,s),a.observe(e),()=>{Vm.delete(e),a.unobserve(e)}}const d4={some:0,all:1};class u4 extends wi{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:r={}}=this.node.getProps(),{root:s,margin:a,amount:n="some",once:o}=r,c={root:s?s.current:void 0,rootMargin:a,threshold:typeof n=="number"?n:d4[n]},d=h=>{const{isIntersecting:m}=h;if(this.isInView===m||(this.isInView=m,o&&!m&&this.hasEnteredView))return;m&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",m);const{onViewportEnter:f,onViewportLeave:p}=this.node.getProps(),g=m?f:p;g&&g(h)};return c4(this.node.current,c,d)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:r,prevProps:s}=this.node;["amount","margin","root"].some(h4(r,s))&&this.startObserver()}unmount(){}}function h4({viewport:e={}},{viewport:r={}}={}){return s=>e[s]!==r[s]}const m4={inView:{Feature:u4},tap:{Feature:n4},focus:{Feature:a4},hover:{Feature:s4}};function Ew(e,r){if(!Array.isArray(r))return!1;const s=r.length;if(s!==e.length)return!1;for(let a=0;a<s;a++)if(r[a]!==e[a])return!1;return!0}function f4(e){const r={};return e.values.forEach((s,a)=>r[a]=s.get()),r}function x4(e){const r={};return e.values.forEach((s,a)=>r[a]=s.getVelocity()),r}function Xu(e,r,s){const a=e.getProps();return Ff(a,r,s!==void 0?s:a.custom,f4(e),x4(e))}let If=Zr;const Ki=e=>e*1e3,En=e=>e/1e3,p4={current:!1},Tw=e=>Array.isArray(e)&&typeof e[0]=="number";function Sw(e){return!!(!e||typeof e=="string"&&Aw[e]||Tw(e)||Array.isArray(e)&&e.every(Sw))}const Go=([e,r,s,a])=>`cubic-bezier(${e}, ${r}, ${s}, ${a})`,Aw={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Go([0,.65,.55,1]),circOut:Go([.55,0,1,.45]),backIn:Go([.31,.01,.66,-.59]),backOut:Go([.33,1.53,.69,.99])};function Cw(e){if(e)return Tw(e)?Go(e):Array.isArray(e)?e.map(Cw):Aw[e]}function g4(e,r,s,{delay:a=0,duration:n,repeat:o=0,repeatType:c="loop",ease:d,times:h}={}){const m={[r]:s};h&&(m.offset=h);const f=Cw(d);return Array.isArray(f)&&(m.easing=f),e.animate(m,{delay:a,duration:n,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:o+1,direction:c==="reverse"?"alternate":"normal"})}function v4(e,{repeat:r,repeatType:s="loop"}){const a=r&&s!=="loop"&&r%2===1?0:e.length-1;return e[a]}const kw=(e,r,s)=>(((1-3*s+3*r)*e+(3*s-6*r))*e+3*r)*e,y4=1e-7,N4=12;function w4(e,r,s,a,n){let o,c,d=0;do c=r+(s-r)/2,o=kw(c,a,n)-e,o>0?s=c:r=c;while(Math.abs(o)>y4&&++d<N4);return c}function Dc(e,r,s,a){if(e===r&&s===a)return Zr;const n=o=>w4(o,0,1,e,s);return o=>o===0||o===1?o:kw(n(o),r,a)}const b4=Dc(.42,0,1,1),j4=Dc(0,0,.58,1),Pw=Dc(.42,0,.58,1),E4=e=>Array.isArray(e)&&typeof e[0]!="number",Rw=e=>r=>r<=.5?e(2*r)/2:(2-e(2*(1-r)))/2,_w=e=>r=>1-e(1-r),Mf=e=>1-Math.sin(Math.acos(e)),Dw=_w(Mf),T4=Rw(Mf),Ow=Dc(.33,1.53,.69,.99),Lf=_w(Ow),S4=Rw(Lf),A4=e=>(e*=2)<1?.5*Lf(e):.5*(2-Math.pow(2,-10*(e-1))),C4={linear:Zr,easeIn:b4,easeInOut:Pw,easeOut:j4,circIn:Mf,circInOut:T4,circOut:Dw,backIn:Lf,backInOut:S4,backOut:Ow,anticipate:A4},$v=e=>{if(Array.isArray(e)){If(e.length===4);const[r,s,a,n]=e;return Dc(r,s,a,n)}else if(typeof e=="string")return C4[e];return e},Bf=(e,r)=>s=>!!(Rc(s)&&kk.test(s)&&s.startsWith(e)||r&&Object.prototype.hasOwnProperty.call(s,r)),Fw=(e,r,s)=>a=>{if(!Rc(a))return a;const[n,o,c,d]=a.match(zu);return{[e]:parseFloat(n),[r]:parseFloat(o),[s]:parseFloat(c),alpha:d!==void 0?parseFloat(d):1}},k4=e=>xi(0,255,e),tm={...sl,transform:e=>Math.round(k4(e))},Ui={test:Bf("rgb","red"),parse:Fw("red","green","blue"),transform:({red:e,green:r,blue:s,alpha:a=1})=>"rgba("+tm.transform(e)+", "+tm.transform(r)+", "+tm.transform(s)+", "+Zo(Qo.transform(a))+")"};function P4(e){let r="",s="",a="",n="";return e.length>5?(r=e.substring(1,3),s=e.substring(3,5),a=e.substring(5,7),n=e.substring(7,9)):(r=e.substring(1,2),s=e.substring(2,3),a=e.substring(3,4),n=e.substring(4,5),r+=r,s+=s,a+=a,n+=n),{red:parseInt(r,16),green:parseInt(s,16),blue:parseInt(a,16),alpha:n?parseInt(n,16)/255:1}}const Um={test:Bf("#"),parse:P4,transform:Ui.transform},Ll={test:Bf("hsl","hue"),parse:Fw("hue","saturation","lightness"),transform:({hue:e,saturation:r,lightness:s,alpha:a=1})=>"hsla("+Math.round(e)+", "+sn.transform(Zo(r))+", "+sn.transform(Zo(s))+", "+Zo(Qo.transform(a))+")"},$s={test:e=>Ui.test(e)||Um.test(e)||Ll.test(e),parse:e=>Ui.test(e)?Ui.parse(e):Ll.test(e)?Ll.parse(e):Um.parse(e),transform:e=>Rc(e)?e:e.hasOwnProperty("red")?Ui.transform(e):Ll.transform(e)},Ur=(e,r,s)=>-s*e+s*r+e;function rm(e,r,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?e+(r-e)*6*s:s<1/2?r:s<2/3?e+(r-e)*(2/3-s)*6:e}function R4({hue:e,saturation:r,lightness:s,alpha:a}){e/=360,r/=100,s/=100;let n=0,o=0,c=0;if(!r)n=o=c=s;else{const d=s<.5?s*(1+r):s+r-s*r,h=2*s-d;n=rm(h,d,e+1/3),o=rm(h,d,e),c=rm(h,d,e-1/3)}return{red:Math.round(n*255),green:Math.round(o*255),blue:Math.round(c*255),alpha:a}}const sm=(e,r,s)=>{const a=e*e;return Math.sqrt(Math.max(0,s*(r*r-a)+a))},_4=[Um,Ui,Ll],D4=e=>_4.find(r=>r.test(e));function Gv(e){const r=D4(e);let s=r.parse(e);return r===Ll&&(s=R4(s)),s}const Iw=(e,r)=>{const s=Gv(e),a=Gv(r),n={...s};return o=>(n.red=sm(s.red,a.red,o),n.green=sm(s.green,a.green,o),n.blue=sm(s.blue,a.blue,o),n.alpha=Ur(s.alpha,a.alpha,o),Ui.transform(n))};function O4(e){var r,s;return isNaN(e)&&Rc(e)&&(((r=e.match(zu))===null||r===void 0?void 0:r.length)||0)+(((s=e.match(cw))===null||s===void 0?void 0:s.length)||0)>0}const Mw={regex:Ak,countKey:"Vars",token:"${v}",parse:Zr},Lw={regex:cw,countKey:"Colors",token:"${c}",parse:$s.parse},Bw={regex:zu,countKey:"Numbers",token:"${n}",parse:sl.parse};function am(e,{regex:r,countKey:s,token:a,parse:n}){const o=e.tokenised.match(r);o&&(e["num"+s]=o.length,e.tokenised=e.tokenised.replace(r,a),e.values.push(...o.map(n)))}function Nu(e){const r=e.toString(),s={value:r,tokenised:r,values:[],numVars:0,numColors:0,numNumbers:0};return s.value.includes("var(--")&&am(s,Mw),am(s,Lw),am(s,Bw),s}function Hw(e){return Nu(e).values}function Vw(e){const{values:r,numColors:s,numVars:a,tokenised:n}=Nu(e),o=r.length;return c=>{let d=n;for(let h=0;h<o;h++)h<a?d=d.replace(Mw.token,c[h]):h<a+s?d=d.replace(Lw.token,$s.transform(c[h])):d=d.replace(Bw.token,Zo(c[h]));return d}}const F4=e=>typeof e=="number"?0:e;function I4(e){const r=Hw(e);return Vw(e)(r.map(F4))}const pi={test:O4,parse:Hw,createTransformer:Vw,getAnimatableNone:I4},Uw=(e,r)=>s=>`${s>0?r:e}`;function $w(e,r){return typeof e=="number"?s=>Ur(e,r,s):$s.test(e)?Iw(e,r):e.startsWith("var(")?Uw(e,r):Ww(e,r)}const Gw=(e,r)=>{const s=[...e],a=s.length,n=e.map((o,c)=>$w(o,r[c]));return o=>{for(let c=0;c<a;c++)s[c]=n[c](o);return s}},M4=(e,r)=>{const s={...e,...r},a={};for(const n in s)e[n]!==void 0&&r[n]!==void 0&&(a[n]=$w(e[n],r[n]));return n=>{for(const o in a)s[o]=a[o](n);return s}},Ww=(e,r)=>{const s=pi.createTransformer(r),a=Nu(e),n=Nu(r);return a.numVars===n.numVars&&a.numColors===n.numColors&&a.numNumbers>=n.numNumbers?ui(Gw(a.values,n.values),s):Uw(e,r)},gc=(e,r,s)=>{const a=r-e;return a===0?1:(s-e)/a},Wv=(e,r)=>s=>Ur(e,r,s);function L4(e){return typeof e=="number"?Wv:typeof e=="string"?$s.test(e)?Iw:Ww:Array.isArray(e)?Gw:typeof e=="object"?M4:Wv}function B4(e,r,s){const a=[],n=s||L4(e[0]),o=e.length-1;for(let c=0;c<o;c++){let d=n(e[c],e[c+1]);if(r){const h=Array.isArray(r)?r[c]||Zr:r;d=ui(h,d)}a.push(d)}return a}function zw(e,r,{clamp:s=!0,ease:a,mixer:n}={}){const o=e.length;if(If(o===r.length),o===1)return()=>r[0];e[0]>e[o-1]&&(e=[...e].reverse(),r=[...r].reverse());const c=B4(r,a,n),d=c.length,h=m=>{let f=0;if(d>1)for(;f<e.length-2&&!(m<e[f+1]);f++);const p=gc(e[f],e[f+1],m);return c[f](p)};return s?m=>h(xi(e[0],e[o-1],m)):h}function H4(e,r){const s=e[e.length-1];for(let a=1;a<=r;a++){const n=gc(0,r,a);e.push(Ur(s,1,n))}}function V4(e){const r=[0];return H4(r,e.length-1),r}function U4(e,r){return e.map(s=>s*r)}function $4(e,r){return e.map(()=>r||Pw).splice(0,e.length-1)}function wu({duration:e=300,keyframes:r,times:s,ease:a="easeInOut"}){const n=E4(a)?a.map($v):$v(a),o={done:!1,value:r[0]},c=U4(s&&s.length===r.length?s:V4(r),e),d=zw(c,r,{ease:Array.isArray(n)?n:$4(r,n)});return{calculatedDuration:e,next:h=>(o.value=d(h),o.done=h>=e,o)}}function Kw(e,r){return r?e*(1e3/r):0}const G4=5;function Xw(e,r,s){const a=Math.max(r-G4,0);return Kw(s-e(a),r-a)}const nm=.001,W4=.01,z4=10,K4=.05,X4=1;function q4({duration:e=800,bounce:r=.25,velocity:s=0,mass:a=1}){let n,o,c=1-r;c=xi(K4,X4,c),e=xi(W4,z4,En(e)),c<1?(n=m=>{const f=m*c,p=f*e,g=f-s,N=$m(m,c),y=Math.exp(-p);return nm-g/N*y},o=m=>{const p=m*c*e,g=p*s+s,N=Math.pow(c,2)*Math.pow(m,2)*e,y=Math.exp(-p),w=$m(Math.pow(m,2),c);return(-n(m)+nm>0?-1:1)*((g-N)*y)/w}):(n=m=>{const f=Math.exp(-m*e),p=(m-s)*e+1;return-nm+f*p},o=m=>{const f=Math.exp(-m*e),p=(s-m)*(e*e);return f*p});const d=5/e,h=J4(n,o,d);if(e=Ki(e),isNaN(h))return{stiffness:100,damping:10,duration:e};{const m=Math.pow(h,2)*a;return{stiffness:m,damping:c*2*Math.sqrt(a*m),duration:e}}}const Y4=12;function J4(e,r,s){let a=s;for(let n=1;n<Y4;n++)a=a-e(a)/r(a);return a}function $m(e,r){return e*Math.sqrt(1-r*r)}const Q4=["duration","bounce"],Z4=["stiffness","damping","mass"];function zv(e,r){return r.some(s=>e[s]!==void 0)}function eP(e){let r={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!zv(e,Z4)&&zv(e,Q4)){const s=q4(e);r={...r,...s,mass:1},r.isResolvedFromDuration=!0}return r}function qw({keyframes:e,restDelta:r,restSpeed:s,...a}){const n=e[0],o=e[e.length-1],c={done:!1,value:n},{stiffness:d,damping:h,mass:m,duration:f,velocity:p,isResolvedFromDuration:g}=eP({...a,velocity:-En(a.velocity||0)}),N=p||0,y=h/(2*Math.sqrt(d*m)),w=o-n,b=En(Math.sqrt(d/m)),C=Math.abs(w)<5;s||(s=C?.01:2),r||(r=C?.005:.5);let A;if(y<1){const E=$m(b,y);A=R=>{const V=Math.exp(-y*b*R);return o-V*((N+y*b*w)/E*Math.sin(E*R)+w*Math.cos(E*R))}}else if(y===1)A=E=>o-Math.exp(-b*E)*(w+(N+b*w)*E);else{const E=b*Math.sqrt(y*y-1);A=R=>{const V=Math.exp(-y*b*R),P=Math.min(E*R,300);return o-V*((N+y*b*w)*Math.sinh(P)+E*w*Math.cosh(P))/E}}return{calculatedDuration:g&&f||null,next:E=>{const R=A(E);if(g)c.done=E>=f;else{let V=N;E!==0&&(y<1?V=Xw(A,E,R):V=0);const P=Math.abs(V)<=s,k=Math.abs(o-R)<=r;c.done=P&&k}return c.value=c.done?o:R,c}}}function Kv({keyframes:e,velocity:r=0,power:s=.8,timeConstant:a=325,bounceDamping:n=10,bounceStiffness:o=500,modifyTarget:c,min:d,max:h,restDelta:m=.5,restSpeed:f}){const p=e[0],g={done:!1,value:p},N=z=>d!==void 0&&z<d||h!==void 0&&z>h,y=z=>d===void 0?h:h===void 0||Math.abs(d-z)<Math.abs(h-z)?d:h;let w=s*r;const b=p+w,C=c===void 0?b:c(b);C!==b&&(w=C-p);const A=z=>-w*Math.exp(-z/a),E=z=>C+A(z),R=z=>{const W=A(z),te=E(z);g.done=Math.abs(W)<=m,g.value=g.done?C:te};let V,P;const k=z=>{N(g.value)&&(V=z,P=qw({keyframes:[g.value,y(g.value)],velocity:Xw(E,z,g.value),damping:n,stiffness:o,restDelta:m,restSpeed:f}))};return k(0),{calculatedDuration:null,next:z=>{let W=!1;return!P&&V===void 0&&(W=!0,R(z),k(z)),V!==void 0&&z>V?P.next(z-V):(!W&&R(z),g)}}}const tP=e=>{const r=({timestamp:s})=>e(s);return{start:()=>Fr.update(r,!0),stop:()=>kn(r),now:()=>_s.isProcessing?_s.timestamp:performance.now()}},Xv=2e4;function qv(e){let r=0;const s=50;let a=e.next(r);for(;!a.done&&r<Xv;)r+=s,a=e.next(r);return r>=Xv?1/0:r}const rP={decay:Kv,inertia:Kv,tween:wu,keyframes:wu,spring:qw};function bu({autoplay:e=!0,delay:r=0,driver:s=tP,keyframes:a,type:n="keyframes",repeat:o=0,repeatDelay:c=0,repeatType:d="loop",onPlay:h,onStop:m,onComplete:f,onUpdate:p,...g}){let N=1,y=!1,w,b;const C=()=>{b=new Promise(M=>{w=M})};C();let A;const E=rP[n]||wu;let R;E!==wu&&typeof a[0]!="number"&&(R=zw([0,100],a,{clamp:!1}),a=[0,100]);const V=E({...g,keyframes:a});let P;d==="mirror"&&(P=E({...g,keyframes:[...a].reverse(),velocity:-(g.velocity||0)}));let k="idle",z=null,W=null,te=null;V.calculatedDuration===null&&o&&(V.calculatedDuration=qv(V));const{calculatedDuration:de}=V;let H=1/0,ue=1/0;de!==null&&(H=de+c,ue=H*(o+1)-c);let I=0;const X=M=>{if(W===null)return;N>0&&(W=Math.min(W,M)),N<0&&(W=Math.min(M-ue/N,W)),z!==null?I=z:I=Math.round(M-W)*N;const _=I-r*(N>=0?1:-1),ne=N>=0?_<0:_>ue;I=Math.max(_,0),k==="finished"&&z===null&&(I=ue);let ae=I,G=V;if(o){const ye=Math.min(I,ue)/H;let je=Math.floor(ye),We=ye%1;!We&&ye>=1&&(We=1),We===1&&je--,je=Math.min(je,o+1),!!(je%2)&&(d==="reverse"?(We=1-We,c&&(We-=c/H)):d==="mirror"&&(G=P)),ae=xi(0,1,We)*H}const ie=ne?{done:!1,value:a[0]}:G.next(ae);R&&(ie.value=R(ie.value));let{done:Me}=ie;!ne&&de!==null&&(Me=N>=0?I>=ue:I<=0);const Ee=z===null&&(k==="finished"||k==="running"&&Me);return p&&p(ie.value),Ee&&he(),ie},oe=()=>{A&&A.stop(),A=void 0},xe=()=>{k="idle",oe(),w(),C(),W=te=null},he=()=>{k="finished",f&&f(),oe(),w()},F=()=>{if(y)return;A||(A=s(X));const M=A.now();h&&h(),z!==null?W=M-z:(!W||k==="finished")&&(W=M),k==="finished"&&C(),te=W,z=null,k="running",A.start()};e&&F();const ee={then(M,_){return b.then(M,_)},get time(){return En(I)},set time(M){M=Ki(M),I=M,z!==null||!A||N===0?z=M:W=A.now()-M/N},get duration(){const M=V.calculatedDuration===null?qv(V):V.calculatedDuration;return En(M)},get speed(){return N},set speed(M){M===N||!A||(N=M,ee.time=En(I))},get state(){return k},play:F,pause:()=>{k="paused",z=I},stop:()=>{y=!0,k!=="idle"&&(k="idle",m&&m(),xe())},cancel:()=>{te!==null&&X(te),xe()},complete:()=>{k="finished"},sample:M=>(W=0,X(M))};return ee}function sP(e){let r;return()=>(r===void 0&&(r=e()),r)}const aP=sP(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),nP=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),Qd=10,iP=2e4,lP=(e,r)=>r.type==="spring"||e==="backgroundColor"||!Sw(r.ease);function oP(e,r,{onUpdate:s,onComplete:a,...n}){if(!(aP()&&nP.has(r)&&!n.repeatDelay&&n.repeatType!=="mirror"&&n.damping!==0&&n.type!=="inertia"))return!1;let c=!1,d,h,m=!1;const f=()=>{h=new Promise(E=>{d=E})};f();let{keyframes:p,duration:g=300,ease:N,times:y}=n;if(lP(r,n)){const E=bu({...n,repeat:0,delay:0});let R={done:!1,value:p[0]};const V=[];let P=0;for(;!R.done&&P<iP;)R=E.sample(P),V.push(R.value),P+=Qd;y=void 0,p=V,g=P-Qd,N="linear"}const w=g4(e.owner.current,r,p,{...n,duration:g,ease:N,times:y}),b=()=>{m=!1,w.cancel()},C=()=>{m=!0,Fr.update(b),d(),f()};return w.onfinish=()=>{m||(e.set(v4(p,n)),a&&a(),C())},{then(E,R){return h.then(E,R)},attachTimeline(E){return w.timeline=E,w.onfinish=null,Zr},get time(){return En(w.currentTime||0)},set time(E){w.currentTime=Ki(E)},get speed(){return w.playbackRate},set speed(E){w.playbackRate=E},get duration(){return En(g)},play:()=>{c||(w.play(),kn(b))},pause:()=>w.pause(),stop:()=>{if(c=!0,w.playState==="idle")return;const{currentTime:E}=w;if(E){const R=bu({...n,autoplay:!1});e.setWithVelocity(R.sample(E-Qd).value,R.sample(E).value,Qd)}C()},complete:()=>{m||w.finish()},cancel:C}}function cP({keyframes:e,delay:r,onUpdate:s,onComplete:a}){const n=()=>(s&&s(e[e.length-1]),a&&a(),{time:0,speed:1,duration:0,play:Zr,pause:Zr,stop:Zr,then:o=>(o(),Promise.resolve()),cancel:Zr,complete:Zr});return r?bu({keyframes:[0,1],duration:0,delay:r,onComplete:n}):n()}const dP={type:"spring",stiffness:500,damping:25,restSpeed:10},uP=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),hP={type:"keyframes",duration:.8},mP={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},fP=(e,{keyframes:r})=>r.length>2?hP:rl.has(e)?e.startsWith("scale")?uP(r[1]):dP:mP,Gm=(e,r)=>e==="zIndex"?!1:!!(typeof r=="number"||Array.isArray(r)||typeof r=="string"&&(pi.test(r)||r==="0")&&!r.startsWith("url(")),xP=new Set(["brightness","contrast","saturate","opacity"]);function pP(e){const[r,s]=e.slice(0,-1).split("(");if(r==="drop-shadow")return e;const[a]=s.match(zu)||[];if(!a)return e;const n=s.replace(a,"");let o=xP.has(r)?1:0;return a!==s&&(o*=100),r+"("+o+n+")"}const gP=/([a-z-]*)\(.*?\)/g,Wm={...pi,getAnimatableNone:e=>{const r=e.match(gP);return r?r.map(pP).join(" "):e}},vP={...dw,color:$s,backgroundColor:$s,outlineColor:$s,fill:$s,stroke:$s,borderColor:$s,borderTopColor:$s,borderRightColor:$s,borderBottomColor:$s,borderLeftColor:$s,filter:Wm,WebkitFilter:Wm},Hf=e=>vP[e];function Yw(e,r){let s=Hf(e);return s!==Wm&&(s=pi),s.getAnimatableNone?s.getAnimatableNone(r):void 0}const Jw=e=>/^0[^.\s]+$/.test(e);function yP(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||Jw(e)}function NP(e,r,s,a){const n=Gm(r,s);let o;Array.isArray(s)?o=[...s]:o=[null,s];const c=a.from!==void 0?a.from:e.get();let d;const h=[];for(let m=0;m<o.length;m++)o[m]===null&&(o[m]=m===0?c:o[m-1]),yP(o[m])&&h.push(m),typeof o[m]=="string"&&o[m]!=="none"&&o[m]!=="0"&&(d=o[m]);if(n&&h.length&&d)for(let m=0;m<h.length;m++){const f=h[m];o[f]=Yw(r,d)}return o}function wP({when:e,delay:r,delayChildren:s,staggerChildren:a,staggerDirection:n,repeat:o,repeatType:c,repeatDelay:d,from:h,elapsed:m,...f}){return!!Object.keys(f).length}function Vf(e,r){return e[r]||e.default||e}const bP={skipAnimations:!1},Uf=(e,r,s,a={})=>n=>{const o=Vf(a,e)||{},c=o.delay||a.delay||0;let{elapsed:d=0}=a;d=d-Ki(c);const h=NP(r,e,s,o),m=h[0],f=h[h.length-1],p=Gm(e,m),g=Gm(e,f);let N={keyframes:h,velocity:r.getVelocity(),ease:"easeOut",...o,delay:-d,onUpdate:y=>{r.set(y),o.onUpdate&&o.onUpdate(y)},onComplete:()=>{n(),o.onComplete&&o.onComplete()}};if(wP(o)||(N={...N,...fP(e,N)}),N.duration&&(N.duration=Ki(N.duration)),N.repeatDelay&&(N.repeatDelay=Ki(N.repeatDelay)),!p||!g||p4.current||o.type===!1||bP.skipAnimations)return cP(N);if(!a.isHandoff&&r.owner&&r.owner.current instanceof HTMLElement&&!r.owner.getProps().onUpdate){const y=oP(r,e,N);if(y)return y}return bu(N)};function ju(e){return!!(ia(e)&&e.add)}const Qw=e=>/^\-?\d*\.?\d+$/.test(e);function $f(e,r){e.indexOf(r)===-1&&e.push(r)}function Gf(e,r){const s=e.indexOf(r);s>-1&&e.splice(s,1)}class Wf{constructor(){this.subscriptions=[]}add(r){return $f(this.subscriptions,r),()=>Gf(this.subscriptions,r)}notify(r,s,a){const n=this.subscriptions.length;if(n)if(n===1)this.subscriptions[0](r,s,a);else for(let o=0;o<n;o++){const c=this.subscriptions[o];c&&c(r,s,a)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const jP=e=>!isNaN(parseFloat(e));class EP{constructor(r,s={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(a,n=!0)=>{this.prev=this.current,this.current=a;const{delta:o,timestamp:c}=_s;this.lastUpdated!==c&&(this.timeDelta=o,this.lastUpdated=c,Fr.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),n&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>Fr.postRender(this.velocityCheck),this.velocityCheck=({timestamp:a})=>{a!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=r,this.canTrackVelocity=jP(this.current),this.owner=s.owner}onChange(r){return this.on("change",r)}on(r,s){this.events[r]||(this.events[r]=new Wf);const a=this.events[r].add(s);return r==="change"?()=>{a(),Fr.read(()=>{this.events.change.getSize()||this.stop()})}:a}clearListeners(){for(const r in this.events)this.events[r].clear()}attach(r,s){this.passiveEffect=r,this.stopPassiveEffect=s}set(r,s=!0){!s||!this.passiveEffect?this.updateAndNotify(r,s):this.passiveEffect(r,this.updateAndNotify)}setWithVelocity(r,s,a){this.set(s),this.prev=r,this.timeDelta=a}jump(r){this.updateAndNotify(r),this.prev=r,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?Kw(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(r){return this.stop(),new Promise(s=>{this.hasAnimated=!0,this.animation=r(s),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function zl(e,r){return new EP(e,r)}const Zw=e=>r=>r.test(e),TP={test:e=>e==="auto",parse:e=>e},eb=[sl,It,sn,ti,Rk,Pk,TP],Vo=e=>eb.find(Zw(e)),SP=[...eb,$s,pi],AP=e=>SP.find(Zw(e));function CP(e,r,s){e.hasValue(r)?e.getValue(r).set(s):e.addValue(r,zl(s))}function kP(e,r){const s=Xu(e,r);let{transitionEnd:a={},transition:n={},...o}=s?e.makeTargetAnimatable(s,!1):{};o={...o,...a};for(const c in o){const d=zk(o[c]);CP(e,c,d)}}function PP(e,r,s){var a,n;const o=Object.keys(r).filter(d=>!e.hasValue(d)),c=o.length;if(c)for(let d=0;d<c;d++){const h=o[d],m=r[h];let f=null;Array.isArray(m)&&(f=m[0]),f===null&&(f=(n=(a=s[h])!==null&&a!==void 0?a:e.readValue(h))!==null&&n!==void 0?n:r[h]),f!=null&&(typeof f=="string"&&(Qw(f)||Jw(f))?f=parseFloat(f):!AP(f)&&pi.test(m)&&(f=Yw(h,m)),e.addValue(h,zl(f,{owner:e})),s[h]===void 0&&(s[h]=f),f!==null&&e.setBaseTarget(h,f))}}function RP(e,r){return r?(r[e]||r.default||r).from:void 0}function _P(e,r,s){const a={};for(const n in e){const o=RP(n,r);if(o!==void 0)a[n]=o;else{const c=s.getValue(n);c&&(a[n]=c.get())}}return a}function DP({protectedKeys:e,needsAnimating:r},s){const a=e.hasOwnProperty(s)&&r[s]!==!0;return r[s]=!1,a}function OP(e,r){const s=e.get();if(Array.isArray(r)){for(let a=0;a<r.length;a++)if(r[a]!==s)return!0}else return s!==r}function tb(e,r,{delay:s=0,transitionOverride:a,type:n}={}){let{transition:o=e.getDefaultTransition(),transitionEnd:c,...d}=e.makeTargetAnimatable(r);const h=e.getValue("willChange");a&&(o=a);const m=[],f=n&&e.animationState&&e.animationState.getState()[n];for(const p in d){const g=e.getValue(p),N=d[p];if(!g||N===void 0||f&&DP(f,p))continue;const y={delay:s,elapsed:0,...Vf(o||{},p)};if(window.HandoffAppearAnimations){const C=e.getProps()[rw];if(C){const A=window.HandoffAppearAnimations(C,p,g,Fr);A!==null&&(y.elapsed=A,y.isHandoff=!0)}}let w=!y.isHandoff&&!OP(g,N);if(y.type==="spring"&&(g.getVelocity()||y.velocity)&&(w=!1),g.animation&&(w=!1),w)continue;g.start(Uf(p,g,N,e.shouldReduceMotion&&rl.has(p)?{type:!1}:y));const b=g.animation;ju(h)&&(h.add(p),b.then(()=>h.remove(p))),m.push(b)}return c&&Promise.all(m).then(()=>{c&&kP(e,c)}),m}function zm(e,r,s={}){const a=Xu(e,r,s.custom);let{transition:n=e.getDefaultTransition()||{}}=a||{};s.transitionOverride&&(n=s.transitionOverride);const o=a?()=>Promise.all(tb(e,a,s)):()=>Promise.resolve(),c=e.variantChildren&&e.variantChildren.size?(h=0)=>{const{delayChildren:m=0,staggerChildren:f,staggerDirection:p}=n;return FP(e,r,m+h,f,p,s)}:()=>Promise.resolve(),{when:d}=n;if(d){const[h,m]=d==="beforeChildren"?[o,c]:[c,o];return h().then(()=>m())}else return Promise.all([o(),c(s.delay)])}function FP(e,r,s=0,a=0,n=1,o){const c=[],d=(e.variantChildren.size-1)*a,h=n===1?(m=0)=>m*a:(m=0)=>d-m*a;return Array.from(e.variantChildren).sort(IP).forEach((m,f)=>{m.notify("AnimationStart",r),c.push(zm(m,r,{...o,delay:s+h(f)}).then(()=>m.notify("AnimationComplete",r)))}),Promise.all(c)}function IP(e,r){return e.sortNodePosition(r)}function MP(e,r,s={}){e.notify("AnimationStart",r);let a;if(Array.isArray(r)){const n=r.map(o=>zm(e,o,s));a=Promise.all(n)}else if(typeof r=="string")a=zm(e,r,s);else{const n=typeof r=="function"?Xu(e,r,s.custom):r;a=Promise.all(tb(e,n,s))}return a.then(()=>e.notify("AnimationComplete",r))}const LP=[...Af].reverse(),BP=Af.length;function HP(e){return r=>Promise.all(r.map(({animation:s,options:a})=>MP(e,s,a)))}function VP(e){let r=HP(e);const s=$P();let a=!0;const n=(h,m)=>{const f=Xu(e,m);if(f){const{transition:p,transitionEnd:g,...N}=f;h={...h,...N,...g}}return h};function o(h){r=h(e)}function c(h,m){const f=e.getProps(),p=e.getVariantContext(!0)||{},g=[],N=new Set;let y={},w=1/0;for(let C=0;C<BP;C++){const A=LP[C],E=s[A],R=f[A]!==void 0?f[A]:p[A],V=xc(R),P=A===m?E.isActive:null;P===!1&&(w=C);let k=R===p[A]&&R!==f[A]&&V;if(k&&a&&e.manuallyAnimateOnMount&&(k=!1),E.protectedKeys={...y},!E.isActive&&P===null||!R&&!E.prevProp||Gu(R)||typeof R=="boolean")continue;let W=UP(E.prevProp,R)||A===m&&E.isActive&&!k&&V||C>w&&V,te=!1;const de=Array.isArray(R)?R:[R];let H=de.reduce(n,{});P===!1&&(H={});const{prevResolvedValues:ue={}}=E,I={...ue,...H},X=oe=>{W=!0,N.has(oe)&&(te=!0,N.delete(oe)),E.needsAnimating[oe]=!0};for(const oe in I){const xe=H[oe],he=ue[oe];if(y.hasOwnProperty(oe))continue;let F=!1;yu(xe)&&yu(he)?F=!Ew(xe,he):F=xe!==he,F?xe!==void 0?X(oe):N.add(oe):xe!==void 0&&N.has(oe)?X(oe):E.protectedKeys[oe]=!0}E.prevProp=R,E.prevResolvedValues=H,E.isActive&&(y={...y,...H}),a&&e.blockInitialAnimation&&(W=!1),W&&(!k||te)&&g.push(...de.map(oe=>({animation:oe,options:{type:A,...h}})))}if(N.size){const C={};N.forEach(A=>{const E=e.getBaseTarget(A);E!==void 0&&(C[A]=E)}),g.push({animation:C})}let b=!!g.length;return a&&(f.initial===!1||f.initial===f.animate)&&!e.manuallyAnimateOnMount&&(b=!1),a=!1,b?r(g):Promise.resolve()}function d(h,m,f){var p;if(s[h].isActive===m)return Promise.resolve();(p=e.variantChildren)===null||p===void 0||p.forEach(N=>{var y;return(y=N.animationState)===null||y===void 0?void 0:y.setActive(h,m)}),s[h].isActive=m;const g=c(f,h);for(const N in s)s[N].protectedKeys={};return g}return{animateChanges:c,setActive:d,setAnimateFunction:o,getState:()=>s}}function UP(e,r){return typeof r=="string"?r!==e:Array.isArray(r)?!Ew(r,e):!1}function Ii(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function $P(){return{animate:Ii(!0),whileInView:Ii(),whileHover:Ii(),whileTap:Ii(),whileDrag:Ii(),whileFocus:Ii(),exit:Ii()}}class GP extends wi{constructor(r){super(r),r.animationState||(r.animationState=VP(r))}updateAnimationControlsSubscription(){const{animate:r}=this.node.getProps();this.unmount(),Gu(r)&&(this.unmount=r.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:r}=this.node.getProps(),{animate:s}=this.node.prevProps||{};r!==s&&this.updateAnimationControlsSubscription()}unmount(){}}let WP=0;class zP extends wi{constructor(){super(...arguments),this.id=WP++}update(){if(!this.node.presenceContext)return;const{isPresent:r,onExitComplete:s,custom:a}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||r===n)return;const o=this.node.animationState.setActive("exit",!r,{custom:a??this.node.getProps().custom});s&&!r&&o.then(()=>s(this.id))}mount(){const{register:r}=this.node.presenceContext||{};r&&(this.unmount=r(this.id))}unmount(){}}const KP={animation:{Feature:GP},exit:{Feature:zP}},Yv=(e,r)=>Math.abs(e-r);function XP(e,r){const s=Yv(e.x,r.x),a=Yv(e.y,r.y);return Math.sqrt(s**2+a**2)}class rb{constructor(r,s,{transformPagePoint:a,contextWindow:n,dragSnapToOrigin:o=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const p=lm(this.lastMoveEventInfo,this.history),g=this.startEvent!==null,N=XP(p.offset,{x:0,y:0})>=3;if(!g&&!N)return;const{point:y}=p,{timestamp:w}=_s;this.history.push({...y,timestamp:w});const{onStart:b,onMove:C}=this.handlers;g||(b&&b(this.lastMoveEvent,p),this.startEvent=this.lastMoveEvent),C&&C(this.lastMoveEvent,p)},this.handlePointerMove=(p,g)=>{this.lastMoveEvent=p,this.lastMoveEventInfo=im(g,this.transformPagePoint),Fr.update(this.updatePoint,!0)},this.handlePointerUp=(p,g)=>{this.end();const{onEnd:N,onSessionEnd:y,resumeAnimation:w}=this.handlers;if(this.dragSnapToOrigin&&w&&w(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const b=lm(p.type==="pointercancel"?this.lastMoveEventInfo:im(g,this.transformPagePoint),this.history);this.startEvent&&N&&N(p,b),y&&y(p,b)},!yw(r))return;this.dragSnapToOrigin=o,this.handlers=s,this.transformPagePoint=a,this.contextWindow=n||window;const c=Ku(r),d=im(c,this.transformPagePoint),{point:h}=d,{timestamp:m}=_s;this.history=[{...h,timestamp:m}];const{onSessionStart:f}=s;f&&f(r,lm(d,this.history)),this.removeListeners=ui(jn(this.contextWindow,"pointermove",this.handlePointerMove),jn(this.contextWindow,"pointerup",this.handlePointerUp),jn(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(r){this.handlers=r}end(){this.removeListeners&&this.removeListeners(),kn(this.updatePoint)}}function im(e,r){return r?{point:r(e.point)}:e}function Jv(e,r){return{x:e.x-r.x,y:e.y-r.y}}function lm({point:e},r){return{point:e,delta:Jv(e,sb(r)),offset:Jv(e,qP(r)),velocity:YP(r,.1)}}function qP(e){return e[0]}function sb(e){return e[e.length-1]}function YP(e,r){if(e.length<2)return{x:0,y:0};let s=e.length-1,a=null;const n=sb(e);for(;s>=0&&(a=e[s],!(n.timestamp-a.timestamp>Ki(r)));)s--;if(!a)return{x:0,y:0};const o=En(n.timestamp-a.timestamp);if(o===0)return{x:0,y:0};const c={x:(n.x-a.x)/o,y:(n.y-a.y)/o};return c.x===1/0&&(c.x=0),c.y===1/0&&(c.y=0),c}function fa(e){return e.max-e.min}function Km(e,r=0,s=.01){return Math.abs(e-r)<=s}function Qv(e,r,s,a=.5){e.origin=a,e.originPoint=Ur(r.min,r.max,e.origin),e.scale=fa(s)/fa(r),(Km(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=Ur(s.min,s.max,e.origin)-e.originPoint,(Km(e.translate)||isNaN(e.translate))&&(e.translate=0)}function ec(e,r,s,a){Qv(e.x,r.x,s.x,a?a.originX:void 0),Qv(e.y,r.y,s.y,a?a.originY:void 0)}function Zv(e,r,s){e.min=s.min+r.min,e.max=e.min+fa(r)}function JP(e,r,s){Zv(e.x,r.x,s.x),Zv(e.y,r.y,s.y)}function ey(e,r,s){e.min=r.min-s.min,e.max=e.min+fa(r)}function tc(e,r,s){ey(e.x,r.x,s.x),ey(e.y,r.y,s.y)}function QP(e,{min:r,max:s},a){return r!==void 0&&e<r?e=a?Ur(r,e,a.min):Math.max(e,r):s!==void 0&&e>s&&(e=a?Ur(s,e,a.max):Math.min(e,s)),e}function ty(e,r,s){return{min:r!==void 0?e.min+r:void 0,max:s!==void 0?e.max+s-(e.max-e.min):void 0}}function ZP(e,{top:r,left:s,bottom:a,right:n}){return{x:ty(e.x,s,n),y:ty(e.y,r,a)}}function ry(e,r){let s=r.min-e.min,a=r.max-e.max;return r.max-r.min<e.max-e.min&&([s,a]=[a,s]),{min:s,max:a}}function eR(e,r){return{x:ry(e.x,r.x),y:ry(e.y,r.y)}}function tR(e,r){let s=.5;const a=fa(e),n=fa(r);return n>a?s=gc(r.min,r.max-a,e.min):a>n&&(s=gc(e.min,e.max-n,r.min)),xi(0,1,s)}function rR(e,r){const s={};return r.min!==void 0&&(s.min=r.min-e.min),r.max!==void 0&&(s.max=r.max-e.min),s}const Xm=.35;function sR(e=Xm){return e===!1?e=0:e===!0&&(e=Xm),{x:sy(e,"left","right"),y:sy(e,"top","bottom")}}function sy(e,r,s){return{min:ay(e,r),max:ay(e,s)}}function ay(e,r){return typeof e=="number"?e:e[r]||0}const ny=()=>({translate:0,scale:1,origin:0,originPoint:0}),Bl=()=>({x:ny(),y:ny()}),iy=()=>({min:0,max:0}),ss=()=>({x:iy(),y:iy()});function Ta(e){return[e("x"),e("y")]}function ab({top:e,left:r,right:s,bottom:a}){return{x:{min:r,max:s},y:{min:e,max:a}}}function aR({x:e,y:r}){return{top:r.min,right:e.max,bottom:r.max,left:e.min}}function nR(e,r){if(!r)return e;const s=r({x:e.left,y:e.top}),a=r({x:e.right,y:e.bottom});return{top:s.y,left:s.x,bottom:a.y,right:a.x}}function om(e){return e===void 0||e===1}function qm({scale:e,scaleX:r,scaleY:s}){return!om(e)||!om(r)||!om(s)}function Mi(e){return qm(e)||nb(e)||e.z||e.rotate||e.rotateX||e.rotateY}function nb(e){return ly(e.x)||ly(e.y)}function ly(e){return e&&e!=="0%"}function Eu(e,r,s){const a=e-s,n=r*a;return s+n}function oy(e,r,s,a,n){return n!==void 0&&(e=Eu(e,n,a)),Eu(e,s,a)+r}function Ym(e,r=0,s=1,a,n){e.min=oy(e.min,r,s,a,n),e.max=oy(e.max,r,s,a,n)}function ib(e,{x:r,y:s}){Ym(e.x,r.translate,r.scale,r.originPoint),Ym(e.y,s.translate,s.scale,s.originPoint)}function iR(e,r,s,a=!1){const n=s.length;if(!n)return;r.x=r.y=1;let o,c;for(let d=0;d<n;d++){o=s[d],c=o.projectionDelta;const h=o.instance;h&&h.style&&h.style.display==="contents"||(a&&o.options.layoutScroll&&o.scroll&&o!==o.root&&Hl(e,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),c&&(r.x*=c.x.scale,r.y*=c.y.scale,ib(e,c)),a&&Mi(o.latestValues)&&Hl(e,o.latestValues))}r.x=cy(r.x),r.y=cy(r.y)}function cy(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function si(e,r){e.min=e.min+r,e.max=e.max+r}function dy(e,r,[s,a,n]){const o=r[n]!==void 0?r[n]:.5,c=Ur(e.min,e.max,o);Ym(e,r[s],r[a],c,r.scale)}const lR=["x","scaleX","originX"],oR=["y","scaleY","originY"];function Hl(e,r){dy(e.x,r,lR),dy(e.y,r,oR)}function lb(e,r){return ab(nR(e.getBoundingClientRect(),r))}function cR(e,r,s){const a=lb(e,s),{scroll:n}=r;return n&&(si(a.x,n.offset.x),si(a.y,n.offset.y)),a}const ob=({current:e})=>e?e.ownerDocument.defaultView:null,dR=new WeakMap;class uR{constructor(r){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ss(),this.visualElement=r}start(r,{snapToCursor:s=!1}={}){const{presenceContext:a}=this.visualElement;if(a&&a.isPresent===!1)return;const n=f=>{const{dragSnapToOrigin:p}=this.getProps();p?this.pauseAnimation():this.stopAnimation(),s&&this.snapToCursor(Ku(f,"page").point)},o=(f,p)=>{const{drag:g,dragPropagation:N,onDragStart:y}=this.getProps();if(g&&!N&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=ww(g),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ta(b=>{let C=this.getAxisMotionValue(b).get()||0;if(sn.test(C)){const{projection:A}=this.visualElement;if(A&&A.layout){const E=A.layout.layoutBox[b];E&&(C=fa(E)*(parseFloat(C)/100))}}this.originPoint[b]=C}),y&&Fr.update(()=>y(f,p),!1,!0);const{animationState:w}=this.visualElement;w&&w.setActive("whileDrag",!0)},c=(f,p)=>{const{dragPropagation:g,dragDirectionLock:N,onDirectionLock:y,onDrag:w}=this.getProps();if(!g&&!this.openGlobalLock)return;const{offset:b}=p;if(N&&this.currentDirection===null){this.currentDirection=hR(b),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",p.point,b),this.updateAxis("y",p.point,b),this.visualElement.render(),w&&w(f,p)},d=(f,p)=>this.stop(f,p),h=()=>Ta(f=>{var p;return this.getAnimationState(f)==="paused"&&((p=this.getAxisMotionValue(f).animation)===null||p===void 0?void 0:p.play())}),{dragSnapToOrigin:m}=this.getProps();this.panSession=new rb(r,{onSessionStart:n,onStart:o,onMove:c,onSessionEnd:d,resumeAnimation:h},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:m,contextWindow:ob(this.visualElement)})}stop(r,s){const a=this.isDragging;if(this.cancel(),!a)return;const{velocity:n}=s;this.startAnimation(n);const{onDragEnd:o}=this.getProps();o&&Fr.update(()=>o(r,s))}cancel(){this.isDragging=!1;const{projection:r,animationState:s}=this.visualElement;r&&(r.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:a}=this.getProps();!a&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),s&&s.setActive("whileDrag",!1)}updateAxis(r,s,a){const{drag:n}=this.getProps();if(!a||!Zd(r,n,this.currentDirection))return;const o=this.getAxisMotionValue(r);let c=this.originPoint[r]+a[r];this.constraints&&this.constraints[r]&&(c=QP(c,this.constraints[r],this.elastic[r])),o.set(c)}resolveConstraints(){var r;const{dragConstraints:s,dragElastic:a}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(r=this.visualElement.projection)===null||r===void 0?void 0:r.layout,o=this.constraints;s&&Ml(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&n?this.constraints=ZP(n.layoutBox,s):this.constraints=!1,this.elastic=sR(a),o!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&Ta(c=>{this.getAxisMotionValue(c)&&(this.constraints[c]=rR(n.layoutBox[c],this.constraints[c]))})}resolveRefConstraints(){const{dragConstraints:r,onMeasureDragConstraints:s}=this.getProps();if(!r||!Ml(r))return!1;const a=r.current,{projection:n}=this.visualElement;if(!n||!n.layout)return!1;const o=cR(a,n.root,this.visualElement.getTransformPagePoint());let c=eR(n.layout.layoutBox,o);if(s){const d=s(aR(c));this.hasMutatedConstraints=!!d,d&&(c=ab(d))}return c}startAnimation(r){const{drag:s,dragMomentum:a,dragElastic:n,dragTransition:o,dragSnapToOrigin:c,onDragTransitionEnd:d}=this.getProps(),h=this.constraints||{},m=Ta(f=>{if(!Zd(f,s,this.currentDirection))return;let p=h&&h[f]||{};c&&(p={min:0,max:0});const g=n?200:1e6,N=n?40:1e7,y={type:"inertia",velocity:a?r[f]:0,bounceStiffness:g,bounceDamping:N,timeConstant:750,restDelta:1,restSpeed:10,...o,...p};return this.startAxisValueAnimation(f,y)});return Promise.all(m).then(d)}startAxisValueAnimation(r,s){const a=this.getAxisMotionValue(r);return a.start(Uf(r,a,0,s))}stopAnimation(){Ta(r=>this.getAxisMotionValue(r).stop())}pauseAnimation(){Ta(r=>{var s;return(s=this.getAxisMotionValue(r).animation)===null||s===void 0?void 0:s.pause()})}getAnimationState(r){var s;return(s=this.getAxisMotionValue(r).animation)===null||s===void 0?void 0:s.state}getAxisMotionValue(r){const s="_drag"+r.toUpperCase(),a=this.visualElement.getProps(),n=a[s];return n||this.visualElement.getValue(r,(a.initial?a.initial[r]:void 0)||0)}snapToCursor(r){Ta(s=>{const{drag:a}=this.getProps();if(!Zd(s,a,this.currentDirection))return;const{projection:n}=this.visualElement,o=this.getAxisMotionValue(s);if(n&&n.layout){const{min:c,max:d}=n.layout.layoutBox[s];o.set(r[s]-Ur(c,d,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:r,dragConstraints:s}=this.getProps(),{projection:a}=this.visualElement;if(!Ml(s)||!a||!this.constraints)return;this.stopAnimation();const n={x:0,y:0};Ta(c=>{const d=this.getAxisMotionValue(c);if(d){const h=d.get();n[c]=tR({min:h,max:h},this.constraints[c])}});const{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",a.root&&a.root.updateScroll(),a.updateLayout(),this.resolveConstraints(),Ta(c=>{if(!Zd(c,r,null))return;const d=this.getAxisMotionValue(c),{min:h,max:m}=this.constraints[c];d.set(Ur(h,m,n[c]))})}addListeners(){if(!this.visualElement.current)return;dR.set(this.visualElement,this);const r=this.visualElement.current,s=jn(r,"pointerdown",h=>{const{drag:m,dragListener:f=!0}=this.getProps();m&&f&&this.start(h)}),a=()=>{const{dragConstraints:h}=this.getProps();Ml(h)&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,o=n.addEventListener("measure",a);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),a();const c=wn(window,"resize",()=>this.scalePositionWithinConstraints()),d=n.addEventListener("didUpdate",(({delta:h,hasLayoutChanged:m})=>{this.isDragging&&m&&(Ta(f=>{const p=this.getAxisMotionValue(f);p&&(this.originPoint[f]+=h[f].translate,p.set(p.get()+h[f].translate))}),this.visualElement.render())}));return()=>{c(),s(),o(),d&&d()}}getProps(){const r=this.visualElement.getProps(),{drag:s=!1,dragDirectionLock:a=!1,dragPropagation:n=!1,dragConstraints:o=!1,dragElastic:c=Xm,dragMomentum:d=!0}=r;return{...r,drag:s,dragDirectionLock:a,dragPropagation:n,dragConstraints:o,dragElastic:c,dragMomentum:d}}}function Zd(e,r,s){return(r===!0||r===e)&&(s===null||s===e)}function hR(e,r=10){let s=null;return Math.abs(e.y)>r?s="y":Math.abs(e.x)>r&&(s="x"),s}class mR extends wi{constructor(r){super(r),this.removeGroupControls=Zr,this.removeListeners=Zr,this.controls=new uR(r)}mount(){const{dragControls:r}=this.node.getProps();r&&(this.removeGroupControls=r.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Zr}unmount(){this.removeGroupControls(),this.removeListeners()}}const uy=e=>(r,s)=>{e&&Fr.update(()=>e(r,s))};class fR extends wi{constructor(){super(...arguments),this.removePointerDownListener=Zr}onPointerDown(r){this.session=new rb(r,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:ob(this.node)})}createPanHandlers(){const{onPanSessionStart:r,onPanStart:s,onPan:a,onPanEnd:n}=this.node.getProps();return{onSessionStart:uy(r),onStart:uy(s),onMove:a,onEnd:(o,c)=>{delete this.session,n&&Fr.update(()=>n(o,c))}}}mount(){this.removePointerDownListener=jn(this.node.current,"pointerdown",r=>this.onPointerDown(r))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function xR(){const e=T.useContext(Tf);if(e===null)return[!0,null];const{isPresent:r,onExitComplete:s,register:a}=e,n=T.useId();return T.useEffect(()=>a(n),[]),!r&&s?[!1,()=>s&&s(n)]:[!0]}const uu={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function hy(e,r){return r.max===r.min?0:e/(r.max-r.min)*100}const Uo={correct:(e,r)=>{if(!r.target)return e;if(typeof e=="string")if(It.test(e))e=parseFloat(e);else return e;const s=hy(e,r.target.x),a=hy(e,r.target.y);return`${s}% ${a}%`}},pR={correct:(e,{treeScale:r,projectionDelta:s})=>{const a=e,n=pi.parse(e);if(n.length>5)return a;const o=pi.createTransformer(e),c=typeof n[0]!="number"?1:0,d=s.x.scale*r.x,h=s.y.scale*r.y;n[0+c]/=d,n[1+c]/=h;const m=Ur(d,h,.5);return typeof n[2+c]=="number"&&(n[2+c]/=m),typeof n[3+c]=="number"&&(n[3+c]/=m),o(n)}};class gR extends Kt.Component{componentDidMount(){const{visualElement:r,layoutGroup:s,switchLayoutGroup:a,layoutId:n}=this.props,{projection:o}=r;jk(vR),o&&(s.group&&s.group.add(o),a&&a.register&&n&&a.register(o),o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,onExitComplete:()=>this.safeToRemove()})),uu.hasEverUpdated=!0}getSnapshotBeforeUpdate(r){const{layoutDependency:s,visualElement:a,drag:n,isPresent:o}=this.props,c=a.projection;return c&&(c.isPresent=o,n||r.layoutDependency!==s||s===void 0?c.willUpdate():this.safeToRemove(),r.isPresent!==o&&(o?c.promote():c.relegate()||Fr.postRender(()=>{const d=c.getStack();(!d||!d.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:r}=this.props.visualElement;r&&(r.root.didUpdate(),queueMicrotask(()=>{!r.currentAnimation&&r.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:r,layoutGroup:s,switchLayoutGroup:a}=this.props,{projection:n}=r;n&&(n.scheduleCheckAfterUnmount(),s&&s.group&&s.group.remove(n),a&&a.deregister&&a.deregister(n))}safeToRemove(){const{safeToRemove:r}=this.props;r&&r()}render(){return null}}function cb(e){const[r,s]=xR(),a=T.useContext(aw);return Kt.createElement(gR,{...e,layoutGroup:a,switchLayoutGroup:T.useContext(nw),isPresent:r,safeToRemove:s})}const vR={borderRadius:{...Uo,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Uo,borderTopRightRadius:Uo,borderBottomLeftRadius:Uo,borderBottomRightRadius:Uo,boxShadow:pR},db=["TopLeft","TopRight","BottomLeft","BottomRight"],yR=db.length,my=e=>typeof e=="string"?parseFloat(e):e,fy=e=>typeof e=="number"||It.test(e);function NR(e,r,s,a,n,o){n?(e.opacity=Ur(0,s.opacity!==void 0?s.opacity:1,wR(a)),e.opacityExit=Ur(r.opacity!==void 0?r.opacity:1,0,bR(a))):o&&(e.opacity=Ur(r.opacity!==void 0?r.opacity:1,s.opacity!==void 0?s.opacity:1,a));for(let c=0;c<yR;c++){const d=`border${db[c]}Radius`;let h=xy(r,d),m=xy(s,d);if(h===void 0&&m===void 0)continue;h||(h=0),m||(m=0),h===0||m===0||fy(h)===fy(m)?(e[d]=Math.max(Ur(my(h),my(m),a),0),(sn.test(m)||sn.test(h))&&(e[d]+="%")):e[d]=m}(r.rotate||s.rotate)&&(e.rotate=Ur(r.rotate||0,s.rotate||0,a))}function xy(e,r){return e[r]!==void 0?e[r]:e.borderRadius}const wR=ub(0,.5,Dw),bR=ub(.5,.95,Zr);function ub(e,r,s){return a=>a<e?0:a>r?1:s(gc(e,r,a))}function py(e,r){e.min=r.min,e.max=r.max}function ba(e,r){py(e.x,r.x),py(e.y,r.y)}function gy(e,r,s,a,n){return e-=r,e=Eu(e,1/s,a),n!==void 0&&(e=Eu(e,1/n,a)),e}function jR(e,r=0,s=1,a=.5,n,o=e,c=e){if(sn.test(r)&&(r=parseFloat(r),r=Ur(c.min,c.max,r/100)-c.min),typeof r!="number")return;let d=Ur(o.min,o.max,a);e===o&&(d-=r),e.min=gy(e.min,r,s,d,n),e.max=gy(e.max,r,s,d,n)}function vy(e,r,[s,a,n],o,c){jR(e,r[s],r[a],r[n],r.scale,o,c)}const ER=["x","scaleX","originX"],TR=["y","scaleY","originY"];function yy(e,r,s,a){vy(e.x,r,ER,s?s.x:void 0,a?a.x:void 0),vy(e.y,r,TR,s?s.y:void 0,a?a.y:void 0)}function Ny(e){return e.translate===0&&e.scale===1}function hb(e){return Ny(e.x)&&Ny(e.y)}function SR(e,r){return e.x.min===r.x.min&&e.x.max===r.x.max&&e.y.min===r.y.min&&e.y.max===r.y.max}function mb(e,r){return Math.round(e.x.min)===Math.round(r.x.min)&&Math.round(e.x.max)===Math.round(r.x.max)&&Math.round(e.y.min)===Math.round(r.y.min)&&Math.round(e.y.max)===Math.round(r.y.max)}function wy(e){return fa(e.x)/fa(e.y)}class AR{constructor(){this.members=[]}add(r){$f(this.members,r),r.scheduleRender()}remove(r){if(Gf(this.members,r),r===this.prevLead&&(this.prevLead=void 0),r===this.lead){const s=this.members[this.members.length-1];s&&this.promote(s)}}relegate(r){const s=this.members.findIndex(n=>r===n);if(s===0)return!1;let a;for(let n=s;n>=0;n--){const o=this.members[n];if(o.isPresent!==!1){a=o;break}}return a?(this.promote(a),!0):!1}promote(r,s){const a=this.lead;if(r!==a&&(this.prevLead=a,this.lead=r,r.show(),a)){a.instance&&a.scheduleRender(),r.scheduleRender(),r.resumeFrom=a,s&&(r.resumeFrom.preserveOpacity=!0),a.snapshot&&(r.snapshot=a.snapshot,r.snapshot.latestValues=a.animationValues||a.latestValues),r.root&&r.root.isUpdating&&(r.isLayoutDirty=!0);const{crossfade:n}=r.options;n===!1&&a.hide()}}exitAnimationComplete(){this.members.forEach(r=>{const{options:s,resumingFrom:a}=r;s.onExitComplete&&s.onExitComplete(),a&&a.options.onExitComplete&&a.options.onExitComplete()})}scheduleRender(){this.members.forEach(r=>{r.instance&&r.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function by(e,r,s){let a="";const n=e.x.translate/r.x,o=e.y.translate/r.y;if((n||o)&&(a=`translate3d(${n}px, ${o}px, 0) `),(r.x!==1||r.y!==1)&&(a+=`scale(${1/r.x}, ${1/r.y}) `),s){const{rotate:h,rotateX:m,rotateY:f}=s;h&&(a+=`rotate(${h}deg) `),m&&(a+=`rotateX(${m}deg) `),f&&(a+=`rotateY(${f}deg) `)}const c=e.x.scale*r.x,d=e.y.scale*r.y;return(c!==1||d!==1)&&(a+=`scale(${c}, ${d})`),a||"none"}const CR=(e,r)=>e.depth-r.depth;class kR{constructor(){this.children=[],this.isDirty=!1}add(r){$f(this.children,r),this.isDirty=!0}remove(r){Gf(this.children,r),this.isDirty=!0}forEach(r){this.isDirty&&this.children.sort(CR),this.isDirty=!1,this.children.forEach(r)}}function PR(e,r){const s=performance.now(),a=({timestamp:n})=>{const o=n-s;o>=r&&(kn(a),e(o-r))};return Fr.read(a,!0),()=>kn(a)}function RR(e){window.MotionDebug&&window.MotionDebug.record(e)}function _R(e){return e instanceof SVGElement&&e.tagName!=="svg"}function DR(e,r,s){const a=ia(e)?e:zl(e);return a.start(Uf("",a,r,s)),a.animation}const jy=["","X","Y","Z"],OR={visibility:"hidden"},Ey=1e3;let FR=0;const Li={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function fb({attachResizeListener:e,defaultParent:r,measureScroll:s,checkIsScrollRoot:a,resetTransform:n}){return class{constructor(c={},d=r?.()){this.id=FR++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Li.totalNodes=Li.resolvedTargetDeltas=Li.recalculatedProjection=0,this.nodes.forEach(LR),this.nodes.forEach($R),this.nodes.forEach(GR),this.nodes.forEach(BR),RR(Li)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=c,this.root=d?d.root||d:this,this.path=d?[...d.path,d]:[],this.parent=d,this.depth=d?d.depth+1:0;for(let h=0;h<this.path.length;h++)this.path[h].shouldResetTransform=!0;this.root===this&&(this.nodes=new kR)}addEventListener(c,d){return this.eventHandlers.has(c)||this.eventHandlers.set(c,new Wf),this.eventHandlers.get(c).add(d)}notifyListeners(c,...d){const h=this.eventHandlers.get(c);h&&h.notify(...d)}hasListeners(c){return this.eventHandlers.has(c)}mount(c,d=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=_R(c),this.instance=c;const{layoutId:h,layout:m,visualElement:f}=this.options;if(f&&!f.current&&f.mount(c),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),d&&(m||h)&&(this.isLayoutDirty=!0),e){let p;const g=()=>this.root.updateBlockedByResize=!1;e(c,()=>{this.root.updateBlockedByResize=!0,p&&p(),p=PR(g,250),uu.hasAnimatedSinceResize&&(uu.hasAnimatedSinceResize=!1,this.nodes.forEach(Sy))})}h&&this.root.registerSharedNode(h,this),this.options.animate!==!1&&f&&(h||m)&&this.addEventListener("didUpdate",({delta:p,hasLayoutChanged:g,hasRelativeTargetChanged:N,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const w=this.options.transition||f.getDefaultTransition()||qR,{onLayoutAnimationStart:b,onLayoutAnimationComplete:C}=f.getProps(),A=!this.targetLayout||!mb(this.targetLayout,y)||N,E=!g&&N;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||E||g&&(A||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(p,E);const R={...Vf(w,"layout"),onPlay:b,onComplete:C};(f.shouldReduceMotion||this.options.layoutRoot)&&(R.delay=0,R.type=!1),this.startAnimation(R)}else g||Sy(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const c=this.getStack();c&&c.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,kn(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(WR),this.animationId++)}getTransformTemplate(){const{visualElement:c}=this.options;return c&&c.getProps().transformTemplate}willUpdate(c=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const p=this.path[f];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:d,layout:h}=this.options;if(d===void 0&&!h)return;const m=this.getTransformTemplate();this.prevTransformTemplateValue=m?m(this.latestValues,""):void 0,this.updateSnapshot(),c&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Ty);return}this.isUpdating||this.nodes.forEach(VR),this.isUpdating=!1,this.nodes.forEach(UR),this.nodes.forEach(IR),this.nodes.forEach(MR),this.clearAllSnapshots();const d=performance.now();_s.delta=xi(0,1e3/60,d-_s.timestamp),_s.timestamp=d,_s.isProcessing=!0,Qh.update.process(_s),Qh.preRender.process(_s),Qh.render.process(_s),_s.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(HR),this.sharedNodes.forEach(zR)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Fr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Fr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let h=0;h<this.path.length;h++)this.path[h].updateScroll();const c=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ss(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:d}=this.options;d&&d.notify("LayoutMeasure",this.layout.layoutBox,c?c.layoutBox:void 0)}updateScroll(c="measure"){let d=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===c&&(d=!1),d&&(this.scroll={animationId:this.root.animationId,phase:c,isRoot:a(this.instance),offset:s(this.instance)})}resetTransform(){if(!n)return;const c=this.isLayoutDirty||this.shouldResetTransform,d=this.projectionDelta&&!hb(this.projectionDelta),h=this.getTransformTemplate(),m=h?h(this.latestValues,""):void 0,f=m!==this.prevTransformTemplateValue;c&&(d||Mi(this.latestValues)||f)&&(n(this.instance,m),this.shouldResetTransform=!1,this.scheduleRender())}measure(c=!0){const d=this.measurePageBox();let h=this.removeElementScroll(d);return c&&(h=this.removeTransform(h)),YR(h),{animationId:this.root.animationId,measuredBox:d,layoutBox:h,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:c}=this.options;if(!c)return ss();const d=c.measureViewportBox(),{scroll:h}=this.root;return h&&(si(d.x,h.offset.x),si(d.y,h.offset.y)),d}removeElementScroll(c){const d=ss();ba(d,c);for(let h=0;h<this.path.length;h++){const m=this.path[h],{scroll:f,options:p}=m;if(m!==this.root&&f&&p.layoutScroll){if(f.isRoot){ba(d,c);const{scroll:g}=this.root;g&&(si(d.x,-g.offset.x),si(d.y,-g.offset.y))}si(d.x,f.offset.x),si(d.y,f.offset.y)}}return d}applyTransform(c,d=!1){const h=ss();ba(h,c);for(let m=0;m<this.path.length;m++){const f=this.path[m];!d&&f.options.layoutScroll&&f.scroll&&f!==f.root&&Hl(h,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),Mi(f.latestValues)&&Hl(h,f.latestValues)}return Mi(this.latestValues)&&Hl(h,this.latestValues),h}removeTransform(c){const d=ss();ba(d,c);for(let h=0;h<this.path.length;h++){const m=this.path[h];if(!m.instance||!Mi(m.latestValues))continue;qm(m.latestValues)&&m.updateSnapshot();const f=ss(),p=m.measurePageBox();ba(f,p),yy(d,m.latestValues,m.snapshot?m.snapshot.layoutBox:void 0,f)}return Mi(this.latestValues)&&yy(d,this.latestValues),d}setTargetDelta(c){this.targetDelta=c,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(c){this.options={...this.options,...c,crossfade:c.crossfade!==void 0?c.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==_s.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(c=!1){var d;const h=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=h.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=h.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=h.isSharedProjectionDirty);const m=!!this.resumingFrom||this!==h;if(!(c||m&&this.isSharedProjectionDirty||this.isProjectionDirty||!((d=this.parent)===null||d===void 0)&&d.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:p,layoutId:g}=this.options;if(!(!this.layout||!(p||g))){if(this.resolvedRelativeTargetAt=_s.timestamp,!this.targetDelta&&!this.relativeTarget){const N=this.getClosestProjectingParent();N&&N.layout&&this.animationProgress!==1?(this.relativeParent=N,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ss(),this.relativeTargetOrigin=ss(),tc(this.relativeTargetOrigin,this.layout.layoutBox,N.layout.layoutBox),ba(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=ss(),this.targetWithTransforms=ss()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),JP(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ba(this.target,this.layout.layoutBox),ib(this.target,this.targetDelta)):ba(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const N=this.getClosestProjectingParent();N&&!!N.resumingFrom==!!this.resumingFrom&&!N.options.layoutScroll&&N.target&&this.animationProgress!==1?(this.relativeParent=N,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ss(),this.relativeTargetOrigin=ss(),tc(this.relativeTargetOrigin,this.target,N.target),ba(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Li.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||qm(this.parent.latestValues)||nb(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var c;const d=this.getLead(),h=!!this.resumingFrom||this!==d;let m=!0;if((this.isProjectionDirty||!((c=this.parent)===null||c===void 0)&&c.isProjectionDirty)&&(m=!1),h&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(m=!1),this.resolvedRelativeTargetAt===_s.timestamp&&(m=!1),m)return;const{layout:f,layoutId:p}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||p))return;ba(this.layoutCorrected,this.layout.layoutBox);const g=this.treeScale.x,N=this.treeScale.y;iR(this.layoutCorrected,this.treeScale,this.path,h),d.layout&&!d.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(d.target=d.layout.layoutBox);const{target:y}=d;if(!y){this.projectionTransform&&(this.projectionDelta=Bl(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=Bl(),this.projectionDeltaWithTransform=Bl());const w=this.projectionTransform;ec(this.projectionDelta,this.layoutCorrected,y,this.latestValues),this.projectionTransform=by(this.projectionDelta,this.treeScale),(this.projectionTransform!==w||this.treeScale.x!==g||this.treeScale.y!==N)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y)),Li.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(c=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),c){const d=this.getStack();d&&d.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(c,d=!1){const h=this.snapshot,m=h?h.latestValues:{},f={...this.latestValues},p=Bl();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!d;const g=ss(),N=h?h.source:void 0,y=this.layout?this.layout.source:void 0,w=N!==y,b=this.getStack(),C=!b||b.members.length<=1,A=!!(w&&!C&&this.options.crossfade===!0&&!this.path.some(XR));this.animationProgress=0;let E;this.mixTargetDelta=R=>{const V=R/1e3;Ay(p.x,c.x,V),Ay(p.y,c.y,V),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(tc(g,this.layout.layoutBox,this.relativeParent.layout.layoutBox),KR(this.relativeTarget,this.relativeTargetOrigin,g,V),E&&SR(this.relativeTarget,E)&&(this.isProjectionDirty=!1),E||(E=ss()),ba(E,this.relativeTarget)),w&&(this.animationValues=f,NR(f,m,this.latestValues,V,A,C)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=V},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(c){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(kn(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Fr.update(()=>{uu.hasAnimatedSinceResize=!0,this.currentAnimation=DR(0,Ey,{...c,onUpdate:d=>{this.mixTargetDelta(d),c.onUpdate&&c.onUpdate(d)},onComplete:()=>{c.onComplete&&c.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const c=this.getStack();c&&c.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Ey),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const c=this.getLead();let{targetWithTransforms:d,target:h,layout:m,latestValues:f}=c;if(!(!d||!h||!m)){if(this!==c&&this.layout&&m&&xb(this.options.animationType,this.layout.layoutBox,m.layoutBox)){h=this.target||ss();const p=fa(this.layout.layoutBox.x);h.x.min=c.target.x.min,h.x.max=h.x.min+p;const g=fa(this.layout.layoutBox.y);h.y.min=c.target.y.min,h.y.max=h.y.min+g}ba(d,h),Hl(d,f),ec(this.projectionDeltaWithTransform,this.layoutCorrected,d,f)}}registerSharedNode(c,d){this.sharedNodes.has(c)||this.sharedNodes.set(c,new AR),this.sharedNodes.get(c).add(d);const m=d.options.initialPromotionConfig;d.promote({transition:m?m.transition:void 0,preserveFollowOpacity:m&&m.shouldPreserveFollowOpacity?m.shouldPreserveFollowOpacity(d):void 0})}isLead(){const c=this.getStack();return c?c.lead===this:!0}getLead(){var c;const{layoutId:d}=this.options;return d?((c=this.getStack())===null||c===void 0?void 0:c.lead)||this:this}getPrevLead(){var c;const{layoutId:d}=this.options;return d?(c=this.getStack())===null||c===void 0?void 0:c.prevLead:void 0}getStack(){const{layoutId:c}=this.options;if(c)return this.root.sharedNodes.get(c)}promote({needsReset:c,transition:d,preserveFollowOpacity:h}={}){const m=this.getStack();m&&m.promote(this,h),c&&(this.projectionDelta=void 0,this.needsReset=!0),d&&this.setOptions({transition:d})}relegate(){const c=this.getStack();return c?c.relegate(this):!1}resetRotation(){const{visualElement:c}=this.options;if(!c)return;let d=!1;const{latestValues:h}=c;if((h.rotate||h.rotateX||h.rotateY||h.rotateZ)&&(d=!0),!d)return;const m={};for(let f=0;f<jy.length;f++){const p="rotate"+jy[f];h[p]&&(m[p]=h[p],c.setStaticValue(p,0))}c.render();for(const f in m)c.setStaticValue(f,m[f]);c.scheduleRender()}getProjectionStyles(c){var d,h;if(!this.instance||this.isSVG)return;if(!this.isVisible)return OR;const m={visibility:""},f=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,m.opacity="",m.pointerEvents=du(c?.pointerEvents)||"",m.transform=f?f(this.latestValues,""):"none",m;const p=this.getLead();if(!this.projectionDelta||!this.layout||!p.target){const w={};return this.options.layoutId&&(w.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,w.pointerEvents=du(c?.pointerEvents)||""),this.hasProjected&&!Mi(this.latestValues)&&(w.transform=f?f({},""):"none",this.hasProjected=!1),w}const g=p.animationValues||p.latestValues;this.applyTransformsToTarget(),m.transform=by(this.projectionDeltaWithTransform,this.treeScale,g),f&&(m.transform=f(g,m.transform));const{x:N,y}=this.projectionDelta;m.transformOrigin=`${N.origin*100}% ${y.origin*100}% 0`,p.animationValues?m.opacity=p===this?(h=(d=g.opacity)!==null&&d!==void 0?d:this.latestValues.opacity)!==null&&h!==void 0?h:1:this.preserveOpacity?this.latestValues.opacity:g.opacityExit:m.opacity=p===this?g.opacity!==void 0?g.opacity:"":g.opacityExit!==void 0?g.opacityExit:0;for(const w in gu){if(g[w]===void 0)continue;const{correct:b,applyTo:C}=gu[w],A=m.transform==="none"?g[w]:b(g[w],p);if(C){const E=C.length;for(let R=0;R<E;R++)m[C[R]]=A}else m[w]=A}return this.options.layoutId&&(m.pointerEvents=p===this?du(c?.pointerEvents)||"":"none"),m}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(c=>{var d;return(d=c.currentAnimation)===null||d===void 0?void 0:d.stop()}),this.root.nodes.forEach(Ty),this.root.sharedNodes.clear()}}}function IR(e){e.updateLayout()}function MR(e){var r;const s=((r=e.resumeFrom)===null||r===void 0?void 0:r.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&s&&e.hasListeners("didUpdate")){const{layoutBox:a,measuredBox:n}=e.layout,{animationType:o}=e.options,c=s.source!==e.layout.source;o==="size"?Ta(p=>{const g=c?s.measuredBox[p]:s.layoutBox[p],N=fa(g);g.min=a[p].min,g.max=g.min+N}):xb(o,s.layoutBox,a)&&Ta(p=>{const g=c?s.measuredBox[p]:s.layoutBox[p],N=fa(a[p]);g.max=g.min+N,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[p].max=e.relativeTarget[p].min+N)});const d=Bl();ec(d,a,s.layoutBox);const h=Bl();c?ec(h,e.applyTransform(n,!0),s.measuredBox):ec(h,a,s.layoutBox);const m=!hb(d);let f=!1;if(!e.resumeFrom){const p=e.getClosestProjectingParent();if(p&&!p.resumeFrom){const{snapshot:g,layout:N}=p;if(g&&N){const y=ss();tc(y,s.layoutBox,g.layoutBox);const w=ss();tc(w,a,N.layoutBox),mb(y,w)||(f=!0),p.options.layoutRoot&&(e.relativeTarget=w,e.relativeTargetOrigin=y,e.relativeParent=p)}}}e.notifyListeners("didUpdate",{layout:a,snapshot:s,delta:h,layoutDelta:d,hasLayoutChanged:m,hasRelativeTargetChanged:f})}else if(e.isLead()){const{onExitComplete:a}=e.options;a&&a()}e.options.transition=void 0}function LR(e){Li.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function BR(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function HR(e){e.clearSnapshot()}function Ty(e){e.clearMeasurements()}function VR(e){e.isLayoutDirty=!1}function UR(e){const{visualElement:r}=e.options;r&&r.getProps().onBeforeLayoutMeasure&&r.notify("BeforeLayoutMeasure"),e.resetTransform()}function Sy(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function $R(e){e.resolveTargetDelta()}function GR(e){e.calcProjection()}function WR(e){e.resetRotation()}function zR(e){e.removeLeadSnapshot()}function Ay(e,r,s){e.translate=Ur(r.translate,0,s),e.scale=Ur(r.scale,1,s),e.origin=r.origin,e.originPoint=r.originPoint}function Cy(e,r,s,a){e.min=Ur(r.min,s.min,a),e.max=Ur(r.max,s.max,a)}function KR(e,r,s,a){Cy(e.x,r.x,s.x,a),Cy(e.y,r.y,s.y,a)}function XR(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const qR={duration:.45,ease:[.4,0,.1,1]},ky=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),Py=ky("applewebkit/")&&!ky("chrome/")?Math.round:Zr;function Ry(e){e.min=Py(e.min),e.max=Py(e.max)}function YR(e){Ry(e.x),Ry(e.y)}function xb(e,r,s){return e==="position"||e==="preserve-aspect"&&!Km(wy(r),wy(s),.2)}const JR=fb({attachResizeListener:(e,r)=>wn(e,"resize",r),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),cm={current:void 0},pb=fb({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!cm.current){const e=new JR({});e.mount(window),e.setOptions({layoutScroll:!0}),cm.current=e}return cm.current},resetTransform:(e,r)=>{e.style.transform=r!==void 0?r:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),QR={pan:{Feature:fR},drag:{Feature:mR,ProjectionNode:pb,MeasureLayout:cb}},ZR=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function e3(e){const r=ZR.exec(e);if(!r)return[,];const[,s,a]=r;return[s,a]}function Jm(e,r,s=1){const[a,n]=e3(e);if(!a)return;const o=window.getComputedStyle(r).getPropertyValue(a);if(o){const c=o.trim();return Qw(c)?parseFloat(c):c}else return Hm(n)?Jm(n,r,s+1):n}function t3(e,{...r},s){const a=e.current;if(!(a instanceof Element))return{target:r,transitionEnd:s};s&&(s={...s}),e.values.forEach(n=>{const o=n.get();if(!Hm(o))return;const c=Jm(o,a);c&&n.set(c)});for(const n in r){const o=r[n];if(!Hm(o))continue;const c=Jm(o,a);c&&(r[n]=c,s||(s={}),s[n]===void 0&&(s[n]=o))}return{target:r,transitionEnd:s}}const r3=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),gb=e=>r3.has(e),s3=e=>Object.keys(e).some(gb),_y=e=>e===sl||e===It,Dy=(e,r)=>parseFloat(e.split(", ")[r]),Oy=(e,r)=>(s,{transform:a})=>{if(a==="none"||!a)return 0;const n=a.match(/^matrix3d\((.+)\)$/);if(n)return Dy(n[1],r);{const o=a.match(/^matrix\((.+)\)$/);return o?Dy(o[1],e):0}},a3=new Set(["x","y","z"]),n3=Pc.filter(e=>!a3.has(e));function i3(e){const r=[];return n3.forEach(s=>{const a=e.getValue(s);a!==void 0&&(r.push([s,a.get()]),a.set(s.startsWith("scale")?1:0))}),r.length&&e.render(),r}const Kl={width:({x:e},{paddingLeft:r="0",paddingRight:s="0"})=>e.max-e.min-parseFloat(r)-parseFloat(s),height:({y:e},{paddingTop:r="0",paddingBottom:s="0"})=>e.max-e.min-parseFloat(r)-parseFloat(s),top:(e,{top:r})=>parseFloat(r),left:(e,{left:r})=>parseFloat(r),bottom:({y:e},{top:r})=>parseFloat(r)+(e.max-e.min),right:({x:e},{left:r})=>parseFloat(r)+(e.max-e.min),x:Oy(4,13),y:Oy(5,14)};Kl.translateX=Kl.x;Kl.translateY=Kl.y;const l3=(e,r,s)=>{const a=r.measureViewportBox(),n=r.current,o=getComputedStyle(n),{display:c}=o,d={};c==="none"&&r.setStaticValue("display",e.display||"block"),s.forEach(m=>{d[m]=Kl[m](a,o)}),r.render();const h=r.measureViewportBox();return s.forEach(m=>{const f=r.getValue(m);f&&f.jump(d[m]),e[m]=Kl[m](h,o)}),e},o3=(e,r,s={},a={})=>{r={...r},a={...a};const n=Object.keys(r).filter(gb);let o=[],c=!1;const d=[];if(n.forEach(h=>{const m=e.getValue(h);if(!e.hasValue(h))return;let f=s[h],p=Vo(f);const g=r[h];let N;if(yu(g)){const y=g.length,w=g[0]===null?1:0;f=g[w],p=Vo(f);for(let b=w;b<y&&g[b]!==null;b++)N?If(Vo(g[b])===N):N=Vo(g[b])}else N=Vo(g);if(p!==N)if(_y(p)&&_y(N)){const y=m.get();typeof y=="string"&&m.set(parseFloat(y)),typeof g=="string"?r[h]=parseFloat(g):Array.isArray(g)&&N===It&&(r[h]=g.map(parseFloat))}else p?.transform&&N?.transform&&(f===0||g===0)?f===0?m.set(N.transform(f)):r[h]=p.transform(g):(c||(o=i3(e),c=!0),d.push(h),a[h]=a[h]!==void 0?a[h]:r[h],m.jump(g))}),d.length){const h=d.indexOf("height")>=0?window.pageYOffset:null,m=l3(r,e,d);return o.length&&o.forEach(([f,p])=>{e.getValue(f).set(p)}),e.render(),$u&&h!==null&&window.scrollTo({top:h}),{target:m,transitionEnd:a}}else return{target:r,transitionEnd:a}};function c3(e,r,s,a){return s3(r)?o3(e,r,s,a):{target:r,transitionEnd:a}}const d3=(e,r,s,a)=>{const n=t3(e,r,a);return r=n.target,a=n.transitionEnd,c3(e,r,s,a)},Qm={current:null},vb={current:!1};function u3(){if(vb.current=!0,!!$u)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),r=()=>Qm.current=e.matches;e.addListener(r),r()}else Qm.current=!1}function h3(e,r,s){const{willChange:a}=r;for(const n in r){const o=r[n],c=s[n];if(ia(o))e.addValue(n,o),ju(a)&&a.add(n);else if(ia(c))e.addValue(n,zl(o,{owner:e})),ju(a)&&a.remove(n);else if(c!==o)if(e.hasValue(n)){const d=e.getValue(n);!d.hasAnimated&&d.set(o)}else{const d=e.getStaticValue(n);e.addValue(n,zl(d!==void 0?d:o,{owner:e}))}}for(const n in s)r[n]===void 0&&e.removeValue(n);return r}const Fy=new WeakMap,yb=Object.keys(pc),m3=yb.length,Iy=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],f3=Cf.length;class x3{constructor({parent:r,props:s,presenceContext:a,reducedMotionConfig:n,visualState:o},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>Fr.render(this.render,!1,!0);const{latestValues:d,renderState:h}=o;this.latestValues=d,this.baseTarget={...d},this.initialValues=s.initial?{...d}:{},this.renderState=h,this.parent=r,this.props=s,this.presenceContext=a,this.depth=r?r.depth+1:0,this.reducedMotionConfig=n,this.options=c,this.isControllingVariants=Wu(s),this.isVariantNode=sw(s),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(r&&r.current);const{willChange:m,...f}=this.scrapeMotionValuesFromProps(s,{});for(const p in f){const g=f[p];d[p]!==void 0&&ia(g)&&(g.set(d[p],!1),ju(m)&&m.add(p))}}scrapeMotionValuesFromProps(r,s){return{}}mount(r){this.current=r,Fy.set(r,this),this.projection&&!this.projection.instance&&this.projection.mount(r),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,a)=>this.bindToMotionValue(a,s)),vb.current||u3(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Qm.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){Fy.delete(this.current),this.projection&&this.projection.unmount(),kn(this.notifyUpdate),kn(this.render),this.valueSubscriptions.forEach(r=>r()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const r in this.events)this.events[r].clear();for(const r in this.features)this.features[r].unmount();this.current=null}bindToMotionValue(r,s){const a=rl.has(r),n=s.on("change",c=>{this.latestValues[r]=c,this.props.onUpdate&&Fr.update(this.notifyUpdate,!1,!0),a&&this.projection&&(this.projection.isTransformDirty=!0)}),o=s.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(r,()=>{n(),o()})}sortNodePosition(r){return!this.current||!this.sortInstanceNodePosition||this.type!==r.type?0:this.sortInstanceNodePosition(this.current,r.current)}loadFeatures({children:r,...s},a,n,o){let c,d;for(let h=0;h<m3;h++){const m=yb[h],{isEnabled:f,Feature:p,ProjectionNode:g,MeasureLayout:N}=pc[m];g&&(c=g),f(s)&&(!this.features[m]&&p&&(this.features[m]=new p(this)),N&&(d=N))}if((this.type==="html"||this.type==="svg")&&!this.projection&&c){this.projection=new c(this.latestValues,this.parent&&this.parent.projection);const{layoutId:h,layout:m,drag:f,dragConstraints:p,layoutScroll:g,layoutRoot:N}=s;this.projection.setOptions({layoutId:h,layout:m,alwaysMeasureLayout:!!f||p&&Ml(p),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof m=="string"?m:"both",initialPromotionConfig:o,layoutScroll:g,layoutRoot:N})}return d}updateFeatures(){for(const r in this.features){const s=this.features[r];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ss()}getStaticValue(r){return this.latestValues[r]}setStaticValue(r,s){this.latestValues[r]=s}makeTargetAnimatable(r,s=!0){return this.makeTargetAnimatableFromInstance(r,this.props,s)}update(r,s){(r.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=r,this.prevPresenceContext=this.presenceContext,this.presenceContext=s;for(let a=0;a<Iy.length;a++){const n=Iy[a];this.propEventSubscriptions[n]&&(this.propEventSubscriptions[n](),delete this.propEventSubscriptions[n]);const o=r["on"+n];o&&(this.propEventSubscriptions[n]=this.on(n,o))}this.prevMotionValues=h3(this,this.scrapeMotionValuesFromProps(r,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(r){return this.props.variants?this.props.variants[r]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(r=!1){if(r)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const a=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(a.initial=this.props.initial),a}const s={};for(let a=0;a<f3;a++){const n=Cf[a],o=this.props[n];(xc(o)||o===!1)&&(s[n]=o)}return s}addVariantChild(r){const s=this.getClosestVariantNode();if(s)return s.variantChildren&&s.variantChildren.add(r),()=>s.variantChildren.delete(r)}addValue(r,s){s!==this.values.get(r)&&(this.removeValue(r),this.bindToMotionValue(r,s)),this.values.set(r,s),this.latestValues[r]=s.get()}removeValue(r){this.values.delete(r);const s=this.valueSubscriptions.get(r);s&&(s(),this.valueSubscriptions.delete(r)),delete this.latestValues[r],this.removeValueFromRenderState(r,this.renderState)}hasValue(r){return this.values.has(r)}getValue(r,s){if(this.props.values&&this.props.values[r])return this.props.values[r];let a=this.values.get(r);return a===void 0&&s!==void 0&&(a=zl(s,{owner:this}),this.addValue(r,a)),a}readValue(r){var s;return this.latestValues[r]!==void 0||!this.current?this.latestValues[r]:(s=this.getBaseTargetFromProps(this.props,r))!==null&&s!==void 0?s:this.readValueFromInstance(this.current,r,this.options)}setBaseTarget(r,s){this.baseTarget[r]=s}getBaseTarget(r){var s;const{initial:a}=this.props,n=typeof a=="string"||typeof a=="object"?(s=Ff(this.props,a))===null||s===void 0?void 0:s[r]:void 0;if(a&&n!==void 0)return n;const o=this.getBaseTargetFromProps(this.props,r);return o!==void 0&&!ia(o)?o:this.initialValues[r]!==void 0&&n===void 0?void 0:this.baseTarget[r]}on(r,s){return this.events[r]||(this.events[r]=new Wf),this.events[r].add(s)}notify(r,...s){this.events[r]&&this.events[r].notify(...s)}}class Nb extends x3{sortInstanceNodePosition(r,s){return r.compareDocumentPosition(s)&2?1:-1}getBaseTargetFromProps(r,s){return r.style?r.style[s]:void 0}removeValueFromRenderState(r,{vars:s,style:a}){delete s[r],delete a[r]}makeTargetAnimatableFromInstance({transition:r,transitionEnd:s,...a},{transformValues:n},o){let c=_P(a,r||{},this);if(n&&(s&&(s=n(s)),a&&(a=n(a)),c&&(c=n(c))),o){PP(this,a,c);const d=d3(this,a,c,s);s=d.transitionEnd,a=d.target}return{transition:r,transitionEnd:s,...a}}}function p3(e){return window.getComputedStyle(e)}class g3 extends Nb{constructor(){super(...arguments),this.type="html"}readValueFromInstance(r,s){if(rl.has(s)){const a=Hf(s);return a&&a.default||0}else{const a=p3(r),n=(ow(s)?a.getPropertyValue(s):a[s])||0;return typeof n=="string"?n.trim():n}}measureInstanceViewportBox(r,{transformPagePoint:s}){return lb(r,s)}build(r,s,a,n){Pf(r,s,a,n.transformTemplate)}scrapeMotionValuesFromProps(r,s){return Of(r,s)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:r}=this.props;ia(r)&&(this.childSubscription=r.on("change",s=>{this.current&&(this.current.textContent=`${s}`)}))}renderInstance(r,s,a,n){fw(r,s,a,n)}}class v3 extends Nb{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(r,s){return r[s]}readValueFromInstance(r,s){if(rl.has(s)){const a=Hf(s);return a&&a.default||0}return s=xw.has(s)?s:Sf(s),r.getAttribute(s)}measureInstanceViewportBox(){return ss()}scrapeMotionValuesFromProps(r,s){return gw(r,s)}build(r,s,a,n){_f(r,s,a,this.isSVGTag,n.transformTemplate)}renderInstance(r,s,a,n){pw(r,s,a,n)}mount(r){this.isSVGTag=Df(r.tagName),super.mount(r)}}const y3=(e,r)=>kf(e)?new v3(r,{enableHardwareAcceleration:!1}):new g3(r,{enableHardwareAcceleration:!0}),N3={layout:{ProjectionNode:pb,MeasureLayout:cb}},w3={...KP,...m4,...QR,...N3},ds=wk((e,r)=>e4(e,r,w3,y3)),b3=Vu("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),pe=Kt.forwardRef(({className:e,variant:r,size:s,asChild:a=!1,...n},o)=>{const c=a?tC:"button";return t.jsx(c,{className:Pr(b3({variant:r,size:s,className:e})),ref:o,...n})});pe.displayName="Button";const Re=Kt.forwardRef(({className:e,type:r,...s},a)=>t.jsx("input",{type:r,className:Pr("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...s}));Re.displayName="Input";var j3="Label",wb=T.forwardRef((e,r)=>t.jsx(es.label,{...e,ref:r,onMouseDown:s=>{s.target.closest("button, input, select, textarea")||(e.onMouseDown?.(s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));wb.displayName=j3;var bb=wb;const E3=Vu("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Q=Kt.forwardRef(({className:e,...r},s)=>t.jsx(bb,{ref:s,className:Pr(E3(),e),...r}));Q.displayName=bb.displayName;const He=Kt.forwardRef(({className:e,...r},s)=>t.jsx("div",{ref:s,className:Pr("rounded-lg border bg-card text-card-foreground shadow-sm",e),...r}));He.displayName="Card";const rt=Kt.forwardRef(({className:e,...r},s)=>t.jsx("div",{ref:s,className:Pr("flex flex-col space-y-1.5 p-6",e),...r}));rt.displayName="CardHeader";const at=Kt.forwardRef(({className:e,...r},s)=>t.jsx("h3",{ref:s,className:Pr("text-2xl font-semibold leading-none tracking-tight",e),...r}));at.displayName="CardTitle";const gr=Kt.forwardRef(({className:e,...r},s)=>t.jsx("p",{ref:s,className:Pr("text-sm text-muted-foreground",e),...r}));gr.displayName="CardDescription";const Ve=Kt.forwardRef(({className:e,...r},s)=>t.jsx("div",{ref:s,className:Pr("p-6 pt-0",e),...r}));Ve.displayName="CardContent";const T3=Kt.forwardRef(({className:e,...r},s)=>t.jsx("div",{ref:s,className:Pr("flex items-center p-6 pt-0",e),...r}));T3.displayName="CardFooter";const Oc=Kt.createContext({value:void 0,onValueChange:()=>{},isOpen:!1,setIsOpen:()=>{},selectedLabel:""});function br({value:e,onValueChange:r,children:s}){const[a,n]=T.useState(!1),[o,c]=T.useState("");return t.jsx(Oc.Provider,{value:{value:e,onValueChange:(d,h)=>{r(d),c(h),n(!1)},isOpen:a,setIsOpen:n,selectedLabel:o},children:t.jsx("div",{className:"relative",children:s})})}function jr({className:e,children:r}){const{isOpen:s,setIsOpen:a}=Kt.useContext(Oc);return t.jsxs("button",{type:"button",className:Pr("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),onClick:()=>a(!s),children:[r,t.jsx(qC,{className:Pr("h-4 w-4 opacity-50 transition-transform",s&&"rotate-180")})]})}function Er({placeholder:e}){const{value:r,selectedLabel:s}=Kt.useContext(Oc);return t.jsx("span",{className:"block truncate",children:s||r||e||""})}function Tr({className:e,children:r}){const{isOpen:s}=Kt.useContext(Oc),a=T.useRef(null);return T.useEffect(()=>{const n=o=>{a.current&&a.current.contains(o.target)};return s&&document.addEventListener("mousedown",n),()=>{document.removeEventListener("mousedown",n)}},[s]),s?t.jsx("div",{ref:a,className:Pr("absolute top-full left-0 right-0 z-50 mt-1 max-h-60 overflow-auto rounded-md border bg-popover text-popover-foreground shadow-md",e),children:t.jsx("div",{className:"p-1",children:r})}):null}function st({value:e,children:r}){const{onValueChange:s}=Kt.useContext(Oc);return t.jsx("button",{type:"button",className:"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground",onClick:()=>s&&s(e,r),children:r})}function ai({value:e,onChange:r,children:s,className:a}){return t.jsx("select",{className:Pr("h-10 w-full rounded-md border border-input bg-background px-3 text-sm",a),value:e,onChange:n=>r?.(n.target.value),children:s})}var S3=mf[" useId ".trim().toString()]||(()=>{}),A3=0;function jb(e){const[r,s]=T.useState(S3());return Yi(()=>{s(a=>a??String(A3++))},[e]),r?`radix-${r}`:""}var C3=T.createContext(void 0);function zf(e){const r=T.useContext(C3);return e||r||"ltr"}var dm="rovingFocusGroup.onEntryFocus",k3={bubbles:!1,cancelable:!0},Fc="RovingFocusGroup",[Zm,Eb,P3]=yN(Fc),[R3,qu]=Ql(Fc,[P3]),[_3,D3]=R3(Fc),Tb=T.forwardRef((e,r)=>t.jsx(Zm.Provider,{scope:e.__scopeRovingFocusGroup,children:t.jsx(Zm.Slot,{scope:e.__scopeRovingFocusGroup,children:t.jsx(O3,{...e,ref:r})})}));Tb.displayName=Fc;var O3=T.forwardRef((e,r)=>{const{__scopeRovingFocusGroup:s,orientation:a,loop:n=!1,dir:o,currentTabStopId:c,defaultCurrentTabStopId:d,onCurrentTabStopIdChange:h,onEntryFocus:m,preventScrollOnEntryFocus:f=!1,...p}=e,g=T.useRef(null),N=za(r,g),y=zf(o),[w,b]=Bu({prop:c,defaultProp:d??null,onChange:h,caller:Fc}),[C,A]=T.useState(!1),E=mi(m),R=Eb(s),V=T.useRef(!1),[P,k]=T.useState(0);return T.useEffect(()=>{const z=g.current;if(z)return z.addEventListener(dm,E),()=>z.removeEventListener(dm,E)},[E]),t.jsx(_3,{scope:s,orientation:a,dir:y,loop:n,currentTabStopId:w,onItemFocus:T.useCallback(z=>b(z),[b]),onItemShiftTab:T.useCallback(()=>A(!0),[]),onFocusableItemAdd:T.useCallback(()=>k(z=>z+1),[]),onFocusableItemRemove:T.useCallback(()=>k(z=>z-1),[]),children:t.jsx(es.div,{tabIndex:C||P===0?-1:0,"data-orientation":a,...p,ref:N,style:{outline:"none",...e.style},onMouseDown:Or(e.onMouseDown,()=>{V.current=!0}),onFocus:Or(e.onFocus,z=>{const W=!V.current;if(z.target===z.currentTarget&&W&&!C){const te=new CustomEvent(dm,k3);if(z.currentTarget.dispatchEvent(te),!te.defaultPrevented){const de=R().filter(oe=>oe.focusable),H=de.find(oe=>oe.active),ue=de.find(oe=>oe.id===w),X=[H,ue,...de].filter(Boolean).map(oe=>oe.ref.current);Cb(X,f)}}V.current=!1}),onBlur:Or(e.onBlur,()=>A(!1))})})}),Sb="RovingFocusGroupItem",Ab=T.forwardRef((e,r)=>{const{__scopeRovingFocusGroup:s,focusable:a=!0,active:n=!1,tabStopId:o,children:c,...d}=e,h=jb(),m=o||h,f=D3(Sb,s),p=f.currentTabStopId===m,g=Eb(s),{onFocusableItemAdd:N,onFocusableItemRemove:y,currentTabStopId:w}=f;return T.useEffect(()=>{if(a)return N(),()=>y()},[a,N,y]),t.jsx(Zm.ItemSlot,{scope:s,id:m,focusable:a,active:n,children:t.jsx(es.span,{tabIndex:p?0:-1,"data-orientation":f.orientation,...d,ref:r,onMouseDown:Or(e.onMouseDown,b=>{a?f.onItemFocus(m):b.preventDefault()}),onFocus:Or(e.onFocus,()=>f.onItemFocus(m)),onKeyDown:Or(e.onKeyDown,b=>{if(b.key==="Tab"&&b.shiftKey){f.onItemShiftTab();return}if(b.target!==b.currentTarget)return;const C=M3(b,f.orientation,f.dir);if(C!==void 0){if(b.metaKey||b.ctrlKey||b.altKey||b.shiftKey)return;b.preventDefault();let E=g().filter(R=>R.focusable).map(R=>R.ref.current);if(C==="last")E.reverse();else if(C==="prev"||C==="next"){C==="prev"&&E.reverse();const R=E.indexOf(b.currentTarget);E=f.loop?L3(E,R+1):E.slice(R+1)}setTimeout(()=>Cb(E))}}),children:typeof c=="function"?c({isCurrentTabStop:p,hasTabStop:w!=null}):c})})});Ab.displayName=Sb;var F3={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function I3(e,r){return r!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function M3(e,r,s){const a=I3(e.key,s);if(!(r==="vertical"&&["ArrowLeft","ArrowRight"].includes(a))&&!(r==="horizontal"&&["ArrowUp","ArrowDown"].includes(a)))return F3[a]}function Cb(e,r=!1){const s=document.activeElement;for(const a of e)if(a===s||(a.focus({preventScroll:r}),document.activeElement!==s))return}function L3(e,r){return e.map((s,a)=>e[(r+a)%e.length])}var kb=Tb,Pb=Ab,Yu="Tabs",[B3,B5]=Ql(Yu,[qu]),Rb=qu(),[H3,Kf]=B3(Yu),_b=T.forwardRef((e,r)=>{const{__scopeTabs:s,value:a,onValueChange:n,defaultValue:o,orientation:c="horizontal",dir:d,activationMode:h="automatic",...m}=e,f=zf(d),[p,g]=Bu({prop:a,onChange:n,defaultProp:o??"",caller:Yu});return t.jsx(H3,{scope:s,baseId:jb(),value:p,onValueChange:g,orientation:c,dir:f,activationMode:h,children:t.jsx(es.div,{dir:f,"data-orientation":c,...m,ref:r})})});_b.displayName=Yu;var Db="TabsList",Ob=T.forwardRef((e,r)=>{const{__scopeTabs:s,loop:a=!0,...n}=e,o=Kf(Db,s),c=Rb(s);return t.jsx(kb,{asChild:!0,...c,orientation:o.orientation,dir:o.dir,loop:a,children:t.jsx(es.div,{role:"tablist","aria-orientation":o.orientation,...n,ref:r})})});Ob.displayName=Db;var Fb="TabsTrigger",Ib=T.forwardRef((e,r)=>{const{__scopeTabs:s,value:a,disabled:n=!1,...o}=e,c=Kf(Fb,s),d=Rb(s),h=Bb(c.baseId,a),m=Hb(c.baseId,a),f=a===c.value;return t.jsx(Pb,{asChild:!0,...d,focusable:!n,active:f,children:t.jsx(es.button,{type:"button",role:"tab","aria-selected":f,"aria-controls":m,"data-state":f?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:h,...o,ref:r,onMouseDown:Or(e.onMouseDown,p=>{!n&&p.button===0&&p.ctrlKey===!1?c.onValueChange(a):p.preventDefault()}),onKeyDown:Or(e.onKeyDown,p=>{[" ","Enter"].includes(p.key)&&c.onValueChange(a)}),onFocus:Or(e.onFocus,()=>{const p=c.activationMode!=="manual";!f&&!n&&p&&c.onValueChange(a)})})})});Ib.displayName=Fb;var Mb="TabsContent",Lb=T.forwardRef((e,r)=>{const{__scopeTabs:s,value:a,forceMount:n,children:o,...c}=e,d=Kf(Mb,s),h=Bb(d.baseId,a),m=Hb(d.baseId,a),f=a===d.value,p=T.useRef(f);return T.useEffect(()=>{const g=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(g)},[]),t.jsx(Lu,{present:n||f,children:({present:g})=>t.jsx(es.div,{"data-state":f?"active":"inactive","data-orientation":d.orientation,role:"tabpanel","aria-labelledby":h,hidden:!g,id:m,tabIndex:0,...c,ref:r,style:{...e.style,animationDuration:p.current?"0s":void 0},children:g&&o})})});Lb.displayName=Mb;function Bb(e,r){return`${e}-trigger-${r}`}function Hb(e,r){return`${e}-content-${r}`}var V3=_b,Vb=Ob,Ub=Ib,$b=Lb;const an=V3,ma=Kt.forwardRef(({className:e,...r},s)=>t.jsx(Vb,{ref:s,className:Pr("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...r}));ma.displayName=Vb.displayName;const xt=Kt.forwardRef(({className:e,...r},s)=>t.jsx(Ub,{ref:s,className:Pr("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...r}));xt.displayName=Ub.displayName;const Ut=Kt.forwardRef(({className:e,...r},s)=>t.jsx($b,{ref:s,className:Pr("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...r}));Ut.displayName=$b.displayName;const Gb=T.createContext(),Ia="http://localhost:5000/api",Ns=()=>{const e=T.useContext(Gb);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},U3=({children:e})=>{const[r,s]=T.useState(null),[a,n]=T.useState([]),[o,c]=T.useState(!0);T.useEffect(()=>{const E=sessionStorage.getItem("erpUser");E&&s(JSON.parse(E)),c(!1)},[]);const d=async E=>{try{const V=E.username.includes("@")?{email:E.username,password:E.password}:{username:E.username,password:E.password},P=await fetch(`${Ia}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(V)}),k=await P.json();if(!P.ok)throw new Error(k.error||"Login failed");return s(k.user),sessionStorage.setItem("erpUser",JSON.stringify(k.user)),{user:k.user}}catch(R){throw new Error(R.message||"Network error during login")}},h=async()=>{try{window.location.href=`${Ia}/auth/google/login`}catch(E){throw new Error(E.message||"Network error during Google OAuth login")}},m=async E=>{try{const R=await fetch(`${Ia}/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(E)}),V=await R.json();if(!R.ok)throw new Error(V.error||"Registration failed");return{message:V.message||"Registration successful! Your account is pending admin approval.",user:V.user}}catch(R){throw new Error(R.message||"Network error during registration")}},f=async()=>{try{const E=await fetch(`${Ia}/auth/pending-users`),R=await E.json();if(!E.ok)throw new Error(R.error||"Failed to fetch pending users");return R}catch(E){throw new Error(E.message||"Network error while fetching pending users")}},p=async E=>{try{const R=await fetch(`${Ia}/auth/approve-user/${E}`,{method:"PUT",headers:{"Content-Type":"application/json"}}),V=await R.json();if(!R.ok)throw new Error(V.error||"Failed to approve user");return V}catch(R){throw new Error(R.message||"Network error while approving user")}},g=async E=>{try{const R=await fetch(`${Ia}/auth/reject-user/${E}`,{method:"PUT",headers:{"Content-Type":"application/json"}}),V=await R.json();if(!R.ok)throw new Error(V.error||"Failed to reject user");return V}catch(R){throw new Error(R.message||"Network error while rejecting user")}},N=async()=>{try{const E=await fetch(`${Ia}/auth/users`),R=await E.json();if(!E.ok)throw new Error(R.error||"Failed to fetch users");return R}catch(E){throw new Error(E.message||"Network error while fetching users")}},y=async(E,R)=>{try{const V=await fetch(`${Ia}/auth/users/${E}/department`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({department:R})}),P=await V.json();if(!V.ok)throw new Error(P.error||"Failed to update user department");return P}catch(V){throw new Error(V.message||"Network error while updating user department")}},w=async E=>{try{const R=await fetch(`${Ia}/auth/users/${E}`,{method:"DELETE",headers:{"Content-Type":"application/json"}}),V=await R.json();if(!R.ok)throw new Error(V.error||"Failed to delete user");return V}catch(R){throw new Error(R.message||"Network error while deleting user")}},b=async E=>{try{const R=await fetch(`${Ia}/auth/forgot-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:E})}),V=await R.json();if(!R.ok)throw new Error(V.error||"Failed to send reset email");return V}catch(R){throw new Error(R.message||"Network error while sending reset email")}},C=async(E,R)=>{try{const V=await fetch(`${Ia}/auth/reset-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:E,new_password:R})}),P=await V.json();if(!V.ok)throw new Error(P.error||"Failed to reset password");return P}catch(V){throw new Error(V.message||"Network error while resetting password")}},A=()=>{s(null),sessionStorage.removeItem("erpUser")};return t.jsx(Gb.Provider,{value:{user:r,login:d,loginWithGoogle:h,register:m,logout:A,getPendingUsers:f,approveUser:p,rejectUser:g,getAllUsers:N,updateUserDepartment:y,deleteUser:w,forgotPassword:b,resetPassword:C,loading:o},children:e})},$3=()=>{const[e,r]=T.useState({username:"",password:""}),[s,a]=T.useState({full_name:"",email:"",username:"",password:"",department:""}),[n,o]=T.useState(""),[c,d]=T.useState("login"),[h,m]=T.useState(!1),{login:f,users:p,register:g,forgotPassword:N}=Ns(),y=[{id:"admin",name:"Admin",icon:""},{id:"production",name:"Production Planning",icon:""},{id:"purchase",name:"Purchase Department",icon:""},{id:"store",name:"Store Department",icon:""},{id:"assembly",name:"Assembly Team",icon:""},{id:"finance",name:"Finance Department",icon:""},{id:"showroom",name:"Showroom Department",icon:""},{id:"sales",name:"Sales Department",icon:""},{id:"hr",name:"Human Resources Department",icon:""},{id:"dispatch",name:"Dispatch Department",icon:""},{id:"watchman",name:"Watchman Department",icon:""},{id:"transport",name:"Transport Department",icon:""}],w=async A=>{if(A.preventDefault(),!e.username||!e.password){dt({title:"Missing Information",description:"Please enter username and password.",variant:"destructive"});return}try{const E=await f(e);dt({title:"Login Successful!",description:`Welcome, ${E.user.username}!`})}catch(E){dt({title:"Login Failed",description:E.message||"Invalid credentials. Please try again.",variant:"destructive"})}},b=async A=>{A.preventDefault();const R=["full_name","email","username","password"].filter(V=>!s[V]);if(R.length>0){dt({title:"Missing Information",description:`Please fill in all required fields: ${R.join(", ")}`,variant:"destructive"});return}if(!s.department){dt({title:"Department Required",description:"Please select a department for your account.",variant:"destructive"});return}try{const V=await g(s);dt({title:"Registration Successful!",description:V.message||"Your account is pending approval from an administrator."}),a({full_name:"",email:"",username:"",password:"",department:""})}catch(V){V.message&&V.message.includes("already exists")?dt({title:"Username or Email Taken",description:V.message,variant:"destructive"}):dt({title:"Registration Failed",description:V.message||"An error occurred during registration.",variant:"destructive"})}},C=async A=>{if(A.preventDefault(),!n){dt({title:"Missing Email",description:"Please enter your email address.",variant:"destructive"});return}try{const E=await N(n);dt({title:"Reset Email Sent",description:E.message||"If the email exists, a reset link has been sent."}),o("")}catch(E){dt({title:"Failed to Send Reset Email",description:E.message||"An error occurred while sending the reset email.",variant:"destructive"})}};return t.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center p-4",children:t.jsx("div",{className:"w-full max-w-md",children:t.jsxs(He,{className:"bg-white border border-gray-300 shadow-lg",children:[t.jsxs("div",{className:"text-center p-8 border-b border-gray-200",children:[t.jsx("div",{className:"w-16 h-16 bg-blue-700 rounded-sm flex items-center justify-center mx-auto mb-4",children:t.jsx(wf,{className:"w-8 h-8 text-white"})}),t.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Enterprise Resource Planning"}),t.jsx("p",{className:"text-gray-600 text-sm",children:"Official System Access Portal"})]}),t.jsx("div",{className:"p-8",children:t.jsxs(an,{value:c,onValueChange:d,className:"w-full",children:[t.jsxs(ma,{className:"grid w-full grid-cols-2 mb-6 bg-gray-100",children:[t.jsx(xt,{value:"login",className:"data-[state=active]:bg-white data-[state=active]:text-gray-800",children:"System Login"}),t.jsx(xt,{value:"register",className:"data-[state=active]:bg-white data-[state=active]:text-gray-800",children:"Account Registration"})]}),t.jsx(Ut,{value:"login",children:h?t.jsxs("form",{onSubmit:C,className:"space-y-6",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"forgot_email",className:"text-gray-700 font-medium",children:"Email Address"}),t.jsxs("div",{className:"relative",children:[t.jsx(Im,{className:"absolute left-3 top-3 w-4 h-4 text-gray-500"}),t.jsx(Re,{id:"forgot_email",type:"email",value:n,onChange:A=>o(A.target.value),className:"pl-10 border-gray-300 bg-white text-gray-900 focus:border-blue-500 focus:ring-blue-500 placeholder:text-gray-500",placeholder:"Enter your email address"})]})]}),t.jsx(pe,{type:"submit",className:"w-full bg-green-600 hover:bg-green-700 text-white font-medium py-3 rounded-sm",children:"Send Reset Link"}),t.jsx("div",{className:"text-center mt-4",children:t.jsx("button",{type:"button",className:"text-sm text-blue-600 hover:underline",onClick:()=>m(!1),children:"Back to Login"})}),t.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-sm",children:[t.jsx("h3",{className:"text-blue-800 font-medium mb-2",children:"Password Reset Process:"}),t.jsx("p",{className:"text-sm text-blue-700",children:"Enter your email address and we'll send you a link to reset your password. The link will expire in 1 hour."})]})]}):t.jsx(t.Fragment,{children:t.jsxs("form",{onSubmit:w,className:"space-y-6",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"username",className:"text-gray-700 font-medium",children:"Username or Email"}),t.jsxs("div",{className:"relative",children:[t.jsx(Nn,{className:"absolute left-3 top-3 w-4 h-4 text-gray-500"}),t.jsx(Re,{id:"username",type:"text",value:e.username,onChange:A=>r({...e,username:A.target.value}),className:"pl-10 border-gray-300 bg-white text-gray-900 focus:border-blue-500 focus:ring-blue-500 placeholder:text-gray-500",placeholder:"Enter your username or email"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"password",className:"text-gray-700 font-medium",children:"Password"}),t.jsxs("div",{className:"relative",children:[t.jsx(Pv,{className:"absolute left-3 top-3 w-4 h-4 text-gray-500"}),t.jsx(Re,{id:"password",type:"password",value:e.password,onChange:A=>r({...e,password:A.target.value}),className:"pl-10 border-gray-300 bg-white text-gray-900 focus:border-blue-500 focus:ring-blue-500 placeholder:text-gray-500",placeholder:"Enter your password"})]})]}),t.jsx(pe,{type:"submit",className:"w-full bg-blue-700 hover:bg-blue-800 text-white font-medium py-3 rounded-sm",children:"Access System"}),t.jsx("div",{className:"text-right mt-2",children:t.jsx("button",{type:"button",className:"text-sm text-blue-600 hover:underline",onClick:()=>m(!0),children:"Forgot Password?"})})]})})}),t.jsxs(Ut,{value:"register",children:[t.jsxs("form",{onSubmit:b,className:"space-y-6",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"full_name",className:"text-gray-700 font-medium",children:"Full Name"}),t.jsxs("div",{className:"relative",children:[t.jsx(Nn,{className:"absolute left-3 top-3 w-4 h-4 text-gray-500"}),t.jsx(Re,{id:"full_name",type:"text",value:s.full_name,onChange:A=>a({...s,full_name:A.target.value}),className:"pl-10 border-gray-300 bg-white text-gray-900 focus:border-blue-500 focus:ring-blue-500 placeholder:text-gray-500",placeholder:"Enter your full name"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"email",className:"text-gray-700 font-medium",children:"Email Address"}),t.jsxs("div",{className:"relative",children:[t.jsx(Im,{className:"absolute left-3 top-3 w-4 h-4 text-gray-500"}),t.jsx(Re,{id:"email",type:"email",value:s.email,onChange:A=>a({...s,email:A.target.value}),className:"pl-10 border-gray-300 bg-white text-gray-900 focus:border-blue-500 focus:ring-blue-500 placeholder:text-gray-500",placeholder:"Enter your email address"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"reg_username",className:"text-gray-700 font-medium",children:"Username"}),t.jsxs("div",{className:"relative",children:[t.jsx(pu,{className:"absolute left-3 top-3 w-4 h-4 text-gray-500"}),t.jsx(Re,{id:"reg_username",type:"text",value:s.username,onChange:A=>a({...s,username:A.target.value}),className:"pl-10 border-gray-300 bg-white text-gray-900 focus:border-blue-500 focus:ring-blue-500 placeholder:text-gray-500",placeholder:"Choose a username"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"reg_password",className:"text-gray-700 font-medium",children:"Password"}),t.jsxs("div",{className:"relative",children:[t.jsx(Pv,{className:"absolute left-3 top-3 w-4 h-4 text-gray-500"}),t.jsx(Re,{id:"reg_password",type:"password",value:s.password,onChange:A=>a({...s,password:A.target.value}),className:"pl-10 border-gray-300 bg-white text-gray-900 focus:border-blue-500 focus:ring-blue-500 placeholder:text-gray-500",placeholder:"Choose a secure password"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"department",className:"text-gray-700 font-medium",children:"Department Assignment"}),t.jsxs(br,{value:s.department,onValueChange:A=>a({...s,department:A}),children:[t.jsx(jr,{className:"w-full border-gray-300 bg-white text-gray-900 focus:border-blue-500 focus:ring-blue-500",children:t.jsx(Er,{placeholder:"Select your department"})}),t.jsx(Tr,{className:"bg-white text-gray-900 border-gray-300",children:y.map(A=>t.jsx(st,{value:A.id,className:"text-gray-900 hover:bg-gray-100",children:A.name},A.id))})]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select the department you will be assigned to."})]}),t.jsx(pe,{type:"submit",className:"w-full bg-green-600 hover:bg-green-700 text-white font-medium py-3 rounded-sm",children:"Submit Registration"})]}),t.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-sm",children:[t.jsx("h3",{className:"text-blue-800 font-medium mb-2",children:"Registration Process:"}),t.jsx("p",{className:"text-sm text-blue-700",children:"Your registration request will be reviewed by system administrators. You will receive notification once your account is approved."})]})]})]})})]})})})},G3=()=>{const[e]=US(),r=e.get("token")||"",[s,a]=T.useState(""),{resetPassword:n}=Ns(),o=Ls(),c=async d=>{if(d.preventDefault(),!s){dt({title:"Missing Password",description:"Please enter a new password.",variant:"destructive"});return}try{await n(r,s),dt({title:"Password Reset Successful",description:"You can now log in with your new password."}),o("/auth")}catch(h){dt({title:"Reset Failed",description:h.message||"Failed to reset password.",variant:"destructive"})}};return t.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center p-4",children:t.jsx("div",{className:"w-full max-w-md",children:t.jsxs(He,{className:"bg-white border border-gray-300 shadow-lg p-8",children:[t.jsx("h2",{className:"text-gray-900 text-2xl font-bold mb-6 text-center",children:"Reset Password"}),t.jsxs("form",{onSubmit:c,className:"space-y-6",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"new_password",className:"text-gray-700 font-medium",children:"New Password"}),t.jsx(Re,{id:"new_password",type:"password",value:s,onChange:d=>a(d.target.value),placeholder:"Enter your new password",className:"border-gray-300 focus:border-blue-500 focus:ring-blue-500"})]}),t.jsx(pe,{type:"submit",className:"w-full bg-blue-700 hover:bg-blue-800 text-white font-medium py-3 rounded-sm",children:"Reset Password"})]})]})})})},W3=()=>{const{user:e,logout:r}=Ns(),s=Ls(),[a,n]=T.useState({activeOrders:0,pendingPurchases:0,itemsInStock:0,completedToday:0});T.useEffect(()=>{const m=JSON.parse(localStorage.getItem("productionOrders")||"[]"),f=JSON.parse(localStorage.getItem("purchaseOrders")||"[]"),p=JSON.parse(localStorage.getItem("storeInventory")||"[]"),g=JSON.parse(localStorage.getItem("assemblyOrders")||"[]"),N=m.filter(A=>A.status!=="completed").length,y=f.filter(A=>A.status.includes("pending")).length,w=p.reduce((A,E)=>A+E.quantity,0),b=new Date().toDateString(),C=g.filter(A=>A.status==="completed"&&new Date(A.completedAt).toDateString()===b).length;n({activeOrders:N,pendingPurchases:y,itemsInStock:w,completedToday:C})},[]);const o=[{id:"production",name:"Production Planning",icon:fc,color:"from-blue-500 to-blue-600",description:"Manage production orders and planning"},{id:"purchase",name:"Purchase Department",icon:di,color:"from-green-500 to-green-600",description:"Handle material procurement and vendor management"},{id:"store",name:"Store Department",icon:Ks,color:"from-purple-500 to-purple-600",description:"Inventory management and stock control"},{id:"assembly",name:"Assembly Team",icon:Jo,color:"from-orange-500 to-orange-600",description:"Product assembly and quality control"},{id:"finance",name:"Finance Department",icon:An,color:"from-yellow-500 to-yellow-600",description:"Financial management and reporting"},{id:"showroom",name:"Showroom Department",icon:Il,color:"from-pink-500 to-pink-600",description:"Product display and customer interaction"},{id:"sales",name:"Sales Department",icon:Cn,color:"from-emerald-500 to-emerald-600",description:"Sales management and customer orders"},{id:"dispatch",name:"Dispatch Department",icon:KN,color:"from-indigo-500 to-indigo-600",description:"Order processing and delivery coordination"},{id:"watchman",name:"Watchman Department",icon:ni,color:"from-red-500 to-red-600",description:"Gate security and pickup verification"},{id:"transport",name:"Transport Department",icon:rn,color:"from-cyan-500 to-cyan-600",description:"Vehicle fleet and delivery management"},{id:"hr",name:"Human Resources Department",icon:Nr,color:"from-purple-500 to-purple-600",description:"Employee management and HR operations"}],c=m=>{e.department==="admin"||e.department===m?s(`/dashboard/${m}`):alert("Access denied. You can only access your assigned department.")},d=()=>{r(),s("/auth")},h=e?.department==="admin";return t.jsx("div",{className:"min-h-screen bg-gray-100",children:t.jsxs("div",{className:"max-w-7xl mx-auto",children:[t.jsx("div",{className:"bg-white border-b-4 border-blue-700 shadow-sm",children:t.jsx("div",{className:"px-4 py-4 sm:px-6 sm:py-4",children:t.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:justify-between sm:items-center sm:space-y-0",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:"w-10 h-10 bg-blue-700 rounded-sm flex items-center justify-center",children:t.jsx(wf,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-800",children:"Enterprise Resource Planning System"}),t.jsxs("p",{className:"text-gray-600 text-sm",children:["Welcome, ",e?.username]})]})]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("div",{className:"flex items-center space-x-2 bg-gray-50 border border-gray-300 rounded-sm px-4 py-2",children:[h?t.jsx(yn,{className:"w-4 h-4 text-blue-700"}):t.jsx(Nn,{className:"w-4 h-4 text-gray-700"}),t.jsx("span",{className:"font-medium text-gray-800 text-sm",children:e?.departmentName})]}),t.jsxs(pe,{onClick:d,variant:"outline",className:"border-red-400 text-red-700 hover:font-medium",children:[t.jsx(xu,{className:"w-4 h-4 mr-2"}),"Logout"]})]})]})})}),t.jsxs("div",{className:"px-4 py-6 sm:px-6",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"Department Access"}),t.jsx("p",{className:"text-gray-600 text-sm",children:"Select a department to access its management system"})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map((m,f)=>{const p=m.icon,g=h||e.department===m.id;return t.jsx("div",{children:t.jsxs(He,{className:`transition-all duration-200 cursor-pointer border ${g?"bg-white border-gray-300 shadow-sm hover:shadow-md hover:border-blue-400":"bg-gray-50 border-gray-200 opacity-60 cursor-not-allowed"}`,onClick:()=>c(m.id),children:[t.jsxs(rt,{className:"pb-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:`w-10 h-10 rounded-sm flex items-center justify-center ${g?"bg-blue-100":"bg-gray-200"}`,children:t.jsx(p,{className:`w-5 h-5 ${g?"text-blue-700":"text-gray-500"}`})}),g&&t.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"})]}),t.jsx(at,{className:`text-lg ${g?"text-gray-800":"text-gray-500"}`,children:m.name})]}),t.jsxs(Ve,{className:"pt-0",children:[t.jsx("p",{className:`text-sm mb-4 ${g?"text-gray-600":"text-gray-400"}`,children:m.description}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:`text-xs px-2 py-1 rounded-sm border ${g?"bg-green-50 text-green-700 border-green-300":"bg-red-50 text-red-700 border-red-300"}`,children:g?"Authorized":"Access Denied"}),g&&t.jsx(pe,{size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white text-xs px-3 py-1",children:"Enter"})]})]})]})},m.id)})})]})]})})},Fe="http://localhost:5000/api",z3=Vu("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Lt({className:e,variant:r,...s}){return t.jsx("div",{className:Pr(z3({variant:r}),e),...s})}const My={RCM:[{name:"PLATE /EARTH COMPACTOR 5HP GREVES ENGINE WITH CLUCH PULLY -HD",materials:[{name:"Material A",quantity:2},{name:"Material B",quantity:3}]},{name:"PLATE /EARTH COMPACTOR 5HP GREVES ENGINE WITH CLUCH PULLY - LD",materials:[]},{name:"PLATE /EARTH COMPACTOR 5HP GREVES ENGINE WITH REGULER PULLY - LD",materials:[]},{name:"PLATE /EARTH COMPACTOR CHASSIS WITH REGULER PULLY-LD",materials:[]},{name:"PLATE /EARTH COMPACTOR CHASSIS WITH CLUCH PULLY-LD",materials:[]},{name:"PLATE /EARTH COMPACTOR CHASSIS WITH REGULER PULLY",materials:[]},{name:"PLATE /EARTH COMPACTOR CHASSIS WITH CLUCH PULLY",materials:[]},{name:"ALANKAR MAKE WALK BEHIND ROLLER WITH 10 HP GREAVES ENGINE SELF START",materials:[]},{name:"C-90 PLATE COMPACTOR WITH HONDA ENGINE",materials:[]},{name:"C-90 PLATE COMPACTOR WITH E AGRO ENGINE",materials:[]},{name:"C-90 PLATE COMPACTOR CHESSIS",materials:[]},{name:"HONDA PETROL ENGINE  GX160 5 HP",materials:[]},{name:"HONDA PETROL ENGINE GX 390 5 HP ROPE START",materials:[]},{name:"HONDA PETROL ENGINE GX 390 5 HP SELF START",materials:[]},{name:"E-AGRO PETROL ENGINE 5 HP",materials:[]},{name:"13 HP HANDAL START WATER COOLED VST MAKE ENGINE",materials:[]},{name:"BULL FLOATER",materials:[]},{name:"TEXTURING BRUSH",materials:[]},{name:"ALANKAR MAKE BAR BENDING MACHINE 42 PRO",materials:[]},{name:"FLOATER   WITH 2 HP SINGAL PHASE  ELECTRIC MOTOR (CROMPECH)",materials:[]},{name:"FLOATER   WITH 2 HP SINGAL PHASE ELECTRIC MOTOR (CROMPTON)",materials:[]},{name:"FLOATER   WITH 2 HP SINGAL PHASE ELECTRIC MOTOR (SGL)",materials:[]},{name:"ALANKAR MAKE 3 PHASE FLOTER MACHINE WITH ELECTRIC MOTER 3 HP (DHANSHREE MAKE)",materials:[]},{name:"FLOTER  5 HP PETROL ENGINE (HONDA)",materials:[]},{name:"FLOTER  5 HP PETROL ENGINE (E-AGRO)",materials:[]},{name:"FLOATER  CHESSIS",materials:[]},{name:"CONCREATE NEEDLE VIBRATOR 45 MM WITH 5 HP HONDA ENGINE",materials:[]},{name:"CONCREATE NEEDLE VIBRATOR 45 MM WITH 5 HP E-AGRO ENGINE",materials:[]},{name:"CONCREATE NEEDLE VIBRATOR 60 MM WITH 5 HP HONDA ENGINE",materials:[]},{name:"CONCREATE NEEDLE VIBRATOR 60 MM WITH 5 HP E-AGRO ENGINE",materials:[]},{name:"CONCREATE NEEDLE VIBRATOR 45 MM WITH 3 HP ELECTRIC MOTOR",materials:[]},{name:"CONCREATE NEEDLE VIBRATOR 60 MM WITH 3 HP ELECTRIC MOTOR",materials:[]},{name:"2 M SCREED VIBRATOR (SS)WITH 0.5 HP HONDA PETROL ENGINE",materials:[]},{name:" 3 M SCREED VIBRATOR(SS) WITH 0.5 HP HONDA PETROL ENGINE",materials:[]},{name:"ALANKAR MAKE 4.3 METER SCREED VIBRATOR MACHINE WITH 5 HP HONDA PETROL ENGINE",materials:[]},{name:"ALANKAR MAKE 4.3 METER SCREED VIBRATOR MACHINE WITH E-AGRO PETROL ENGINE",materials:[]},{name:"ALANKAR MAKE 3.2 METER SCREED VIBRATOR MACHINE WITH 5 HP HONDA PETROL ENGINE",materials:[]},{name:"ALANKAR MAKE 3.2 METER SCREED VIBRATOR MACHINE WITH E-AGRO PETROL ENGINE",materials:[]},{name:"ALANKAR MAKE 5.2 METER SCREED VIBRATOR MACHINE WITH 5 HP HONDA PETROL ENGINE",materials:[]},{name:"ALANKAR MAKE 5.2 METER SCREED VIBRATOR MACHINE WITH E-AGRO PETROL ENGINE",materials:[]},{name:"ALANKAR MAKE 11.7 HP 110MM GCM WITH ROPE START HONDA ENGINE ",materials:[]},{name:"ALANKAR MAKE 11.7 HP 110MM GCM WITH ROPE START HONDA ENGINE-LD",materials:[]},{name:"ALANKAR MAKE 11.7 HP 110MM GCM WITH SELF START HONDA ENGINE ",materials:[]},{name:"ALANKAR MAKE 11.7 HP 110MM GCM WITH SELF START HONDA ENGINE-LD",materials:[]},{name:"ALANKAR MAKE 8.3 HP 110MM GCM WITH COTTON GREAVES ROPE START DI ENGINE",materials:[]},{name:"ALANKAR MAKE 8.3 HP 110MM GCM WITH COTTON GREAVES ROPE START DI ENGINE-LD",materials:[]},{name:"ALANKAR MAKE 8.3 HP 110MM GCM WITH COTTON GREAVES ROPE START DI ENGINE (WITHOUT NAME & NUMBER) ",materials:[]},{name:"ALANKAR MAKE 8.3 HP 110MM GCM WITH COTTON GREAVES ROPE START DI ENGINE (WITHOUT NAME & NUMBER)-LD",materials:[]},{name:"ALANKAR MAKE 8.3 HP 110MM GCM WITH COTTON GREAVES SELF START DI ENGINE",materials:[]},{name:"ALANKAR MAKE 10 HP  110MM GCM WITH SELF ROPE KOLHER ENGINE",materials:[]},{name:"ALANKAR MAKE 10 HP  110MM GCM WITH SELF START KOLHER ENGINE",materials:[]},{name:"ALANKAR MAKE 13 HP 200 MM GCM WITH HANDAL START WATER COOLED VST MAKE ENGINE",materials:[]},{name:"ALANKAR MAKE 13 HP 200 MM GCM WITH HANDAL START WATER COOLED VST MAKE ENGINE-LD",materials:[]},{name:"ALANKAR MAKE 13 HP 200 MM GCM WITH HANDAL START WATER COOLED VST MAKE ENGINE (WITHOUT NAME & NUMBER) ",materials:[]},{name:"ALANKAR MAKE 13 HP 200 MM GCM WITH HANDAL START WATER COOLED VST MAKE ENGINE (WITHOUT NAME & NUMBER)-LD",materials:[]},{name:"ALANKAR MAKE 13 HP 200 MM ECM WITH HANDAL START WATER COOLED VST MAKE ENGINE",materials:[]},{name:"ALANKAR MAKE 13 HP 240 MM GCM WITH HANDAL START WATER COOLED VST MAKE ENGINE",materials:[]},{name:"ALANKAR MAKE 13 HP 240 MM GCM WITH HANDAL START WATER COOLED VST MAKE ENGINE-LD",materials:[]},{name:"ALANKAR MAKE 13 HP 240 MM ECM WITH HANDAL START WATER COOLED VST MAKE ENGINE",materials:[]},{name:"ALANKAR MAKE 13 HP 300 MM GCM WITH HANDAL START WATER COOLED VST MAKE ENGINE",materials:[]},{name:"ALANKAR MAKE 13 HP 300 MM ECM WITH HANDAL START WATER COOLED VST MAKE ENGINE",materials:[]},{name:"ALANKAR MAKE 7.5 HP 75MM GCM WITH ELECTRIC SIEMENSE MAKE MOTOR",materials:[]},{name:"ALANKAR MAKE 7.5 HP 75MM GCM WITH ELECTRIC SIEMENSE MAKE MOTOR-LD",materials:[]},{name:"ALANKAR MAKE 10 HP 125MM GCM WITH ELECTRIC SIEMENSE MAKE MOTOR",materials:[]},{name:"ALANKAR MAKE 10 HP 125MM GCM WITH ELECTRIC SIEMENSE MAKE MOTOR-LD",materials:[]},{name:"ALANKAR MAKE 15 HP 200MM GCM WITH ELECTRIC SIEMENSE MAKE MOTOR",materials:[]},{name:"ALANKAR MAKE 15 HP 200MM GCM WITH ELECTRIC SIEMENSE MAKE MOTOR-LD",materials:[]},{name:"ALANKAR MAKE 15 HP 240MM GCM WITH ELECTRIC SIEMENSE MAKE MOTOR",materials:[]},{name:"ALANKAR MAKE 15 HP 240MM GCM WITH ELECTRIC SIEMENSE MAKE MOTOR-LD",materials:[]},{name:"ALANKAR MAKE 15 HP 320MM GCM WITH ELECTRIC SIEMENSE MAKE MOTOR",materials:[]},{name:"ALANKAR MAKE 20 HP 320MM GCM WITH ELECTRIC SIEMENSE MAKE MOTOR",materials:[]},{name:"ALANKAR MAKE 20 HP 350MM GCM WITH ELECTRIC SIEMENSE MAKE MOTOR",materials:[]},{name:"ALANKAR MAKE 20 HP 350MM ECM WITH ELECTRIC SIEMENSE MAKE MOTOR",materials:[]},{name:"ALANKAR MAKE 25 HP 350MM GCM WITH ELECTRIC SIEMENSE MAKE MOTOR",materials:[]},{name:"ALANKAR MAKE 25 HP 400MM GCM WITH ELECTRIC SIEMENSE MAKE MOTOR",materials:[]},{name:"ALANKAR MAKE 25 HP 400MM ECM WITH ELECTRIC SIEMENSE MAKE MOTOR",materials:[]},{name:"ALANKAR MAKE 30 HP 400MM GCM WITH ELECTRIC SIEMENSE MAKE MOTOR",materials:[]},{name:"ALANKAR MAKE 30 HP 450MM GCM WITH ELECTRIC SIEMENSE MAKE MOTOR",materials:[]},{name:"ALANKAR MAKE 30 HP 450MM ECM WITH ELECTRIC SIEMENSE MAKE MOTOR",materials:[]},{name:"ALANKAR MAKE 13 HP TEXTURING MACHINE WITH HANDAL START WATER COOLED VST MAKE ENGINE",materials:[]},{name:"ALANKAR MAKE 15 HP HARD TEXTURING MACHINE WITH SIEMENSE MAKE MOTOR",materials:[]},{name:"ALANKAR MAKE 15 HP 320 MM SLAB CUTTING MACHINE WITH SIEMENSE MAKE MOTOR",materials:[]},{name:"ALANKAR MAKE 11.7 HP 240 MM CCM HONDA MAKE SELF START ENGINE",materials:[]},{name:"ALANKAR MAKE 8.3 HP 110MM GCM CHASSIS",materials:[]},{name:"ALANKAR MAKE 8.3 HP 110MM GCM CHASSIS (WITHOUT NAME & NUMBER) ",materials:[]},{name:"ALANKAR MAKE 13 HP 200 MM GCM CHASSIS",materials:[]},{name:"ALANKAR MAKE 13 HP 200 MM GCM CHASSIS (WITHOUT NAME & NUMBER) ",materials:[]},{name:"ALANKAR MAKE 13 HP 300 MM GCM CHASSIS",materials:[]},{name:"ALANKAR MAKE 13 HP 300 MM GCM CHASSIS (WITHOUT NAME & NUMBER) ",materials:[]},{name:"ALANKAR MAKE 13 HP TEXTURING MACHINE CHASSIS",materials:[]},{name:"ALANKAR MAKE 13 HP TEXTURING MACHINE CHASSIS (WITHOUT NAME & NUMBER) ",materials:[]},{name:"ALANKAR MAKE GCM CUTTER GUARD 16'",materials:[]},{name:"ALANKAR MAKE GCM CUTTER GUARD 20'",materials:[]},{name:"ALANKAR MAKE GCM CUTTER GUARD 24'",materials:[]},{name:"ALANKAR MAKE GCM CUTTER GUARD 32'",materials:[]},{name:"ALANKAR MAKE GCM CUTTER GUARD 36'",materials:[]},{name:"ALANKAR MAKE GCM CUTTER GUARD 40'",materials:[]},{name:"ALANKAR MAKE GCM CUTTER GUARD 44'",materials:[]},{name:"ALANKAR MAKE DIAMOND BLADE 8'' X 3 MM",materials:[]},{name:"ALANKAR MAKE  DIAMOND BLADE 8'' X 5.2 MM",materials:[]},{name:"ALANKAR MAKE  DIAMOND BLADE 10'' X 3.5 MM",materials:[]},{name:"ALANKAR MAKE  DIAMOND BLADE 12'' X 3.5 MM",materials:[]},{name:"ALANKAR MAKE DIAMOND BLADE 14'' X 3.5 MM",materials:[]},{name:"ALANKAR MAKE DIAMOND BLADE 14'' X 5.2 MM",materials:[]},{name:"ALANKAR MAKE DIAMOND BLADE 14'' X 6.5 MM",materials:[]},{name:"ALANKAR MAKE DIAMOND BLADE 14'' X 8 MM",materials:[]},{name:"ALANKAR MAKE DIAMOND BLADE 14'' X 10 MM",materials:[]},{name:"ALANKAR MAKE DIAMOND BLADE 16'' X 3.5 MM",materials:[]},{name:"ALANKAR MAKE DIAMOND BLADE 16'' X 4.0 MM",materials:[]},{name:"ALANKAR MAKE DIAMOND BLADE 16'' X 6.5 MM",materials:[]},{name:"ALANKAR MAKE DIAMOND BLADE 18'' X 4.2 MM",materials:[]},{name:"ALANKAR MAKE DIAMOND BLADE 18'' X 6.5 MM",materials:[]},{name:"ALANKAR MAKE DIAMOND BLADE 20'' X 3.5 MM",materials:[]},{name:"ALANKAR MAKE DIAMOND BLADE 20'' X 4.5 MM",materials:[]},{name:"ALANKAR MAKE DIAMOND BLADE 22'' X 4.2 MM",materials:[]},{name:"ALANKAR MAKE DIAMOND BLADE 22'' X 4.5 MM",materials:[]},{name:"ALANKAR MAKE DIAMOND BLADE 22'' X 5.2 MM",materials:[]},{name:"ALANKAR MAKE DIAMOND BLADE 24'' X 4.5 MM",materials:[]},{name:"ALANKAR MAKE DIAMOND BLADE 24'' X 5.2 MM",materials:[]},{name:"ALANKAR MAKE DIAMOND BLADE 30'' X 6.5 MM",materials:[]},{name:"ALANKAR MAKE DIAMOND BLADE 32'' X 6.4 MM",materials:[]},{name:"ALANKAR MAKE DIAMOND BLADE 36'' X 8 MM",materials:[]},{name:"ALANKAR MAKE DIAMOND BLADE 40'' X 8 MM",materials:[]},{name:"ALANKAR MAKE DIAMOND BLADE 44'' X 8 MM",materials:[]},{name:"ALANKAR MAKE DIAMOND BLADE 54'' X 9 MM",materials:[]},{name:"ALANKAR MAKE BANDSAW BLADE NACHI",materials:[]},{name:"ALANKAR MAKE DOWEL BAR CUTTING MACHINE",materials:[]},{name:"ALANKAR MAKE FLOATER DISK  1100 X 3 ",materials:[]},{name:"ALANKAR MAKE FLOATER BLADE 340 X 150 X 2.5",materials:[]},{name:"ALANKAR MAKE FLOATER BLADE 310 X 180 X 2.5",materials:[]},{name:"ALANKAR MAKE FLOATER BLADE 350 X 140 X 2.5",materials:[]},{name:"ALANKAR MAKE FLOATER BLADE 350 X 121 X 2.5",materials:[]}],BCE:[{name:"SINGLE WHEEL BARROW 30 KG",materials:[]},{name:"SINGLE WHEEL BARROW 21KG (PIPE)",materials:[]},{name:"SINGAL WHEEL BARROW 21 KG ( PIPE) WITH CHAIN",materials:[]},{name:"SINGAL WHEEL BARROW 22 KG APPROX  (GSB)",materials:[]},{name:"DOUBLE WHEEL BARROW  (32 KG)",materials:[]},{name:"DOUBLE WHEEL BARROW WITH CHAIN",materials:[]},{name:"DOUBLE WHEEL BARROW WITH 15' TYRE (32 KG)",materials:[]},{name:"DOUBLE WHEEL BARROW 27KG (PIPE)",materials:[]},{name:"SINGAL WHEEL BARROW WITH CHAIN ",materials:[]},{name:"SINGAL WHEEL BARROW LIGHT ",materials:[]},{name:"SINGAL WHEEL ASSEMBLY (TYRE / TUBE / SHAFT / DISK )",materials:[]},{name:"SINGAL WHEEL WITH DISK 3.50.8",materials:[]},{name:"SINGAL WHEEL BARROW DISK 3.50.8",materials:[]},{name:"SINGAL WHEEL TYRE 3.50.8",materials:[]},{name:"SINGAL WHEEL TUBE 3.50.8",materials:[]},{name:"SINGAL WHEEL BARROW SHAFT",materials:[]},{name:"15' SOLID TYRE COMPLETE ASSEMBLY WITH 6205 BEARING",materials:[]},{name:"TYRE 4.00.8 WITH BERING 62.5 ZZ WITH DISK",materials:[]},{name:"TYRE 4.00.8 WITH BERING 62.6  ZZ",materials:[]},{name:"SINGAL WHEEL BARROW DISK 4.00.8",materials:[]},{name:"SINGAL WHEEL TYRE 4.00.8",materials:[]},{name:"SINGAL WHEEL TUBE  4.00.8",materials:[]},{name:"ALANKAR MAKE CONCRETE TRAY GALVANISED WITH 4 NOS HANDAL ",materials:[]},{name:"VIBRATING TABLE MOTER 2 HP 3 PHASE(SGL)",materials:[]},{name:"VIBRATING TABLE MOTER 2 HP 3 PHASE(DEEP)",materials:[]},{name:"VIBRATING TABLE MOTER 2 HP SINGAL PHASE(SGL)",materials:[]},{name:"VIBRATING TABLE MOTER 2 HP SINGAL PHASE(DEEP)",materials:[]},{name:"PRICAST TABLE VIBRATING MOTOR 1 HP SINGAL PHASE (DEEP)",materials:[]},{name:"FOOT MOUNTING MOTER 2 HP SINGAL PHASE (SGL)",materials:[]},{name:"FOOT MOUNTING MOTER 2 HP SINGAL PHASE (CROMPECH)",materials:[]},{name:"FOOT MOUNTING MOTER 3 HP SINGAL PHASE (SGL)",materials:[]},{name:"FOOT MOUNTING MOTER 3 HP SINGAL PHASE (CROMPECH)",materials:[]},{name:"FOOT MOUNTING MOTER 3 HP 3 PHASE (SGL)",materials:[]},{name:"FOOT MOUNTING MOTER 3 HP 3 PHASE (CROMPECH)",materials:[]},{name:"FLANGE MOUTING MOTER 5 HP 3 PHASE (CG)",materials:[]},{name:"FLANGE MOUTING MOTER 5 HP 3 PHASE (CROMPECH)",materials:[]},{name:"FLANGE MOUTING MOTER 7.5 HP 3 PHASE (CG)",materials:[]},{name:"GEARBOX 2 HP (BEACON)",materials:[]},{name:"GEARBOX 5 HP (BEACON)",materials:[]},{name:"GEARBOX 7.5 HP (BEACON)",materials:[]},{name:"ALANKAR MAKE ONE BAG MIXER HANDI MS",materials:[]},{name:"ALANKAR MAKE ONE BAG MIXER HANDI CI",materials:[]},{name:"ALANKAR MAKE HALF BAG MIXER HANDI MS",materials:[]},{name:"ALANKAR MAKE 1.5 HP (SEEMA)ELECTRIC HALF BAG TILTING MIXER ",materials:[]},{name:"HALF BAG MIXER WITH 2 HP SINGAL PHASE ELECTRIC MOTOR ( CROMPECH) & M.S.HANDI WITH 15' TYRE ",materials:[]},{name:"HALF BAG MIXER WITH 2 HP  SINGLE PHASE ELECTRIC MOTOR ( CROMPECH) & M.S.HANDI WITH 4.00-8 TYRE ",materials:[]},{name:"HALF BAG MIXER WITH 2 HP SINGLE PHASE ELECTRIC MOTOR ( CROMPTON) & M.S.HANDI & M.S.HANDI WITH 15' TYRE ",materials:[]},{name:"HALF BAG MIXER WITH 2 HP SINGLE PHASE ELECTRIC MOTOR ( CROMPTON) & M.S.HANDI & M.S.HANDI WITH 4.00-8 TYRE ",materials:[]},{name:"HALF BAG MIXER WITH 2 HP SINGLE PHASE ELECTRIC MOTOR ( SGL ) & M.S.HANDI & M.S.HANDI WITH 15' TYRE ",materials:[]},{name:"HALF BAG MIXER WITH 2HP SINGLE PHASE ELECTRIC MOTOR ( SGL ) & M.S.HANDI & M.S.HANDI WITH 4.00-8 TYRE ",materials:[]},{name:"HALF BAG MIXER WITH 2 HP SINGLE PHASE ELECTRIC MOTOR (CROMPTON) & C.I.HANDI",materials:[]},{name:"HALF BAG MIXER WITH 2 HPSINGLE PHASE ELECTRIC MOTOR (SGL) & C.I.HANDI",materials:[]},{name:"HALF BAG MIXER WITH 5 HP DISEL ENGINE (CHETAK) & M.S.HANDI WITH 4.00-8 TYRE",materials:[]},{name:"HALF BAG MIXER WITH 5 HP DISEL ENGINE (HTC) & M.S.HANDI WITH 4.00-8 TYRE",materials:[]},{name:"HALF BAG MIXER WITH 5 HP DISEL ENGINE (CHETAK) & 2 HP SINGLE PHASE ELECTRIC MOTOR ( CROMPECH) WITH  ( M.S.HANDI ) & 4.00-8 TYRE",materials:[]},{name:"HALF BAG MIXER WITH 5 HP DISEL ENGINE (CHETAK) & 2 HP THREE PHASE ELECTRIC MOTOR ( CROMPECH) WITH  ( M.S.HANDI ) & 4.00-8 TYRE",materials:[]},{name:"ONE BAG STAND TYPE  CONCRETE MIXER WITH 3 HP  SINGAL PHASE ELECTRIC MOTOR (CROMPTON)MS HANDI",materials:[]},{name:"ONE BAG STAND TYPE  CONCRETE MIXER WITH 3 HP  SINGAL PHASE ELECTRIC MOTOR (CROMPTON)CI HANDI",materials:[]},{name:"ONE BAG STAND TYPE  CONCRETE MIXER WITH 3 HP THREE PHASE ELECTRIC MOTOR (CROMPTON)MS HANDI",materials:[]},{name:"ONE BAG STAND TYPE  CONCRETE MIXER WITH 3 HP THREE PHASE ELECTRIC MOTOR (CROMPTON) CI HANDI",materials:[]},{name:"ONE BAG STAND TYPE  CONCRETE MIXER WITH 3 HP SINGAL PHASE ELECTRIC MOTOR (SGL)MS HANDI",materials:[]},{name:"ONE BAG STAND TYPE  CONCRETE MIXER WITH 3 HP SINGAL PHASE ELECTRIC MOTOR (SGL)CI HANDI",materials:[]},{name:"ONE BAG STAND TYPE  CONCRETE MIXER WITH 3 HP THREE PHASE ELECTRIC MOTOR (SGL)MS HANDI",materials:[]},{name:"ONE BAG STAND TYPE  CONCRETE MIXER WITH 3 HP THREE PHASE ELECTRIC MOTOR (SGL)CI HANDI",materials:[]},{name:"ONE BAG STAND TYPE  CONCRETE MIXER WITH 3 HP SINGAL PHASE ELECTRIC MOTOR ( CROMPECH) MS HANDI",materials:[]},{name:"ONE BAG STAND TYPE  CONCRETE MIXER WITH 3 HP SINGAL PHASE ELECTRIC MOTOR ( CROMPECH) CI HANDI",materials:[]},{name:"ONE BAG STAND TYPE  CONCRETE MIXER WITH 3 HP SINGAL PHASE ELECTRIC MOTOR ( DEEP ) MS HANDI",materials:[]},{name:"ONE BAG STAND TYPE  CONCRETE MIXER WITH 3 HP SINGAL PHASE ELECTRIC MOTOR ( DEEP ) CI HANDI",materials:[]},{name:"ONE BAG STAND TYPE  CONCRETE MIXER WITH 3 HP THREE PHASE ELECTRIC MOTOR ( CROMPECH) MS HANDI",materials:[]},{name:"ONE BAG STAND TYPE  CONCRETE MIXER WITH 3 HP THREE PHASE ELECTRIC MOTOR ( CROMPECH) CI HANDI",materials:[]},{name:"ONE BAG STAND TYPE  CONCRETE MIXER WITH 3 HP THREE PHASE ELECTRIC MOTOR ( DEEP ) MS HANDI",materials:[]},{name:"ONE BAG STAND TYPE  CONCRETE MIXER WITH 3 HP THREE PHASE ELECTRIC MOTOR ( DEEP ) CI HANDI",materials:[]},{name:"ONE BAG STAND TYPE  CONCRETE MIXER WITH MS HANDI",materials:[]},{name:"ONE BAG STAND TYPE  CONCRETE MIXER WITH CI HANDI",materials:[]},{name:"ONE BAG CONCRETE MIXER WITH 3 HP SINGAL PHASE ELECTRIC MOTOR (CROMPTON) & 5.00-19 TYRE MS HANDI",materials:[]},{name:"ONE BAG CONCRETE MIXER WITH 3 HP SINGAL PHASE ELECTRIC MOTOR (CROMPTON) & 5.00-19 TYRE CI HANDI",materials:[]},{name:"ONE BAG CONCRETE MIXER WITH 3 HP TREE PHASE ELECTRIC MOTOR (CROMPTON) & 5.00-19 TYRE  MS HANDI",materials:[]},{name:"ONE BAG CONCRETE MIXER WITH 3 HP TREE PHASE ELECTRIC MOTOR (CROMPTON) & 5.00-19 TYRE  CI HANDI",materials:[]},{name:"ONE BAG CONCRETE MIXER WITH 3 HP SINGAL PHASE ELECTRIC MOTOR (CROMPECH) & 5.00-19 TYRE  MS HANDI",materials:[]},{name:"ONE BAG CONCRETE MIXER WITH 3 HP SINGAL PHASE ELECTRIC MOTOR (CROMPECH) & 5.00-19 TYRE CI HANDI",materials:[]},{name:"ONE BAG CONCRETE MIXER WITH 3 HP THREE PHASE ELECTRIC MOTOR (CROMPECH) & 5.00-19 TYRE MS HANDI",materials:[]},{name:"ONE BAG CONCRETE MIXER WITH 3 HP THREE PHASE ELECTRIC MOTOR (CROMPECH) & 5.00-19 TYRE CI HANDI",materials:[]},{name:"ONE BAG CONCRETE MIXER WITH 3 HP SINGAL PHASE ELECTRIC MOTOR (SGL) & 5.00-19 TYRE  MS HANDI",materials:[]},{name:"ONE BAG CONCRETE MIXER WITH 3 HP SINGAL PHASE ELECTRIC MOTOR (SGL) & 5.00-19 TYRE  CI HANDI",materials:[]},{name:"ONE BAG CONCRETE MIXER WITH 3 HP THREE PHASE ELECTRIC MOTOR (SGL) & 5.00-19 TYRE  MS HANDI",materials:[]},{name:"ONE BAG CONCRETE MIXER WITH 3 HP THREE PHASE ELECTRIC MOTOR (SGL) & 5.00-19 TYRE  CI HANDI",materials:[]},{name:"ONE BAG CONCRETE MIXER WITH 6.5 HP DIESEL ENGINE (CHETAK) & 5.00-19 TYRE MS HANDI",materials:[]},{name:"ONE BAG CONCRETE MIXER WITH 6.5 HP DIESEL ENGINE (CHETAK) & 5.00-19 TYRE CI HANDI",materials:[]},{name:"ONE BAG CONCRETE MIXER WITH 6.5 HP DIESEL ENGINE (HTC) & 5.00-19 TYRE MS HANDI",materials:[]},{name:"ONE BAG CONCRETE MIXER WITH 6.5 HP DIESEL ENGINE (HTC) & 5.00-19 TYRE CI HANDI",materials:[]},{name:"ONE BAG CONCRETE MIXER WITH 6.5 HP DIESEL ENGINE (MARSHAL) & 5.00-19 TYRE MS HANDI",materials:[]},{name:"ONE BAG CONCRETE MIXER WITH 6.5 HP DIESEL ENGINE (MARSHAL) & 5.00-19 TYRE CI HANDI",materials:[]},{name:"ONE BAG MIXER WITH 6.5 HP DISEL ENGINE (HTC) & 3 HP SINGLE PHASE ELECTRIC MOTOR ( CROMPECH) WITH  (M.S.HANDI ) & 5.00-19 TYRE",materials:[]},{name:"ONE BAG MIXER WITH 6.5 HP DISEL ENGINE (HTC) & 3 HP THREE PHASE ELECTRIC MOTOR (CROMPECH) WITH  (M.S.HANDI ) & 5.00-19 TYRE",materials:[]},{name:"ONE BAG HYDRAULIC HOPPER CONCRETE MIXER WITH 8HP DIESEL ENGINE (CHETAK) & 5.00-19  TYRE MS HANDI",materials:[]},{name:"ONE BAG HYDRAULIC HOPPER CONCRETE MIXER WITH 8HP DIESEL ENGINE (CHETAK) & 5.00-19  TYRE CI HANDI",materials:[]},{name:"ONE BAG HYDRAULIC HOPPER CONCRETE MIXER WITH 8HP DIESEL ENGINE (HTC) & 5.00-19  TYRE MS HANDI",materials:[]},{name:"ONE BAG HYDRAULIC HOPPER CONCRETE MIXER WITH 8 HP DIESEL ENGINE (HTC) & 5.00-19  TYRE CI HANDI",materials:[]},{name:"ONE BAG HYDRAULIC HOPPER CONCRETE MIXER WITH 8 HP DIESEL ENGINE (CHETAK) & 6.00-16 TYRE MS HANDI",materials:[]},{name:"ONE BAG HYDRAULIC HOPPER CONCRETE MIXER WITH 8 HP DIESEL ENGINE (CHETAK) & 6.00-16 TYRE CI HANDI",materials:[]},{name:"ONE BAG HYDRAULIC HOPPER CONCRETE MIXER WITH 8 HP DIESEL ENGINE  (HTC) & 6.00-16 TYRE MS HANDI",materials:[]},{name:"ONE BAG HYDRAULIC HOPPER CONCRETE MIXER WITH 8 HP DIESEL ENGINE  (HTC) & 6.00-16 TYRE CI HANDI",materials:[]},{name:"ONE BAG HYDRAULIC HOPPER CONCRETE MIXER WITH 7.5 HP THREE PHASE ELECTRIC MOTOR (SGL) & 5.00-19 TYRE MS HANDI",materials:[]},{name:"ONE BAG HYDRAULIC HOPPER CONCRETE MIXER WITH 7.5 HP THREE PHASE ELECTRIC MOTOR (SGL )& 5.00-19 TYRE CI HANDI",materials:[]},{name:"FOUR WHEEL TROLLY WITH 4.00-8 TYRE ",materials:[]},{name:"VIBRATING TABLE WITH 2 HP SINGAL PHASE MOTER (SGL)",materials:[]},{name:"VIBRATING TABLE WITH 2 HP THREE PHASE MOTER (SGL)",materials:[]},{name:"VIBRATING TABLE WITH 2 HP SINGAL PHASE MOTER (DEEP)",materials:[]},{name:"VIBRATING TABLE WITH 2 HP THREE PHASE MOTER (DEEP)",materials:[]},{name:"COLOR MIXER 2 HP SINGAL PHASE MOTOR (SGL) WITH GEAR BOX ",materials:[]},{name:"COLOR MIXER 2 HP THREE PHASE MOTOR (SGL) WITH GEAR BOX ",materials:[]},{name:"COLOR MIXER 2 HP SINGAL PHASE MOTOR (CROMPTON) WITH GEAR BOX ",materials:[]},{name:"COLOR MIXER 2 HP THREE PHASE MOTOR (CROMPTON) WITH GEAR BOX ",materials:[]},{name:"COLOR MIXER 2 HP SINGAL PHASE MOTOR (CROMPECH) WITH GEAR BOX ",materials:[]},{name:"COLOR MIXER 2 HP THREE PHASE MOTOR (CROMPECH) WITH GEAR BOX ",materials:[]},{name:"SIDE TABLE",materials:[]},{name:"PRICAST TABLE  2.5X12 FEET WITH 1 HP SINGLE PHASE(DEEP) VIBRATOR MOTORS 2 NOS",materials:[]},{name:"PRICAST TABLE  2.5X12 FEET WITH 1 HP SINGLE PHASE(DEEP) VIBRATOR MOTORS 3 NOS",materials:[]},{name:"PRICAST TABLE 3 X 6 FEET WITH 1 HP SINGLE PHASE(DEEP) VIBRATOR MOTORS 1 NOS",materials:[]},{name:"HYDRAULIC HOPPER PAN MIXER 450 KG",materials:[]},{name:"PAN MIXER 25 KG WITH 5 HP SINGAL PHASE ( SGL) ELECTRIC MOTER WITH INNER-OUTER SCREAPER",materials:[]},{name:"PAN MIXER 250 KG WITH 5 HP 3 PHASE (CROMTON)ELECTRIC MOTOR WITH ROLLER 400 X 200 & INNER - OUTER SCRAPER",materials:[]},{name:"PAN MIXER 250 KG WITH 5 HP 3 PHASE (CROMTON)ELECTRIC MOTOR WITH INNER -OUTER SCRAPER",materials:[]},{name:"PAN MIXER 450 KG WITH 7.5 HP 3 PHASE (CROMTON)ELECTRIC MOTOR WITH ROLLER 400 X 270 & INNER - OUTER SCRAPER",materials:[]},{name:"PAN MIXER 450 KG WITH 7.5 HP 3 PHASE (CROMTON)ELECTRIC MOTOR WITH  ROLLER 450 X 270  & INNER- OUTER SCRAPER",materials:[]},{name:"PAN MIXER 450 KG WITH 7.5 HP 3 PHASE (CROMTON)ELECTRIC MOTOR WITH  INNER- OUTER SCRAPER",materials:[]},{name:"PALLET LIFFTING SHIFTING TROLLY ",materials:[]},{name:"HYDRAULIC OIL 68 GRADE SHELL MAKE",materials:[]},{name:"EBM 7.0 TOOL KIT",materials:[]},{name:"EBM 4.0 TOOL KIT",materials:[]},{name:"AIR BLOWER",materials:[]},{name:"VIBRATING TABLE SETUP WITH THREE PHASE MOTOR ",materials:[]},{name:"VIBRATING TABLE SETUP WITH SINGAL PHASE MOTER ",materials:[]},{name:"ALANKAR MAKE VIBRATING TABLE  DEEP SINGAL PHASE MOTER WITH SINGAL PHASE COLOR MIXER & CONCRETE MIXER WITH CROMPACH MOTER",materials:[]},{name:"ALANKAR MAKE VIBRATING TABLE  DEEP THREE PHASE MOTER WITH THREE PHASE COLOR MIXER & CONCRETE MIXER WITH CROMPACH MOTER",materials:[]},{name:"ALANKAR MAKE VIBRATING TABLE  SGL SINGAL PHASE MOTER WITH SINGAL PHASE COLOR MIXER & CONCRETE MIXER WITH CROMPACH MOTER",materials:[]},{name:"ALANKAR MAKE VIBRATING TABLE  SGL THREE PHASE MOTER WITH THREE PHASE COLOR MIXER & CONCRETE MIXER WITH CROMPACH MOTER",materials:[]},{name:"EBM MANUAL MACHINE",materials:[]},{name:"EBM 4.0 SEMIAUTOMATIC MACHINE",materials:[]},{name:"EBM 4.0 SEMIAUTOMATIC PLANT",materials:[]},{name:"EBM 4.0 AUTOMATIC PLANT",materials:[]},{name:"EBM 7.0 AUTOMATIC PLANT",materials:[]},{name:"EBM 7.0 AUTOMATIC PLUS PLANT",materials:[]},{name:"CONVER BELT FOR 4.0 EBM 13 FT WITH 3 PHASE 1 HP CROMTON MOTER & GEAR BOX",materials:[]},{name:"CONVER BELT FOR 7.0 EBM 16 FT WITH 3 PHASE 1 HP CROMTON MOTER & GEAR BOX",materials:[]},{name:"CONVER BELT FOR 7.0 PLUS EBM 16 FT WITH 3 PHASE 1 HP CROMTON MOTER & GEAR BOX",materials:[]}]},Ly={production:fc,purchase:di,store:XN,assembly:Jo,finance:An,showroom:Il,sales:Cn,dispatch:Ks,transport:rn,watchman:yn},By={pending:"bg-yellow-100 text-yellow-800 border-yellow-300",in_progress:"bg-blue-100 text-blue-800 border-blue-300",waiting:"bg-orange-100 text-orange-800 border-orange-300",completed:"bg-green-100 text-green-800 border-green-300",failed:"bg-red-100 text-red-800 border-red-300",materials_ready:"bg-purple-100 text-purple-800 border-purple-300",customer_details_required:"bg-amber-100 text-amber-800 border-amber-300",ready_for_pickup:"bg-indigo-100 text-indigo-800 border-indigo-300"},Rn=({className:e=""})=>{const[r,s]=T.useState([]),[a,n]=T.useState([]),[o,c]=T.useState(!1),[d,h]=T.useState(""),[m,f]=T.useState(!1);T.useEffect(()=>{if(!d.trim()){s([]),n([]),c(!1);return}p();const R=setInterval(p,3e4);return()=>clearInterval(R)},[d]);const p=async()=>{if(!d.trim()){s([]),n([]),c(!1);return}try{f(!0);const R=encodeURIComponent(d||""),V=`${Fe}/orders/status-tracking${R?`?q=${R}`:""}`,P=await fetch(V);if(P.ok){const k=await P.json();s(Array.isArray(k?.productionOrders)?k.productionOrders:[]),n(Array.isArray(k?.salesOrders)?k.salesOrders:[])}else console.error("Failed to fetch order status")}catch(R){console.error("Error fetching order status:",R)}finally{c(!1),f(!1)}},g=()=>{p()},N=R=>Array.isArray(R)?R.filter(V=>{if(!d.trim())return!0;const P=d.toLowerCase();return V.orderNumber?.toLowerCase().includes(P)||V.productName?.toLowerCase().includes(P)||V.customerName?.toLowerCase().includes(P)||V.currentDepartment?.toLowerCase().includes(P)||C(V.currentDepartment)?.toLowerCase().includes(P)||V.status?.toLowerCase().includes(P)||A(V.status)?.toLowerCase().includes(P)||V.id?.toString().includes(d)}):[],y=N(r),w=N(a);function b(R){switch(R?.toLowerCase()){case"pending":return Ka;case"in_progress":case"materials_ready":return Ks;case"completed":return dr;case"failed":return Sr;default:return Ka}}function C(R){return{production:"Production Planning",purchase:"Purchase Department",store:"Store Department",assembly:"Assembly Team",finance:"Finance Department",showroom:"Showroom Department",sales:"Sales Department",dispatch:"Dispatch Department",transport:"Transport Department",watchman:"Security Department"}[R]||R}function A(R){return R?.replace(/_/g," ").replace(/\b\w/g,V=>V.toUpperCase())||"Unknown"}if(o)return t.jsx(He,{className:`bg-gradient-to-br from-slate-50 to-blue-50 border-2 border-blue-200 ${e}`,children:t.jsx(Ve,{className:"p-4",children:t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsx(Cr,{className:"w-5 h-5 animate-spin mr-2 text-blue-600"}),t.jsx("span",{className:"text-blue-800 font-medium",children:"Loading order status..."})]})})});const E=!!d.trim();return t.jsx(He,{className:`relative z-10 bg-gradient-to-br from-slate-50 to-blue-50 border-2 border-blue-200 shadow-lg ${e}`,children:t.jsxs(Ve,{className:"p-4 overflow-x-hidden px-4 box-border",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-3 gap-3",children:[t.jsxs("div",{children:[t.jsxs("h3",{className:"text-lg font-bold text-blue-900 flex items-center",children:[t.jsx(Ks,{className:"w-5 h-5 mr-2"}),"Order Status Tracker"]}),t.jsx("p",{className:"text-xs text-blue-600 mt-1 max-w-xs",children:"Search by: Order Number, Product Name, Customer Name, Department, or Status"})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:items-center space-y-2 sm:space-y-0 sm:space-x-2 w-full max-w-md",children:[t.jsxs("div",{className:"relative flex-grow min-w-[200px] max-w-full",children:[t.jsx(fi,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),t.jsx(Re,{type:"text",placeholder:"Search by order #, product, customer, department, status...",value:d,onChange:R=>h(R.target.value),className:"pl-8 w-full h-8 text-sm border-blue-300 focus:border-blue-500"})]}),t.jsx(pe,{onClick:g,disabled:m||!E,size:"sm",variant:"outline",className:"border-blue-300 text-blue-700 hover:bg-blue-100 w-full sm:w-auto mt-2 sm:mt-0",children:t.jsx(Cr,{className:`w-4 h-4 ${m?"animate-spin":""}`})})]})]}),E?t.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto overflow-x-auto max-w-full",children:[t.jsxs("div",{className:"max-w-full",children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx(fc,{className:"w-4 h-4 text-blue-700 mr-2"}),t.jsx("h4",{className:"text-sm font-semibold text-blue-800",children:"Production Orders"}),t.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",y.length,")"]})]}),y.length===0?t.jsx("div",{className:"text-center py-4 text-gray-500 border border-dashed border-blue-200 rounded",children:t.jsx("p",{className:"text-sm",children:"No production orders"})}):y.map(R=>{const V=Ly[R.currentDepartment]||Ks,P=b(R.status),k=By[R.status]||"bg-gray-100 text-gray-800 border-gray-300";return t.jsx("div",{className:"bg-white rounded-lg border border-blue-200 p-3 shadow-sm hover:shadow-md transition-shadow max-w-full w-full sm:w-auto",children:t.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between max-w-full gap-2 sm:gap-4",children:[t.jsx("div",{className:"flex items-center space-x-3 max-w-full flex-wrap sm:flex-nowrap",children:t.jsxs("div",{className:"flex items-center space-x-2 max-w-full",children:[t.jsx(V,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),t.jsxs("div",{className:"max-w-full min-w-0",children:[t.jsxs("div",{className:"flex items-center space-x-2 max-w-full flex-wrap sm:flex-nowrap",children:[t.jsxs("span",{className:"font-semibold text-gray-900 truncate max-w-full",children:["#",R.orderNumber]}),t.jsx(Av,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),t.jsx("span",{className:"text-sm font-medium text-blue-700 truncate max-w-full",children:C(R.currentDepartment)})]}),t.jsxs("p",{className:"text-sm text-gray-600 truncate max-w-full",children:[R.productName," ",R.quantity&&`(Qty: ${R.quantity})`,R.customerName&&`  ${R.customerName}`]})]})]})}),t.jsxs("div",{className:"flex items-center space-x-2 max-w-full flex-shrink-0",children:[t.jsxs(Lt,{className:`${k} border font-medium flex items-center gap-1 whitespace-nowrap`,children:[t.jsx(P,{className:"w-3 h-3"}),A(R.status)]}),R.updatedAt&&t.jsx("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:new Date(R.updatedAt).toLocaleDateString()})]})]})},R.id)})]}),t.jsxs("div",{className:"max-w-full",children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx(Cn,{className:"w-4 h-4 text-blue-700 mr-2"}),t.jsx("h4",{className:"text-sm font-semibold text-blue-800",children:"Sales Orders"}),t.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",w.length,")"]})]}),w.length===0?t.jsx("div",{className:"text-center py-4 text-gray-500 border border-dashed border-blue-200 rounded",children:t.jsx("p",{className:"text-sm",children:"No sales orders"})}):w.map(R=>{const V=Ly[R.currentDepartment]||Ks,P=b(R.status),k=By[R.status]||"bg-gray-100 text-gray-800 border-gray-300";return t.jsx("div",{className:"bg-white rounded-lg border border-blue-200 p-3 shadow-sm hover:shadow-md transition-shadow max-w-full w-full sm:w-auto",children:t.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between max-w-full gap-2 sm:gap-4",children:[t.jsx("div",{className:"flex items-center space-x-3 max-w-full flex-wrap sm:flex-nowrap",children:t.jsxs("div",{className:"flex items-center space-x-2 max-w-full",children:[t.jsx(V,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),t.jsxs("div",{className:"max-w-full min-w-0",children:[t.jsxs("div",{className:"flex items-center space-x-2 max-w-full flex-wrap sm:flex-nowrap",children:[t.jsxs("span",{className:"font-semibold text-gray-900 truncate max-w-full",children:["#",R.orderNumber]}),t.jsx(Av,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),t.jsx("span",{className:"text-sm font-medium text-blue-700 truncate max-w-full",children:C(R.currentDepartment)})]}),t.jsxs("p",{className:"text-sm text-gray-600 truncate max-w-full",children:[R.productName," ",R.quantity&&`(Qty: ${R.quantity})`,R.customerName&&`  ${R.customerName}`]})]})]})}),t.jsxs("div",{className:"flex items-center space-x-2 max-w-full flex-shrink-0",children:[t.jsxs(Lt,{className:`${k} border font-medium flex items-center gap-1 whitespace-nowrap`,children:[t.jsx(P,{className:"w-3 h-3"}),A(R.status)]}),R.updatedAt&&t.jsx("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:new Date(R.updatedAt).toLocaleDateString()})]})]})},R.id)})]})]}):t.jsxs("div",{className:"text-center py-6 text-gray-600",children:[t.jsx(fi,{className:"w-10 h-10 mx-auto mb-2 text-gray-400"}),t.jsx("p",{className:"font-medium",children:"Search to view order status"}),t.jsx("p",{className:"text-sm",children:"Type a product, customer, or order number, then press Refresh"})]}),E&&t.jsx("div",{className:"mt-3 pt-3 border-t border-blue-200",children:t.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between text-sm gap-2 sm:gap-0",children:[t.jsxs("span",{className:"text-blue-700 font-medium",children:["Totals  Production: ",y.length,", Sales: ",w.length]}),t.jsxs("span",{className:"text-gray-500 whitespace-nowrap",children:["Last updated: ",new Date().toLocaleTimeString()]})]})})]})})},Wb=()=>{const{user:e}=Ns(),r=Ls(),[s,a]=T.useState([]),[n,o]=T.useState({category:"RCM",subCategory:"",quantity:""}),[c,d]=T.useState([]),[h,m]=T.useState(""),[f,p]=T.useState(!1),[g,N]=T.useState(!1),[y,w]=T.useState(!0),b=async()=>{try{w(!0);const te=await fetch(`${Fe}/production-orders`);if(!te.ok)throw new Error("Failed to fetch orders");const de=await te.json();a(de)}catch(te){console.error("Error fetching orders:",te),dt({title:"Error",description:"Failed to load production orders. Please refresh the page.",variant:"destructive"})}finally{w(!1)}},C=async()=>{try{const te=await fetch(`${Fe}/purchase-orders`);if(!te.ok)throw new Error("Failed to fetch purchase orders");const de=await te.json();d(de)}catch(te){console.error("Error fetching purchase orders:",te)}};T.useEffect(()=>{b(),C()},[]);const A=async te=>{if(te.preventDefault(),!n.category||!n.subCategory||!n.quantity){dt({title:"Missing Information",description:"Please select a category, sub-category, and quantity.",variant:"destructive"});return}const de=My[n.category].find(H=>H.name===n.subCategory);if(!de){dt({title:"Invalid Product",description:"Selected product not found.",variant:"destructive"});return}N(!0);try{const H={productName:de.name,category:n.category,quantity:parseInt(n.quantity),materials:de.materials.map(X=>({...X,quantity:X.quantity*parseInt(n.quantity)})),createdBy:e?.name||e?.email||"Unknown User"},ue=await fetch(`${Fe}/production-orders`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(H)});if(!ue.ok){const X=await ue.json();throw new Error(X.error||"Failed to create order")}const I=await ue.json();dt({title:"Production Order Created",description:`Order for ${I.productionOrder.productName} has been successfully submitted.`}),o({category:"RCM",subCategory:"",quantity:""}),m(""),p(!1),await b(),await C()}catch(H){console.error("Error creating order:",H),dt({title:"Error",description:H.message||"Failed to create production order. Please try again.",variant:"destructive"})}finally{N(!1)}},E=te=>{const de=c.find(H=>H.productionOrderId===te);return de?de.status.replace(/_/g," "):"pending materials"},R=()=>{p(!0)},V=()=>{setTimeout(()=>p(!1),300)},P=te=>{o({...n,subCategory:te}),m(te),p(!1)},k=te=>{te.preventDefault()},z=My[n.category]?.filter(te=>te.name.toLowerCase().includes(h.toLowerCase()))||[],W=te=>{switch(te.toLowerCase()){case"pending materials":case"pending_materials":return"bg-amber-50 text-amber-800 border border-amber-200";case"materials ready":case"materials_ready":return"bg-blue-50 text-blue-800 border border-blue-200";case"in production":case"in_production":return"bg-orange-50 text-orange-800 border border-orange-200";case"completed":return"bg-green-50 text-green-800 border border-green-200";default:return"bg-gray-50 text-gray-800 border border-gray-200"}};return t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50",children:[t.jsx("div",{className:"max-w-7xl mx-auto bg-white shadow-md border-b-4 border-blue-800 rounded-b-lg",children:t.jsx("div",{className:"px-4 sm:px-6 py-4 sm:py-6",children:t.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:justify-between sm:items-center sm:space-y-0",children:[t.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4",children:[t.jsxs(pe,{onClick:()=>r(e.department==="admin"?"/dashboard/admin":"/dashboard"),variant:"outline",className:"border border-gray-300 bg-white text-gray-800 text-sm placeholder-gray-500 w-full sm:w-auto",children:[t.jsx(qs,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-600 to-blue-800 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx(fc,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Production Department"}),t.jsx("p",{className:"text-gray-600 text-sm sm:text-base font-medium",children:"Production Order Management System"})]})]})]}),t.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 px-4 py-4 sm:px-6 rounded-lg shadow-sm w-full sm:w-auto",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(Nr,{className:"w-5 h-5 text-blue-600"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 text-xs font-medium",children:"Production Team"}),t.jsx("p",{className:"text-blue-600 text-xs font-medium",children:"Production Planning Department"})]})]})})]})})}),t.jsx("div",{className:"max-w-7xl mx-auto px-6 py-4",children:t.jsx(Rn,{className:"mb-4"})}),t.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[t.jsx("div",{className:"space-y-6",children:t.jsxs(He,{className:"bg-white shadow-lg border-2 border-blue-100",children:[t.jsx(rt,{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-t-lg",children:t.jsxs(at,{className:"flex items-center text-xl font-bold",children:[t.jsx(Ga,{className:"w-6 h-6 mr-3"}),"New Production Order Request"]})}),t.jsx(Ve,{className:"p-8",children:t.jsxs("form",{onSubmit:A,className:"space-y-6",children:[t.jsxs("div",{className:"bg-gray-50 border-l-4 border-blue-600 p-4 rounded-r-lg",children:[t.jsx("h3",{className:"font-bold text-gray-900 text-lg mb-1",children:"Production Order Details"}),t.jsx("p",{className:"text-gray-600 text-sm",children:"Please fill all required fields marked with *"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs(Q,{htmlFor:"category",className:"text-gray-900 font-bold text-base flex items-center",children:[t.jsx(Ks,{className:"w-4 h-4 mr-2 text-blue-600"}),"Product Category *"]}),t.jsxs("select",{id:"category",value:n.category,onChange:te=>{o({...n,category:te.target.value,subCategory:""}),m(""),p(!1)},className:"w-full border-2 border-gray-300 text-gray-900 rounded-lg p-3 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 font-medium bg-white",children:[t.jsx("option",{value:"RCM",className:"font-medium",children:"RCM - Road Construction Machines"}),t.jsx("option",{value:"BCE",className:"font-medium",children:"BCE - Building Construction Equipments"})]})]}),t.jsxs("div",{className:"relative space-y-2",children:[t.jsx(Q,{htmlFor:"subCategory",className:"text-gray-900 font-bold text-base",children:"Product Sub-Category *"}),t.jsx(Re,{type:"text",placeholder:"Type to search products...",className:"w-full border-2 border-gray-300 text-gray-900 bg-white rounded-lg p-3 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 font-medium placeholder:text-gray-500",value:h,onChange:te=>m(te.target.value),onFocus:R,onBlur:V}),f&&h&&t.jsx("div",{className:"absolute z-10 w-full max-h-48 overflow-y-auto bg-white rounded-lg mt-1 border-2 border-gray-200 shadow-xl",onMouseDown:k,children:z.length>0?z.map(te=>t.jsx("div",{onClick:()=>P(te.name),onMouseDown:k,className:`p-3 cursor-pointer hover:bg-blue-50 text-gray-900 font-medium border-b border-gray-100 last:border-b-0 transition-colors duration-150 ${n.subCategory===te.name?"bg-blue-100 text-blue-800":""}`,children:te.name},te.name)):t.jsx("div",{className:"p-4 text-gray-500 text-center font-medium",children:"No matching products found"})})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"quantity",className:"text-gray-900 font-bold text-base",children:"Required Quantity *"}),t.jsx(Re,{id:"quantity",type:"number",value:n.quantity,onChange:te=>o({...n,quantity:te.target.value}),placeholder:"Enter quantity (e.g., 100)",className:"w-full border-2 border-gray-300 text-gray-900 bg-white rounded-lg p-3 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 font-medium placeholder:text-gray-500",min:"1",step:"1"})]}),t.jsx("div",{className:"pt-4",children:t.jsxs(pe,{type:"submit",className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-bold py-4 text-lg rounded-lg shadow-lg border-2 border-blue-800 transition-all duration-200",disabled:g,children:[g?t.jsx(kv,{className:"w-5 h-5 mr-3 animate-spin"}):t.jsx(Mm,{className:"w-5 h-5 mr-3"}),g?"Submitting Order...":"Submit Production Order"]})})]})})]})}),t.jsx("div",{className:"space-y-6",children:t.jsx(ds.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.2},children:t.jsxs(He,{className:"bg-white shadow-lg border-2 border-green-100",children:[t.jsxs(rt,{className:"bg-gradient-to-r from-green-600 to-green-700 text-white rounded-t-lg",children:[t.jsxs(at,{className:"flex items-center justify-between text-xl font-bold",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx(QC,{className:"w-6 h-6 mr-3"}),"Active Production Orders"]}),t.jsxs(Lt,{className:"bg-white text-green-700 font-bold px-3 py-1",children:["Total: ",s.length]})]}),t.jsx("p",{className:"text-green-100 text-sm font-medium mt-1",children:"Current Production Queue Status"})]}),t.jsx(Ve,{className:"p-6",children:t.jsx("div",{className:"space-y-4",children:y?t.jsx("div",{className:"flex justify-center items-center py-12",children:t.jsxs("div",{className:"text-center",children:[t.jsx(kv,{className:"w-12 h-12 animate-spin text-blue-600 mx-auto mb-4"}),t.jsx("span",{className:"text-gray-700 font-medium text-lg",children:"Loading production orders..."}),t.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we fetch the data"})]})}):s.length>0?s.map((te,de)=>t.jsx(ds.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:de*.1},className:"bg-gradient-to-r from-gray-50 to-blue-50 border-2 border-gray-200 rounded-lg p-6 hover:shadow-lg transition-shadow duration-300 max-w-full overflow-hidden",children:t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center mb-3",children:[t.jsx(Ks,{className:"w-6 h-6 text-blue-600 mr-3 flex-shrink-0"}),t.jsx("h4",{className:"font-semibold text-gray-800 text-xl break-words",children:te.productName})]}),t.jsxs("div",{className:"space-y-2 text-sm text-gray-700",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("span",{className:"font-semibold w-24 flex-shrink-0",children:"Quantity:"}),t.jsxs("span",{className:"font-bold text-blue-700 truncate",children:[te.quantity," units"]})]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx(tn,{className:"w-5 h-5 mr-2 text-gray-600 flex-shrink-0"}),t.jsx("span",{className:"font-semibold",children:"Ordered:"}),t.jsx("span",{className:"ml-2 font-medium truncate",children:te.createdAt})]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("span",{className:"font-semibold",children:"Order ID:"}),t.jsxs("span",{className:"ml-2 font-mono text-xs bg-gray-200 px-3 py-1 rounded truncate",children:["#",te.id]})]})]})]}),t.jsx("div",{className:"ml-0 sm:ml-6 flex-shrink-0",children:t.jsxs(Lt,{className:`${W(E(te.id))} font-bold text-sm px-4 py-2 rounded-full flex items-center space-x-2 whitespace-nowrap`,children:[t.jsx(di,{className:"w-5 h-5"}),t.jsx("span",{children:E(te.id).toUpperCase()})]})})]})},te.id)):t.jsxs("div",{className:"text-center py-12",children:[t.jsx(fc,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-bold text-gray-700 mb-2",children:"No Active Production Orders"}),t.jsx("p",{className:"text-gray-500 font-medium",children:"Submit your first production order using the form on the left."})]})})})]})})})]}),t.jsx("div",{className:"mt-12 bg-white border-2 border-gray-200 rounded-lg p-6 shadow-sm",children:t.jsxs("div",{className:"text-center text-gray-600",children:[t.jsx("p",{className:"font-medium",children:" Production Management System"}),t.jsx("p",{className:"text-sm mt-1",children:"For technical support, contact IT Department"})]})})]})]})},zb=()=>{const{user:e}=Ns(),r=Ls(),[s,a]=T.useState([]),[n,o]=T.useState(!0),[c,d]=T.useState(null),[h,m]=T.useState({productName:"",quantity:0,materials:[]}),f=async()=>{try{const H=await fetch(`${Fe}/purchase-orders`);if(!H.ok)throw new Error(`HTTP error! status: ${H.status}`);const ue=await H.json();a(Array.isArray(ue)?ue:[])}catch(H){console.error("Error fetching purchase orders:",H),dt({title:"Error",description:`Failed to load purchase orders: ${H.message}`,variant:"destructive"}),a([])}finally{o(!1)}},p=async H=>{try{const ue=await fetch(`${Fe}/purchase-orders/${H}/approve`,{method:"PUT",headers:{"Content-Type":"application/json"}});if(!ue.ok){const I=await ue.json();throw new Error(I.error||"Approval failed")}await ue.json(),dt({title:" Order Approved",description:"Purchase order has been approved and sent to Store for inventory check."}),f()}catch(ue){console.error(ue),dt({title:"Error",description:ue.message||"Could not approve purchase order.",variant:"destructive"})}},g=async H=>{try{const ue=await fetch(`${Fe}/purchase-orders/${H}/reject`,{method:"PUT",headers:{"Content-Type":"application/json"}});if(!ue.ok){const I=await ue.json();throw new Error(I.error||"Rejection failed")}dt({title:" Order Rejected",description:"Purchase order has been rejected."}),f()}catch(ue){console.error(ue),dt({title:"Error",description:ue.message||"Could not reject purchase order.",variant:"destructive"})}},N=async H=>{try{const ue=await fetch(`${Fe}/purchase-orders/${H}/request-finance-approval`,{method:"PUT",headers:{"Content-Type":"application/json"}});if(!ue.ok){const I=await ue.json();throw new Error(I.error||"Finance request failed")}dt({title:" Finance Approval Requested",description:"Request sent to Finance Department for approval."}),f()}catch(ue){console.error(ue),dt({title:"Error",description:ue.message||"Could not request finance approval.",variant:"destructive"})}},y=H=>{d(H.id),m({productName:H.productName,quantity:H.quantity,materials:H.materials||[]})},w=()=>{d(null),m({productName:"",quantity:0,materials:[]})},b=async H=>{try{const ue=await fetch(`${Fe}/purchase-orders/${H}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({product_name:h.productName,quantity:h.quantity,materials:h.materials})});if(!ue.ok){const I=await ue.json();throw new Error(I.error||"Update failed")}dt({title:" Order Updated",description:"Purchase order has been updated successfully."}),d(null),f()}catch(ue){console.error(ue),dt({title:"Error",description:ue.message||"Could not update purchase order.",variant:"destructive"})}},C=()=>{m(H=>({...H,materials:[...H.materials,{name:"",quantity:1,unit_cost:0}]}))},A=(H,ue,I)=>{m(X=>({...X,materials:X.materials.map((oe,xe)=>xe===H?{...oe,[ue]:I}:oe)}))},E=H=>{m(ue=>({...ue,materials:ue.materials.filter((I,X)=>X!==H)}))},R=H=>{const I={pending_request:{color:"bg-yellow-100 text-yellow-800 border border-yellow-300",text:"Pending Request"},pending_store_check:{color:"bg-blue-100 text-blue-800 border border-blue-300",text:"Pending Store Check"},store_allocated:{color:"bg-green-100 text-green-800 border border-green-300",text:"Store Allocated"},partially_allocated:{color:"bg-amber-100 text-amber-800 border border-amber-300",text:"Partially Allocated"},insufficient_stock:{color:"bg-orange-100 text-orange-800 border border-orange-300",text:"Insufficient Stock"},pending_finance_approval:{color:"bg-indigo-100 text-indigo-800 border border-indigo-300",text:"Pending Finance Approval"},finance_approved:{color:"bg-purple-100 text-purple-800 border border-purple-300",text:"Finance Approved"},verified_in_store:{color:"bg-teal-100 text-teal-800 border border-teal-300",text:"Verified in Store"},approved:{color:"bg-green-100 text-green-800 border border-green-300",text:"Approved"},rejected:{color:"bg-red-100 text-red-800 border border-red-300",text:"Rejected"},completed:{color:"bg-gray-100 text-gray-800 border border-gray-300",text:"Completed"}}[H]||{color:"bg-gray-100 text-gray-800 border border-gray-300",text:H?.replace(/_/g," ")||"Unknown"};return t.jsx(Lt,{className:`${I.color} font-medium`,children:I.text})},V=H=>{const ue=[];switch(H.status){case"pending_request":ue.push({label:"Accept & Send to Store",action:()=>p(H.id),icon:t.jsx(Lm,{className:"w-4 h-4 mr-2"}),className:"bg-green-600 hover:bg-green-700 text-white"}),ue.push({label:"Reject",action:()=>g(H.id),icon:t.jsx(rk,{className:"w-4 h-4 mr-2"}),className:"bg-red-600 hover:bg-red-700 text-white"});break;case"insufficient_stock":case"partially_allocated":ue.push({label:"Edit Order",action:()=>y(H),icon:t.jsx(zi,{className:"w-4 h-4 mr-2"}),className:"bg-orange-600 hover:bg-orange-700 text-white"}),ue.push({label:"Send to Finance for Approval",action:()=>N(H.id),icon:t.jsx(An,{className:"w-4 h-4 mr-2"}),className:"bg-blue-600 hover:bg-blue-700 text-white"});break}return ue};T.useEffect(()=>{f()},[]);const P=["pending_request","insufficient_stock","partially_allocated","pending_store_check","pending_finance_approval"],k=["approved","completed","finance_approved","store_allocated","verified_in_store","rejected"],z=s.filter(H=>P.includes(H.status)),W=s.filter(H=>k.includes(H.status)),[te,de]=T.useState(0);return t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50",children:[t.jsx("div",{className:"max-w-7xl mx-auto bg-white shadow-md border-b-4 border-blue-800 rounded-b-lg",children:t.jsx("div",{className:"px-4 sm:px-6 py-4 sm:py-6",children:t.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:justify-between sm:items-center sm:space-y-0",children:[t.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4",children:[t.jsxs(pe,{onClick:()=>r(e.department==="admin"?"/dashboard/admin":"/dashboard"),variant:"outline",className:"border border-gray-300 bg-white text-gray-800 text-sm placeholder-gray-500 w-full sm:w-auto",children:[t.jsx(qs,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-600 to-green-800 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx(di,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Purchase Department"}),t.jsx("p",{className:"text-gray-600 text-sm sm:text-base font-medium",children:"Purchase Management"})]})]})]}),t.jsx("div",{className:"bg-gradient-to-r from-green-50 to-indigo-50 border-2 border-green-200 px-4 py-4 sm:px-6 rounded-lg shadow-sm w-full sm:w-auto",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(Nr,{className:"w-5 h-5 text-green-600"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 text-xs font-medium",children:"Purchase Team"}),t.jsx("p",{className:"text-green-600 text-xs font-medium",children:"Purchase Management"})]})]})})]})})}),t.jsx("div",{className:"max-w-7xl mx-auto px-6 py-4",children:t.jsx(Rn,{className:"mb-4"})}),t.jsx("div",{className:"max-w-7xl mx-auto px-6",children:t.jsxs("div",{className:"flex space-x-2 border-b border-blue-200 mb-8",children:[t.jsxs("button",{className:`relative px-6 py-3 text-lg font-semibold focus:outline-none transition-colors border-b-4 ${te===0?"border-blue-700 text-blue-800 bg-white":"border-transparent text-gray-500 bg-blue-50 hover:text-blue-700"}`,onClick:()=>de(0),children:["Orders Requiring Action",z.length>0&&t.jsx("span",{className:"absolute top-2 right-2 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:z.length})]}),t.jsx("button",{className:`px-6 py-3 text-lg font-semibold focus:outline-none transition-colors border-b-4 ${te===1?"border-blue-700 text-blue-800 bg-white":"border-transparent text-gray-500 bg-blue-50 hover:text-blue-700"}`,onClick:()=>de(1),children:"Processed Orders"})]})}),t.jsx("div",{className:"max-w-7xl mx-auto p-6",children:t.jsxs("div",{className:"grid gap-10",children:[te===0?t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-blue-800 mb-4",children:"Orders Requiring Action"}),n?t.jsx("div",{className:"min-h-[200px] flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx(Cr,{className:"w-12 h-12 animate-spin mx-auto mb-4 text-blue-600"}),t.jsx("p",{className:"text-gray-800 text-lg font-medium",children:"Loading Purchase dashboard..."}),t.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Please wait while we retrieve the data"})]})}):z.length===0?t.jsx(He,{className:"bg-white border border-gray-300 shadow-sm",children:t.jsxs(Ve,{className:"p-8 text-center",children:[t.jsx(di,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"No Orders Requiring Action"}),t.jsx("p",{className:"text-gray-600",children:"All new or pending orders will appear here."})]})}):z.map((H,ue)=>t.jsx(ds.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:ue*.1},children:t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm hover:shadow-md transition-shadow mb-6",children:[t.jsx(rt,{children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsxs(at,{className:"text-gray-800 text-lg",children:["Purchase Order #",H.id]}),t.jsxs("p",{className:"text-gray-600 text-sm mt-1",children:["Product: ",H.productName," | Quantity: ",H.quantity]}),H.materials&&H.materials.length>0&&t.jsxs("p",{className:"text-green-700 text-sm font-semibold mt-1",children:["Total Cost: ",H.materials.reduce((I,X)=>I+(X.quantity||0)*(X.unit_cost||0),0).toFixed(2)]}),t.jsxs("p",{className:"text-gray-500 text-xs mt-1",children:["Created: ",H.createdAt]})]}),t.jsx("div",{className:"text-right",children:R(H.status)})]})}),t.jsx(Ve,{children:t.jsx("div",{className:"space-y-4",children:c===H.id?t.jsxs("div",{className:"space-y-4 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[t.jsxs("h4",{className:"text-blue-800 font-semibold mb-3 flex items-center",children:[t.jsx(zi,{className:"w-4 h-4 mr-2"}),"Editing Purchase Order"]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"productName",className:"text-sm font-medium text-gray-700",children:"Product Name"}),t.jsx(Re,{id:"productName",value:h.productName,onChange:I=>m(X=>({...X,productName:I.target.value})),className:"mt-1"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"quantity",className:"text-sm font-medium text-gray-700",children:"Quantity"}),t.jsx(Re,{id:"quantity",type:"number",value:h.quantity,onChange:I=>m(X=>({...X,quantity:parseInt(I.target.value)||0})),className:"mt-1"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx(Q,{className:"text-sm font-medium text-gray-700",children:"Materials"}),t.jsxs(pe,{type:"button",onClick:C,size:"sm",className:"bg-green-600 hover:bg-green-700 text-white",children:[t.jsx(ri,{className:"w-4 h-4 mr-1"}),"Add Material"]})]}),t.jsx("div",{className:"space-y-2",children:h.materials.map((I,X)=>t.jsxs("div",{className:"flex items-center space-x-2 bg-white border border-gray-200 rounded-lg p-2",children:[t.jsx(Re,{placeholder:"Material name",value:I.name||"",onChange:oe=>A(X,"name",oe.target.value),className:"flex-1"}),t.jsx(Re,{type:"number",placeholder:"Qty",value:I.quantity||1,onChange:oe=>A(X,"quantity",parseInt(oe.target.value)||1),className:"w-20"}),t.jsx(Re,{type:"number",placeholder:"Unit Cost ()",value:I.unit_cost||0,onChange:oe=>A(X,"unit_cost",parseFloat(oe.target.value)||0),className:"w-32"}),t.jsxs("div",{className:"text-sm text-gray-600 font-medium w-24",children:["",((I.quantity||1)*(I.unit_cost||0)).toFixed(2)]}),t.jsx(pe,{type:"button",onClick:()=>E(X),size:"sm",variant:"destructive",children:t.jsx(jf,{className:"w-4 h-4"})})]},X))})]}),t.jsxs("div",{className:"flex space-x-3 pt-4",children:[t.jsxs(pe,{onClick:()=>b(H.id),className:"bg-green-600 hover:bg-green-700 text-white",children:[t.jsx(bf,{className:"w-4 h-4 mr-2"}),"Save Changes"]}),t.jsxs(pe,{onClick:w,variant:"outline",className:"border-gray-300",children:[t.jsx(Ef,{className:"w-4 h-4 mr-2"}),"Cancel"]})]})]}):t.jsxs(t.Fragment,{children:[H.materials&&H.materials.length>0&&t.jsxs("div",{children:[t.jsx("h4",{className:"text-gray-800 font-semibold mb-3",children:"Required Materials:"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:H.materials.map((I,X)=>t.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-800 font-medium",children:typeof I=="string"?I:I.name||I}),t.jsx("div",{className:"text-right text-sm",children:typeof I=="object"&&I.quantity&&t.jsxs("div",{className:"text-gray-600",children:["Qty: ",I.quantity]})})]})},X))})]}),t.jsx("div",{className:"flex space-x-3 pt-4",children:V(H).map((I,X)=>t.jsxs(pe,{onClick:I.action,className:I.className,children:[I.icon,I.label]},X))})]})})})]})},H.id))]}):t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Processed Orders"}),n?t.jsx("div",{className:"min-h-[100px] flex items-center justify-center",children:t.jsx(Cr,{className:"w-8 h-8 animate-spin text-blue-600"})}):W.length===0?t.jsx(He,{className:"bg-white border border-gray-300 shadow-sm",children:t.jsxs(Ve,{className:"p-8 text-center",children:[t.jsx(di,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"No Processed Orders"}),t.jsx("p",{className:"text-gray-600",children:"Orders that have been processed will appear here."})]})}):W.map((H,ue)=>t.jsx(ds.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:ue*.1},children:t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm hover:shadow-md transition-shadow mb-6",children:[t.jsx(rt,{children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsxs(at,{className:"text-gray-800 text-lg",children:["Purchase Order #",H.id]}),t.jsxs("p",{className:"text-gray-600 text-sm mt-1",children:["Product: ",H.productName," | Quantity: ",H.quantity]}),H.materials&&H.materials.length>0&&t.jsxs("p",{className:"text-green-700 text-sm font-semibold mt-1",children:["Total Cost: ",H.materials.reduce((I,X)=>I+(X.quantity||0)*(X.unit_cost||0),0).toFixed(2)]}),t.jsxs("p",{className:"text-gray-500 text-xs mt-1",children:["Created: ",H.createdAt]})]}),t.jsx("div",{className:"text-right",children:R(H.status)})]})}),t.jsx(Ve,{children:t.jsx("div",{className:"space-y-4",children:H.materials&&H.materials.length>0&&t.jsxs("div",{children:[t.jsx("h4",{className:"text-gray-800 font-semibold mb-3",children:"Required Materials:"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:H.materials.map((I,X)=>t.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-800 font-medium",children:typeof I=="string"?I:I.name||I}),t.jsx("div",{className:"text-right text-sm",children:typeof I=="object"&&I.quantity&&t.jsxs("div",{className:"text-gray-600",children:["Qty: ",I.quantity]})})]})},X))})]})})})]})},H.id))]}),t.jsxs("div",{className:"mt-12 bg-white border-2 border-gray-200 rounded-lg p-6 shadow-sm text-center text-gray-600",children:[t.jsx("p",{className:"font-medium",children:" Procurement Management System"}),t.jsx("p",{className:"text-sm mt-1",children:"For technical support, contact IT Department"})]})]})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Kb=1252,K3=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Xf={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},qf=function(e){K3.indexOf(e)!=-1&&(Kb=Xf[0]=e)};function X3(){qf(1252)}var Ua=function(e){qf(e)};function Xb(){Ua(1200),X3()}function Hy(e){for(var r=[],s=0,a=e.length;s<a;++s)r[s]=e.charCodeAt(s);return r}function q3(e){for(var r=[],s=0;s<e.length>>1;++s)r[s]=String.fromCharCode(e.charCodeAt(2*s)+(e.charCodeAt(2*s+1)<<8));return r.join("")}function qb(e){for(var r=[],s=0;s<e.length>>1;++s)r[s]=String.fromCharCode(e.charCodeAt(2*s+1)+(e.charCodeAt(2*s)<<8));return r.join("")}var Wo=function(e){var r=e.charCodeAt(0),s=e.charCodeAt(1);return r==255&&s==254?q3(e.slice(2)):r==254&&s==255?qb(e.slice(2)):r==65279?e.slice(1):e},eu=function(r){return String.fromCharCode(r)},Vy=function(r){return String.fromCharCode(r)},vc,oi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Uy(e){for(var r="",s=0,a=0,n=0,o=0,c=0,d=0,h=0,m=0;m<e.length;)s=e.charCodeAt(m++),o=s>>2,a=e.charCodeAt(m++),c=(s&3)<<4|a>>4,n=e.charCodeAt(m++),d=(a&15)<<2|n>>6,h=n&63,isNaN(a)?d=h=64:isNaN(n)&&(h=64),r+=oi.charAt(o)+oi.charAt(c)+oi.charAt(d)+oi.charAt(h);return r}function xa(e){var r="",s=0,a=0,n=0,o=0,c=0,d=0,h=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var m=0;m<e.length;)o=oi.indexOf(e.charAt(m++)),c=oi.indexOf(e.charAt(m++)),s=o<<2|c>>4,r+=String.fromCharCode(s),d=oi.indexOf(e.charAt(m++)),a=(c&15)<<4|d>>2,d!==64&&(r+=String.fromCharCode(a)),h=oi.indexOf(e.charAt(m++)),n=(d&3)<<6|h,h!==64&&(r+=String.fromCharCode(n));return r}var tr=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),al=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,s){return s?new Buffer(r,s):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}})();function gi(e){return tr?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function $y(e){return tr?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ha=function(r){return tr?al(r,"binary"):r.split("").map(function(s){return s.charCodeAt(0)&255})};function nl(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var r=[],s=0;s<e.length;++s)r[s]=String.fromCharCode(e[s]);return r.join("")}function Yf(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Yf(new Uint8Array(e));for(var r=new Array(e.length),s=0;s<e.length;++s)r[s]=e[s];return r}var ii=tr?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:al(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,s=0;for(r=0;r<e.length;++r)s+=e[r].length;var a=new Uint8Array(s),n=0;for(r=0,s=0;r<e.length;s+=n,++r)if(n=e[r].length,e[r]instanceof Uint8Array)a.set(e[r],s);else{if(typeof e[r]=="string")throw"wtf";a.set(new Uint8Array(e[r]),s)}return a}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function Y3(e){for(var r=[],s=0,a=e.length+250,n=gi(e.length+255),o=0;o<e.length;++o){var c=e.charCodeAt(o);if(c<128)n[s++]=c;else if(c<2048)n[s++]=192|c>>6&31,n[s++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var d=e.charCodeAt(++o)&1023;n[s++]=240|c>>8&7,n[s++]=128|c>>2&63,n[s++]=128|d>>6&15|(c&3)<<4,n[s++]=128|d&63}else n[s++]=224|c>>12&15,n[s++]=128|c>>6&63,n[s++]=128|c&63;s>a&&(r.push(n.slice(0,s)),s=0,n=gi(65535),a=65530)}return r.push(n.slice(0,s)),ii(r)}var Ys=/\u0000/g,zo=/[\u0001-\u0006]/g;function $l(e){for(var r="",s=e.length-1;s>=0;)r+=e.charAt(s--);return r}function $a(e,r){var s=""+e;return s.length>=r?s:Wr("0",r-s.length)+s}function Jf(e,r){var s=""+e;return s.length>=r?s:Wr(" ",r-s.length)+s}function Tu(e,r){var s=""+e;return s.length>=r?s:s+Wr(" ",r-s.length)}function J3(e,r){var s=""+Math.round(e);return s.length>=r?s:Wr("0",r-s.length)+s}function Q3(e,r){var s=""+e;return s.length>=r?s:Wr("0",r-s.length)+s}var Gy=Math.pow(2,32);function Ol(e,r){if(e>Gy||e<-Gy)return J3(e,r);var s=Math.round(e);return Q3(s,r)}function Su(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var Wy=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],um=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Z3(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var zt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},zy={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},e_={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Au(e,r,s){for(var a=e<0?-1:1,n=e*a,o=0,c=1,d=0,h=1,m=0,f=0,p=Math.floor(n);m<r&&(p=Math.floor(n),d=p*c+o,f=p*m+h,!(n-p<5e-8));)n=1/(n-p),o=c,c=d,h=m,m=f;if(f>r&&(m>r?(f=h,d=o):(f=m,d=c)),!s)return[0,a*d,f];var g=Math.floor(a*d/f);return[g,a*d-g*f,f]}function $i(e,r,s){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),o=0,c=[],d={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(d.u)<1e-6&&(d.u=0),r&&r.date1904&&(a+=1462),d.u>.9999&&(d.u=0,++n==86400&&(d.T=n=0,++a,++d.D)),a===60)c=s?[1317,10,29]:[1900,2,29],o=3;else if(a===0)c=s?[1317,8,29]:[1900,1,0],o=6;else{a>60&&--a;var h=new Date(1900,0,1);h.setDate(h.getDate()+a-1),c=[h.getFullYear(),h.getMonth()+1,h.getDate()],o=h.getDay(),a<60&&(o=(o+6)%7),s&&(o=i_(h,c))}return d.y=c[0],d.m=c[1],d.d=c[2],d.S=n%60,n=Math.floor(n/60),d.M=n%60,n=Math.floor(n/60),d.H=n,d.q=o,d}var Yb=new Date(1899,11,31,0,0,0),t_=Yb.getTime(),r_=new Date(1900,2,1,0,0,0);function Jb(e,r){var s=e.getTime();return r?s-=1461*24*60*60*1e3:e>=r_&&(s+=1440*60*1e3),(s-(t_+(e.getTimezoneOffset()-Yb.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Qf(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function s_(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function a_(e){var r=e<0?12:11,s=Qf(e.toFixed(12));return s.length<=r||(s=e.toPrecision(10),s.length<=r)?s:e.toExponential(5)}function n_(e){var r=Qf(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function yc(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),s;return r>=-4&&r<=-1?s=e.toPrecision(10+r):Math.abs(r)<=9?s=a_(e):r===10?s=e.toFixed(10).substr(0,12):s=n_(e),Qf(s_(s.toUpperCase()))}function Ji(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):yc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Aa(14,Jb(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function i_(e,r){r[0]-=581;var s=e.getDay();return e<60&&(s=(s+6)%7),s}function l_(e,r,s,a){var n="",o=0,c=0,d=s.y,h,m=0;switch(e){case 98:d=s.y+543;case 121:switch(r.length){case 1:case 2:h=d%100,m=2;break;default:h=d%1e4,m=4;break}break;case 109:switch(r.length){case 1:case 2:h=s.m,m=r.length;break;case 3:return um[s.m-1][1];case 5:return um[s.m-1][0];default:return um[s.m-1][2]}break;case 100:switch(r.length){case 1:case 2:h=s.d,m=r.length;break;case 3:return Wy[s.q][0];default:return Wy[s.q][1]}break;case 104:switch(r.length){case 1:case 2:h=1+(s.H+11)%12,m=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:h=s.H,m=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:h=s.M,m=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return s.u===0&&(r=="s"||r=="ss")?$a(s.S,r.length):(a>=2?c=a===3?1e3:100:c=a===1?10:1,o=Math.round(c*(s.S+s.u)),o>=60*c&&(o=0),r==="s"?o===0?"0":""+o/c:(n=$a(o,2+a),r==="ss"?n.substr(0,2):"."+n.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":h=s.D*24+s.H;break;case"[m]":case"[mm]":h=(s.D*24+s.H)*60+s.M;break;case"[s]":case"[ss]":h=((s.D*24+s.H)*60+s.M)*60+Math.round(s.S+s.u);break;default:throw"bad abstime format: "+r}m=r.length===3?1:2;break;case 101:h=d,m=1;break}var f=m>0?$a(h,m):"";return f}function ci(e){var r=3;if(e.length<=r)return e;for(var s=e.length%r,a=e.substr(0,s);s!=e.length;s+=r)a+=(a.length>0?",":"")+e.substr(s,r);return a}var Qb=/%/g;function o_(e,r,s){var a=r.replace(Qb,""),n=r.length-a.length;return Tn(e,a,s*Math.pow(10,2*n))+Wr("%",n)}function c_(e,r,s){for(var a=r.length-1;r.charCodeAt(a-1)===44;)--a;return Tn(e,r.substr(0,a),s/Math.pow(10,3*(r.length-a)))}function Zb(e,r){var s,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Zb(e,-r);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%n;if(o<0&&(o+=n),s=(r/Math.pow(10,o)).toPrecision(a+1+(n+o)%n),s.indexOf("e")===-1){var c=Math.floor(Math.log(r)*Math.LOG10E);for(s.indexOf(".")===-1?s=s.charAt(0)+"."+s.substr(1)+"E+"+(c-s.length+o):s+="E+"+(c-o);s.substr(0,2)==="0.";)s=s.charAt(0)+s.substr(2,n)+"."+s.substr(2+n),s=s.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");s=s.replace(/\+-/,"-")}s=s.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,h,m,f){return h+m+f.substr(0,(n+o)%n)+"."+f.substr(o)+"E"})}else s=r.toExponential(a);return e.match(/E\+00$/)&&s.match(/e[+-]\d$/)&&(s=s.substr(0,s.length-1)+"0"+s.charAt(s.length-1)),e.match(/E\-/)&&s.match(/e\+/)&&(s=s.replace(/e\+/,"e")),s.replace("e","E")}var ej=/# (\?+)( ?)\/( ?)(\d+)/;function d_(e,r,s){var a=parseInt(e[4],10),n=Math.round(r*a),o=Math.floor(n/a),c=n-o*a,d=a;return s+(o===0?"":""+o)+" "+(c===0?Wr(" ",e[1].length+1+e[4].length):Jf(c,e[1].length)+e[2]+"/"+e[3]+$a(d,e[4].length))}function u_(e,r,s){return s+(r===0?"":""+r)+Wr(" ",e[1].length+2+e[4].length)}var tj=/^#*0*\.([0#]+)/,rj=/\).*[0#]/,sj=/\(###\) ###\\?-####/;function Ws(e){for(var r="",s,a=0;a!=e.length;++a)switch(s=e.charCodeAt(a)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(s)}return r}function Ky(e,r){var s=Math.pow(10,r);return""+Math.round(e*s)/s}function Xy(e,r){var s=e-Math.floor(e),a=Math.pow(10,r);return r<(""+Math.round(s*a)).length?0:Math.round(s*a)}function h_(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function m_(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ea(e,r,s){if(e.charCodeAt(0)===40&&!r.match(rj)){var a=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return s>=0?Ea("n",a,s):"("+Ea("n",a,-s)+")"}if(r.charCodeAt(r.length-1)===44)return c_(e,r,s);if(r.indexOf("%")!==-1)return o_(e,r,s);if(r.indexOf("E")!==-1)return Zb(r,s);if(r.charCodeAt(0)===36)return"$"+Ea(e,r.substr(r.charAt(1)==" "?2:1),s);var n,o,c,d,h=Math.abs(s),m=s<0?"-":"";if(r.match(/^00+$/))return m+Ol(h,r.length);if(r.match(/^[#?]+$/))return n=Ol(s,0),n==="0"&&(n=""),n.length>r.length?n:Ws(r.substr(0,r.length-n.length))+n;if(o=r.match(ej))return d_(o,h,m);if(r.match(/^#+0+$/))return m+Ol(h,r.length-r.indexOf("0"));if(o=r.match(tj))return n=Ky(s,o[1].length).replace(/^([^\.]+)$/,"$1."+Ws(o[1])).replace(/\.$/,"."+Ws(o[1])).replace(/\.(\d*)$/,function(y,w){return"."+w+Wr("0",Ws(o[1]).length-w.length)}),r.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return m+Ky(h,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return m+ci(Ol(h,0));if(o=r.match(/^#,##0\.([#0]*0)$/))return s<0?"-"+Ea(e,r,-s):ci(""+(Math.floor(s)+h_(s,o[1].length)))+"."+$a(Xy(s,o[1].length),o[1].length);if(o=r.match(/^#,#*,#0/))return Ea(e,r.replace(/^#,#*,/,""),s);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return n=$l(Ea(e,r.replace(/[\\-]/g,""),s)),c=0,$l($l(r.replace(/\\/g,"")).replace(/[0#]/g,function(y){return c<n.length?n.charAt(c++):y==="0"?"0":""}));if(r.match(sj))return n=Ea(e,"##########",s),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(o[4].length,7),d=Au(h,Math.pow(10,c)-1,!1),n=""+m,f=Tn("n",o[1],d[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+o[2]+"/"+o[3],f=Tu(d[2],c),f.length<o[4].length&&(f=Ws(o[4].substr(o[4].length-f.length))+f),n+=f,n;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(o[1].length,o[4].length),7),d=Au(h,Math.pow(10,c)-1,!0),m+(d[0]||(d[1]?"":"0"))+" "+(d[1]?Jf(d[1],c)+o[2]+"/"+o[3]+Tu(d[2],c):Wr(" ",2*c+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return n=Ol(s,0),r.length<=n.length?n:Ws(r.substr(0,r.length-n.length))+n;if(o=r.match(/^([#0?]+)\.([#0]+)$/)){n=""+s.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),c=n.indexOf(".");var p=r.indexOf(".")-c,g=r.length-n.length-p;return Ws(r.substr(0,p)+n+r.substr(r.length-g))}if(o=r.match(/^00,000\.([#0]*0)$/))return c=Xy(s,o[1].length),s<0?"-"+Ea(e,r,-s):ci(m_(s)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?$a(0,3-y.length):"")+y})+"."+$a(c,o[1].length);switch(r){case"###,##0.00":return Ea(e,"#,##0.00",s);case"###,###":case"##,###":case"#,###":var N=ci(Ol(h,0));return N!=="0"?m+N:"";case"###,###.00":return Ea(e,"###,##0.00",s).replace(/^0\./,".");case"#,###.00":return Ea(e,"#,##0.00",s).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function f_(e,r,s){for(var a=r.length-1;r.charCodeAt(a-1)===44;)--a;return Tn(e,r.substr(0,a),s/Math.pow(10,3*(r.length-a)))}function x_(e,r,s){var a=r.replace(Qb,""),n=r.length-a.length;return Tn(e,a,s*Math.pow(10,2*n))+Wr("%",n)}function aj(e,r){var s,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+aj(e,-r);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%n;if(o<0&&(o+=n),s=(r/Math.pow(10,o)).toPrecision(a+1+(n+o)%n),!s.match(/[Ee]/)){var c=Math.floor(Math.log(r)*Math.LOG10E);s.indexOf(".")===-1?s=s.charAt(0)+"."+s.substr(1)+"E+"+(c-s.length+o):s+="E+"+(c-o),s=s.replace(/\+-/,"-")}s=s.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,h,m,f){return h+m+f.substr(0,(n+o)%n)+"."+f.substr(o)+"E"})}else s=r.toExponential(a);return e.match(/E\+00$/)&&s.match(/e[+-]\d$/)&&(s=s.substr(0,s.length-1)+"0"+s.charAt(s.length-1)),e.match(/E\-/)&&s.match(/e\+/)&&(s=s.replace(/e\+/,"e")),s.replace("e","E")}function Za(e,r,s){if(e.charCodeAt(0)===40&&!r.match(rj)){var a=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return s>=0?Za("n",a,s):"("+Za("n",a,-s)+")"}if(r.charCodeAt(r.length-1)===44)return f_(e,r,s);if(r.indexOf("%")!==-1)return x_(e,r,s);if(r.indexOf("E")!==-1)return aj(r,s);if(r.charCodeAt(0)===36)return"$"+Za(e,r.substr(r.charAt(1)==" "?2:1),s);var n,o,c,d,h=Math.abs(s),m=s<0?"-":"";if(r.match(/^00+$/))return m+$a(h,r.length);if(r.match(/^[#?]+$/))return n=""+s,s===0&&(n=""),n.length>r.length?n:Ws(r.substr(0,r.length-n.length))+n;if(o=r.match(ej))return u_(o,h,m);if(r.match(/^#+0+$/))return m+$a(h,r.length-r.indexOf("0"));if(o=r.match(tj))return n=(""+s).replace(/^([^\.]+)$/,"$1."+Ws(o[1])).replace(/\.$/,"."+Ws(o[1])),n=n.replace(/\.(\d*)$/,function(y,w){return"."+w+Wr("0",Ws(o[1]).length-w.length)}),r.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return m+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return m+ci(""+h);if(o=r.match(/^#,##0\.([#0]*0)$/))return s<0?"-"+Za(e,r,-s):ci(""+s)+"."+Wr("0",o[1].length);if(o=r.match(/^#,#*,#0/))return Za(e,r.replace(/^#,#*,/,""),s);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return n=$l(Za(e,r.replace(/[\\-]/g,""),s)),c=0,$l($l(r.replace(/\\/g,"")).replace(/[0#]/g,function(y){return c<n.length?n.charAt(c++):y==="0"?"0":""}));if(r.match(sj))return n=Za(e,"##########",s),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(o[4].length,7),d=Au(h,Math.pow(10,c)-1,!1),n=""+m,f=Tn("n",o[1],d[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+o[2]+"/"+o[3],f=Tu(d[2],c),f.length<o[4].length&&(f=Ws(o[4].substr(o[4].length-f.length))+f),n+=f,n;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(o[1].length,o[4].length),7),d=Au(h,Math.pow(10,c)-1,!0),m+(d[0]||(d[1]?"":"0"))+" "+(d[1]?Jf(d[1],c)+o[2]+"/"+o[3]+Tu(d[2],c):Wr(" ",2*c+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return n=""+s,r.length<=n.length?n:Ws(r.substr(0,r.length-n.length))+n;if(o=r.match(/^([#0]+)\.([#0]+)$/)){n=""+s.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),c=n.indexOf(".");var p=r.indexOf(".")-c,g=r.length-n.length-p;return Ws(r.substr(0,p)+n+r.substr(r.length-g))}if(o=r.match(/^00,000\.([#0]*0)$/))return s<0?"-"+Za(e,r,-s):ci(""+s).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?$a(0,3-y.length):"")+y})+"."+$a(0,o[1].length);switch(r){case"###,###":case"##,###":case"#,###":var N=ci(""+h);return N!=="0"?m+N:"";default:if(r.match(/\.[0#?]*$/))return Za(e,r.slice(0,r.lastIndexOf(".")),s)+Ws(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Tn(e,r,s){return(s|0)===s?Za(e,r,s):Ea(e,r,s)}function p_(e){for(var r=[],s=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:s=!s;break;case 95:case 42:case 92:++a;break;case 59:r[r.length]=e.substr(n,a-n),n=a+1}if(r[r.length]=e.substr(n),s===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var nj=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Zl(e){for(var r=0,s="",a="";r<e.length;)switch(s=e.charAt(r)){case"G":Su(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="/")return!0;++r;break;case"[":for(a=s;e.charAt(r++)!=="]"&&r<e.length;)a+=e.charAt(r);if(a.match(nj))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(s=e.charAt(++r))>-1||s=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===s;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function g_(e,r,s,a){for(var n=[],o="",c=0,d="",h="t",m,f,p,g="H";c<e.length;)switch(d=e.charAt(c)){case"G":if(!Su(e,c))throw new Error("unrecognized character "+d+" in "+e);n[n.length]={t:"G",v:"General"},c+=7;break;case'"':for(o="";(p=e.charCodeAt(++c))!==34&&c<e.length;)o+=String.fromCharCode(p);n[n.length]={t:"t",v:o},++c;break;case"\\":var N=e.charAt(++c),y=N==="("||N===")"?N:"t";n[n.length]={t:y,v:N},++c;break;case"_":n[n.length]={t:"t",v:" "},c+=2;break;case"@":n[n.length]={t:"T",v:r},++c;break;case"B":case"b":if(e.charAt(c+1)==="1"||e.charAt(c+1)==="2"){if(m==null&&(m=$i(r,s,e.charAt(c+1)==="2"),m==null))return"";n[n.length]={t:"X",v:e.substr(c,2)},h=d,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||m==null&&(m=$i(r,s),m==null))return"";for(o=d;++c<e.length&&e.charAt(c).toLowerCase()===d;)o+=d;d==="m"&&h.toLowerCase()==="h"&&(d="M"),d==="h"&&(d=g),n[n.length]={t:d,v:o},h=d;break;case"A":case"a":case"":var w={t:d,v:d};if(m==null&&(m=$i(r,s)),e.substr(c,3).toUpperCase()==="A/P"?(m!=null&&(w.v=m.H>=12?"P":"A"),w.t="T",g="h",c+=3):e.substr(c,5).toUpperCase()==="AM/PM"?(m!=null&&(w.v=m.H>=12?"PM":"AM"),w.t="T",c+=5,g="h"):e.substr(c,5).toUpperCase()==="/"?(m!=null&&(w.v=m.H>=12?"":""),w.t="T",c+=5,g="h"):(w.t="t",++c),m==null&&w.t==="T")return"";n[n.length]=w,h=d;break;case"[":for(o=d;e.charAt(c++)!=="]"&&c<e.length;)o+=e.charAt(c);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(nj)){if(m==null&&(m=$i(r,s),m==null))return"";n[n.length]={t:"Z",v:o.toLowerCase()},h=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",Zl(e)||(n[n.length]={t:"t",v:o}));break;case".":if(m!=null){for(o=d;++c<e.length&&(d=e.charAt(c))==="0";)o+=d;n[n.length]={t:"s",v:o};break}case"0":case"#":for(o=d;++c<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(c))>-1;)o+=d;n[n.length]={t:"n",v:o};break;case"?":for(o=d;e.charAt(++c)===d;)o+=d;n[n.length]={t:d,v:o},h=d;break;case"*":++c,(e.charAt(c)==" "||e.charAt(c)=="*")&&++c;break;case"(":case")":n[n.length]={t:a===1?"t":d,v:d},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=d;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)o+=e.charAt(c);n[n.length]={t:"D",v:o};break;case" ":n[n.length]={t:d,v:d},++c;break;case"$":n[n.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(d)===-1)throw new Error("unrecognized character "+d+" in "+e);n[n.length]={t:"t",v:d},++c;break}var b=0,C=0,A;for(c=n.length-1,h="t";c>=0;--c)switch(n[c].t){case"h":case"H":n[c].t=g,h="h",b<1&&(b=1);break;case"s":(A=n[c].v.match(/\.0+$/))&&(C=Math.max(C,A[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":h=n[c].t;break;case"m":h==="s"&&(n[c].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&n[c].v.match(/[Hh]/)&&(b=1),b<2&&n[c].v.match(/[Mm]/)&&(b=2),b<3&&n[c].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H);break;case 2:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M);break}var E="",R;for(c=0;c<n.length;++c)switch(n[c].t){case"t":case"T":case" ":case"D":break;case"X":n[c].v="",n[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[c].v=l_(n[c].t.charCodeAt(0),n[c].v,m,C),n[c].t="t";break;case"n":case"?":for(R=c+1;n[R]!=null&&((d=n[R].t)==="?"||d==="D"||(d===" "||d==="t")&&n[R+1]!=null&&(n[R+1].t==="?"||n[R+1].t==="t"&&n[R+1].v==="/")||n[c].t==="("&&(d===" "||d==="n"||d===")")||d==="t"&&(n[R].v==="/"||n[R].v===" "&&n[R+1]!=null&&n[R+1].t=="?"));)n[c].v+=n[R].v,n[R]={v:"",t:";"},++R;E+=n[c].v,c=R-1;break;case"G":n[c].t="t",n[c].v=Ji(r,s);break}var V="",P,k;if(E.length>0){E.charCodeAt(0)==40?(P=r<0&&E.charCodeAt(0)===45?-r:r,k=Tn("n",E,P)):(P=r<0&&a>1?-r:r,k=Tn("n",E,P),P<0&&n[0]&&n[0].t=="t"&&(k=k.substr(1),n[0].v="-"+n[0].v)),R=k.length-1;var z=n.length;for(c=0;c<n.length;++c)if(n[c]!=null&&n[c].t!="t"&&n[c].v.indexOf(".")>-1){z=c;break}var W=n.length;if(z===n.length&&k.indexOf("E")===-1){for(c=n.length-1;c>=0;--c)n[c]==null||"n?".indexOf(n[c].t)===-1||(R>=n[c].v.length-1?(R-=n[c].v.length,n[c].v=k.substr(R+1,n[c].v.length)):R<0?n[c].v="":(n[c].v=k.substr(0,R+1),R=-1),n[c].t="t",W=c);R>=0&&W<n.length&&(n[W].v=k.substr(0,R+1)+n[W].v)}else if(z!==n.length&&k.indexOf("E")===-1){for(R=k.indexOf(".")-1,c=z;c>=0;--c)if(!(n[c]==null||"n?".indexOf(n[c].t)===-1)){for(f=n[c].v.indexOf(".")>-1&&c===z?n[c].v.indexOf(".")-1:n[c].v.length-1,V=n[c].v.substr(f+1);f>=0;--f)R>=0&&(n[c].v.charAt(f)==="0"||n[c].v.charAt(f)==="#")&&(V=k.charAt(R--)+V);n[c].v=V,n[c].t="t",W=c}for(R>=0&&W<n.length&&(n[W].v=k.substr(0,R+1)+n[W].v),R=k.indexOf(".")+1,c=z;c<n.length;++c)if(!(n[c]==null||"n?(".indexOf(n[c].t)===-1&&c!==z)){for(f=n[c].v.indexOf(".")>-1&&c===z?n[c].v.indexOf(".")+1:0,V=n[c].v.substr(0,f);f<n[c].v.length;++f)R<k.length&&(V+=k.charAt(R++));n[c].v=V,n[c].t="t",W=c}}}for(c=0;c<n.length;++c)n[c]!=null&&"n?".indexOf(n[c].t)>-1&&(P=a>1&&r<0&&c>0&&n[c-1].v==="-"?-r:r,n[c].v=Tn(n[c].t,n[c].v,P),n[c].t="t");var te="";for(c=0;c!==n.length;++c)n[c]!=null&&(te+=n[c].v);return te}var qy=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Yy(e,r){if(r==null)return!1;var s=parseFloat(r[2]);switch(r[1]){case"=":if(e==s)return!0;break;case">":if(e>s)return!0;break;case"<":if(e<s)return!0;break;case"<>":if(e!=s)return!0;break;case">=":if(e>=s)return!0;break;case"<=":if(e<=s)return!0;break}return!1}function v_(e,r){var s=p_(e),a=s.length,n=s[a-1].indexOf("@");if(a<4&&n>-1&&--a,s.length>4)throw new Error("cannot find right format for |"+s.join("|")+"|");if(typeof r!="number")return[4,s.length===4||n>-1?s[s.length-1]:"@"];switch(s.length){case 1:s=n>-1?["General","General","General",s[0]]:[s[0],s[0],s[0],"@"];break;case 2:s=n>-1?[s[0],s[0],s[0],s[1]]:[s[0],s[1],s[0],"@"];break;case 3:s=n>-1?[s[0],s[1],s[0],s[2]]:[s[0],s[1],s[2],"@"];break}var o=r>0?s[0]:r<0?s[1]:s[2];if(s[0].indexOf("[")===-1&&s[1].indexOf("[")===-1)return[a,o];if(s[0].match(/\[[=<>]/)!=null||s[1].match(/\[[=<>]/)!=null){var c=s[0].match(qy),d=s[1].match(qy);return Yy(r,c)?[a,s[0]]:Yy(r,d)?[a,s[1]]:[a,s[c!=null&&d!=null?2:1]]}return[a,o]}function Aa(e,r,s){s==null&&(s={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&s.dateNF?a=s.dateNF:a=e;break;case"number":e==14&&s.dateNF?a=s.dateNF:a=(s.table!=null?s.table:zt)[e],a==null&&(a=s.table&&s.table[zy[e]]||zt[zy[e]]),a==null&&(a=e_[e]||"General");break}if(Su(a,0))return Ji(r,s);r instanceof Date&&(r=Jb(r,s.date1904));var n=v_(a,r);if(Su(n[1]))return Ji(r,s);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return g_(n[1],r,s,n[0])}function Xi(e,r){if(typeof r!="number"){r=+r||-1;for(var s=0;s<392;++s){if(zt[s]==null){r<0&&(r=s);continue}if(zt[s]==e){r=s;break}}r<0&&(r=391)}return zt[r]=e,r}function ij(){zt=Z3()}var y_={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},lj=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function N_(e){var r=typeof e=="number"?zt[e]:e;return r=r.replace(lj,"(\\d+)"),new RegExp("^"+r+"$")}function w_(e,r,s){var a=-1,n=-1,o=-1,c=-1,d=-1,h=-1;(r.match(lj)||[]).forEach(function(p,g){var N=parseInt(s[g+1],10);switch(p.toLowerCase().charAt(0)){case"y":a=N;break;case"d":o=N;break;case"h":c=N;break;case"s":h=N;break;case"m":c>=0?d=N:n=N;break}}),h>=0&&d==-1&&n>=0&&(d=n,n=-1);var m=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);m.length==7&&(m="0"+m),m.length==8&&(m="20"+m);var f=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return c==-1&&d==-1&&h==-1?m:a==-1&&n==-1&&o==-1?f:m+"T"+f}var b_=(function(){var e={};e.version="1.2.0";function r(){for(var k=0,z=new Array(256),W=0;W!=256;++W)k=W,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,z[W]=k;return typeof Int32Array<"u"?new Int32Array(z):z}var s=r();function a(k){var z=0,W=0,te=0,de=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(te=0;te!=256;++te)de[te]=k[te];for(te=0;te!=256;++te)for(W=k[te],z=256+te;z<4096;z+=256)W=de[z]=W>>>8^k[W&255];var H=[];for(te=1;te!=16;++te)H[te-1]=typeof Int32Array<"u"?de.subarray(te*256,te*256+256):de.slice(te*256,te*256+256);return H}var n=a(s),o=n[0],c=n[1],d=n[2],h=n[3],m=n[4],f=n[5],p=n[6],g=n[7],N=n[8],y=n[9],w=n[10],b=n[11],C=n[12],A=n[13],E=n[14];function R(k,z){for(var W=z^-1,te=0,de=k.length;te<de;)W=W>>>8^s[(W^k.charCodeAt(te++))&255];return~W}function V(k,z){for(var W=z^-1,te=k.length-15,de=0;de<te;)W=E[k[de++]^W&255]^A[k[de++]^W>>8&255]^C[k[de++]^W>>16&255]^b[k[de++]^W>>>24]^w[k[de++]]^y[k[de++]]^N[k[de++]]^g[k[de++]]^p[k[de++]]^f[k[de++]]^m[k[de++]]^h[k[de++]]^d[k[de++]]^c[k[de++]]^o[k[de++]]^s[k[de++]];for(te+=15;de<te;)W=W>>>8^s[(W^k[de++])&255];return~W}function P(k,z){for(var W=z^-1,te=0,de=k.length,H=0,ue=0;te<de;)H=k.charCodeAt(te++),H<128?W=W>>>8^s[(W^H)&255]:H<2048?(W=W>>>8^s[(W^(192|H>>6&31))&255],W=W>>>8^s[(W^(128|H&63))&255]):H>=55296&&H<57344?(H=(H&1023)+64,ue=k.charCodeAt(te++)&1023,W=W>>>8^s[(W^(240|H>>8&7))&255],W=W>>>8^s[(W^(128|H>>2&63))&255],W=W>>>8^s[(W^(128|ue>>6&15|(H&3)<<4))&255],W=W>>>8^s[(W^(128|ue&63))&255]):(W=W>>>8^s[(W^(224|H>>12&15))&255],W=W>>>8^s[(W^(128|H>>6&63))&255],W=W>>>8^s[(W^(128|H&63))&255]);return~W}return e.table=s,e.bstr=R,e.buf=V,e.str=P,e})(),rr=(function(){var r={};r.version="1.2.1";function s(O,J){for(var K=O.split("/"),q=J.split("/"),Z=0,se=0,Ae=Math.min(K.length,q.length);Z<Ae;++Z){if(se=K[Z].length-q[Z].length)return se;if(K[Z]!=q[Z])return K[Z]<q[Z]?-1:1}return K.length-q.length}function a(O){if(O.charAt(O.length-1)=="/")return O.slice(0,-1).indexOf("/")===-1?O:a(O.slice(0,-1));var J=O.lastIndexOf("/");return J===-1?O:O.slice(0,J+1)}function n(O){if(O.charAt(O.length-1)=="/")return n(O.slice(0,-1));var J=O.lastIndexOf("/");return J===-1?O:O.slice(J+1)}function o(O,J){typeof J=="string"&&(J=new Date(J));var K=J.getHours();K=K<<6|J.getMinutes(),K=K<<5|J.getSeconds()>>>1,O.write_shift(2,K);var q=J.getFullYear()-1980;q=q<<4|J.getMonth()+1,q=q<<5|J.getDate(),O.write_shift(2,q)}function c(O){var J=O.read_shift(2)&65535,K=O.read_shift(2)&65535,q=new Date,Z=K&31;K>>>=5;var se=K&15;K>>>=4,q.setMilliseconds(0),q.setFullYear(K+1980),q.setMonth(se-1),q.setDate(Z);var Ae=J&31;J>>>=5;var Le=J&63;return J>>>=6,q.setHours(J),q.setMinutes(Le),q.setSeconds(Ae<<1),q}function d(O){Es(O,0);for(var J={},K=0;O.l<=O.length-4;){var q=O.read_shift(2),Z=O.read_shift(2),se=O.l+Z,Ae={};switch(q){case 21589:K=O.read_shift(1),K&1&&(Ae.mtime=O.read_shift(4)),Z>5&&(K&2&&(Ae.atime=O.read_shift(4)),K&4&&(Ae.ctime=O.read_shift(4))),Ae.mtime&&(Ae.mt=new Date(Ae.mtime*1e3));break}O.l=se,J[q]=Ae}return J}var h;function m(){return h||(h={})}function f(O,J){if(O[0]==80&&O[1]==75)return $t(O,J);if((O[0]|32)==109&&(O[1]|32)==105)return L(O,J);if(O.length<512)throw new Error("CFB file size "+O.length+" < 512");var K=3,q=512,Z=0,se=0,Ae=0,Le=0,Ce=0,_e=[],De=O.slice(0,512);Es(De,0);var Ke=p(De);switch(K=Ke[0],K){case 3:q=512;break;case 4:q=4096;break;case 0:if(Ke[1]==0)return $t(O,J);default:throw new Error("Major Version: Expected 3 or 4 saw "+K)}q!==512&&(De=O.slice(0,q),Es(De,28));var it=O.slice(0,q);g(De,K);var S=De.read_shift(4,"i");if(K===3&&S!==0)throw new Error("# Directory Sectors: Expected 0 saw "+S);De.l+=4,Ae=De.read_shift(4,"i"),De.l+=4,De.chk("00100000","Mini Stream Cutoff Size: "),Le=De.read_shift(4,"i"),Z=De.read_shift(4,"i"),Ce=De.read_shift(4,"i"),se=De.read_shift(4,"i");for(var re=-1,Ne=0;Ne<109&&(re=De.read_shift(4,"i"),!(re<0));++Ne)_e[Ne]=re;var Te=N(O,q);b(Ce,se,Te,q,_e);var Qe=A(Te,Ae,_e,q);Qe[Ae].name="!Directory",Z>0&&Le!==ue&&(Qe[Le].name="!MiniFAT"),Qe[_e[0]].name="!FAT",Qe.fat_addrs=_e,Qe.ssz=q;var St={},Yt=[],cr=[],Yr=[];E(Ae,Qe,Te,Yt,Z,St,cr,Le),y(cr,Yr,Yt),Yt.shift();var ur={FileIndex:cr,FullPaths:Yr};return J&&J.raw&&(ur.raw={header:it,sectors:Te}),ur}function p(O){if(O[O.l]==80&&O[O.l+1]==75)return[0,0];O.chk(I,"Header Signature: "),O.l+=16;var J=O.read_shift(2,"u");return[O.read_shift(2,"u"),J]}function g(O,J){var K=9;switch(O.l+=2,K=O.read_shift(2)){case 9:if(J!=3)throw new Error("Sector Shift: Expected 9 saw "+K);break;case 12:if(J!=4)throw new Error("Sector Shift: Expected 12 saw "+K);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+K)}O.chk("0600","Mini Sector Shift: "),O.chk("000000000000","Reserved: ")}function N(O,J){for(var K=Math.ceil(O.length/J)-1,q=[],Z=1;Z<K;++Z)q[Z-1]=O.slice(Z*J,(Z+1)*J);return q[K-1]=O.slice(K*J),q}function y(O,J,K){for(var q=0,Z=0,se=0,Ae=0,Le=0,Ce=K.length,_e=[],De=[];q<Ce;++q)_e[q]=De[q]=q,J[q]=K[q];for(;Le<De.length;++Le)q=De[Le],Z=O[q].L,se=O[q].R,Ae=O[q].C,_e[q]===q&&(Z!==-1&&_e[Z]!==Z&&(_e[q]=_e[Z]),se!==-1&&_e[se]!==se&&(_e[q]=_e[se])),Ae!==-1&&(_e[Ae]=q),Z!==-1&&q!=_e[q]&&(_e[Z]=_e[q],De.lastIndexOf(Z)<Le&&De.push(Z)),se!==-1&&q!=_e[q]&&(_e[se]=_e[q],De.lastIndexOf(se)<Le&&De.push(se));for(q=1;q<Ce;++q)_e[q]===q&&(se!==-1&&_e[se]!==se?_e[q]=_e[se]:Z!==-1&&_e[Z]!==Z&&(_e[q]=_e[Z]));for(q=1;q<Ce;++q)if(O[q].type!==0){if(Le=q,Le!=_e[Le])do Le=_e[Le],J[q]=J[Le]+"/"+J[q];while(Le!==0&&_e[Le]!==-1&&Le!=_e[Le]);_e[q]=-1}for(J[0]+="/",q=1;q<Ce;++q)O[q].type!==2&&(J[q]+="/")}function w(O,J,K){for(var q=O.start,Z=O.size,se=[],Ae=q;K&&Z>0&&Ae>=0;)se.push(J.slice(Ae*H,Ae*H+H)),Z-=H,Ae=Bi(K,Ae*4);return se.length===0?us(0):ii(se).slice(0,O.size)}function b(O,J,K,q,Z){var se=ue;if(O===ue){if(J!==0)throw new Error("DIFAT chain shorter than expected")}else if(O!==-1){var Ae=K[O],Le=(q>>>2)-1;if(!Ae)return;for(var Ce=0;Ce<Le&&(se=Bi(Ae,Ce*4))!==ue;++Ce)Z.push(se);b(Bi(Ae,q-4),J-1,K,q,Z)}}function C(O,J,K,q,Z){var se=[],Ae=[];Z||(Z=[]);var Le=q-1,Ce=0,_e=0;for(Ce=J;Ce>=0;){Z[Ce]=!0,se[se.length]=Ce,Ae.push(O[Ce]);var De=K[Math.floor(Ce*4/q)];if(_e=Ce*4&Le,q<4+_e)throw new Error("FAT boundary crossed: "+Ce+" 4 "+q);if(!O[De])break;Ce=Bi(O[De],_e)}return{nodes:se,data:i1([Ae])}}function A(O,J,K,q){var Z=O.length,se=[],Ae=[],Le=[],Ce=[],_e=q-1,De=0,Ke=0,it=0,S=0;for(De=0;De<Z;++De)if(Le=[],it=De+J,it>=Z&&(it-=Z),!Ae[it]){Ce=[];var re=[];for(Ke=it;Ke>=0;){re[Ke]=!0,Ae[Ke]=!0,Le[Le.length]=Ke,Ce.push(O[Ke]);var Ne=K[Math.floor(Ke*4/q)];if(S=Ke*4&_e,q<4+S)throw new Error("FAT boundary crossed: "+Ke+" 4 "+q);if(!O[Ne]||(Ke=Bi(O[Ne],S),re[Ke]))break}se[it]={nodes:Le,data:i1([Ce])}}return se}function E(O,J,K,q,Z,se,Ae,Le){for(var Ce=0,_e=q.length?2:0,De=J[O].data,Ke=0,it=0,S;Ke<De.length;Ke+=128){var re=De.slice(Ke,Ke+128);Es(re,64),it=re.read_shift(2),S=sx(re,0,it-_e),q.push(S);var Ne={name:S,type:re.read_shift(1),color:re.read_shift(1),L:re.read_shift(4,"i"),R:re.read_shift(4,"i"),C:re.read_shift(4,"i"),clsid:re.read_shift(16),state:re.read_shift(4,"i"),start:0,size:0},Te=re.read_shift(2)+re.read_shift(2)+re.read_shift(2)+re.read_shift(2);Te!==0&&(Ne.ct=R(re,re.l-8));var Qe=re.read_shift(2)+re.read_shift(2)+re.read_shift(2)+re.read_shift(2);Qe!==0&&(Ne.mt=R(re,re.l-8)),Ne.start=re.read_shift(4,"i"),Ne.size=re.read_shift(4,"i"),Ne.size<0&&Ne.start<0&&(Ne.size=Ne.type=0,Ne.start=ue,Ne.name=""),Ne.type===5?(Ce=Ne.start,Z>0&&Ce!==ue&&(J[Ce].name="!StreamData")):Ne.size>=4096?(Ne.storage="fat",J[Ne.start]===void 0&&(J[Ne.start]=C(K,Ne.start,J.fat_addrs,J.ssz)),J[Ne.start].name=Ne.name,Ne.content=J[Ne.start].data.slice(0,Ne.size)):(Ne.storage="minifat",Ne.size<0?Ne.size=0:Ce!==ue&&Ne.start!==ue&&J[Ce]&&(Ne.content=w(Ne,J[Ce].data,(J[Le]||{}).data))),Ne.content&&Es(Ne.content,0),se[S]=Ne,Ae.push(Ne)}}function R(O,J){return new Date((ua(O,J+4)/1e7*Math.pow(2,32)+ua(O,J)/1e7-11644473600)*1e3)}function V(O,J){return m(),f(h.readFileSync(O),J)}function P(O,J){var K=J&&J.type;switch(K||tr&&Buffer.isBuffer(O)&&(K="buffer"),K||"base64"){case"file":return V(O,J);case"base64":return f(Ha(xa(O)),J);case"binary":return f(Ha(O),J)}return f(O,J)}function k(O,J){var K=J||{},q=K.root||"Root Entry";if(O.FullPaths||(O.FullPaths=[]),O.FileIndex||(O.FileIndex=[]),O.FullPaths.length!==O.FileIndex.length)throw new Error("inconsistent CFB structure");O.FullPaths.length===0&&(O.FullPaths[0]=q+"/",O.FileIndex[0]={name:q,type:5}),K.CLSID&&(O.FileIndex[0].clsid=K.CLSID),z(O)}function z(O){var J="Sh33tJ5";if(!rr.find(O,"/"+J)){var K=us(4);K[0]=55,K[1]=K[3]=50,K[2]=54,O.FileIndex.push({name:J,type:2,content:K,size:4,L:69,R:69,C:69}),O.FullPaths.push(O.FullPaths[0]+J),W(O)}}function W(O,J){k(O);for(var K=!1,q=!1,Z=O.FullPaths.length-1;Z>=0;--Z){var se=O.FileIndex[Z];switch(se.type){case 0:q?K=!0:(O.FileIndex.pop(),O.FullPaths.pop());break;case 1:case 2:case 5:q=!0,isNaN(se.R*se.L*se.C)&&(K=!0),se.R>-1&&se.L>-1&&se.R==se.L&&(K=!0);break;default:K=!0;break}}if(!(!K&&!J)){var Ae=new Date(1987,1,19),Le=0,Ce=Object.create?Object.create(null):{},_e=[];for(Z=0;Z<O.FullPaths.length;++Z)Ce[O.FullPaths[Z]]=!0,O.FileIndex[Z].type!==0&&_e.push([O.FullPaths[Z],O.FileIndex[Z]]);for(Z=0;Z<_e.length;++Z){var De=a(_e[Z][0]);q=Ce[De],q||(_e.push([De,{name:n(De).replace("/",""),type:1,clsid:oe,ct:Ae,mt:Ae,content:null}]),Ce[De]=!0)}for(_e.sort(function(S,re){return s(S[0],re[0])}),O.FullPaths=[],O.FileIndex=[],Z=0;Z<_e.length;++Z)O.FullPaths[Z]=_e[Z][0],O.FileIndex[Z]=_e[Z][1];for(Z=0;Z<_e.length;++Z){var Ke=O.FileIndex[Z],it=O.FullPaths[Z];if(Ke.name=n(it).replace("/",""),Ke.L=Ke.R=Ke.C=-(Ke.color=1),Ke.size=Ke.content?Ke.content.length:0,Ke.start=0,Ke.clsid=Ke.clsid||oe,Z===0)Ke.C=_e.length>1?1:-1,Ke.size=0,Ke.type=5;else if(it.slice(-1)=="/"){for(Le=Z+1;Le<_e.length&&a(O.FullPaths[Le])!=it;++Le);for(Ke.C=Le>=_e.length?-1:Le,Le=Z+1;Le<_e.length&&a(O.FullPaths[Le])!=a(it);++Le);Ke.R=Le>=_e.length?-1:Le,Ke.type=1}else a(O.FullPaths[Z+1]||"")==a(it)&&(Ke.R=Z+1),Ke.type=2}}}function te(O,J){var K=J||{};if(K.fileType=="mad")return ce(O,K);switch(W(O),K.fileType){case"zip":return qt(O,K)}var q=(function(S){for(var re=0,Ne=0,Te=0;Te<S.FileIndex.length;++Te){var Qe=S.FileIndex[Te];if(Qe.content){var St=Qe.content.length;St>0&&(St<4096?re+=St+63>>6:Ne+=St+511>>9)}}for(var Yt=S.FullPaths.length+3>>2,cr=re+7>>3,Yr=re+127>>7,ur=cr+Ne+Yt+Yr,ut=ur+127>>7,Ir=ut<=109?0:Math.ceil((ut-109)/127);ur+ut+Ir+127>>7>ut;)Ir=++ut<=109?0:Math.ceil((ut-109)/127);var nr=[1,Ir,ut,Yr,Yt,Ne,re,0];return S.FileIndex[0].size=re<<6,nr[7]=(S.FileIndex[0].start=nr[0]+nr[1]+nr[2]+nr[3]+nr[4]+nr[5])+(nr[6]+7>>3),nr})(O),Z=us(q[7]<<9),se=0,Ae=0;{for(se=0;se<8;++se)Z.write_shift(1,X[se]);for(se=0;se<8;++se)Z.write_shift(2,0);for(Z.write_shift(2,62),Z.write_shift(2,3),Z.write_shift(2,65534),Z.write_shift(2,9),Z.write_shift(2,6),se=0;se<3;++se)Z.write_shift(2,0);for(Z.write_shift(4,0),Z.write_shift(4,q[2]),Z.write_shift(4,q[0]+q[1]+q[2]+q[3]-1),Z.write_shift(4,0),Z.write_shift(4,4096),Z.write_shift(4,q[3]?q[0]+q[1]+q[2]-1:ue),Z.write_shift(4,q[3]),Z.write_shift(-4,q[1]?q[0]-1:ue),Z.write_shift(4,q[1]),se=0;se<109;++se)Z.write_shift(-4,se<q[2]?q[1]+se:-1)}if(q[1])for(Ae=0;Ae<q[1];++Ae){for(;se<236+Ae*127;++se)Z.write_shift(-4,se<q[2]?q[1]+se:-1);Z.write_shift(-4,Ae===q[1]-1?ue:Ae+1)}var Le=function(S){for(Ae+=S;se<Ae-1;++se)Z.write_shift(-4,se+1);S&&(++se,Z.write_shift(-4,ue))};for(Ae=se=0,Ae+=q[1];se<Ae;++se)Z.write_shift(-4,xe.DIFSECT);for(Ae+=q[2];se<Ae;++se)Z.write_shift(-4,xe.FATSECT);Le(q[3]),Le(q[4]);for(var Ce=0,_e=0,De=O.FileIndex[0];Ce<O.FileIndex.length;++Ce)De=O.FileIndex[Ce],De.content&&(_e=De.content.length,!(_e<4096)&&(De.start=Ae,Le(_e+511>>9)));for(Le(q[6]+7>>3);Z.l&511;)Z.write_shift(-4,xe.ENDOFCHAIN);for(Ae=se=0,Ce=0;Ce<O.FileIndex.length;++Ce)De=O.FileIndex[Ce],De.content&&(_e=De.content.length,!(!_e||_e>=4096)&&(De.start=Ae,Le(_e+63>>6)));for(;Z.l&511;)Z.write_shift(-4,xe.ENDOFCHAIN);for(se=0;se<q[4]<<2;++se){var Ke=O.FullPaths[se];if(!Ke||Ke.length===0){for(Ce=0;Ce<17;++Ce)Z.write_shift(4,0);for(Ce=0;Ce<3;++Ce)Z.write_shift(4,-1);for(Ce=0;Ce<12;++Ce)Z.write_shift(4,0);continue}De=O.FileIndex[se],se===0&&(De.start=De.size?De.start-1:ue);var it=se===0&&K.root||De.name;if(_e=2*(it.length+1),Z.write_shift(64,it,"utf16le"),Z.write_shift(2,_e),Z.write_shift(1,De.type),Z.write_shift(1,De.color),Z.write_shift(-4,De.L),Z.write_shift(-4,De.R),Z.write_shift(-4,De.C),De.clsid)Z.write_shift(16,De.clsid,"hex");else for(Ce=0;Ce<4;++Ce)Z.write_shift(4,0);Z.write_shift(4,De.state||0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,De.start),Z.write_shift(4,De.size),Z.write_shift(4,0)}for(se=1;se<O.FileIndex.length;++se)if(De=O.FileIndex[se],De.size>=4096)if(Z.l=De.start+1<<9,tr&&Buffer.isBuffer(De.content))De.content.copy(Z,Z.l,0,De.size),Z.l+=De.size+511&-512;else{for(Ce=0;Ce<De.size;++Ce)Z.write_shift(1,De.content[Ce]);for(;Ce&511;++Ce)Z.write_shift(1,0)}for(se=1;se<O.FileIndex.length;++se)if(De=O.FileIndex[se],De.size>0&&De.size<4096)if(tr&&Buffer.isBuffer(De.content))De.content.copy(Z,Z.l,0,De.size),Z.l+=De.size+63&-64;else{for(Ce=0;Ce<De.size;++Ce)Z.write_shift(1,De.content[Ce]);for(;Ce&63;++Ce)Z.write_shift(1,0)}if(tr)Z.l=Z.length;else for(;Z.l<Z.length;)Z.write_shift(1,0);return Z}function de(O,J){var K=O.FullPaths.map(function(Ce){return Ce.toUpperCase()}),q=K.map(function(Ce){var _e=Ce.split("/");return _e[_e.length-(Ce.slice(-1)=="/"?2:1)]}),Z=!1;J.charCodeAt(0)===47?(Z=!0,J=K[0].slice(0,-1)+J):Z=J.indexOf("/")!==-1;var se=J.toUpperCase(),Ae=Z===!0?K.indexOf(se):q.indexOf(se);if(Ae!==-1)return O.FileIndex[Ae];var Le=!se.match(zo);for(se=se.replace(Ys,""),Le&&(se=se.replace(zo,"!")),Ae=0;Ae<K.length;++Ae)if((Le?K[Ae].replace(zo,"!"):K[Ae]).replace(Ys,"")==se||(Le?q[Ae].replace(zo,"!"):q[Ae]).replace(Ys,"")==se)return O.FileIndex[Ae];return null}var H=64,ue=-2,I="d0cf11e0a1b11ae1",X=[208,207,17,224,161,177,26,225],oe="00000000000000000000000000000000",xe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ue,FREESECT:-1,HEADER_SIGNATURE:I,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:oe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function he(O,J,K){m();var q=te(O,K);h.writeFileSync(J,q)}function F(O){for(var J=new Array(O.length),K=0;K<O.length;++K)J[K]=String.fromCharCode(O[K]);return J.join("")}function ee(O,J){var K=te(O,J);switch(J&&J.type||"buffer"){case"file":return m(),h.writeFileSync(J.filename,K),K;case"binary":return typeof K=="string"?K:F(K);case"base64":return Uy(typeof K=="string"?K:F(K));case"buffer":if(tr)return Buffer.isBuffer(K)?K:al(K);case"array":return typeof K=="string"?Ha(K):K}return K}var M;function _(O){try{var J=O.InflateRaw,K=new J;if(K._processChunk(new Uint8Array([3,0]),K._finishFlushFlag),K.bytesRead)M=O;else throw new Error("zlib does not expose bytesRead")}catch(q){console.error("cannot use native zlib: "+(q.message||q))}}function ne(O,J){if(!M)return wt(O,J);var K=M.InflateRaw,q=new K,Z=q._processChunk(O.slice(O.l),q._finishFlushFlag);return O.l+=q.bytesRead,Z}function ae(O){return M?M.deflateRawSync(O):et(O)}var G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ie=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Me=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ee(O){var J=(O<<1|O<<11)&139536|(O<<5|O<<15)&558144;return(J>>16|J>>8|J)&255}for(var ye=typeof Uint8Array<"u",je=ye?new Uint8Array(256):[],We=0;We<256;++We)je[We]=Ee(We);function Y(O,J){var K=je[O&255];return J<=8?K>>>8-J:(K=K<<8|je[O>>8&255],J<=16?K>>>16-J:(K=K<<8|je[O>>16&255],K>>>24-J))}function Dt(O,J){var K=J&7,q=J>>>3;return(O[q]|(K<=6?0:O[q+1]<<8))>>>K&3}function we(O,J){var K=J&7,q=J>>>3;return(O[q]|(K<=5?0:O[q+1]<<8))>>>K&7}function ot(O,J){var K=J&7,q=J>>>3;return(O[q]|(K<=4?0:O[q+1]<<8))>>>K&15}function Ye(O,J){var K=J&7,q=J>>>3;return(O[q]|(K<=3?0:O[q+1]<<8))>>>K&31}function Ue(O,J){var K=J&7,q=J>>>3;return(O[q]|(K<=1?0:O[q+1]<<8))>>>K&127}function Nt(O,J,K){var q=J&7,Z=J>>>3,se=(1<<K)-1,Ae=O[Z]>>>q;return K<8-q||(Ae|=O[Z+1]<<8-q,K<16-q)||(Ae|=O[Z+2]<<16-q,K<24-q)||(Ae|=O[Z+3]<<24-q),Ae&se}function qe(O,J,K){var q=J&7,Z=J>>>3;return q<=5?O[Z]|=(K&7)<<q:(O[Z]|=K<<q&255,O[Z+1]=(K&7)>>8-q),J+3}function Bt(O,J,K){var q=J&7,Z=J>>>3;return K=(K&1)<<q,O[Z]|=K,J+1}function jt(O,J,K){var q=J&7,Z=J>>>3;return K<<=q,O[Z]|=K&255,K>>>=8,O[Z+1]=K,J+8}function Ze(O,J,K){var q=J&7,Z=J>>>3;return K<<=q,O[Z]|=K&255,K>>>=8,O[Z+1]=K&255,O[Z+2]=K>>>8,J+16}function Xt(O,J){var K=O.length,q=2*K>J?2*K:J+5,Z=0;if(K>=J)return O;if(tr){var se=$y(q);if(O.copy)O.copy(se);else for(;Z<O.length;++Z)se[Z]=O[Z];return se}else if(ye){var Ae=new Uint8Array(q);if(Ae.set)Ae.set(O);else for(;Z<K;++Z)Ae[Z]=O[Z];return Ae}return O.length=q,O}function ze(O){for(var J=new Array(O),K=0;K<O;++K)J[K]=0;return J}function ht(O,J,K){var q=1,Z=0,se=0,Ae=0,Le=0,Ce=O.length,_e=ye?new Uint16Array(32):ze(32);for(se=0;se<32;++se)_e[se]=0;for(se=Ce;se<K;++se)O[se]=0;Ce=O.length;var De=ye?new Uint16Array(Ce):ze(Ce);for(se=0;se<Ce;++se)_e[Z=O[se]]++,q<Z&&(q=Z),De[se]=0;for(_e[0]=0,se=1;se<=q;++se)_e[se+16]=Le=Le+_e[se-1]<<1;for(se=0;se<Ce;++se)Le=O[se],Le!=0&&(De[se]=_e[Le+16]++);var Ke=0;for(se=0;se<Ce;++se)if(Ke=O[se],Ke!=0)for(Le=Y(De[se],q)>>q-Ke,Ae=(1<<q+4-Ke)-1;Ae>=0;--Ae)J[Le|Ae<<Ke]=Ke&15|se<<4;return q}var nt=ye?new Uint16Array(512):ze(512),Ot=ye?new Uint16Array(32):ze(32);if(!ye){for(var lt=0;lt<512;++lt)nt[lt]=0;for(lt=0;lt<32;++lt)Ot[lt]=0}(function(){for(var O=[],J=0;J<32;J++)O.push(5);ht(O,Ot,32);var K=[];for(J=0;J<=143;J++)K.push(8);for(;J<=255;J++)K.push(9);for(;J<=279;J++)K.push(7);for(;J<=287;J++)K.push(8);ht(K,nt,288)})();var Jt=(function(){for(var J=ye?new Uint8Array(32768):[],K=0,q=0;K<Me.length-1;++K)for(;q<Me[K+1];++q)J[q]=K;for(;q<32768;++q)J[q]=29;var Z=ye?new Uint8Array(259):[];for(K=0,q=0;K<ie.length-1;++K)for(;q<ie[K+1];++q)Z[q]=K;function se(Le,Ce){for(var _e=0;_e<Le.length;){var De=Math.min(65535,Le.length-_e),Ke=_e+De==Le.length;for(Ce.write_shift(1,+Ke),Ce.write_shift(2,De),Ce.write_shift(2,~De&65535);De-- >0;)Ce[Ce.l++]=Le[_e++]}return Ce.l}function Ae(Le,Ce){for(var _e=0,De=0,Ke=ye?new Uint16Array(32768):[];De<Le.length;){var it=Math.min(65535,Le.length-De);if(it<10){for(_e=qe(Ce,_e,+(De+it==Le.length)),_e&7&&(_e+=8-(_e&7)),Ce.l=_e/8|0,Ce.write_shift(2,it),Ce.write_shift(2,~it&65535);it-- >0;)Ce[Ce.l++]=Le[De++];_e=Ce.l*8;continue}_e=qe(Ce,_e,+(De+it==Le.length)+2);for(var S=0;it-- >0;){var re=Le[De];S=(S<<5^re)&32767;var Ne=-1,Te=0;if((Ne=Ke[S])&&(Ne|=De&-32768,Ne>De&&(Ne-=32768),Ne<De))for(;Le[Ne+Te]==Le[De+Te]&&Te<250;)++Te;if(Te>2){re=Z[Te],re<=22?_e=jt(Ce,_e,je[re+1]>>1)-1:(jt(Ce,_e,3),_e+=5,jt(Ce,_e,je[re-23]>>5),_e+=3);var Qe=re<8?0:re-4>>2;Qe>0&&(Ze(Ce,_e,Te-ie[re]),_e+=Qe),re=J[De-Ne],_e=jt(Ce,_e,je[re]>>3),_e-=3;var St=re<4?0:re-2>>1;St>0&&(Ze(Ce,_e,De-Ne-Me[re]),_e+=St);for(var Yt=0;Yt<Te;++Yt)Ke[S]=De&32767,S=(S<<5^Le[De])&32767,++De;it-=Te-1}else re<=143?re=re+48:_e=Bt(Ce,_e,1),_e=jt(Ce,_e,je[re]),Ke[S]=De&32767,++De}_e=jt(Ce,_e,0)-1}return Ce.l=(_e+7)/8|0,Ce.l}return function(Ce,_e){return Ce.length<8?se(Ce,_e):Ae(Ce,_e)}})();function et(O){var J=us(50+Math.floor(O.length*1.1)),K=Jt(O,J);return J.slice(0,K)}var Ft=ye?new Uint16Array(32768):ze(32768),kt=ye?new Uint16Array(32768):ze(32768),er=ye?new Uint16Array(128):ze(128),B=1,me=1;function Je(O,J){var K=Ye(O,J)+257;J+=5;var q=Ye(O,J)+1;J+=5;var Z=ot(O,J)+4;J+=4;for(var se=0,Ae=ye?new Uint8Array(19):ze(19),Le=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ce=1,_e=ye?new Uint8Array(8):ze(8),De=ye?new Uint8Array(8):ze(8),Ke=Ae.length,it=0;it<Z;++it)Ae[G[it]]=se=we(O,J),Ce<se&&(Ce=se),_e[se]++,J+=3;var S=0;for(_e[0]=0,it=1;it<=Ce;++it)De[it]=S=S+_e[it-1]<<1;for(it=0;it<Ke;++it)(S=Ae[it])!=0&&(Le[it]=De[S]++);var re=0;for(it=0;it<Ke;++it)if(re=Ae[it],re!=0){S=je[Le[it]]>>8-re;for(var Ne=(1<<7-re)-1;Ne>=0;--Ne)er[S|Ne<<re]=re&7|it<<3}var Te=[];for(Ce=1;Te.length<K+q;)switch(S=er[Ue(O,J)],J+=S&7,S>>>=3){case 16:for(se=3+Dt(O,J),J+=2,S=Te[Te.length-1];se-- >0;)Te.push(S);break;case 17:for(se=3+we(O,J),J+=3;se-- >0;)Te.push(0);break;case 18:for(se=11+Ue(O,J),J+=7;se-- >0;)Te.push(0);break;default:Te.push(S),Ce<S&&(Ce=S);break}var Qe=Te.slice(0,K),St=Te.slice(K);for(it=K;it<286;++it)Qe[it]=0;for(it=q;it<30;++it)St[it]=0;return B=ht(Qe,Ft,286),me=ht(St,kt,30),J}function mt(O,J){if(O[0]==3&&!(O[1]&3))return[gi(J),2];for(var K=0,q=0,Z=$y(J||1<<18),se=0,Ae=Z.length>>>0,Le=0,Ce=0;(q&1)==0;){if(q=we(O,K),K+=3,q>>>1)q>>1==1?(Le=9,Ce=5):(K=Je(O,K),Le=B,Ce=me);else{K&7&&(K+=8-(K&7));var _e=O[K>>>3]|O[(K>>>3)+1]<<8;if(K+=32,_e>0)for(!J&&Ae<se+_e&&(Z=Xt(Z,se+_e),Ae=Z.length);_e-- >0;)Z[se++]=O[K>>>3],K+=8;continue}for(;;){!J&&Ae<se+32767&&(Z=Xt(Z,se+32767),Ae=Z.length);var De=Nt(O,K,Le),Ke=q>>>1==1?nt[De]:Ft[De];if(K+=Ke&15,Ke>>>=4,(Ke>>>8&255)===0)Z[se++]=Ke;else{if(Ke==256)break;Ke-=257;var it=Ke<8?0:Ke-4>>2;it>5&&(it=0);var S=se+ie[Ke];it>0&&(S+=Nt(O,K,it),K+=it),De=Nt(O,K,Ce),Ke=q>>>1==1?Ot[De]:kt[De],K+=Ke&15,Ke>>>=4;var re=Ke<4?0:Ke-2>>1,Ne=Me[Ke];for(re>0&&(Ne+=Nt(O,K,re),K+=re),!J&&Ae<S&&(Z=Xt(Z,S+100),Ae=Z.length);se<S;)Z[se]=Z[se-Ne],++se}}}return J?[Z,K+7>>>3]:[Z.slice(0,se),K+7>>>3]}function wt(O,J){var K=O.slice(O.l||0),q=mt(K,J);return O.l+=q[1],q[0]}function Et(O,J){if(O)typeof console<"u"&&console.error(J);else throw new Error(J)}function $t(O,J){var K=O;Es(K,0);var q=[],Z=[],se={FileIndex:q,FullPaths:Z};k(se,{root:J.root});for(var Ae=K.length-4;(K[Ae]!=80||K[Ae+1]!=75||K[Ae+2]!=5||K[Ae+3]!=6)&&Ae>=0;)--Ae;K.l=Ae+4,K.l+=4;var Le=K.read_shift(2);K.l+=6;var Ce=K.read_shift(4);for(K.l=Ce,Ae=0;Ae<Le;++Ae){K.l+=20;var _e=K.read_shift(4),De=K.read_shift(4),Ke=K.read_shift(2),it=K.read_shift(2),S=K.read_shift(2);K.l+=8;var re=K.read_shift(4),Ne=d(K.slice(K.l+Ke,K.l+Ke+it));K.l+=Ke+it+S;var Te=K.l;K.l=re+4,Vt(K,_e,De,se,Ne),K.l=Te}return se}function Vt(O,J,K,q,Z){O.l+=2;var se=O.read_shift(2),Ae=O.read_shift(2),Le=c(O);if(se&8257)throw new Error("Unsupported ZIP encryption");for(var Ce=O.read_shift(4),_e=O.read_shift(4),De=O.read_shift(4),Ke=O.read_shift(2),it=O.read_shift(2),S="",re=0;re<Ke;++re)S+=String.fromCharCode(O[O.l++]);if(it){var Ne=d(O.slice(O.l,O.l+it));(Ne[21589]||{}).mt&&(Le=Ne[21589].mt),((Z||{})[21589]||{}).mt&&(Le=Z[21589].mt)}O.l+=it;var Te=O.slice(O.l,O.l+_e);switch(Ae){case 8:Te=ne(O,De);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ae)}var Qe=!1;se&8&&(Ce=O.read_shift(4),Ce==134695760&&(Ce=O.read_shift(4),Qe=!0),_e=O.read_shift(4),De=O.read_shift(4)),_e!=J&&Et(Qe,"Bad compressed size: "+J+" != "+_e),De!=K&&Et(Qe,"Bad uncompressed size: "+K+" != "+De),Pt(q,S,Te,{unsafe:!0,mt:Le})}function qt(O,J){var K=J||{},q=[],Z=[],se=us(1),Ae=K.compression?8:0,Le=0,Ce=0,_e=0,De=0,Ke=0,it=O.FullPaths[0],S=it,re=O.FileIndex[0],Ne=[],Te=0;for(Ce=1;Ce<O.FullPaths.length;++Ce)if(S=O.FullPaths[Ce].slice(it.length),re=O.FileIndex[Ce],!(!re.size||!re.content||S=="Sh33tJ5")){var Qe=De,St=us(S.length);for(_e=0;_e<S.length;++_e)St.write_shift(1,S.charCodeAt(_e)&127);St=St.slice(0,St.l),Ne[Ke]=b_.buf(re.content,0);var Yt=re.content;Ae==8&&(Yt=ae(Yt)),se=us(30),se.write_shift(4,67324752),se.write_shift(2,20),se.write_shift(2,Le),se.write_shift(2,Ae),re.mt?o(se,re.mt):se.write_shift(4,0),se.write_shift(-4,Ne[Ke]),se.write_shift(4,Yt.length),se.write_shift(4,re.content.length),se.write_shift(2,St.length),se.write_shift(2,0),De+=se.length,q.push(se),De+=St.length,q.push(St),De+=Yt.length,q.push(Yt),se=us(46),se.write_shift(4,33639248),se.write_shift(2,0),se.write_shift(2,20),se.write_shift(2,Le),se.write_shift(2,Ae),se.write_shift(4,0),se.write_shift(-4,Ne[Ke]),se.write_shift(4,Yt.length),se.write_shift(4,re.content.length),se.write_shift(2,St.length),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(4,0),se.write_shift(4,Qe),Te+=se.l,Z.push(se),Te+=St.length,Z.push(St),++Ke}return se=us(22),se.write_shift(4,101010256),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,Ke),se.write_shift(2,Ke),se.write_shift(4,Te),se.write_shift(4,De),se.write_shift(2,0),ii([ii(q),ii(Z),se])}var ls={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Oe(O,J){if(O.ctype)return O.ctype;var K=O.name||"",q=K.match(/\.([^\.]+)$/);return q&&ls[q[1]]||J&&(q=(K=J).match(/[\.\\]([^\.\\])+$/),q&&ls[q[1]])?ls[q[1]]:"application/octet-stream"}function U(O){for(var J=Uy(O),K=[],q=0;q<J.length;q+=76)K.push(J.slice(q,q+76));return K.join(`\r
`)+`\r
`}function ve(O){var J=O.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(_e){var De=_e.charCodeAt(0).toString(16).toUpperCase();return"="+(De.length==1?"0"+De:De)});J=J.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),J.charAt(0)==`
`&&(J="=0D"+J.slice(1)),J=J.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var K=[],q=J.split(`\r
`),Z=0;Z<q.length;++Z){var se=q[Z];if(se.length==0){K.push("");continue}for(var Ae=0;Ae<se.length;){var Le=76,Ce=se.slice(Ae,Ae+Le);Ce.charAt(Le-1)=="="?Le--:Ce.charAt(Le-2)=="="?Le-=2:Ce.charAt(Le-3)=="="&&(Le-=3),Ce=se.slice(Ae,Ae+Le),Ae+=Le,Ae<se.length&&(Ce+="="),K.push(Ce)}}return K.join(`\r
`)}function ct(O){for(var J=[],K=0;K<O.length;++K){for(var q=O[K];K<=O.length&&q.charAt(q.length-1)=="=";)q=q.slice(0,q.length-1)+O[++K];J.push(q)}for(var Z=0;Z<J.length;++Z)J[Z]=J[Z].replace(/[=][0-9A-Fa-f]{2}/g,function(se){return String.fromCharCode(parseInt(se.slice(1),16))});return Ha(J.join(`\r
`))}function vt(O,J,K){for(var q="",Z="",se="",Ae,Le=0;Le<10;++Le){var Ce=J[Le];if(!Ce||Ce.match(/^\s*$/))break;var _e=Ce.match(/^(.*?):\s*([^\s].*)$/);if(_e)switch(_e[1].toLowerCase()){case"content-location":q=_e[2].trim();break;case"content-type":se=_e[2].trim();break;case"content-transfer-encoding":Z=_e[2].trim();break}}switch(++Le,Z.toLowerCase()){case"base64":Ae=Ha(xa(J.slice(Le).join("")));break;case"quoted-printable":Ae=ct(J.slice(Le));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Z)}var De=Pt(O,q.slice(K.length),Ae,{unsafe:!0});se&&(De.ctype=se)}function L(O,J){if(F(O.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var K=J&&J.root||"",q=(tr&&Buffer.isBuffer(O)?O.toString("binary"):F(O)).split(`\r
`),Z=0,se="";for(Z=0;Z<q.length;++Z)if(se=q[Z],!!/^Content-Location:/i.test(se)&&(se=se.slice(se.indexOf("file")),K||(K=se.slice(0,se.lastIndexOf("/")+1)),se.slice(0,K.length)!=K))for(;K.length>0&&(K=K.slice(0,K.length-1),K=K.slice(0,K.lastIndexOf("/")+1),se.slice(0,K.length)!=K););var Ae=(q[1]||"").match(/boundary="(.*?)"/);if(!Ae)throw new Error("MAD cannot find boundary");var Le="--"+(Ae[1]||""),Ce=[],_e=[],De={FileIndex:Ce,FullPaths:_e};k(De);var Ke,it=0;for(Z=0;Z<q.length;++Z){var S=q[Z];S!==Le&&S!==Le+"--"||(it++&&vt(De,q.slice(Ke,Z),K),Ke=Z)}return De}function ce(O,J){var K=J||{},q=K.boundary||"SheetJS";q="------="+q;for(var Z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+q.slice(2)+'"',"","",""],se=O.FullPaths[0],Ae=se,Le=O.FileIndex[0],Ce=1;Ce<O.FullPaths.length;++Ce)if(Ae=O.FullPaths[Ce].slice(se.length),Le=O.FileIndex[Ce],!(!Le.size||!Le.content||Ae=="Sh33tJ5")){Ae=Ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Te){return"_x"+Te.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Te){return"_u"+Te.charCodeAt(0).toString(16)+"_"});for(var _e=Le.content,De=tr&&Buffer.isBuffer(_e)?_e.toString("binary"):F(_e),Ke=0,it=Math.min(1024,De.length),S=0,re=0;re<=it;++re)(S=De.charCodeAt(re))>=32&&S<128&&++Ke;var Ne=Ke>=it*4/5;Z.push(q),Z.push("Content-Location: "+(K.root||"file:///C:/SheetJS/")+Ae),Z.push("Content-Transfer-Encoding: "+(Ne?"quoted-printable":"base64")),Z.push("Content-Type: "+Oe(Le,Ae)),Z.push(""),Z.push(Ne?ve(De):U(De))}return Z.push(q+`--\r
`),Z.join(`\r
`)}function Be(O){var J={};return k(J,O),J}function Pt(O,J,K,q){var Z=q&&q.unsafe;Z||k(O);var se=!Z&&rr.find(O,J);if(!se){var Ae=O.FullPaths[0];J.slice(0,Ae.length)==Ae?Ae=J:(Ae.slice(-1)!="/"&&(Ae+="/"),Ae=(Ae+J).replace("//","/")),se={name:n(J),type:2},O.FileIndex.push(se),O.FullPaths.push(Ae),Z||rr.utils.cfb_gc(O)}return se.content=K,se.size=K?K.length:0,q&&(q.CLSID&&(se.clsid=q.CLSID),q.mt&&(se.mt=q.mt),q.ct&&(se.ct=q.ct)),se}function ar(O,J){k(O);var K=rr.find(O,J);if(K){for(var q=0;q<O.FileIndex.length;++q)if(O.FileIndex[q]==K)return O.FileIndex.splice(q,1),O.FullPaths.splice(q,1),!0}return!1}function $r(O,J,K){k(O);var q=rr.find(O,J);if(q){for(var Z=0;Z<O.FileIndex.length;++Z)if(O.FileIndex[Z]==q)return O.FileIndex[Z].name=n(K),O.FullPaths[Z]=K,!0}return!1}function ws(O){W(O,!0)}return r.find=de,r.read=P,r.parse=f,r.write=ee,r.writeFile=he,r.utils={cfb_new:Be,cfb_add:Pt,cfb_del:ar,cfb_mov:$r,cfb_gc:ws,ReadShift:rc,CheckField:kj,prep_blob:Es,bconcat:ii,use_zlib:_,_deflateRaw:et,_inflateRaw:wt,consts:xe},r})();function j_(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var s=r.read();return r.close(),s}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function nn(e){for(var r=Object.keys(e),s=[],a=0;a<r.length;++a)Object.prototype.hasOwnProperty.call(e,r[a])&&s.push(r[a]);return s}function Zf(e){for(var r=[],s=nn(e),a=0;a!==s.length;++a)r[e[s[a]]]=s[a];return r}var Cu=new Date(1899,11,30,0,0,0);function Js(e,r){var s=e.getTime(),a=Cu.getTime()+(e.getTimezoneOffset()-Cu.getTimezoneOffset())*6e4;return(s-a)/(1440*60*1e3)}var oj=new Date,E_=Cu.getTime()+(oj.getTimezoneOffset()-Cu.getTimezoneOffset())*6e4,Jy=oj.getTimezoneOffset();function Ju(e){var r=new Date;return r.setTime(e*24*60*60*1e3+E_),r.getTimezoneOffset()!==Jy&&r.setTime(r.getTime()+(r.getTimezoneOffset()-Jy)*6e4),r}function T_(e){var r=0,s=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=n.length;++o)if(n[o]){switch(s=1,o>3&&(a=!0),n[o].slice(n[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[o].slice(n[o].length-1));case"D":s*=24;case"H":s*=60;case"M":if(a)s*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=s*parseInt(n[o],10)}return r}var Qy=new Date("2017-02-19T19:06:09.000Z"),cj=isNaN(Qy.getFullYear())?new Date("2/19/17"):Qy,S_=cj.getFullYear()==2017;function ys(e,r){var s=new Date(e);if(S_)return r>0?s.setTime(s.getTime()+s.getTimezoneOffset()*60*1e3):r<0&&s.setTime(s.getTime()-s.getTimezoneOffset()*60*1e3),s;if(e instanceof Date)return e;if(cj.getFullYear()==1917&&!isNaN(s.getFullYear())){var a=s.getFullYear();return e.indexOf(""+a)>-1||s.setFullYear(s.getFullYear()+100),s}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function Qi(e,r){if(tr&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return Xo(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Xo(qb(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return Xo(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Xo(new TextDecoder("utf-16be").decode(e.slice(2)))}var s={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(o){return s[o]||o})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function Ts(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=Ts(e[s]));return r}function Wr(e,r){for(var s="";s.length<r;)s+=e;return s}function Wa(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var s=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return s*=100,""});return!isNaN(r=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,o){return s=-s,o}),!isNaN(r=Number(a)))?r/s:r}var A_=["january","february","march","april","may","june","july","august","september","october","november","december"];function Xl(e){var r=new Date(e),s=new Date(NaN),a=r.getYear(),n=r.getMonth(),o=r.getDate();if(isNaN(o))return s;var c=e.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&A_.indexOf(c)==-1)return s}else if(c.match(/[a-z]/))return s;return a<0||a>8099?s:(n>0||o>1)&&a!=101?r:e.match(/[^-0-9:,\/\\]/)?s:r}var C_=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(s,a,n){if(e||typeof a=="string")return s.split(a);for(var o=s.split(a),c=[o[0]],d=1;d<o.length;++d)c.push(n),c.push(o[d]);return c}})();function dj(e){return e?e.content&&e.type?Qi(e.content,!0):e.data?Wo(e.data):e.asNodeBuffer&&tr?Wo(e.asNodeBuffer().toString("binary")):e.asBinary?Wo(e.asBinary()):e._data&&e._data.getContent?Wo(Qi(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function uj(e){if(!e)return null;if(e.data)return Hy(e.data);if(e.asNodeBuffer&&tr)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?Hy(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function k_(e){return e&&e.name.slice(-4)===".bin"?uj(e):dj(e)}function Sa(e,r){for(var s=e.FullPaths||nn(e.files),a=r.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),o=0;o<s.length;++o){var c=s[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==c||n==c)return e.files?e.files[s[o]]:e.FileIndex[o]}return null}function ex(e,r){var s=Sa(e,r);if(s==null)throw new Error("Cannot find file "+r+" in zip");return s}function as(e,r,s){if(!s)return k_(ex(e,r));if(!r)return null;try{return as(e,r)}catch{return null}}function ha(e,r,s){if(!s)return dj(ex(e,r));if(!r)return null;try{return ha(e,r)}catch{return null}}function P_(e,r,s){return uj(ex(e,r))}function Zy(e){for(var r=e.FullPaths||nn(e.files),s=[],a=0;a<r.length;++a)r[a].slice(-1)!="/"&&s.push(r[a].replace(/^Root Entry[\/]/,""));return s.sort()}function R_(e,r,s){if(e.FullPaths){if(typeof s=="string"){var a;return tr?a=al(s):a=Y3(s),rr.utils.cfb_add(e,r,a)}rr.utils.cfb_add(e,r,s)}else e.file(r,s)}function hj(e,r){switch(r.type){case"base64":return rr.read(e,{type:"base64"});case"binary":return rr.read(e,{type:"binary"});case"buffer":case"array":return rr.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function Ko(e,r){if(e.charAt(0)=="/")return e.slice(1);var s=r.split("/");r.slice(-1)!="/"&&s.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?s.pop():n!=="."&&s.push(n)}return s.join("/")}var mj=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,__=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,e1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,D_=/<[^>]*>/g,Bs=mj.match(e1)?e1:D_,O_=/<\w*:/,F_=/<(\/?)\w+:/;function Mt(e,r,s){for(var a={},n=0,o=0;n!==e.length&&!((o=e.charCodeAt(n))===32||o===10||o===13);++n);if(r||(a[0]=e.slice(0,n)),n===e.length)return a;var c=e.match(__),d=0,h="",m=0,f="",p="",g=1;if(c)for(m=0;m!=c.length;++m){for(p=c[m],o=0;o!=p.length&&p.charCodeAt(o)!==61;++o);for(f=p.slice(0,o).trim();p.charCodeAt(o+1)==32;)++o;for(g=(n=p.charCodeAt(o+1))==34||n==39?1:0,h=p.slice(o+1+g,p.length-g),d=0;d!=f.length&&f.charCodeAt(d)!==58;++d);if(d===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),a[f]=h,a[f.toLowerCase()]=h;else{var N=(d===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(d+1);if(a[N]&&f.slice(d-3,d)=="ext")continue;a[N]=h,a[N.toLowerCase()]=h}}return a}function ln(e){return e.replace(F_,"<$1")}var fj={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},I_=Zf(fj),lr=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function s(a){var n=a+"",o=n.indexOf("<![CDATA[");if(o==-1)return n.replace(e,function(d,h){return fj[d]||String.fromCharCode(parseInt(h,d.indexOf("x")>-1?16:10))||d}).replace(r,function(d,h){return String.fromCharCode(parseInt(h,16))});var c=n.indexOf("]]>");return s(n.slice(0,o))+n.slice(o+9,c)+s(n.slice(c+3))}})(),M_=/[&<>'"]/g,L_=/[\u0000-\u001f]/g;function tx(e){var r=e+"";return r.replace(M_,function(s){return I_[s]}).replace(/\n/g,"<br/>").replace(L_,function(s){return"&#x"+("000"+s.charCodeAt(0).toString(16)).slice(-4)+";"})}var t1=(function(){var e=/&#(\d+);/g;function r(s,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,r)}})();function Br(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function hm(e){for(var r="",s=0,a=0,n=0,o=0,c=0,d=0;s<e.length;){if(a=e.charCodeAt(s++),a<128){r+=String.fromCharCode(a);continue}if(n=e.charCodeAt(s++),a>191&&a<224){c=(a&31)<<6,c|=n&63,r+=String.fromCharCode(c);continue}if(o=e.charCodeAt(s++),a<240){r+=String.fromCharCode((a&15)<<12|(n&63)<<6|o&63);continue}c=e.charCodeAt(s++),d=((a&7)<<18|(n&63)<<12|(o&63)<<6|c&63)-65536,r+=String.fromCharCode(55296+(d>>>10&1023)),r+=String.fromCharCode(56320+(d&1023))}return r}function r1(e){var r=gi(2*e.length),s,a,n=1,o=0,c=0,d;for(a=0;a<e.length;a+=n)n=1,(d=e.charCodeAt(a))<128?s=d:d<224?(s=(d&31)*64+(e.charCodeAt(a+1)&63),n=2):d<240?(s=(d&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,s=(d&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),s-=65536,c=55296+(s>>>10&1023),s=56320+(s&1023)),c!==0&&(r[o++]=c&255,r[o++]=c>>>8,c=0),r[o++]=s%256,r[o++]=s>>>8;return r.slice(0,o).toString("ucs2")}function s1(e){return al(e,"binary").toString("utf8")}var tu="foo bar baz",kr=tr&&(s1(tu)==hm(tu)&&s1||r1(tu)==hm(tu)&&r1)||hm,Xo=tr?function(e){return al(e,"utf8").toString("binary")}:function(e){for(var r=[],s=0,a=0,n=0;s<e.length;)switch(a=e.charCodeAt(s++),!0){case a<128:r.push(String.fromCharCode(a));break;case a<2048:r.push(String.fromCharCode(192+(a>>6))),r.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(s++)-56320+(a<<10),r.push(String.fromCharCode(240+(n>>18&7))),r.push(String.fromCharCode(144+(n>>12&63))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)));break;default:r.push(String.fromCharCode(224+(a>>12))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)))}return r.join("")},Nc=(function(){var e={};return function(s,a){var n=s+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+s+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+s+">",a||"")}})(),xj=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(s){for(var a=s.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}})(),B_=(function(){var e={};return function(s){return e[s]!==void 0?e[s]:e[s]=new RegExp("<(?:vt:)?"+s+">([\\s\\S]*?)</(?:vt:)?"+s+">","g")}})(),H_=/<\/?(?:vt:)?variant>/g,V_=/<(?:vt:)([^>]*)>([\s\S]*)</;function a1(e,r){var s=Mt(e),a=e.match(B_(s.baseType))||[],n=[];if(a.length!=s.size){if(r.WTF)throw new Error("unexpected vector length "+a.length+" != "+s.size);return n}return a.forEach(function(o){var c=o.replace(H_,"").match(V_);c&&n.push({v:kr(c[2]),t:c[1]})}),n}var U_=/(^\s|\s$|\n)/;function $_(e){return nn(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function G_(e,r,s){return"<"+e+(s!=null?$_(s):"")+(r!=null?(r.match(U_)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function rx(e){if(tr&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return kr(nl(Yf(e)));throw new Error("Bad input format: expected Buffer or string")}var wc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,W_={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},z_=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function K_(e,r){for(var s=1-2*(e[r+7]>>>7),a=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),n=e[r+6]&15,o=5;o>=0;--o)n=n*256+e[r+o];return a==2047?n==0?s*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),s*Math.pow(2,a-52)*n)}function X_(e,r,s){var a=(r<0||1/r==-1/0?1:0)<<7,n=0,o=0,c=a?-r:r;isFinite(c)?c==0?n=o=0:(n=Math.floor(Math.log(c)/Math.LN2),o=c*Math.pow(2,52-n),n<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?n=-1022:(o-=Math.pow(2,52),n+=1023)):(n=2047,o=isNaN(r)?26985:0);for(var d=0;d<=5;++d,o/=256)e[s+d]=o&255;e[s+6]=(n&15)<<4|o&15,e[s+7]=n>>4|a}var n1=function(e){for(var r=[],s=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,o=e[0][a].length;n<o;n+=s)r.push.apply(r,e[0][a].slice(n,n+s));return r},i1=tr?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:al(r)})):n1(e)}:n1,l1=function(e,r,s){for(var a=[],n=r;n<s;n+=2)a.push(String.fromCharCode(bn(e,n)));return a.join("").replace(Ys,"")},sx=tr?function(e,r,s){return Buffer.isBuffer(e)?e.toString("utf16le",r,s).replace(Ys,""):l1(e,r,s)}:l1,o1=function(e,r,s){for(var a=[],n=r;n<r+s;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},pj=tr?function(e,r,s){return Buffer.isBuffer(e)?e.toString("hex",r,r+s):o1(e,r,s)}:o1,c1=function(e,r,s){for(var a=[],n=r;n<s;n++)a.push(String.fromCharCode(Fl(e,n)));return a.join("")},Ic=tr?function(r,s,a){return Buffer.isBuffer(r)?r.toString("utf8",s,a):c1(r,s,a)}:c1,gj=function(e,r){var s=ua(e,r);return s>0?Ic(e,r+4,r+4+s-1):""},vj=gj,yj=function(e,r){var s=ua(e,r);return s>0?Ic(e,r+4,r+4+s-1):""},Nj=yj,wj=function(e,r){var s=2*ua(e,r);return s>0?Ic(e,r+4,r+4+s-1):""},bj=wj,jj=function(r,s){var a=ua(r,s);return a>0?sx(r,s+4,s+4+a):""},Ej=jj,Tj=function(e,r){var s=ua(e,r);return s>0?Ic(e,r+4,r+4+s):""},Sj=Tj,Aj=function(e,r){return K_(e,r)},ku=Aj,Cj=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};tr&&(vj=function(r,s){if(!Buffer.isBuffer(r))return gj(r,s);var a=r.readUInt32LE(s);return a>0?r.toString("utf8",s+4,s+4+a-1):""},Nj=function(r,s){if(!Buffer.isBuffer(r))return yj(r,s);var a=r.readUInt32LE(s);return a>0?r.toString("utf8",s+4,s+4+a-1):""},bj=function(r,s){if(!Buffer.isBuffer(r))return wj(r,s);var a=2*r.readUInt32LE(s);return r.toString("utf16le",s+4,s+4+a-1)},Ej=function(r,s){if(!Buffer.isBuffer(r))return jj(r,s);var a=r.readUInt32LE(s);return r.toString("utf16le",s+4,s+4+a)},Sj=function(r,s){if(!Buffer.isBuffer(r))return Tj(r,s);var a=r.readUInt32LE(s);return r.toString("utf8",s+4,s+4+a)},ku=function(r,s){return Buffer.isBuffer(r)?r.readDoubleLE(s):Aj(r,s)},Cj=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var Fl=function(e,r){return e[r]},bn=function(e,r){return e[r+1]*256+e[r]},q_=function(e,r){var s=e[r+1]*256+e[r];return s<32768?s:(65535-s+1)*-1},ua=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},Bi=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},Y_=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function rc(e,r){var s="",a,n,o=[],c,d,h,m;switch(r){case"dbcs":if(m=this.l,tr&&Buffer.isBuffer(this))s=this.slice(this.l,this.l+2*e).toString("utf16le");else for(h=0;h<e;++h)s+=String.fromCharCode(bn(this,m)),m+=2;e*=2;break;case"utf8":s=Ic(this,this.l,this.l+e);break;case"utf16le":e*=2,s=sx(this,this.l,this.l+e);break;case"wstr":return rc.call(this,e,"dbcs");case"lpstr-ansi":s=vj(this,this.l),e=4+ua(this,this.l);break;case"lpstr-cp":s=Nj(this,this.l),e=4+ua(this,this.l);break;case"lpwstr":s=bj(this,this.l),e=4+2*ua(this,this.l);break;case"lpp4":e=4+ua(this,this.l),s=Ej(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ua(this,this.l),s=Sj(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,s="";(c=Fl(this,this.l+e++))!==0;)o.push(eu(c));s=o.join("");break;case"_wstr":for(e=0,s="";(c=bn(this,this.l+e))!==0;)o.push(eu(c)),e+=2;e+=2,s=o.join("");break;case"dbcs-cont":for(s="",m=this.l,h=0;h<e;++h){if(this.lens&&this.lens.indexOf(m)!==-1)return c=Fl(this,m),this.l=m+1,d=rc.call(this,e-h,c?"dbcs-cont":"sbcs-cont"),o.join("")+d;o.push(eu(bn(this,m))),m+=2}s=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(s="",m=this.l,h=0;h!=e;++h){if(this.lens&&this.lens.indexOf(m)!==-1)return c=Fl(this,m),this.l=m+1,d=rc.call(this,e-h,c?"dbcs-cont":"sbcs-cont"),o.join("")+d;o.push(eu(Fl(this,m))),m+=1}s=o.join("");break;default:switch(e){case 1:return a=Fl(this,this.l),this.l++,a;case 2:return a=(r==="i"?q_:bn)(this,this.l),this.l+=2,a;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(a=(e>0?Bi:Y_)(this,this.l),this.l+=4,a):(n=ua(this,this.l),this.l+=4,n);case 8:case-8:if(r==="f")return e==8?n=ku(this,this.l):n=ku([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:s=pj(this,this.l,e);break}}return this.l+=e,s}var J_=function(e,r,s){e[s]=r&255,e[s+1]=r>>>8&255,e[s+2]=r>>>16&255,e[s+3]=r>>>24&255},Q_=function(e,r,s){e[s]=r&255,e[s+1]=r>>8&255,e[s+2]=r>>16&255,e[s+3]=r>>24&255},Z_=function(e,r,s){e[s]=r&255,e[s+1]=r>>>8&255};function eD(e,r,s){var a=0,n=0;if(s==="dbcs"){for(n=0;n!=r.length;++n)Z_(this,r.charCodeAt(n),this.l+2*n);a=2*r.length}else if(s==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=r.length;++n)this[this.l+n]=r.charCodeAt(n)&255;a=r.length}else if(s==="hex"){for(;n<e;++n)this[this.l++]=parseInt(r.slice(2*n,2*n+2),16)||0;return this}else if(s==="utf16le"){var o=Math.min(this.l+e,this.length);for(n=0;n<Math.min(r.length,e);++n){var c=r.charCodeAt(n);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=r&255;break;case 2:a=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:a=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:a=4,J_(this,r,this.l);break;case 8:if(a=8,s==="f"){X_(this,r,this.l);break}case 16:break;case-4:a=4,Q_(this,r,this.l);break}return this.l+=a,this}function kj(e,r){var s=pj(this,this.l,e.length>>1);if(s!==e)throw new Error(r+"Expected "+e+" saw "+s);this.l+=e.length>>1}function Es(e,r){e.l=r,e.read_shift=rc,e.chk=kj,e.write_shift=eD}function Ms(e,r){e.l+=r}function us(e){var r=gi(e);return Es(r,0),r}function _n(e,r,s){if(e){var a,n,o;Es(e,e.l||0);for(var c=e.length,d=0,h=0;e.l<c;){d=e.read_shift(1),d&128&&(d=(d&127)+((e.read_shift(1)&127)<<7));var m=Fu[d]||Fu[65535];for(a=e.read_shift(1),o=a&127,n=1;n<4&&a&128;++n)o+=((a=e.read_shift(1))&127)<<7*n;h=e.l+o;var f=m.f&&m.f(e,o,s);if(e.l=h,r(f,m,d))return}}}function ef(){var e=[],r=tr?256:2048,s=function(m){var f=us(m);return Es(f,0),f},a=s(r),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},o=function(m){return a&&m<a.length-a.l?a:(n(),a=s(Math.max(m+1,r)))},c=function(){return n(),ii(e)},d=function(m){n(),a=m,a.l==null&&(a.l=a.length),o(r)};return{next:o,push:d,end:c,_bufs:e}}function sc(e,r,s){var a=Ts(e);if(r.s?(a.cRel&&(a.c+=r.s.c),a.rRel&&(a.r+=r.s.r)):(a.cRel&&(a.c+=r.c),a.rRel&&(a.r+=r.r)),!s||s.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function d1(e,r,s){var a=Ts(e);return a.s=sc(a.s,r.s,s),a.e=sc(a.e,r.s,s),a}function ac(e,r){if(e.cRel&&e.c<0)for(e=Ts(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=Ts(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var s=Gt(e);return!e.cRel&&e.cRel!=null&&(s=sD(s)),!e.rRel&&e.rRel!=null&&(s=tD(s)),s}function mm(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+hs(e.s.c)+":"+(e.e.cRel?"":"$")+hs(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Ss(e.s.r)+":"+(e.e.rRel?"":"$")+Ss(e.e.r):ac(e.s,r.biff)+":"+ac(e.e,r.biff)}function ax(e){return parseInt(rD(e),10)-1}function Ss(e){return""+(e+1)}function tD(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function rD(e){return e.replace(/\$(\d+)$/,"$1")}function nx(e){for(var r=aD(e),s=0,a=0;a!==r.length;++a)s=26*s+r.charCodeAt(a)-64;return s-1}function hs(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function sD(e){return e.replace(/^([A-Z])/,"$$$1")}function aD(e){return e.replace(/^\$([A-Z])/,"$1")}function nD(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Xs(e){for(var r=0,s=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?r=10*r+(n-48):n>=65&&n<=90&&(s=26*s+(n-64))}return{c:s-1,r:r-1}}function Gt(e){for(var r=e.c+1,s="";r;r=(r-1)/26|0)s=String.fromCharCode((r-1)%26+65)+s;return s+(e.r+1)}function eo(e){var r=e.indexOf(":");return r==-1?{s:Xs(e),e:Xs(e)}:{s:Xs(e.slice(0,r)),e:Xs(e.slice(r+1))}}function sr(e,r){return typeof r>"u"||typeof r=="number"?sr(e.s,e.e):(typeof e!="string"&&(e=Gt(e)),typeof r!="string"&&(r=Gt(r)),e==r?e:e+":"+r)}function qr(e){var r={s:{c:0,r:0},e:{c:0,r:0}},s=0,a=0,n=0,o=e.length;for(s=0;a<o&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)s=26*s+n;for(r.s.c=--s,s=0;a<o&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)s=10*s+n;if(r.s.r=--s,a===o||n!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++a,s=0;a!=o&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)s=26*s+n;for(r.e.c=--s,s=0;a!=o&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)s=10*s+n;return r.e.r=--s,r}function u1(e,r){var s=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=Aa(e.z,s?Js(r):r)}catch{}try{return e.w=Aa((e.XF||{}).numFmtId||(s?14:0),s?Js(r):r)}catch{return""+r}}function Pn(e,r,s){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&s&&s.dateNF&&(e.z=s.dateNF),e.t=="e"?ol[e.v]||e.v:r==null?u1(e,e.v):u1(e,r))}function bi(e,r){var s=r&&r.sheet?r.sheet:"Sheet1",a={};return a[s]=e,{SheetNames:[s],Sheets:a}}function Pj(e,r,s){var a=s||{},n=e?Array.isArray(e):a.dense,o=e||(n?[]:{}),c=0,d=0;if(o&&a.origin!=null){if(typeof a.origin=="number")c=a.origin;else{var h=typeof a.origin=="string"?Xs(a.origin):a.origin;c=h.r,d=h.c}o["!ref"]||(o["!ref"]="A1:A1")}var m={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var f=qr(o["!ref"]);m.s.c=f.s.c,m.s.r=f.s.r,m.e.c=Math.max(m.e.c,f.e.c),m.e.r=Math.max(m.e.r,f.e.r),c==-1&&(m.e.r=c=f.e.r+1)}for(var p=0;p!=r.length;++p)if(r[p]){if(!Array.isArray(r[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=r[p].length;++g)if(!(typeof r[p][g]>"u")){var N={v:r[p][g]},y=c+p,w=d+g;if(m.s.r>y&&(m.s.r=y),m.s.c>w&&(m.s.c=w),m.e.r<y&&(m.e.r=y),m.e.c<w&&(m.e.c=w),r[p][g]&&typeof r[p][g]=="object"&&!Array.isArray(r[p][g])&&!(r[p][g]instanceof Date))N=r[p][g];else if(Array.isArray(N.v)&&(N.f=r[p][g][1],N.v=N.v[0]),N.v===null)if(N.f)N.t="n";else if(a.nullError)N.t="e",N.v=0;else if(a.sheetStubs)N.t="z";else continue;else typeof N.v=="number"?N.t="n":typeof N.v=="boolean"?N.t="b":N.v instanceof Date?(N.z=a.dateNF||zt[14],a.cellDates?(N.t="d",N.w=Aa(N.z,Js(N.v))):(N.t="n",N.v=Js(N.v),N.w=Aa(N.z,N.v))):N.t="s";if(n)o[y]||(o[y]=[]),o[y][w]&&o[y][w].z&&(N.z=o[y][w].z),o[y][w]=N;else{var b=Gt({c:w,r:y});o[b]&&o[b].z&&(N.z=o[b].z),o[b]=N}}}return m.s.c<1e7&&(o["!ref"]=sr(m)),o}function to(e,r){return Pj(null,e,r)}function iD(e){return e.read_shift(4,"i")}function Is(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function lD(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function ix(e,r){var s=e.l,a=e.read_shift(1),n=Is(e),o=[],c={t:n,h:n};if((a&1)!==0){for(var d=e.read_shift(4),h=0;h!=d;++h)o.push(lD(e));c.r=o}else c.r=[{ich:0,ifnt:0}];return e.l=s+r,c}var oD=ix;function Ca(e){var r=e.read_shift(4),s=e.read_shift(2);return s+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:s}}function il(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}var cD=Is;function lx(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}var dD=Is,tf=lx;function ox(e){var r=e.slice(e.l,e.l+4),s=r[0]&1,a=r[0]&2;e.l+=4;var n=a===0?ku([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):Bi(r,0)>>2;return s?n/100:n}function Rj(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var ll=Rj;function Os(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function uD(e){var r={},s=e.read_shift(1),a=s>>>1,n=e.read_shift(1),o=e.read_shift(2,"i"),c=e.read_shift(1),d=e.read_shift(1),h=e.read_shift(1);switch(e.l++,a){case 0:r.auto=1;break;case 1:r.index=n;var m=qi[n];m&&(r.rgb=jc(m));break;case 2:r.rgb=jc([c,d,h]);break;case 3:r.theme=n;break}return o!=0&&(r.tint=o>0?o/32767:o/32768),r}function hD(e){var r=e.read_shift(1);e.l++;var s={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return s}function _j(e,r){var s={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return s[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function mD(e){return _j(e,1)}function fD(e){return _j(e,2)}var cx=2,na=3,ru=11,h1=12,Pu=19,su=64,xD=65,pD=71,gD=4108,vD=4126,vs=80,Dj=81,yD=[vs,Dj],ND={1:{n:"CodePage",t:cx},2:{n:"Category",t:vs},3:{n:"PresentationFormat",t:vs},4:{n:"ByteCount",t:na},5:{n:"LineCount",t:na},6:{n:"ParagraphCount",t:na},7:{n:"SlideCount",t:na},8:{n:"NoteCount",t:na},9:{n:"HiddenCount",t:na},10:{n:"MultimediaClipCount",t:na},11:{n:"ScaleCrop",t:ru},12:{n:"HeadingPairs",t:gD},13:{n:"TitlesOfParts",t:vD},14:{n:"Manager",t:vs},15:{n:"Company",t:vs},16:{n:"LinksUpToDate",t:ru},17:{n:"CharacterCount",t:na},19:{n:"SharedDoc",t:ru},22:{n:"HyperlinksChanged",t:ru},23:{n:"AppVersion",t:na,p:"version"},24:{n:"DigSig",t:xD},26:{n:"ContentType",t:vs},27:{n:"ContentStatus",t:vs},28:{n:"Language",t:vs},29:{n:"Version",t:vs},255:{},2147483648:{n:"Locale",t:Pu},2147483651:{n:"Behavior",t:Pu},1919054434:{}},wD={1:{n:"CodePage",t:cx},2:{n:"Title",t:vs},3:{n:"Subject",t:vs},4:{n:"Author",t:vs},5:{n:"Keywords",t:vs},6:{n:"Comments",t:vs},7:{n:"Template",t:vs},8:{n:"LastAuthor",t:vs},9:{n:"RevNumber",t:vs},10:{n:"EditTime",t:su},11:{n:"LastPrinted",t:su},12:{n:"CreatedDate",t:su},13:{n:"ModifiedDate",t:su},14:{n:"PageCount",t:na},15:{n:"WordCount",t:na},16:{n:"CharCount",t:na},17:{n:"Thumbnail",t:pD},18:{n:"Application",t:vs},19:{n:"DocSecurity",t:na},255:{},2147483648:{n:"Locale",t:Pu},2147483651:{n:"Behavior",t:Pu},1919054434:{}},m1={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},bD=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function jD(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var ED=jD([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),qi=Ts(ED),ol={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Oj={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},f1={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function TD(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function SD(e){var r=TD();if(!e||!e.match)return r;var s={};if((e.match(Bs)||[]).forEach(function(a){var n=Mt(a);switch(n[0].replace(O_,"<")){case"<?xml":break;case"<Types":r.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":s[n.Extension]=n.ContentType;break;case"<Override":r[f1[n.ContentType]]!==void 0&&r[f1[n.ContentType]].push(n.PartName);break}}),r.xmlns!==W_.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=s,delete r.calcchains,r}var Vl={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function rf(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function nc(e,r){var s={"!id":{}};if(!e)return s;r.charAt(0)!=="/"&&(r="/"+r);var a={};return(e.match(Bs)||[]).forEach(function(n){var o=Mt(n);if(o[0]==="<Relationship"){var c={};c.Type=o.Type,c.Target=o.Target,c.Id=o.Id,o.TargetMode&&(c.TargetMode=o.TargetMode);var d=o.TargetMode==="External"?o.Target:Ko(o.Target,r);s[d]=c,a[o.Id]=c}}),s["!id"]=a,s}var AD="application/vnd.oasis.opendocument.spreadsheet";function CD(e,r){for(var s=rx(e),a,n;a=wc.exec(s);)switch(a[3]){case"manifest":break;case"file-entry":if(n=Mt(a[0],!1),n.path=="/"&&n.type!==AD)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw a}}var ic=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],kD=(function(){for(var e=new Array(ic.length),r=0;r<ic.length;++r){var s=ic[r],a="(?:"+s[0].slice(0,s[0].indexOf(":"))+":)"+s[0].slice(s[0].indexOf(":")+1);e[r]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e})();function Fj(e){var r={};e=kr(e);for(var s=0;s<ic.length;++s){var a=ic[s],n=e.match(kD[s]);n!=null&&n.length>0&&(r[a[1]]=lr(n[1])),a[2]==="date"&&r[a[1]]&&(r[a[1]]=ys(r[a[1]]))}return r}var PD=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Ij(e,r,s,a){var n=[];if(typeof e=="string")n=a1(e,a);else for(var o=0;o<e.length;++o)n=n.concat(e[o].map(function(f){return{v:f}}));var c=typeof r=="string"?a1(r,a).map(function(f){return f.v}):r,d=0,h=0;if(c.length>0)for(var m=0;m!==n.length;m+=2){switch(h=+n[m+1].v,n[m].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":s.Worksheets=h,s.SheetNames=c.slice(d,d+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":s.NamedRanges=h,s.DefinedNames=c.slice(d,d+h);break;case"Charts":case"Diagramme":s.Chartsheets=h,s.ChartNames=c.slice(d,d+h);break}d+=h}}function RD(e,r,s){var a={};return r||(r={}),e=kr(e),PD.forEach(function(n){var o=(e.match(Nc(n[0]))||[])[1];switch(n[2]){case"string":o&&(r[n[1]]=lr(o));break;case"bool":r[n[1]]=o==="true";break;case"raw":var c=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));c&&c.length>0&&(a[n[1]]=c[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&Ij(a.HeadingPairs,a.TitlesOfParts,r,s),r}var _D=/<[^>]+>[^<]*/g;function DD(e,r){var s={},a="",n=e.match(_D);if(n)for(var o=0;o!=n.length;++o){var c=n[o],d=Mt(c);switch(d[0]){case"<?xml":break;case"<Properties":break;case"<property":a=lr(d.name);break;case"</property>":a=null;break;default:if(c.indexOf("<vt:")===0){var h=c.split(">"),m=h[0].slice(4),f=h[1];switch(m){case"lpstr":case"bstr":case"lpwstr":s[a]=lr(f);break;case"bool":s[a]=Br(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":s[a]=parseInt(f,10);break;case"r4":case"r8":case"decimal":s[a]=parseFloat(f);break;case"filetime":case"date":s[a]=ys(f);break;case"cy":case"error":s[a]=lr(f);break;default:if(m.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",c,m,h)}}else if(c.slice(0,2)!=="</"){if(r.WTF)throw new Error(c)}}}return s}var OD={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},fm;function FD(e,r,s){fm||(fm=Zf(OD)),r=fm[r]||r,e[r]=s}function dx(e){var r=e.read_shift(4),s=e.read_shift(4);return new Date((s/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Mj(e,r,s){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(s)for(;e.l-a&3;)++e.l;return n}function Lj(e,r,s){var a=e.read_shift(0,"lpwstr");return a}function Bj(e,r,s){return r===31?Lj(e):Mj(e,r,s)}function sf(e,r,s){return Bj(e,r,s===!1?0:4)}function ID(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return Bj(e,r,0)}function MD(e){for(var r=e.read_shift(4),s=[],a=0;a!=r;++a){var n=e.l;s[a]=e.read_shift(0,"lpwstr").replace(Ys,""),e.l-n&2&&(e.l+=2)}return s}function LD(e){for(var r=e.read_shift(4),s=[],a=0;a!=r;++a)s[a]=e.read_shift(0,"lpstr-cp").replace(Ys,"");return s}function BD(e){var r=e.l,s=Ru(e,Dj);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var a=Ru(e,na);return[s,a]}function HD(e){for(var r=e.read_shift(4),s=[],a=0;a<r/2;++a)s.push(BD(e));return s}function x1(e,r){for(var s=e.read_shift(4),a={},n=0;n!=s;++n){var o=e.read_shift(4),c=e.read_shift(4);a[o]=e.read_shift(c,r===1200?"utf16le":"utf8").replace(Ys,"").replace(zo,"!"),r===1200&&c%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function Hj(e){var r=e.read_shift(4),s=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),s}function VD(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function Ru(e,r,s){var a=e.read_shift(2),n,o=s||{};if(e.l+=2,r!==h1&&a!==r&&yD.indexOf(r)===-1&&!((r&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+r+" saw "+a);switch(r===h1?a:r){case 2:return n=e.read_shift(2,"i"),o.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return Mj(e,a,4).replace(Ys,"");case 31:return Lj(e);case 64:return dx(e);case 65:return Hj(e);case 71:return VD(e);case 80:return sf(e,a,!o.raw).replace(Ys,"");case 81:return ID(e,a).replace(Ys,"");case 4108:return HD(e);case 4126:case 4127:return a==4127?MD(e):LD(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+a)}}function p1(e,r){var s=e.l,a=e.read_shift(4),n=e.read_shift(4),o=[],c=0,d=0,h=-1,m={};for(c=0;c!=n;++c){var f=e.read_shift(4),p=e.read_shift(4);o[c]=[f,p+s]}o.sort(function(A,E){return A[1]-E[1]});var g={};for(c=0;c!=n;++c){if(e.l!==o[c][1]){var N=!0;if(c>0&&r)switch(r[o[c-1][0]].t){case 2:e.l+2===o[c][1]&&(e.l+=2,N=!1);break;case 80:e.l<=o[c][1]&&(e.l=o[c][1],N=!1);break;case 4108:e.l<=o[c][1]&&(e.l=o[c][1],N=!1);break}if((!r||c==0)&&e.l<=o[c][1]&&(N=!1,e.l=o[c][1]),N)throw new Error("Read Error: Expected address "+o[c][1]+" at "+e.l+" :"+c)}if(r){var y=r[o[c][0]];if(g[y.n]=Ru(e,y.t,{raw:!0}),y.p==="version"&&(g[y.n]=String(g[y.n]>>16)+"."+("0000"+String(g[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(g[y.n]){case 0:g[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ua(d=g[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[y.n])}}else if(o[c][0]===1){if(d=g.CodePage=Ru(e,cx),Ua(d),h!==-1){var w=e.l;e.l=o[h][1],m=x1(e,d),e.l=w}}else if(o[c][0]===0){if(d===0){h=c,e.l=o[c+1][1];continue}m=x1(e,d)}else{var b=m[o[c][0]],C;switch(e[e.l]){case 65:e.l+=4,C=Hj(e);break;case 30:e.l+=4,C=sf(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,C=sf(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,C=e.read_shift(4,"i");break;case 19:e.l+=4,C=e.read_shift(4);break;case 5:e.l+=4,C=e.read_shift(8,"f");break;case 11:e.l+=4,C=Qr(e,4);break;case 64:e.l+=4,C=ys(dx(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[b]=C}}return e.l=s+a,g}function g1(e,r,s){var a=e.content;if(!a)return{};Es(a,0);var n,o,c,d,h=0;a.chk("feff","Byte Order: "),a.read_shift(2);var m=a.read_shift(4),f=a.read_shift(16);if(f!==rr.utils.consts.HEADER_CLSID&&f!==s)throw new Error("Bad PropertySet CLSID "+f);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(o=a.read_shift(16),d=a.read_shift(4),n===1&&d!==a.l)throw new Error("Length mismatch: "+d+" !== "+a.l);n===2&&(c=a.read_shift(16),h=a.read_shift(4));var p=p1(a,r),g={SystemIdentifier:m};for(var N in p)g[N]=p[N];if(g.FMTID=o,n===1)return g;if(h-a.l==2&&(a.l+=2),a.l!==h)throw new Error("Length mismatch 2: "+a.l+" !== "+h);var y;try{y=p1(a,null)}catch{}for(N in y)g[N]=y[N];return g.FMTID=[o,c],g}function ei(e,r){return e.read_shift(r),null}function UD(e,r,s){for(var a=[],n=e.l+r;e.l<n;)a.push(s(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function Qr(e,r){return e.read_shift(r)===1}function ns(e){return e.read_shift(2,"u")}function Vj(e,r){return UD(e,r,ns)}function $D(e){var r=e.read_shift(1),s=e.read_shift(1);return s===1?r:r===1}function Mc(e,r,s){var a=e.read_shift(s&&s.biff>=12?2:1),n="sbcs-cont";if(s&&s.biff>=8,!s||s.biff==8){var o=e.read_shift(1);o&&(n="dbcs-cont")}else s.biff==12&&(n="wstr");s.biff>=2&&s.biff<=5&&(n="cpstr");var c=a?e.read_shift(a,n):"";return c}function GD(e){var r=e.read_shift(2),s=e.read_shift(1),a=s&4,n=s&8,o=1+(s&1),c=0,d,h={};n&&(c=e.read_shift(2)),a&&(d=e.read_shift(4));var m=o==2?"dbcs-cont":"sbcs-cont",f=r===0?"":e.read_shift(r,m);return n&&(e.l+=4*c),a&&(e.l+=d),h.t=f,n||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function Zi(e,r,s){var a;if(s){if(s.biff>=2&&s.biff<=5)return e.read_shift(r,"cpstr");if(s.biff>=12)return e.read_shift(r,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(r,"sbcs-cont"):a=e.read_shift(r,"dbcs-cont"),a}function Lc(e,r,s){var a=e.read_shift(s&&s.biff==2?1:2);return a===0?(e.l++,""):Zi(e,a,s)}function cl(e,r,s){if(s.biff>5)return Lc(e,r,s);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,s.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function WD(e){var r=e.read_shift(1);e.l++;var s=e.read_shift(2);return e.l+=2,[r,s]}function zD(e){var r=e.read_shift(4),s=e.l,a=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=s);var n=e.read_shift((a?r-24:r)>>1,"utf16le").replace(Ys,"");return a&&(e.l+=24),n}function KD(e){for(var r=e.read_shift(2),s="";r-- >0;)s+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return s+a.replace(/\\/g,"/");var o=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=e.read_shift(o>>1,"utf16le").replace(Ys,"");return s+c}function XD(e,r){var s=e.read_shift(16);switch(s){case"e0c9ea79f9bace118c8200aa004ba90b":return zD(e);case"0303000000000000c000000000000046":return KD(e);default:throw new Error("Unsupported Moniker "+s)}}function au(e){var r=e.read_shift(4),s=r>0?e.read_shift(r,"utf16le").replace(Ys,""):"";return s}function qD(e,r){var s=e.l+r,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var o,c,d,h,m="",f,p;n&16&&(o=au(e,s-e.l)),n&128&&(c=au(e,s-e.l)),(n&257)===257&&(d=au(e,s-e.l)),(n&257)===1&&(h=XD(e,s-e.l)),n&8&&(m=au(e,s-e.l)),n&32&&(f=e.read_shift(16)),n&64&&(p=dx(e)),e.l=s;var g=c||d||h||"";g&&m&&(g+="#"+m),g||(g="#"+m),n&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var N={Target:g};return f&&(N.guid=f),p&&(N.time=p),o&&(N.Tooltip=o),N}function Uj(e){var r=e.read_shift(1),s=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[r,s,a,n]}function $j(e,r){var s=Uj(e);return s[3]=0,s}function on(e){var r=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);return{r,c:s,ixfe:a}}function YD(e){var r=e.read_shift(2),s=e.read_shift(2);return e.l+=8,{type:r,flags:s}}function JD(e,r,s){return r===0?"":cl(e,r,s)}function QD(e,r,s){var a=s.biff>8?4:2,n=e.read_shift(a),o=e.read_shift(a,"i"),c=e.read_shift(a,"i");return[n,o,c]}function Gj(e){var r=e.read_shift(2),s=ox(e);return[r,s]}function ZD(e,r,s){e.l+=4,r-=4;var a=e.l+r,n=Mc(e,r,s),o=e.read_shift(2);if(a-=e.l,o!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+o);return e.l+=o,n}function Qu(e){var r=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r},e:{c:n,r:s}}}function Wj(e){var r=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r},e:{c:n,r:s}}}var eO=Wj;function zj(e){e.l+=4;var r=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[s,r,a]}function tO(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function rO(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function Rs(e){e.l+=2,e.l+=e.read_shift(2)}var sO={0:Rs,4:Rs,5:Rs,6:Rs,7:rO,8:Rs,9:Rs,10:Rs,11:Rs,12:Rs,13:tO,14:Rs,15:Rs,16:Rs,17:Rs,18:Rs,19:Rs,20:Rs,21:zj};function aO(e,r){for(var s=e.l+r,a=[];e.l<s;){var n=e.read_shift(2);e.l-=2;try{a.push(sO[n](e,s-e.l))}catch{return e.l=s,a}}return e.l!=s&&(e.l=s),a}function nu(e,r){var s={BIFFVer:0,dt:0};switch(s.BIFFVer=e.read_shift(2),r-=2,r>=2&&(s.dt=e.read_shift(2),e.l-=2),s.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+s.BIFFVer)}return e.read_shift(r),s}function nO(e,r){return r===0||e.read_shift(2),1200}function iO(e,r,s){if(s.enc)return e.l+=r,"";var a=e.l,n=cl(e,0,s);return e.read_shift(r+a-e.l),n}function lO(e,r,s){var a=s&&s.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function oO(e,r,s){var a=e.read_shift(4),n=e.read_shift(1)&3,o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var c=Mc(e,0,s);return c.length===0&&(c="Sheet1"),{pos:a,hs:n,dt:o,name:c}}function cO(e,r){for(var s=e.l+r,a=e.read_shift(4),n=e.read_shift(4),o=[],c=0;c!=n&&e.l<s;++c)o.push(GD(e));return o.Count=a,o.Unique=n,o}function dO(e,r){var s={};return s.dsst=e.read_shift(2),e.l+=r-2,s}function uO(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var s=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(r.level=a&7),a&32&&(r.hidden=!0),a&64&&(r.hpt=s/20),r}function hO(e){var r=YD(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var s=e.read_shift(4);return s!==0}function mO(e){return e.read_shift(2),e.read_shift(4)}function v1(e,r,s){var a=0;s&&s.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);s&&s.biff==2&&(a=1-(n>>15),n&=32767);var o={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[o,n]}function fO(e){var r=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),d=e.read_shift(2),h=e.read_shift(2),m=e.read_shift(2);return{Pos:[r,s],Dim:[a,n],Flags:o,CurTab:c,FirstTab:d,Selected:h,TabRatio:m}}function xO(e,r,s){if(s&&s.biff>=2&&s.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function pO(){}function gO(e,r,s){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(s&&s.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=Mc(e,0,s),a}function vO(e){var r=on(e);return r.isst=e.read_shift(4),r}function yO(e,r,s){s.biffguess&&s.biff==2&&(s.biff=5);var a=e.l+r,n=on(e);s.biff==2&&e.l++;var o=Lc(e,a-e.l,s);return n.val=o,n}function NO(e,r,s){var a=e.read_shift(2),n=cl(e,0,s);return[a,n]}var wO=cl;function y1(e,r,s){var a=e.l+r,n=s.biff==8||!s.biff?4:2,o=e.read_shift(n),c=e.read_shift(n),d=e.read_shift(2),h=e.read_shift(2);return e.l=a,{s:{r:o,c:d},e:{r:c,c:h}}}function bO(e){var r=e.read_shift(2),s=e.read_shift(2),a=Gj(e);return{r,c:s,ixfe:a[0],rknum:a[1]}}function jO(e,r){for(var s=e.l+r-2,a=e.read_shift(2),n=e.read_shift(2),o=[];e.l<s;)o.push(Gj(e));if(e.l!==s)throw new Error("MulRK read error");var c=e.read_shift(2);if(o.length!=c-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:c,rkrec:o}}function EO(e,r){for(var s=e.l+r-2,a=e.read_shift(2),n=e.read_shift(2),o=[];e.l<s;)o.push(e.read_shift(2));if(e.l!==s)throw new Error("MulBlank read error");var c=e.read_shift(2);if(o.length!=c-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:c,ixfe:o}}function TO(e,r,s,a){var n={},o=e.read_shift(4),c=e.read_shift(4),d=e.read_shift(4),h=e.read_shift(2);return n.patternType=bD[d>>26],a.cellStyles&&(n.alc=o&7,n.fWrap=o>>3&1,n.alcV=o>>4&7,n.fJustLast=o>>7&1,n.trot=o>>8&255,n.cIndent=o>>16&15,n.fShrinkToFit=o>>20&1,n.iReadOrder=o>>22&2,n.fAtrNum=o>>26&1,n.fAtrFnt=o>>27&1,n.fAtrAlc=o>>28&1,n.fAtrBdr=o>>29&1,n.fAtrPat=o>>30&1,n.fAtrProt=o>>31&1,n.dgLeft=c&15,n.dgRight=c>>4&15,n.dgTop=c>>8&15,n.dgBottom=c>>12&15,n.icvLeft=c>>16&127,n.icvRight=c>>23&127,n.grbitDiag=c>>30&3,n.icvTop=d&127,n.icvBottom=d>>7&127,n.icvDiag=d>>14&127,n.dgDiag=d>>21&15,n.icvFore=h&127,n.icvBack=h>>7&127,n.fsxButton=h>>14&1),n}function SO(e,r,s){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,r-=6,a.data=TO(e,r,a.fStyle,s),a}function AO(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function N1(e,r,s){var a=on(e);(s.biff==2||r==9)&&++e.l;var n=$D(e);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function CO(e,r,s){s.biffguess&&s.biff==2&&(s.biff=5);var a=on(e),n=Os(e);return a.val=n,a}var w1=JD;function kO(e,r,s){var a=e.l+r,n=e.read_shift(2),o=e.read_shift(2);if(s.sbcch=o,o==1025||o==14849)return[o,n];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var c=Zi(e,o),d=[];a>e.l;)d.push(Lc(e));return[o,n,c,d]}function b1(e,r,s){var a=e.read_shift(2),n,o={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return s.sbcch===14849&&(n=ZD(e,r-2,s)),o.body=n||e.read_shift(r-2),typeof n=="string"&&(o.Name=n),o}var PO=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function j1(e,r,s){var a=e.l+r,n=e.read_shift(2),o=e.read_shift(1),c=e.read_shift(1),d=e.read_shift(s&&s.biff==2?1:2),h=0;(!s||s.biff>=5)&&(s.biff!=5&&(e.l+=2),h=e.read_shift(2),s.biff==5&&(e.l+=2),e.l+=4);var m=Zi(e,c,s);n&32&&(m=PO[m.charCodeAt(0)]);var f=a-e.l;s&&s.biff==2&&--f;var p=a==e.l||d===0||!(f>0)?[]:u8(e,f,s,d);return{chKey:o,Name:m,itab:h,rgce:p}}function Kj(e,r,s){if(s.biff<8)return RO(e,r,s);for(var a=[],n=e.l+r,o=e.read_shift(s.biff>8?4:2);o--!==0;)a.push(QD(e,s.biff>8?12:6,s));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function RO(e,r,s){e[e.l+1]==3&&e[e.l]++;var a=Mc(e,r,s);return a.charCodeAt(0)==3?a.slice(1):a}function _O(e,r,s){if(s.biff<8){e.l+=r;return}var a=e.read_shift(2),n=e.read_shift(2),o=Zi(e,a,s),c=Zi(e,n,s);return[o,c]}function DO(e,r,s){var a=Wj(e);e.l++;var n=e.read_shift(1);return r-=8,[h8(e,r,s),n,a]}function E1(e,r,s){var a=eO(e);switch(s.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[a,c8(e,r,s)]}function OO(e){var r=e.read_shift(4)!==0,s=e.read_shift(4)!==0,a=e.read_shift(4);return[r,s,a]}function FO(e,r,s){if(!(s.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),d=cl(e,0,s);return s.biff<8&&e.read_shift(1),[{r:a,c:n},d,c,o]}}function IO(e,r,s){return FO(e,r,s)}function MO(e,r){for(var s=[],a=e.read_shift(2);a--;)s.push(Qu(e));return s}function LO(e,r,s){if(s&&s.biff<8)return HO(e,r,s);var a=zj(e),n=aO(e,r-22,a[1]);return{cmo:a,ft:n}}var BO={8:function(e,r){var s=e.l+r;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=s,{fmt:a}}};function HO(e,r,s){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var c=[];return c.push((BO[a]||Ms)(e,r,s)),{cmo:[n,a,o],ft:c}}function VO(e,r,s){var a=e.l,n="";try{e.l+=4;var o=(s.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(o)==-1?e.l+=6:c=WD(e,6,s);var d=e.read_shift(2);e.read_shift(2),ns(e,2);var h=e.read_shift(2);e.l+=h;for(var m=1;m<e.lens.length-1;++m){if(e.l-a!=e.lens[m])throw new Error("TxO: bad continue record");var f=e[e.l],p=Zi(e,e.lens[m+1]-e.lens[m]-1);if(n+=p,n.length>=(f?d:2*d))break}if(n.length!==d&&n.length!==d*2)throw new Error("cchText: "+d+" != "+n.length);return e.l=a+r,{t:n}}catch{return e.l=a+r,{t:n}}}function UO(e,r){var s=Qu(e);e.l+=16;var a=qD(e,r-24);return[s,a]}function $O(e,r){e.read_shift(2);var s=Qu(e),a=e.read_shift((r-10)/2,"dbcs-cont");return a=a.replace(Ys,""),[s,a]}function GO(e){var r=[0,0],s;return s=e.read_shift(2),r[0]=m1[s]||s,s=e.read_shift(2),r[1]=m1[s]||s,r}function WO(e){for(var r=e.read_shift(2),s=[];r-- >0;)s.push($j(e));return s}function zO(e){for(var r=e.read_shift(2),s=[];r-- >0;)s.push($j(e));return s}function KO(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function Xj(e,r,s){if(!s.cellStyles)return Ms(e,r);var a=s&&s.biff>=12?4:2,n=e.read_shift(a),o=e.read_shift(a),c=e.read_shift(a),d=e.read_shift(a),h=e.read_shift(2);a==2&&(e.l+=2);var m={s:n,e:o,w:c,ixfe:d,flags:h};return(s.biff>=5||!s.biff)&&(m.level=h>>8&7),m}function XO(e,r){var s={};return r<32||(e.l+=16,s.header=Os(e),s.footer=Os(e),e.l+=2),s}function qO(e,r,s){var a={area:!1};if(s.biff!=5)return e.l+=r,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}var YO=on,JO=Vj,QO=Lc;function ZO(e){var r=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(4),n={fmt:r,env:s,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function eF(e,r,s){s.biffguess&&s.biff==5&&(s.biff=2);var a=on(e);++e.l;var n=cl(e,r-7,s);return a.t="str",a.val=n,a}function tF(e){var r=on(e);++e.l;var s=Os(e);return r.t="n",r.val=s,r}function rF(e){var r=on(e);++e.l;var s=e.read_shift(2);return r.t="n",r.val=s,r}function sF(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function aF(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function nF(e,r,s){var a=e.l+r,n=on(e),o=e.read_shift(2),c=Zi(e,o,s);return e.l=a,n.t="str",n.val=c,n}var iF=[2,3,48,49,131,139,140,245],T1=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Zf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function s(d,h){var m=[],f=gi(1);switch(h.type){case"base64":f=Ha(xa(d));break;case"binary":f=Ha(d);break;case"buffer":case"array":f=d;break}Es(f,0);var p=f.read_shift(1),g=!!(p&136),N=!1,y=!1;switch(p){case 2:break;case 3:break;case 48:N=!0,g=!0;break;case 49:N=!0,g=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var w=0,b=521;p==2&&(w=f.read_shift(2)),f.l+=3,p!=2&&(w=f.read_shift(4)),w>1048576&&(w=1e6),p!=2&&(b=f.read_shift(2));var C=f.read_shift(2),A=h.codepage||1252;p!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(A=e[f[f.l]]),f.l+=1,f.l+=2),y&&(f.l+=36);for(var E=[],R={},V=Math.min(f.length,p==2?521:b-10-(N?264:0)),P=y?32:11;f.l<V&&f[f.l]!=13;)switch(R={},R.name=vc.utils.decode(A,f.slice(f.l,f.l+P)).replace(/[\u0000\r\n].*$/g,""),f.l+=P,R.type=String.fromCharCode(f.read_shift(1)),p!=2&&!y&&(R.offset=f.read_shift(4)),R.len=f.read_shift(1),p==2&&(R.offset=f.read_shift(2)),R.dec=f.read_shift(1),R.name.length&&E.push(R),p!=2&&(f.l+=y?13:14),R.type){case"B":(!N||R.len!=8)&&h.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+R.type)}if(f[f.l]!==13&&(f.l=b-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=b;var k=0,z=0;for(m[0]=[],z=0;z!=E.length;++z)m[0][z]=E[z].name;for(;w-- >0;){if(f[f.l]===42){f.l+=C;continue}for(++f.l,m[++k]=[],z=0,z=0;z!=E.length;++z){var W=f.slice(f.l,f.l+E[z].len);f.l+=E[z].len,Es(W,0);var te=vc.utils.decode(A,W);switch(E[z].type){case"C":te.trim().length&&(m[k][z]=te.replace(/\s+$/,""));break;case"D":te.length===8?m[k][z]=new Date(+te.slice(0,4),+te.slice(4,6)-1,+te.slice(6,8)):m[k][z]=te;break;case"F":m[k][z]=parseFloat(te.trim());break;case"+":case"I":m[k][z]=y?W.read_shift(-4,"i")^2147483648:W.read_shift(4,"i");break;case"L":switch(te.trim().toUpperCase()){case"Y":case"T":m[k][z]=!0;break;case"N":case"F":m[k][z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+te+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));m[k][z]="##MEMO##"+(y?parseInt(te.trim(),10):W.read_shift(4));break;case"N":te=te.replace(/\u0000/g,"").trim(),te&&te!="."&&(m[k][z]=+te||0);break;case"@":m[k][z]=new Date(W.read_shift(-8,"f")-621356832e5);break;case"T":m[k][z]=new Date((W.read_shift(4)-2440588)*864e5+W.read_shift(4));break;case"Y":m[k][z]=W.read_shift(4,"i")/1e4+W.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[k][z]=-W.read_shift(-8,"f");break;case"B":if(N&&E[z].len==8){m[k][z]=W.read_shift(8,"f");break}case"G":case"P":W.l+=E[z].len;break;case"0":if(E[z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[z].type)}}}if(p!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return h&&h.sheetRows&&(m=m.slice(0,h.sheetRows)),h.DBF=E,m}function a(d,h){var m=h||{};m.dateNF||(m.dateNF="yyyymmdd");var f=to(s(d,m),m);return f["!cols"]=m.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete m.DBF,f}function n(d,h){try{return bi(a(d,h),h)}catch(m){if(h&&h.WTF)throw m}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function c(d,h){var m=h||{};if(+m.codepage>=0&&Ua(+m.codepage),m.type=="string")throw new Error("Cannot write DBF to JS string");var f=ef(),p=uf(d,{header:1,raw:!0,cellDates:!0}),g=p[0],N=p.slice(1),y=d["!cols"]||[],w=0,b=0,C=0,A=1;for(w=0;w<g.length;++w){if(((y[w]||{}).DBF||{}).name){g[w]=y[w].DBF.name,++C;continue}if(g[w]!=null){if(++C,typeof g[w]=="number"&&(g[w]=g[w].toString(10)),typeof g[w]!="string")throw new Error("DBF Invalid column name "+g[w]+" |"+typeof g[w]+"|");if(g.indexOf(g[w])!==w){for(b=0;b<1024;++b)if(g.indexOf(g[w]+"_"+b)==-1){g[w]+="_"+b;break}}}}var E=qr(d["!ref"]),R=[],V=[],P=[];for(w=0;w<=E.e.c-E.s.c;++w){var k="",z="",W=0,te=[];for(b=0;b<N.length;++b)N[b][w]!=null&&te.push(N[b][w]);if(te.length==0||g[w]==null){R[w]="?";continue}for(b=0;b<te.length;++b){switch(typeof te[b]){case"number":z="B";break;case"string":z="C";break;case"boolean":z="L";break;case"object":z=te[b]instanceof Date?"D":"C";break;default:z="C"}W=Math.max(W,String(te[b]).length),k=k&&k!=z?"C":z}W>250&&(W=250),z=((y[w]||{}).DBF||{}).type,z=="C"&&y[w].DBF.len>W&&(W=y[w].DBF.len),k=="B"&&z=="N"&&(k="N",P[w]=y[w].DBF.dec,W=y[w].DBF.len),V[w]=k=="C"||z=="N"?W:o[k]||0,A+=V[w],R[w]=k}var de=f.next(32);for(de.write_shift(4,318902576),de.write_shift(4,N.length),de.write_shift(2,296+32*C),de.write_shift(2,A),w=0;w<4;++w)de.write_shift(4,0);for(de.write_shift(4,0|(+r[Kb]||3)<<8),w=0,b=0;w<g.length;++w)if(g[w]!=null){var H=f.next(32),ue=(g[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);H.write_shift(1,ue,"sbcs"),H.write_shift(1,R[w]=="?"?"C":R[w],"sbcs"),H.write_shift(4,b),H.write_shift(1,V[w]||o[R[w]]||0),H.write_shift(1,P[w]||0),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(1,0),H.write_shift(4,0),H.write_shift(4,0),b+=V[w]||o[R[w]]||0}var I=f.next(264);for(I.write_shift(4,13),w=0;w<65;++w)I.write_shift(4,0);for(w=0;w<N.length;++w){var X=f.next(A);for(X.write_shift(1,0),b=0;b<g.length;++b)if(g[b]!=null)switch(R[b]){case"L":X.write_shift(1,N[w][b]==null?63:N[w][b]?84:70);break;case"B":X.write_shift(8,N[w][b]||0,"f");break;case"N":var oe="0";for(typeof N[w][b]=="number"&&(oe=N[w][b].toFixed(P[b]||0)),C=0;C<V[b]-oe.length;++C)X.write_shift(1,32);X.write_shift(1,oe,"sbcs");break;case"D":N[w][b]?(X.write_shift(4,("0000"+N[w][b].getFullYear()).slice(-4),"sbcs"),X.write_shift(2,("00"+(N[w][b].getMonth()+1)).slice(-2),"sbcs"),X.write_shift(2,("00"+N[w][b].getDate()).slice(-2),"sbcs")):X.write_shift(8,"00000000","sbcs");break;case"C":var xe=String(N[w][b]!=null?N[w][b]:"").slice(0,V[b]);for(X.write_shift(1,xe,"sbcs"),C=0;C<V[b]-xe.length;++C)X.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:n,to_sheet:a,from_sheet:c}})(),lF=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+nn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),s=function(g,N){var y=e[N];return typeof y=="number"?Vy(y):y},a=function(g,N,y){var w=N.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return w==59?g:Vy(w)};e["|"]=254;function n(g,N){switch(N.type){case"base64":return o(xa(g),N);case"binary":return o(g,N);case"buffer":return o(tr&&Buffer.isBuffer(g)?g.toString("binary"):nl(g),N);case"array":return o(Qi(g),N)}throw new Error("Unrecognized type "+N.type)}function o(g,N){var y=g.split(/[\n\r]+/),w=-1,b=-1,C=0,A=0,E=[],R=[],V=null,P={},k=[],z=[],W=[],te=0,de;for(+N.codepage>=0&&Ua(+N.codepage);C!==y.length;++C){te=0;var H=y[C].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(r,s),ue=H.replace(/;;/g,"\0").split(";").map(function(G){return G.replace(/\u0000/g,";")}),I=ue[0],X;if(H.length>0)switch(I){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ue[1].charAt(0)=="P"&&R.push(H.slice(3).replace(/;;/g,";"));break;case"C":var oe=!1,xe=!1,he=!1,F=!1,ee=-1,M=-1;for(A=1;A<ue.length;++A)switch(ue[A].charAt(0)){case"A":break;case"X":b=parseInt(ue[A].slice(1))-1,xe=!0;break;case"Y":for(w=parseInt(ue[A].slice(1))-1,xe||(b=0),de=E.length;de<=w;++de)E[de]=[];break;case"K":X=ue[A].slice(1),X.charAt(0)==='"'?X=X.slice(1,X.length-1):X==="TRUE"?X=!0:X==="FALSE"?X=!1:isNaN(Wa(X))?isNaN(Xl(X).getDate())||(X=ys(X)):(X=Wa(X),V!==null&&Zl(V)&&(X=Ju(X))),oe=!0;break;case"E":F=!0;var _=Gl(ue[A].slice(1),{r:w,c:b});E[w][b]=[E[w][b],_];break;case"S":he=!0,E[w][b]=[E[w][b],"S5S"];break;case"G":break;case"R":ee=parseInt(ue[A].slice(1))-1;break;case"C":M=parseInt(ue[A].slice(1))-1;break;default:if(N&&N.WTF)throw new Error("SYLK bad record "+H)}if(oe&&(E[w][b]&&E[w][b].length==2?E[w][b][0]=X:E[w][b]=X,V=null),he){if(F)throw new Error("SYLK shared formula cannot have own formula");var ne=ee>-1&&E[ee][M];if(!ne||!ne[1])throw new Error("SYLK shared formula cannot find base");E[w][b][1]=a2(ne[1],{r:w-ee,c:b-M})}break;case"F":var ae=0;for(A=1;A<ue.length;++A)switch(ue[A].charAt(0)){case"X":b=parseInt(ue[A].slice(1))-1,++ae;break;case"Y":for(w=parseInt(ue[A].slice(1))-1,de=E.length;de<=w;++de)E[de]=[];break;case"M":te=parseInt(ue[A].slice(1))/20;break;case"F":break;case"G":break;case"P":V=R[parseInt(ue[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(W=ue[A].slice(1).split(" "),de=parseInt(W[0],10);de<=parseInt(W[1],10);++de)te=parseInt(W[2],10),z[de-1]=te===0?{hidden:!0}:{wch:te},ql(z[de-1]);break;case"C":b=parseInt(ue[A].slice(1))-1,z[b]||(z[b]={});break;case"R":w=parseInt(ue[A].slice(1))-1,k[w]||(k[w]={}),te>0?(k[w].hpt=te,k[w].hpx=Ec(te)):te===0&&(k[w].hidden=!0);break;default:if(N&&N.WTF)throw new Error("SYLK bad record "+H)}ae<1&&(V=null);break;default:if(N&&N.WTF)throw new Error("SYLK bad record "+H)}}return k.length>0&&(P["!rows"]=k),z.length>0&&(P["!cols"]=z),N&&N.sheetRows&&(E=E.slice(0,N.sheetRows)),[E,P]}function c(g,N){var y=n(g,N),w=y[0],b=y[1],C=to(w,N);return nn(b).forEach(function(A){C[A]=b[A]}),C}function d(g,N){return bi(c(g,N),N)}function h(g,N,y,w){var b="C;Y"+(y+1)+";X"+(w+1)+";K";switch(g.t){case"n":b+=g.v||0,g.f&&!g.F&&(b+=";E"+KI(g.f,{r:y,c:w}));break;case"b":b+=g.v?"TRUE":"FALSE";break;case"e":b+=g.w||g.v;break;case"d":b+='"'+(g.w||g.v)+'"';break;case"s":b+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function m(g,N){N.forEach(function(y,w){var b="F;W"+(w+1)+" "+(w+1)+" ";y.hidden?b+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=Du(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=Ou(y.wpx)),typeof y.wch=="number"&&(b+=Math.round(y.wch))),b.charAt(b.length-1)!=" "&&g.push(b)})}function f(g,N){N.forEach(function(y,w){var b="F;";y.hidden?b+="M0;":y.hpt?b+="M"+20*y.hpt+";":y.hpx&&(b+="M"+20*t2(y.hpx)+";"),b.length>2&&g.push(b+"R"+(w+1))})}function p(g,N){var y=["ID;PWXL;N;E"],w=[],b=qr(g["!ref"]),C,A=Array.isArray(g),E=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),g["!cols"]&&m(y,g["!cols"]),g["!rows"]&&f(y,g["!rows"]),y.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var R=b.s.r;R<=b.e.r;++R)for(var V=b.s.c;V<=b.e.c;++V){var P=Gt({r:R,c:V});C=A?(g[R]||[])[V]:g[P],!(!C||C.v==null&&(!C.f||C.F))&&w.push(h(C,g,R,V))}return y.join(E)+E+w.join(E)+E+"E"+E}return{to_workbook:d,to_sheet:c,from_sheet:p}})(),oF=(function(){function e(o,c){switch(c.type){case"base64":return r(xa(o),c);case"binary":return r(o,c);case"buffer":return r(tr&&Buffer.isBuffer(o)?o.toString("binary"):nl(o),c);case"array":return r(Qi(o),c)}throw new Error("Unrecognized type "+c.type)}function r(o,c){for(var d=o.split(`
`),h=-1,m=-1,f=0,p=[];f!==d.length;++f){if(d[f].trim()==="BOT"){p[++h]=[],m=0;continue}if(!(h<0)){var g=d[f].trim().split(","),N=g[0],y=g[1];++f;for(var w=d[f]||"";(w.match(/["]/g)||[]).length&1&&f<d.length-1;)w+=`
`+d[++f];switch(w=w.trim(),+N){case-1:if(w==="BOT"){p[++h]=[],m=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?p[h][m]=!0:w==="FALSE"?p[h][m]=!1:isNaN(Wa(y))?isNaN(Xl(y).getDate())?p[h][m]=y:p[h][m]=ys(y):p[h][m]=Wa(y),++m;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),p[h][m++]=w!==""?w:null;break}if(w==="EOD")break}}return c&&c.sheetRows&&(p=p.slice(0,c.sheetRows)),p}function s(o,c){return to(e(o,c),c)}function a(o,c){return bi(s(o,c),c)}var n=(function(){var o=function(h,m,f,p,g){h.push(m),h.push(f+","+p),h.push('"'+g.replace(/"/g,'""')+'"')},c=function(h,m,f,p){h.push(m+","+f),h.push(m==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(h){var m=[],f=qr(h["!ref"]),p,g=Array.isArray(h);o(m,"TABLE",0,1,"sheetjs"),o(m,"VECTORS",0,f.e.r-f.s.r+1,""),o(m,"TUPLES",0,f.e.c-f.s.c+1,""),o(m,"DATA",0,0,"");for(var N=f.s.r;N<=f.e.r;++N){c(m,-1,0,"BOT");for(var y=f.s.c;y<=f.e.c;++y){var w=Gt({r:N,c:y});if(p=g?(h[N]||[])[y]:h[w],!p){c(m,1,0,"");continue}switch(p.t){case"n":var b=p.w;!b&&p.v!=null&&(b=p.v),b==null?p.f&&!p.F?c(m,1,0,"="+p.f):c(m,1,0,""):c(m,0,b,"V");break;case"b":c(m,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":c(m,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Aa(p.z||zt[14],Js(ys(p.v)))),c(m,0,p.w,"V");break;default:c(m,1,0,"")}}}c(m,-1,0,"EOD");var C=`\r
`,A=m.join(C);return A}})();return{to_workbook:a,to_sheet:s,from_sheet:n}})(),cF=(function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function s(p,g){for(var N=p.split(`
`),y=-1,w=-1,b=0,C=[];b!==N.length;++b){var A=N[b].trim().split(":");if(A[0]==="cell"){var E=Xs(A[1]);if(C.length<=E.r)for(y=C.length;y<=E.r;++y)C[y]||(C[y]=[]);switch(y=E.r,w=E.c,A[2]){case"t":C[y][w]=e(A[3]);break;case"v":C[y][w]=+A[3];break;case"vtf":var R=A[A.length-1];case"vtc":switch(A[3]){case"nl":C[y][w]=!!+A[4];break;default:C[y][w]=+A[4];break}A[2]=="vtf"&&(C[y][w]=[C[y][w],R])}}}return g&&g.sheetRows&&(C=C.slice(0,g.sheetRows)),C}function a(p,g){return to(s(p,g),g)}function n(p,g){return bi(a(p,g),g)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,d=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function m(p){if(!p||!p["!ref"])return"";for(var g=[],N=[],y,w="",b=eo(p["!ref"]),C=Array.isArray(p),A=b.s.r;A<=b.e.r;++A)for(var E=b.s.c;E<=b.e.c;++E)if(w=Gt({r:A,c:E}),y=C?(p[A]||[])[E]:p[w],!(!y||y.v==null||y.t==="z")){switch(N=["cell",w,"t"],y.t){case"s":case"str":N.push(r(y.v));break;case"n":y.f?(N[2]="vtf",N[3]="n",N[4]=y.v,N[5]=r(y.f)):(N[2]="v",N[3]=y.v);break;case"b":N[2]="vt"+(y.f?"f":"c"),N[3]="nl",N[4]=y.v?"1":"0",N[5]=r(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var R=Js(ys(y.v));N[2]="vtc",N[3]="nd",N[4]=""+R,N[5]=y.w||Aa(y.z||zt[14],R);break;case"e":continue}g.push(N.join(":"))}return g.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function f(p){return[o,c,d,c,m(p),h].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:f}})(),bc=(function(){function e(f,p,g,N,y){y.raw?p[g][N]=f:f===""||(f==="TRUE"?p[g][N]=!0:f==="FALSE"?p[g][N]=!1:isNaN(Wa(f))?isNaN(Xl(f).getDate())?p[g][N]=f:p[g][N]=ys(f):p[g][N]=Wa(f))}function r(f,p){var g=p||{},N=[];if(!f||f.length===0)return N;for(var y=f.split(/[\r\n]/),w=y.length-1;w>=0&&y[w].length===0;)--w;for(var b=10,C=0,A=0;A<=w;++A)C=y[A].indexOf(" "),C==-1?C=y[A].length:C++,b=Math.max(b,C);for(A=0;A<=w;++A){N[A]=[];var E=0;for(e(y[A].slice(0,b).trim(),N,A,E,g),E=1;E<=(y[A].length-b)/10+1;++E)e(y[A].slice(b+(E-1)*10,b+E*10).trim(),N,A,E,g)}return g.sheetRows&&(N=N.slice(0,g.sheetRows)),N}var s={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(f){for(var p={},g=!1,N=0,y=0;N<f.length;++N)(y=f.charCodeAt(N))==34?g=!g:!g&&y in s&&(p[y]=(p[y]||0)+1);y=[];for(N in p)Object.prototype.hasOwnProperty.call(p,N)&&y.push([p[N],N]);if(!y.length){p=a;for(N in p)Object.prototype.hasOwnProperty.call(p,N)&&y.push([p[N],N])}return y.sort(function(w,b){return w[0]-b[0]||a[w[1]]-a[b[1]]}),s[y.pop()[1]]||44}function o(f,p){var g=p||{},N="",y=g.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(N=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(N=f.charAt(4),f=f.slice(6)):N=n(f.slice(0,1024)):g&&g.FS?N=g.FS:N=n(f.slice(0,1024));var b=0,C=0,A=0,E=0,R=0,V=N.charCodeAt(0),P=!1,k=0,z=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var W=g.dateNF!=null?N_(g.dateNF):null;function te(){var de=f.slice(E,R),H={};if(de.charAt(0)=='"'&&de.charAt(de.length-1)=='"'&&(de=de.slice(1,-1).replace(/""/g,'"')),de.length===0)H.t="z";else if(g.raw)H.t="s",H.v=de;else if(de.trim().length===0)H.t="s",H.v=de;else if(de.charCodeAt(0)==61)de.charCodeAt(1)==34&&de.charCodeAt(de.length-1)==34?(H.t="s",H.v=de.slice(2,-1).replace(/""/g,'"')):qI(de)?(H.t="n",H.f=de.slice(1)):(H.t="s",H.v=de);else if(de=="TRUE")H.t="b",H.v=!0;else if(de=="FALSE")H.t="b",H.v=!1;else if(!isNaN(A=Wa(de)))H.t="n",g.cellText!==!1&&(H.w=de),H.v=A;else if(!isNaN(Xl(de).getDate())||W&&de.match(W)){H.z=g.dateNF||zt[14];var ue=0;W&&de.match(W)&&(de=w_(de,g.dateNF,de.match(W)||[]),ue=1),g.cellDates?(H.t="d",H.v=ys(de,ue)):(H.t="n",H.v=Js(ys(de,ue))),g.cellText!==!1&&(H.w=Aa(H.z,H.v instanceof Date?Js(H.v):H.v)),g.cellNF||delete H.z}else H.t="s",H.v=de;if(H.t=="z"||(g.dense?(y[b]||(y[b]=[]),y[b][C]=H):y[Gt({c:C,r:b})]=H),E=R+1,z=f.charCodeAt(E),w.e.c<C&&(w.e.c=C),w.e.r<b&&(w.e.r=b),k==V)++C;else if(C=0,++b,g.sheetRows&&g.sheetRows<=b)return!0}e:for(;R<f.length;++R)switch(k=f.charCodeAt(R)){case 34:z===34&&(P=!P);break;case V:case 10:case 13:if(!P&&te())break e;break}return R-E>0&&te(),y["!ref"]=sr(w),y}function c(f,p){return!(p&&p.PRN)||p.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?o(f,p):to(r(f,p),p)}function d(f,p){var g="",N=p.type=="string"?[0,0,0,0]:vx(f,p);switch(p.type){case"base64":g=xa(f);break;case"binary":g=f;break;case"buffer":p.codepage==65001?g=f.toString("utf8"):p.codepage&&typeof vc<"u"||(g=tr&&Buffer.isBuffer(f)?f.toString("binary"):nl(f));break;case"array":g=Qi(f);break;case"string":g=f;break;default:throw new Error("Unrecognized type "+p.type)}return N[0]==239&&N[1]==187&&N[2]==191?g=kr(g.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?g=kr(g):p.type=="binary"&&typeof vc<"u",g.slice(0,19)=="socialcalc:version:"?cF.to_sheet(p.type=="string"?g:kr(g),p):c(g,p)}function h(f,p){return bi(d(f,p),p)}function m(f){for(var p=[],g=qr(f["!ref"]),N,y=Array.isArray(f),w=g.s.r;w<=g.e.r;++w){for(var b=[],C=g.s.c;C<=g.e.c;++C){var A=Gt({r:w,c:C});if(N=y?(f[w]||[])[C]:f[A],!N||N.v==null){b.push("          ");continue}for(var E=(N.w||(Pn(N),N.w)||"").slice(0,10);E.length<10;)E+=" ";b.push(E+(C===0?" ":""))}p.push(b.join(""))}return p.join(`
`)}return{to_workbook:h,to_sheet:d,from_sheet:m}})();function dF(e,r){var s=r||{},a=!!s.WTF;s.WTF=!0;try{var n=lF.to_workbook(e,s);return s.WTF=a,n}catch(o){if(s.WTF=a,!o.message.match(/SYLK bad record ID/)&&a)throw o;return bc.to_workbook(e,r)}}var lc=(function(){function e(_,ne,ae){if(_){Es(_,_.l||0);for(var G=ae.Enum||ee;_.l<_.length;){var ie=_.read_shift(2),Me=G[ie]||G[65535],Ee=_.read_shift(2),ye=_.l+Ee,je=Me.f&&Me.f(_,Ee,ae);if(_.l=ye,ne(je,Me,ie))return}}}function r(_,ne){switch(ne.type){case"base64":return s(Ha(xa(_)),ne);case"binary":return s(Ha(_),ne);case"buffer":case"array":return s(_,ne)}throw"Unsupported type "+ne.type}function s(_,ne){if(!_)return _;var ae=ne||{},G=ae.dense?[]:{},ie="Sheet1",Me="",Ee=0,ye={},je=[],We=[],Y={s:{r:0,c:0},e:{r:0,c:0}},Dt=ae.sheetRows||0;if(_[2]==0&&(_[3]==8||_[3]==9)&&_.length>=16&&_[14]==5&&_[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(_[2]==2)ae.Enum=ee,e(_,function(Ue,Nt,qe){switch(qe){case 0:ae.vers=Ue,Ue>=4096&&(ae.qpro=!0);break;case 6:Y=Ue;break;case 204:Ue&&(Me=Ue);break;case 222:Me=Ue;break;case 15:case 51:ae.qpro||(Ue[1].v=Ue[1].v.slice(1));case 13:case 14:case 16:qe==14&&(Ue[2]&112)==112&&(Ue[2]&15)>1&&(Ue[2]&15)<15&&(Ue[1].z=ae.dateNF||zt[14],ae.cellDates&&(Ue[1].t="d",Ue[1].v=Ju(Ue[1].v))),ae.qpro&&Ue[3]>Ee&&(G["!ref"]=sr(Y),ye[ie]=G,je.push(ie),G=ae.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},Ee=Ue[3],ie=Me||"Sheet"+(Ee+1),Me="");var Bt=ae.dense?(G[Ue[0].r]||[])[Ue[0].c]:G[Gt(Ue[0])];if(Bt){Bt.t=Ue[1].t,Bt.v=Ue[1].v,Ue[1].z!=null&&(Bt.z=Ue[1].z),Ue[1].f!=null&&(Bt.f=Ue[1].f);break}ae.dense?(G[Ue[0].r]||(G[Ue[0].r]=[]),G[Ue[0].r][Ue[0].c]=Ue[1]):G[Gt(Ue[0])]=Ue[1];break}},ae);else if(_[2]==26||_[2]==14)ae.Enum=M,_[2]==14&&(ae.qpro=!0,_.l=0),e(_,function(Ue,Nt,qe){switch(qe){case 204:ie=Ue;break;case 22:Ue[1].v=Ue[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ue[3]>Ee&&(G["!ref"]=sr(Y),ye[ie]=G,je.push(ie),G=ae.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},Ee=Ue[3],ie="Sheet"+(Ee+1)),Dt>0&&Ue[0].r>=Dt)break;ae.dense?(G[Ue[0].r]||(G[Ue[0].r]=[]),G[Ue[0].r][Ue[0].c]=Ue[1]):G[Gt(Ue[0])]=Ue[1],Y.e.c<Ue[0].c&&(Y.e.c=Ue[0].c),Y.e.r<Ue[0].r&&(Y.e.r=Ue[0].r);break;case 27:Ue[14e3]&&(We[Ue[14e3][0]]=Ue[14e3][1]);break;case 1537:We[Ue[0]]=Ue[1],Ue[0]==Ee&&(ie=Ue[1]);break}},ae);else throw new Error("Unrecognized LOTUS BOF "+_[2]);if(G["!ref"]=sr(Y),ye[Me||ie]=G,je.push(Me||ie),!We.length)return{SheetNames:je,Sheets:ye};for(var we={},ot=[],Ye=0;Ye<We.length;++Ye)ye[je[Ye]]?(ot.push(We[Ye]||je[Ye]),we[We[Ye]]=ye[We[Ye]]||ye[je[Ye]]):(ot.push(We[Ye]),we[We[Ye]]={"!ref":"A1"});return{SheetNames:ot,Sheets:we}}function a(_,ne){var ae=ne||{};if(+ae.codepage>=0&&Ua(+ae.codepage),ae.type=="string")throw new Error("Cannot write WK1 to JS string");var G=ef(),ie=qr(_["!ref"]),Me=Array.isArray(_),Ee=[];La(G,0,o(1030)),La(G,6,h(ie));for(var ye=Math.min(ie.e.r,8191),je=ie.s.r;je<=ye;++je)for(var We=Ss(je),Y=ie.s.c;Y<=ie.e.c;++Y){je===ie.s.r&&(Ee[Y]=hs(Y));var Dt=Ee[Y]+We,we=Me?(_[je]||[])[Y]:_[Dt];if(!(!we||we.t=="z"))if(we.t=="n")(we.v|0)==we.v&&we.v>=-32768&&we.v<=32767?La(G,13,N(je,Y,we.v)):La(G,14,w(je,Y,we.v));else{var ot=Pn(we);La(G,15,p(je,Y,ot.slice(0,239)))}}return La(G,1),G.end()}function n(_,ne){var ae=ne||{};if(+ae.codepage>=0&&Ua(+ae.codepage),ae.type=="string")throw new Error("Cannot write WK3 to JS string");var G=ef();La(G,0,c(_));for(var ie=0,Me=0;ie<_.SheetNames.length;++ie)(_.Sheets[_.SheetNames[ie]]||{})["!ref"]&&La(G,27,F(_.SheetNames[ie],Me++));var Ee=0;for(ie=0;ie<_.SheetNames.length;++ie){var ye=_.Sheets[_.SheetNames[ie]];if(!(!ye||!ye["!ref"])){for(var je=qr(ye["!ref"]),We=Array.isArray(ye),Y=[],Dt=Math.min(je.e.r,8191),we=je.s.r;we<=Dt;++we)for(var ot=Ss(we),Ye=je.s.c;Ye<=je.e.c;++Ye){we===je.s.r&&(Y[Ye]=hs(Ye));var Ue=Y[Ye]+ot,Nt=We?(ye[we]||[])[Ye]:ye[Ue];if(!(!Nt||Nt.t=="z"))if(Nt.t=="n")La(G,23,te(we,Ye,Ee,Nt.v));else{var qe=Pn(Nt);La(G,22,k(we,Ye,Ee,qe.slice(0,239)))}}++Ee}}return La(G,1),G.end()}function o(_){var ne=us(2);return ne.write_shift(2,_),ne}function c(_){var ne=us(26);ne.write_shift(2,4096),ne.write_shift(2,4),ne.write_shift(4,0);for(var ae=0,G=0,ie=0,Me=0;Me<_.SheetNames.length;++Me){var Ee=_.SheetNames[Me],ye=_.Sheets[Ee];if(!(!ye||!ye["!ref"])){++ie;var je=eo(ye["!ref"]);ae<je.e.r&&(ae=je.e.r),G<je.e.c&&(G=je.e.c)}}return ae>8191&&(ae=8191),ne.write_shift(2,ae),ne.write_shift(1,ie),ne.write_shift(1,G),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(1,1),ne.write_shift(1,2),ne.write_shift(4,0),ne.write_shift(4,0),ne}function d(_,ne,ae){var G={s:{c:0,r:0},e:{c:0,r:0}};return ne==8&&ae.qpro?(G.s.c=_.read_shift(1),_.l++,G.s.r=_.read_shift(2),G.e.c=_.read_shift(1),_.l++,G.e.r=_.read_shift(2),G):(G.s.c=_.read_shift(2),G.s.r=_.read_shift(2),ne==12&&ae.qpro&&(_.l+=2),G.e.c=_.read_shift(2),G.e.r=_.read_shift(2),ne==12&&ae.qpro&&(_.l+=2),G.s.c==65535&&(G.s.c=G.e.c=G.s.r=G.e.r=0),G)}function h(_){var ne=us(8);return ne.write_shift(2,_.s.c),ne.write_shift(2,_.s.r),ne.write_shift(2,_.e.c),ne.write_shift(2,_.e.r),ne}function m(_,ne,ae){var G=[{c:0,r:0},{t:"n",v:0},0,0];return ae.qpro&&ae.vers!=20768?(G[0].c=_.read_shift(1),G[3]=_.read_shift(1),G[0].r=_.read_shift(2),_.l+=2):(G[2]=_.read_shift(1),G[0].c=_.read_shift(2),G[0].r=_.read_shift(2)),G}function f(_,ne,ae){var G=_.l+ne,ie=m(_,ne,ae);if(ie[1].t="s",ae.vers==20768){_.l++;var Me=_.read_shift(1);return ie[1].v=_.read_shift(Me,"utf8"),ie}return ae.qpro&&_.l++,ie[1].v=_.read_shift(G-_.l,"cstr"),ie}function p(_,ne,ae){var G=us(7+ae.length);G.write_shift(1,255),G.write_shift(2,ne),G.write_shift(2,_),G.write_shift(1,39);for(var ie=0;ie<G.length;++ie){var Me=ae.charCodeAt(ie);G.write_shift(1,Me>=128?95:Me)}return G.write_shift(1,0),G}function g(_,ne,ae){var G=m(_,ne,ae);return G[1].v=_.read_shift(2,"i"),G}function N(_,ne,ae){var G=us(7);return G.write_shift(1,255),G.write_shift(2,ne),G.write_shift(2,_),G.write_shift(2,ae,"i"),G}function y(_,ne,ae){var G=m(_,ne,ae);return G[1].v=_.read_shift(8,"f"),G}function w(_,ne,ae){var G=us(13);return G.write_shift(1,255),G.write_shift(2,ne),G.write_shift(2,_),G.write_shift(8,ae,"f"),G}function b(_,ne,ae){var G=_.l+ne,ie=m(_,ne,ae);if(ie[1].v=_.read_shift(8,"f"),ae.qpro)_.l=G;else{var Me=_.read_shift(2);R(_.slice(_.l,_.l+Me),ie),_.l+=Me}return ie}function C(_,ne,ae){var G=ne&32768;return ne&=-32769,ne=(G?_:0)+(ne>=8192?ne-16384:ne),(G?"":"$")+(ae?hs(ne):Ss(ne))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function R(_,ne){Es(_,0);for(var ae=[],G=0,ie="",Me="",Ee="",ye="";_.l<_.length;){var je=_[_.l++];switch(je){case 0:ae.push(_.read_shift(8,"f"));break;case 1:Me=C(ne[0].c,_.read_shift(2),!0),ie=C(ne[0].r,_.read_shift(2),!1),ae.push(Me+ie);break;case 2:{var We=C(ne[0].c,_.read_shift(2),!0),Y=C(ne[0].r,_.read_shift(2),!1);Me=C(ne[0].c,_.read_shift(2),!0),ie=C(ne[0].r,_.read_shift(2),!1),ae.push(We+Y+":"+Me+ie)}break;case 3:if(_.l<_.length){console.error("WK1 premature formula end");return}break;case 4:ae.push("("+ae.pop()+")");break;case 5:ae.push(_.read_shift(2));break;case 6:{for(var Dt="";je=_[_.l++];)Dt+=String.fromCharCode(je);ae.push('"'+Dt.replace(/"/g,'""')+'"')}break;case 8:ae.push("-"+ae.pop());break;case 23:ae.push("+"+ae.pop());break;case 22:ae.push("NOT("+ae.pop()+")");break;case 20:case 21:ye=ae.pop(),Ee=ae.pop(),ae.push(["AND","OR"][je-20]+"("+Ee+","+ye+")");break;default:if(je<32&&E[je])ye=ae.pop(),Ee=ae.pop(),ae.push(Ee+E[je]+ye);else if(A[je]){if(G=A[je][1],G==69&&(G=_[_.l++]),G>ae.length){console.error("WK1 bad formula parse 0x"+je.toString(16)+":|"+ae.join("|")+"|");return}var we=ae.slice(-G);ae.length-=G,ae.push(A[je][0]+"("+we.join(",")+")")}else return je<=7?console.error("WK1 invalid opcode "+je.toString(16)):je<=24?console.error("WK1 unsupported op "+je.toString(16)):je<=30?console.error("WK1 invalid opcode "+je.toString(16)):je<=115?console.error("WK1 unsupported function opcode "+je.toString(16)):console.error("WK1 unrecognized opcode "+je.toString(16))}}ae.length==1?ne[1].f=""+ae[0]:console.error("WK1 bad formula parse |"+ae.join("|")+"|")}function V(_){var ne=[{c:0,r:0},{t:"n",v:0},0];return ne[0].r=_.read_shift(2),ne[3]=_[_.l++],ne[0].c=_[_.l++],ne}function P(_,ne){var ae=V(_);return ae[1].t="s",ae[1].v=_.read_shift(ne-4,"cstr"),ae}function k(_,ne,ae,G){var ie=us(6+G.length);ie.write_shift(2,_),ie.write_shift(1,ae),ie.write_shift(1,ne),ie.write_shift(1,39);for(var Me=0;Me<G.length;++Me){var Ee=G.charCodeAt(Me);ie.write_shift(1,Ee>=128?95:Ee)}return ie.write_shift(1,0),ie}function z(_,ne){var ae=V(_);ae[1].v=_.read_shift(2);var G=ae[1].v>>1;if(ae[1].v&1)switch(G&7){case 0:G=(G>>3)*5e3;break;case 1:G=(G>>3)*500;break;case 2:G=(G>>3)/20;break;case 3:G=(G>>3)/200;break;case 4:G=(G>>3)/2e3;break;case 5:G=(G>>3)/2e4;break;case 6:G=(G>>3)/16;break;case 7:G=(G>>3)/64;break}return ae[1].v=G,ae}function W(_,ne){var ae=V(_),G=_.read_shift(4),ie=_.read_shift(4),Me=_.read_shift(2);if(Me==65535)return G===0&&ie===3221225472?(ae[1].t="e",ae[1].v=15):G===0&&ie===3489660928?(ae[1].t="e",ae[1].v=42):ae[1].v=0,ae;var Ee=Me&32768;return Me=(Me&32767)-16446,ae[1].v=(1-Ee*2)*(ie*Math.pow(2,Me+32)+G*Math.pow(2,Me)),ae}function te(_,ne,ae,G){var ie=us(14);if(ie.write_shift(2,_),ie.write_shift(1,ae),ie.write_shift(1,ne),G==0)return ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(2,65535),ie;var Me=0,Ee=0,ye=0,je=0;return G<0&&(Me=1,G=-G),Ee=Math.log2(G)|0,G/=Math.pow(2,Ee-31),je=G>>>0,(je&2147483648)==0&&(G/=2,++Ee,je=G>>>0),G-=je,je|=2147483648,je>>>=0,G*=Math.pow(2,32),ye=G>>>0,ie.write_shift(4,ye),ie.write_shift(4,je),Ee+=16383+(Me?32768:0),ie.write_shift(2,Ee),ie}function de(_,ne){var ae=W(_);return _.l+=ne-14,ae}function H(_,ne){var ae=V(_),G=_.read_shift(4);return ae[1].v=G>>6,ae}function ue(_,ne){var ae=V(_),G=_.read_shift(8,"f");return ae[1].v=G,ae}function I(_,ne){var ae=ue(_);return _.l+=ne-10,ae}function X(_,ne){return _[_.l+ne-1]==0?_.read_shift(ne,"cstr"):""}function oe(_,ne){var ae=_[_.l++];ae>ne-1&&(ae=ne-1);for(var G="";G.length<ae;)G+=String.fromCharCode(_[_.l++]);return G}function xe(_,ne,ae){if(!(!ae.qpro||ne<21)){var G=_.read_shift(1);_.l+=17,_.l+=1,_.l+=2;var ie=_.read_shift(ne-21,"cstr");return[G,ie]}}function he(_,ne){for(var ae={},G=_.l+ne;_.l<G;){var ie=_.read_shift(2);if(ie==14e3){for(ae[ie]=[0,""],ae[ie][0]=_.read_shift(2);_[_.l];)ae[ie][1]+=String.fromCharCode(_[_.l]),_.l++;_.l++}}return ae}function F(_,ne){var ae=us(5+_.length);ae.write_shift(2,14e3),ae.write_shift(2,ne);for(var G=0;G<_.length;++G){var ie=_.charCodeAt(G);ae[ae.l++]=ie>127?95:ie}return ae[ae.l++]=0,ae}var ee={0:{n:"BOF",f:ns},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:d},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:y},15:{n:"LABEL",f},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:X},222:{n:"SHEETNAMELP",f:oe},65535:{n:""}},M={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:W},24:{n:"NUMBER18",f:z},25:{n:"FORMULA19",f:de},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:he},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:H},38:{n:"??"},39:{n:"NUMBER27",f:ue},40:{n:"FORMULA28",f:I},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:X},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:xe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:r}})();function uF(e){var r={},s=e.match(Bs),a=0,n=!1;if(s)for(;a!=s.length;++a){var o=Mt(s[a]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;r.cp=Xf[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=o.val;break;case"<sz":r.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":o.rgb&&(r.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(o[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+o[0])}}return r}var hF=(function(){var e=Nc("t"),r=Nc("rPr");function s(o){var c=o.match(e);if(!c)return{t:"s",v:""};var d={t:"s",v:lr(c[1])},h=o.match(r);return h&&(d.s=uF(h[1])),d}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(c){return c.replace(a,"").split(n).map(s).filter(function(d){return d.v})}})(),mF=(function(){var r=/(\r\n|\n)/g;function s(n,o,c){var d=[];n.u&&d.push("text-decoration: underline;"),n.uval&&d.push("text-underline-style:"+n.uval+";"),n.sz&&d.push("font-size:"+n.sz+"pt;"),n.outline&&d.push("text-effect: outline;"),n.shadow&&d.push("text-shadow: auto;"),o.push('<span style="'+d.join("")+'">'),n.b&&(o.push("<b>"),c.push("</b>")),n.i&&(o.push("<i>"),c.push("</i>")),n.strike&&(o.push("<s>"),c.push("</s>"));var h=n.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(o.push("<"+h+">"),c.push("</"+h+">")),c.push("</span>"),n}function a(n){var o=[[],n.v,[]];return n.v?(n.s&&s(n.s,o[0],o[2]),o[0].join("")+o[1].replace(r,"<br/>")+o[2].join("")):""}return function(o){return o.map(a).join("")}})(),fF=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,xF=/<(?:\w+:)?r>/,pF=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ux(e,r){var s=r?r.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=lr(kr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=kr(e),s&&(a.h=tx(a.t))):e.match(xF)&&(a.r=kr(e),a.t=lr(kr((e.replace(pF,"").match(fF)||[]).join("").replace(Bs,""))),s&&(a.h=mF(hF(a.r)))),a):{t:""}}var gF=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,vF=/<(?:\w+:)?(?:si|sstItem)>/g,yF=/<\/(?:\w+:)?(?:si|sstItem)>/;function NF(e,r){var s=[],a="";if(!e)return s;var n=e.match(gF);if(n){a=n[2].replace(vF,"").split(yF);for(var o=0;o!=a.length;++o){var c=ux(a[o].trim(),r);c!=null&&(s[s.length]=c)}n=Mt(n[1]),s.Count=n.count,s.Unique=n.uniqueCount}return s}function wF(e){return[e.read_shift(4),e.read_shift(4)]}function bF(e,r){var s=[],a=!1;return _n(e,function(o,c,d){switch(d){case 159:s.Count=o[0],s.Unique=o[1];break;case 19:s.push(o);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(c.T,!a||r.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}),s}function qj(e){for(var r=[],s=e.split(""),a=0;a<s.length;++a)r[a]=s[a].charCodeAt(0);return r}function Sn(e,r){var s={};return s.Major=e.read_shift(2),s.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),s}function jF(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=Sn(e,4),r.U=Sn(e,4),r.W=Sn(e,4),r}function EF(e){for(var r=e.read_shift(4),s=e.l+r-4,a={},n=e.read_shift(4),o=[];n-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=o,e.l!=s)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+s);return a}function TF(e){var r=[];e.l+=4;for(var s=e.read_shift(4);s-- >0;)r.push(EF(e));return r}function SF(e){var r=[];e.l+=4;for(var s=e.read_shift(4);s-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function AF(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=Sn(e,4),r.U=Sn(e,4),r.W=Sn(e,4),r}function CF(e){var r=AF(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function Yj(e,r){var s=e.l+r,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(s-e.l>>1,"utf16le"),e.l=s,a}function Jj(e,r){var s={},a=e.l+r;return e.l+=4,s.Salt=e.slice(e.l,e.l+16),e.l+=16,s.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),s.VerifierHash=e.slice(e.l,a),e.l=a,s}function kF(e){var r=Sn(e);switch(r.Minor){case 2:return[r.Minor,PF(e)];case 3:return[r.Minor,RF()];case 4:return[r.Minor,_F(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function PF(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var s=e.read_shift(4),a=Yj(e,s),n=Jj(e,e.length-e.l);return{t:"Std",h:a,v:n}}function RF(){throw new Error("File is password-protected: ECMA-376 Extensible")}function _F(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var s=e.read_shift(e.length-e.l,"utf8"),a={};return s.replace(Bs,function(o){var c=Mt(o);switch(ln(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(d){a[d]=c[d]});break;case"<dataIntegrity":a.encryptedHmacKey=c.encryptedHmacKey,a.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(c);break;default:throw c[0]}}),a}function DF(e,r){var s={},a=s.EncryptionVersionInfo=Sn(e,4);if(r-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);s.Flags=e.read_shift(4),r-=4;var n=e.read_shift(4);return r-=4,s.EncryptionHeader=Yj(e,n),r-=n,s.EncryptionVerifier=Jj(e,r),s}function OF(e){var r={},s=r.EncryptionVersionInfo=Sn(e,4);if(s.Major!=1||s.Minor!=1)throw"unrecognized version code "+s.Major+" : "+s.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function FF(e){var r=0,s,a=qj(e),n=a.length+1,o,c,d,h,m;for(s=gi(n),s[0]=a.length,o=1;o!=n;++o)s[o]=a[o-1];for(o=n-1;o>=0;--o)c=s[o],d=(r&16384)===0?0:1,h=r<<1&32767,m=d|h,r=m^c;return r^52811}var Qj=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],s=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(c){return(c/2|c*128)&255},n=function(c,d){return a(c^d)},o=function(c){for(var d=r[c.length-1],h=104,m=c.length-1;m>=0;--m)for(var f=c[m],p=0;p!=7;++p)f&64&&(d^=s[h]),f*=2,--h;return d};return function(c){for(var d=qj(c),h=o(d),m=d.length,f=gi(16),p=0;p!=16;++p)f[p]=0;var g,N,y;for((m&1)===1&&(g=h>>8,f[m]=n(e[0],g),--m,g=h&255,N=d[d.length-1],f[m]=n(N,g));m>0;)--m,g=h>>8,f[m]=n(d[m],g),--m,g=h&255,f[m]=n(d[m],g);for(m=15,y=15-d.length;y>0;)g=h>>8,f[m]=n(e[y],g),--m,--y,g=h&255,f[m]=n(d[m],g),--m,--y;return f}})(),IF=function(e,r,s,a,n){n||(n=r),a||(a=Qj(e));var o,c;for(o=0;o!=r.length;++o)c=r[o],c^=a[s],c=(c>>5|c<<3)&255,n[o]=c,++s;return[n,s,a]},MF=function(e){var r=0,s=Qj(e);return function(a){var n=IF("",a,r,s);return r=n[1],n[0]}};function LF(e,r,s,a){var n={key:ns(e),verificationBytes:ns(e)};return s.password&&(n.verifier=FF(s.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=MF(s.password)),n}function BF(e,r,s){var a=s||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=OF(e):a.Data=DF(e,r),a}function HF(e,r,s){var a={Type:s.biff>=8?e.read_shift(2):0};return a.Type?BF(e,r-2,a):LF(e,s.biff>=8?r:r-2,s,a),a}var VF=(function(){function e(n,o){switch(o.type){case"base64":return r(xa(n),o);case"binary":return r(n,o);case"buffer":return r(tr&&Buffer.isBuffer(n)?n.toString("binary"):nl(n),o);case"array":return r(Qi(n),o)}throw new Error("Unrecognized type "+o.type)}function r(n,o){var c=o||{},d=c.dense?[]:{},h=n.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(f,p){Array.isArray(d)&&(d[p]=[]);for(var g=/\\\w+\b/g,N=0,y,w=-1;y=g.exec(f);){switch(y[0]){case"\\cell":var b=f.slice(N,g.lastIndex-y[0].length);if(b[0]==" "&&(b=b.slice(1)),++w,b.length){var C={v:b,t:"s"};Array.isArray(d)?d[p][w]=C:d[Gt({r:p,c:w})]=C}break}N=g.lastIndex}w>m.e.c&&(m.e.c=w)}),d["!ref"]=sr(m),d}function s(n,o){return bi(e(n,o),o)}function a(n){for(var o=["{\\rtf1\\ansi"],c=qr(n["!ref"]),d,h=Array.isArray(n),m=c.s.r;m<=c.e.r;++m){o.push("\\trowd\\trautofit1");for(var f=c.s.c;f<=c.e.c;++f)o.push("\\cellx"+(f+1));for(o.push("\\pard\\intbl"),f=c.s.c;f<=c.e.c;++f){var p=Gt({r:m,c:f});d=h?(n[m]||[])[f]:n[p],!(!d||d.v==null&&(!d.f||d.F))&&(o.push(" "+(d.w||(Pn(d),d.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:s,to_sheet:e,from_sheet:a}})();function UF(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function jc(e){for(var r=0,s=1;r!=3;++r)s=s*256+(e[r]>255?255:e[r]<0?0:e[r]);return s.toString(16).toUpperCase().slice(1)}function $F(e){var r=e[0]/255,s=e[1]/255,a=e[2]/255,n=Math.max(r,s,a),o=Math.min(r,s,a),c=n-o;if(c===0)return[0,0,r];var d=0,h=0,m=n+o;switch(h=c/(m>1?2-m:m),n){case r:d=((s-a)/c+6)%6;break;case s:d=(a-r)/c+2;break;case a:d=(r-s)/c+4;break}return[d/6,h,m/2]}function GF(e){var r=e[0],s=e[1],a=e[2],n=s*2*(a<.5?a:1-a),o=a-n/2,c=[o,o,o],d=6*r,h;if(s!==0)switch(d|0){case 0:case 6:h=n*d,c[0]+=n,c[1]+=h;break;case 1:h=n*(2-d),c[0]+=h,c[1]+=n;break;case 2:h=n*(d-2),c[1]+=n,c[2]+=h;break;case 3:h=n*(4-d),c[1]+=h,c[2]+=n;break;case 4:h=n*(d-4),c[2]+=n,c[0]+=h;break;case 5:h=n*(6-d),c[2]+=h,c[0]+=n;break}for(var m=0;m!=3;++m)c[m]=Math.round(c[m]*255);return c}function _u(e,r){if(r===0)return e;var s=$F(UF(e));return r<0?s[2]=s[2]*(1+r):s[2]=1-(1-s[2])*(1-r),jc(GF(s))}var Zj=6,WF=15,zF=1,zs=Zj;function Du(e){return Math.floor((e+Math.round(128/zs)/256)*zs)}function Ou(e){return Math.floor((e-5)/zs*100+.5)/100}function af(e){return Math.round((e*zs+5)/zs*256)/256}function xm(e){return af(Ou(Du(e)))}function hx(e){var r=Math.abs(e-xm(e)),s=zs;if(r>.005)for(zs=zF;zs<WF;++zs)Math.abs(e-xm(e))<=r&&(r=Math.abs(e-xm(e)),s=zs);zs=s}function ql(e){e.width?(e.wpx=Du(e.width),e.wch=Ou(e.wpx),e.MDW=zs):e.wpx?(e.wch=Ou(e.wpx),e.width=af(e.wch),e.MDW=zs):typeof e.wch=="number"&&(e.width=af(e.wch),e.wpx=Du(e.width),e.MDW=zs),e.customWidth&&delete e.customWidth}var KF=96,e2=KF;function t2(e){return e*96/e2}function Ec(e){return e*e2/96}var XF={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function qF(e,r,s,a){r.Borders=[];var n={},o=!1;(e[0].match(Bs)||[]).forEach(function(c){var d=Mt(c);switch(ln(d[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},d.diagonalUp&&(n.diagonalUp=Br(d.diagonalUp)),d.diagonalDown&&(n.diagonalDown=Br(d.diagonalDown)),r.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(a&&a.WTF&&!o)throw new Error("unrecognized "+d[0]+" in borders")}})}function YF(e,r,s,a){r.Fills=[];var n={},o=!1;(e[0].match(Bs)||[]).forEach(function(c){var d=Mt(c);switch(ln(d[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},r.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":d.patternType&&(n.patternType=d.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),d.indexed&&(n.bgColor.indexed=parseInt(d.indexed,10)),d.theme&&(n.bgColor.theme=parseInt(d.theme,10)),d.tint&&(n.bgColor.tint=parseFloat(d.tint)),d.rgb&&(n.bgColor.rgb=d.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),d.theme&&(n.fgColor.theme=parseInt(d.theme,10)),d.tint&&(n.fgColor.tint=parseFloat(d.tint)),d.rgb!=null&&(n.fgColor.rgb=d.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(a&&a.WTF&&!o)throw new Error("unrecognized "+d[0]+" in fills")}})}function JF(e,r,s,a){r.Fonts=[];var n={},o=!1;(e[0].match(Bs)||[]).forEach(function(c){var d=Mt(c);switch(ln(d[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(n),n={};break;case"<name":d.val&&(n.name=kr(d.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=d.val?Br(d.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=d.val?Br(d.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(d.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=d.val?Br(d.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=d.val?Br(d.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=d.val?Br(d.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=d.val?Br(d.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=d.val?Br(d.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":d.val&&(n.sz=+d.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":d.val&&(n.vertAlign=d.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":d.val&&(n.family=parseInt(d.val,10));break;case"<family/>":case"</family>":break;case"<scheme":d.val&&(n.scheme=d.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(d.val=="1")break;d.codepage=Xf[parseInt(d.val,10)];break;case"<color":if(n.color||(n.color={}),d.auto&&(n.color.auto=Br(d.auto)),d.rgb)n.color.rgb=d.rgb.slice(-6);else if(d.indexed){n.color.index=parseInt(d.indexed,10);var h=qi[n.color.index];n.color.index==81&&(h=qi[1]),h||(h=qi[1]),n.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else d.theme&&(n.color.theme=parseInt(d.theme,10),d.tint&&(n.color.tint=parseFloat(d.tint)),d.theme&&s.themeElements&&s.themeElements.clrScheme&&(n.color.rgb=_u(s.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(a&&a.WTF&&!o)throw new Error("unrecognized "+d[0]+" in fonts")}})}function QF(e,r,s){r.NumberFmt=[];for(var a=nn(zt),n=0;n<a.length;++n)r.NumberFmt[a[n]]=zt[a[n]];var o=e[0].match(Bs);if(o)for(n=0;n<o.length;++n){var c=Mt(o[n]);switch(ln(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var d=lr(kr(c.formatCode)),h=parseInt(c.numFmtId,10);if(r.NumberFmt[h]=d,h>0){if(h>392){for(h=392;h>60&&r.NumberFmt[h]!=null;--h);r.NumberFmt[h]=d}Xi(d,h)}}break;case"</numFmt>":break;default:if(s.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}var iu=["numFmtId","fillId","fontId","borderId","xfId"],lu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function ZF(e,r,s){r.CellXf=[];var a,n=!1;(e[0].match(Bs)||[]).forEach(function(o){var c=Mt(o),d=0;switch(ln(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=c,delete a[0],d=0;d<iu.length;++d)a[iu[d]]&&(a[iu[d]]=parseInt(a[iu[d]],10));for(d=0;d<lu.length;++d)a[lu[d]]&&(a[lu[d]]=Br(a[lu[d]]));if(r.NumberFmt&&a.numFmtId>392){for(d=392;d>60;--d)if(r.NumberFmt[a.numFmtId]==r.NumberFmt[d]){a.numFmtId=d;break}}r.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};c.vertical&&(h.vertical=c.vertical),c.horizontal&&(h.horizontal=c.horizontal),c.textRotation!=null&&(h.textRotation=c.textRotation),c.indent&&(h.indent=c.indent),c.wrapText&&(h.wrapText=Br(c.wrapText)),a.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(s&&s.WTF&&!n)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}var eI=(function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,s=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(d,h,m){var f={};if(!d)return f;d=d.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=d.match(r))&&QF(p,f,m),(p=d.match(n))&&JF(p,f,h,m),(p=d.match(a))&&YF(p,f,h,m),(p=d.match(o))&&qF(p,f,h,m),(p=d.match(s))&&ZF(p,f,m),f}})();function tI(e,r){var s=e.read_shift(2),a=Is(e);return[s,a]}function rI(e,r,s){var a={};a.sz=e.read_shift(2)/20;var n=hD(e);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var o=e.read_shift(2);switch(o===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var c=e.read_shift(1);c!=0&&(a.underline=c);var d=e.read_shift(1);d>0&&(a.family=d);var h=e.read_shift(1);switch(h>0&&(a.charset=h),e.l++,a.color=uD(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Is(e),a}var sI=Ms;function aI(e,r){var s=e.l+r,a=e.read_shift(2),n=e.read_shift(2);return e.l=s,{ixfe:a,numFmtId:n}}var nI=Ms;function iI(e,r,s){var a={};a.NumberFmt=[];for(var n in zt)a.NumberFmt[n]=zt[n];a.CellXf=[],a.Fonts=[];var o=[],c=!1;return _n(e,function(h,m,f){switch(f){case 44:a.NumberFmt[h[0]]=h[1],Xi(h[1],h[0]);break;case 43:a.Fonts.push(h),h.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(h.color.rgb=_u(r.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&a.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:o.push(f),c=!0;break;case 38:o.pop(),c=!1;break;default:if(m.T>0)o.push(f);else if(m.T<0)o.pop();else if(!c||s.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),a}var lI=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function oI(e,r,s){r.themeElements.clrScheme=[];var a={};(e[0].match(Bs)||[]).forEach(function(n){var o=Mt(n);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=o.val;break;case"<a:sysClr":a.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(r.themeElements.clrScheme[lI.indexOf(o[0])]=a,a={}):a.name=o[0].slice(3,o[0].length-1);break;default:if(s&&s.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function cI(){}function dI(){}var uI=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,hI=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,mI=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function fI(e,r,s){r.themeElements={};var a;[["clrScheme",uI,oI],["fontScheme",hI,cI],["fmtScheme",mI,dI]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,r,s)})}var xI=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function r2(e,r){(!e||e.length===0)&&(e=pI());var s,a={};if(!(s=e.match(xI)))throw new Error("themeElements not found in theme");return fI(s[0],a,r),a.raw=e,a}function pI(e,r){var s=[mj];return s[s.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',s[s.length]="<a:themeElements>",s[s.length]='<a:clrScheme name="Office">',s[s.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',s[s.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',s[s.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',s[s.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',s[s.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',s[s.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',s[s.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',s[s.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',s[s.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',s[s.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',s[s.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',s[s.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',s[s.length]="</a:clrScheme>",s[s.length]='<a:fontScheme name="Office">',s[s.length]="<a:majorFont>",s[s.length]='<a:latin typeface="Cambria"/>',s[s.length]='<a:ea typeface=""/>',s[s.length]='<a:cs typeface=""/>',s[s.length]='<a:font script="Jpan" typeface=" "/>',s[s.length]='<a:font script="Hang" typeface=" "/>',s[s.length]='<a:font script="Hans" typeface=""/>',s[s.length]='<a:font script="Hant" typeface=""/>',s[s.length]='<a:font script="Arab" typeface="Times New Roman"/>',s[s.length]='<a:font script="Hebr" typeface="Times New Roman"/>',s[s.length]='<a:font script="Thai" typeface="Tahoma"/>',s[s.length]='<a:font script="Ethi" typeface="Nyala"/>',s[s.length]='<a:font script="Beng" typeface="Vrinda"/>',s[s.length]='<a:font script="Gujr" typeface="Shruti"/>',s[s.length]='<a:font script="Khmr" typeface="MoolBoran"/>',s[s.length]='<a:font script="Knda" typeface="Tunga"/>',s[s.length]='<a:font script="Guru" typeface="Raavi"/>',s[s.length]='<a:font script="Cans" typeface="Euphemia"/>',s[s.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',s[s.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',s[s.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',s[s.length]='<a:font script="Thaa" typeface="MV Boli"/>',s[s.length]='<a:font script="Deva" typeface="Mangal"/>',s[s.length]='<a:font script="Telu" typeface="Gautami"/>',s[s.length]='<a:font script="Taml" typeface="Latha"/>',s[s.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',s[s.length]='<a:font script="Orya" typeface="Kalinga"/>',s[s.length]='<a:font script="Mlym" typeface="Kartika"/>',s[s.length]='<a:font script="Laoo" typeface="DokChampa"/>',s[s.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',s[s.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',s[s.length]='<a:font script="Viet" typeface="Times New Roman"/>',s[s.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',s[s.length]='<a:font script="Geor" typeface="Sylfaen"/>',s[s.length]="</a:majorFont>",s[s.length]="<a:minorFont>",s[s.length]='<a:latin typeface="Calibri"/>',s[s.length]='<a:ea typeface=""/>',s[s.length]='<a:cs typeface=""/>',s[s.length]='<a:font script="Jpan" typeface=" "/>',s[s.length]='<a:font script="Hang" typeface=" "/>',s[s.length]='<a:font script="Hans" typeface=""/>',s[s.length]='<a:font script="Hant" typeface=""/>',s[s.length]='<a:font script="Arab" typeface="Arial"/>',s[s.length]='<a:font script="Hebr" typeface="Arial"/>',s[s.length]='<a:font script="Thai" typeface="Tahoma"/>',s[s.length]='<a:font script="Ethi" typeface="Nyala"/>',s[s.length]='<a:font script="Beng" typeface="Vrinda"/>',s[s.length]='<a:font script="Gujr" typeface="Shruti"/>',s[s.length]='<a:font script="Khmr" typeface="DaunPenh"/>',s[s.length]='<a:font script="Knda" typeface="Tunga"/>',s[s.length]='<a:font script="Guru" typeface="Raavi"/>',s[s.length]='<a:font script="Cans" typeface="Euphemia"/>',s[s.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',s[s.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',s[s.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',s[s.length]='<a:font script="Thaa" typeface="MV Boli"/>',s[s.length]='<a:font script="Deva" typeface="Mangal"/>',s[s.length]='<a:font script="Telu" typeface="Gautami"/>',s[s.length]='<a:font script="Taml" typeface="Latha"/>',s[s.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',s[s.length]='<a:font script="Orya" typeface="Kalinga"/>',s[s.length]='<a:font script="Mlym" typeface="Kartika"/>',s[s.length]='<a:font script="Laoo" typeface="DokChampa"/>',s[s.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',s[s.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',s[s.length]='<a:font script="Viet" typeface="Arial"/>',s[s.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',s[s.length]='<a:font script="Geor" typeface="Sylfaen"/>',s[s.length]="</a:minorFont>",s[s.length]="</a:fontScheme>",s[s.length]='<a:fmtScheme name="Office">',s[s.length]="<a:fillStyleLst>",s[s.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:lin ang="16200000" scaled="1"/>',s[s.length]="</a:gradFill>",s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:lin ang="16200000" scaled="0"/>',s[s.length]="</a:gradFill>",s[s.length]="</a:fillStyleLst>",s[s.length]="<a:lnStyleLst>",s[s.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]="</a:lnStyleLst>",s[s.length]="<a:effectStyleLst>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]="</a:effectStyle>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]="</a:effectStyle>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',s[s.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',s[s.length]="</a:effectStyle>",s[s.length]="</a:effectStyleLst>",s[s.length]="<a:bgFillStyleLst>",s[s.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',s[s.length]="</a:gradFill>",s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',s[s.length]="</a:gradFill>",s[s.length]="</a:bgFillStyleLst>",s[s.length]="</a:fmtScheme>",s[s.length]="</a:themeElements>",s[s.length]="<a:objectDefaults>",s[s.length]="<a:spDef>",s[s.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',s[s.length]="</a:spDef>",s[s.length]="<a:lnDef>",s[s.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',s[s.length]="</a:lnDef>",s[s.length]="</a:objectDefaults>",s[s.length]="<a:extraClrSchemeLst/>",s[s.length]="</a:theme>",s.join("")}function gI(e,r,s){var a=e.l+r,n=e.read_shift(4);if(n!==124226){if(!s.cellStyles){e.l=a;return}var o=e.slice(e.l);e.l=a;var c;try{c=hj(o,{type:"array"})}catch{return}var d=ha(c,"theme/theme/theme1.xml",!0);if(d)return r2(d,s)}}function vI(e){return e.read_shift(4)}function yI(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=NI(e,4);break;case 2:r.xclrValue=Uj(e);break;case 3:r.xclrValue=vI(e);break;case 4:e.l+=4;break}return e.l+=8,r}function NI(e,r){return Ms(e,r)}function wI(e,r){return Ms(e,r)}function bI(e){var r=e.read_shift(2),s=e.read_shift(2)-4,a=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=yI(e);break;case 6:a[1]=wI(e,s);break;case 14:case 15:a[1]=e.read_shift(s===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+s)}return a}function jI(e,r){var s=e.l+r;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),o=[];n-- >0;)o.push(bI(e,s-e.l));return{ixfe:a,ext:o}}function EI(e,r){r.forEach(function(s){s[0]})}function TI(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:Is(e)}}function SI(e){for(var r=[],s=e.read_shift(4);s-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function AI(e){return e.l+=4,e.read_shift(4)!=0}function CI(e,r,s){var a={Types:[],Cell:[],Value:[]},n=s||{},o=[],c=!1,d=2;return _n(e,function(h,m,f){switch(f){case 335:a.Types.push({name:h.name});break;case 51:h.forEach(function(p){d==1?a.Cell.push({type:a.Types[p[0]-1].name,index:p[1]}):d==0&&a.Value.push({type:a.Types[p[0]-1].name,index:p[1]})});break;case 337:d=h?1:0;break;case 338:d=2;break;case 35:o.push(f),c=!0;break;case 36:o.pop(),c=!1;break;default:if(!m.T){if(!c||n.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),a}function kI(e,r,s){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,o=2,c;return e.replace(Bs,function(d){var h=Mt(d);switch(ln(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var m=0;m<a.Types.length;++m)a.Types[m].name==h.name&&(c=a.Types[m]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?a.Cell.push({type:a.Types[h.t-1].name,index:+h.v}):o==0&&a.Value.push({type:a.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+h.i);break;default:if(!n&&s.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return d}),a}function PI(e){var r=[];if(!e)return r;var s=1;return(e.match(Bs)||[]).forEach(function(a){var n=Mt(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?s=n.i:n.i=s,r.push(n);break}}),r}function RI(e){var r={};r.i=e.read_shift(4);var s={};s.r=e.read_shift(4),s.c=e.read_shift(4),r.r=Gt(s);var a=e.read_shift(1);return a&2&&(r.l="1"),a&8&&(r.a="1"),r}function _I(e,r,s){var a=[];return _n(e,function(o,c,d){switch(d){case 63:a.push(o);break;default:if(!c.T)throw new Error("Unexpected record 0x"+d.toString(16))}}),a}function DI(e,r,s,a){if(!e)return e;var n=a||{},o=!1;_n(e,function(d,h,m){switch(m){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!h.T){if(!o||n.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}},n)}function OI(e,r){if(!e)return"??";var s=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][s].Target}function S1(e,r,s,a){var n=Array.isArray(e),o;r.forEach(function(c){var d=Xs(c.ref);if(n?(e[d.r]||(e[d.r]=[]),o=e[d.r][d.c]):o=e[c.ref],!o){o={t:"z"},n?e[d.r][d.c]=o:e[c.ref]=o;var h=qr(e["!ref"]||"BDWGO1000001:A1");h.s.r>d.r&&(h.s.r=d.r),h.e.r<d.r&&(h.e.r=d.r),h.s.c>d.c&&(h.s.c=d.c),h.e.c<d.c&&(h.e.c=d.c);var m=sr(h);m!==e["!ref"]&&(e["!ref"]=m)}o.c||(o.c=[]);var f={a:c.author,t:c.t,r:c.r,T:s};c.h&&(f.h=c.h);for(var p=o.c.length-1;p>=0;--p){if(!s&&o.c[p].T)return;s&&!o.c[p].T&&o.c.splice(p,1)}if(s&&a){for(p=0;p<a.length;++p)if(f.a==a[p].id){f.a=a[p].name||f.a;break}}o.c.push(f)})}function FI(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var s=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var d=c.match(/<(?:\w+:)?author[^>]*>(.*)/);d&&s.push(d[1])}});var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var d=c.match(/<(?:\w+:)?comment[^>]*>/);if(d){var h=Mt(d[0]),m={author:h.authorId&&s[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},f=Xs(h.ref);if(!(r.sheetRows&&r.sheetRows<=f.r)){var p=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!p&&!!p[1]&&ux(p[1])||{r:"",t:"",h:""};m.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),m.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(m.h=g.h),a.push(m)}}}}),a}function II(e,r){var s=[],a=!1,n={},o=0;return e.replace(Bs,function(d,h){var m=Mt(d);switch(ln(m[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:m.personId,guid:m.id,ref:m.ref,T:1};break;case"</threadedComment>":n.t!=null&&s.push(n);break;case"<text>":case"<text":o=h+d.length;break;case"</text>":n.t=e.slice(o,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&r.WTF)throw new Error("unrecognized "+m[0]+" in threaded comments")}return d}),s}function MI(e,r){var s=[],a=!1;return e.replace(Bs,function(o){var c=Mt(o);switch(ln(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":s.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&r.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),s}function LI(e){var r={};r.iauthor=e.read_shift(4);var s=ll(e);return r.rfx=s.s,r.ref=Gt(s.s),e.l+=16,r}var BI=Is;function HI(e,r){var s=[],a=[],n={},o=!1;return _n(e,function(d,h,m){switch(m){case 632:a.push(d);break;case 635:n=d;break;case 637:n.t=d.t,n.h=d.h,n.r=d.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,r.sheetRows&&n.rfx&&r.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,s.push(n);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!o||r.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}),s}var VI="application/vnd.ms-office.vbaProject";function UI(e){var r=rr.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(s,a){if(!(s.slice(-1)==="/"||!s.match(/_VBA_PROJECT_CUR/))){var n=s.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");rr.utils.cfb_add(r,n,e.FileIndex[a].content)}}),rr.write(r)}function $I(){return{"!type":"dialog"}}function GI(){return{"!type":"dialog"}}function WI(){return{"!type":"macro"}}function zI(){return{"!type":"macro"}}var Gl=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function s(a,n,o,c){var d=!1,h=!1;o.length==0?h=!0:o.charAt(0)=="["&&(h=!0,o=o.slice(1,-1)),c.length==0?d=!0:c.charAt(0)=="["&&(d=!0,c=c.slice(1,-1));var m=o.length>0?parseInt(o,10)|0:0,f=c.length>0?parseInt(c,10)|0:0;return d?f+=r.c:--f,h?m+=r.r:--m,n+(d?"":"$")+hs(f)+(h?"":"$")+Ss(m)}return function(n,o){return r=o,n.replace(e,s)}})(),s2=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,KI=(function(){return function(r,s){return r.replace(s2,function(a,n,o,c,d,h){var m=nx(c)-(o?0:s.c),f=ax(h)-(d?0:s.r),p=f==0?"":d?f+1:"["+f+"]",g=m==0?"":o?m+1:"["+m+"]";return n+"R"+p+"C"+g})}})();function a2(e,r){return e.replace(s2,function(s,a,n,o,c,d){return a+(n=="$"?n+o:hs(nx(o)+r.c))+(c=="$"?c+d:Ss(ax(d)+r.r))})}function XI(e,r,s){var a=eo(r),n=a.s,o=Xs(s),c={r:o.r-n.r,c:o.c-n.c};return a2(e,c)}function qI(e){return e.length!=1}function A1(e){return e.replace(/_xlfn\./g,"")}function rs(e){e.l+=1}function vi(e,r){var s=e.read_shift(2);return[s&16383,s>>14&1,s>>15&1]}function n2(e,r,s){var a=2;if(s){if(s.biff>=2&&s.biff<=5)return i2(e);s.biff==12&&(a=4)}var n=e.read_shift(a),o=e.read_shift(a),c=vi(e),d=vi(e);return{s:{r:n,c:c[0],cRel:c[1],rRel:c[2]},e:{r:o,c:d[0],cRel:d[1],rRel:d[2]}}}function i2(e){var r=vi(e),s=vi(e),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:r[0],c:a,cRel:r[1],rRel:r[2]},e:{r:s[0],c:n,cRel:s[1],rRel:s[2]}}}function YI(e,r,s){if(s.biff<8)return i2(e);var a=e.read_shift(s.biff==12?4:2),n=e.read_shift(s.biff==12?4:2),o=vi(e),c=vi(e);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:n,c:c[0],cRel:c[1],rRel:c[2]}}}function l2(e,r,s){if(s&&s.biff>=2&&s.biff<=5)return JI(e);var a=e.read_shift(s&&s.biff==12?4:2),n=vi(e);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function JI(e){var r=vi(e),s=e.read_shift(1);return{r:r[0],c:s,cRel:r[1],rRel:r[2]}}function QI(e){var r=e.read_shift(2),s=e.read_shift(2);return{r,c:s&255,fQuoted:!!(s&16384),cRel:s>>15,rRel:s>>15}}function ZI(e,r,s){var a=s&&s.biff?s.biff:8;if(a>=2&&a<=5)return e6(e);var n=e.read_shift(a>=12?4:2),o=e.read_shift(2),c=(o&16384)>>14,d=(o&32768)>>15;if(o&=16383,d==1)for(;n>524287;)n-=1048576;if(c==1)for(;o>8191;)o=o-16384;return{r:n,c:o,cRel:c,rRel:d}}function e6(e){var r=e.read_shift(2),s=e.read_shift(1),a=(r&32768)>>15,n=(r&16384)>>14;return r&=16383,a==1&&r>=8192&&(r=r-16384),n==1&&s>=128&&(s=s-256),{r,c:s,cRel:n,rRel:a}}function t6(e,r,s){var a=(e[e.l++]&96)>>5,n=n2(e,s.biff>=2&&s.biff<=5?6:8,s);return[a,n]}function r6(e,r,s){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),o=8;if(s)switch(s.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var c=n2(e,o,s);return[a,n,c]}function s6(e,r,s){var a=(e[e.l++]&96)>>5;return e.l+=s&&s.biff>8?12:s.biff<8?6:8,[a]}function a6(e,r,s){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),o=8;if(s)switch(s.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[a,n]}function n6(e,r,s){var a=(e[e.l++]&96)>>5,n=YI(e,r-1,s);return[a,n]}function i6(e,r,s){var a=(e[e.l++]&96)>>5;return e.l+=s.biff==2?6:s.biff==12?14:7,[a]}function C1(e){var r=e[e.l+1]&1,s=1;return e.l+=4,[r,s]}function l6(e,r,s){e.l+=2;for(var a=e.read_shift(s&&s.biff==2?1:2),n=[],o=0;o<=a;++o)n.push(e.read_shift(s&&s.biff==2?1:2));return n}function o6(e,r,s){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(s&&s.biff==2?1:2)]}function c6(e,r,s){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(s&&s.biff==2?1:2)]}function d6(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function u6(e,r,s){var a=e[e.l+1]&255?1:0;return e.l+=s&&s.biff==2?3:4,[a]}function o2(e){var r=e.read_shift(1),s=e.read_shift(1);return[r,s]}function h6(e){return e.read_shift(2),o2(e)}function m6(e){return e.read_shift(2),o2(e)}function f6(e,r,s){var a=(e[e.l]&96)>>5;e.l+=1;var n=l2(e,0,s);return[a,n]}function x6(e,r,s){var a=(e[e.l]&96)>>5;e.l+=1;var n=ZI(e,0,s);return[a,n]}function p6(e,r,s){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);s&&s.biff==5&&(e.l+=12);var o=l2(e,0,s);return[a,n,o]}function g6(e,r,s){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(s&&s.biff<=3?1:2);return[v8[n],u2[n],a]}function v6(e,r,s){var a=e[e.l++],n=e.read_shift(1),o=s&&s.biff<=3?[a==88?-1:0,e.read_shift(1)]:y6(e);return[n,(o[0]===0?u2:g8)[o[1]]]}function y6(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function N6(e,r,s){e.l+=s&&s.biff==2?3:4}function w6(e,r,s){if(e.l++,s&&s.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(s&&s.biff==2?1:2);return[a,n]}function b6(e){return e.l++,ol[e.read_shift(1)]}function j6(e){return e.l++,e.read_shift(2)}function E6(e){return e.l++,e.read_shift(1)!==0}function T6(e){return e.l++,Os(e)}function S6(e,r,s){return e.l++,Mc(e,r-1,s)}function A6(e,r){var s=[e.read_shift(1)];if(r==12)switch(s[0]){case 2:s[0]=4;break;case 4:s[0]=16;break;case 0:s[0]=1;break;case 1:s[0]=2;break}switch(s[0]){case 4:s[1]=Qr(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:s[1]=ol[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:s[1]=Os(e);break;case 2:s[1]=cl(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+s[0])}return s}function C6(e,r,s){for(var a=e.read_shift(s.biff==12?4:2),n=[],o=0;o!=a;++o)n.push((s.biff==12?ll:Qu)(e));return n}function k6(e,r,s){var a=0,n=0;s.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),s.biff>=2&&s.biff<8&&(--a,--n==0&&(n=256));for(var o=0,c=[];o!=a&&(c[o]=[]);++o)for(var d=0;d!=n;++d)c[o][d]=A6(e,s.biff);return c}function P6(e,r,s){var a=e.read_shift(1)>>>5&3,n=!s||s.biff>=8?4:2,o=e.read_shift(n);switch(s.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,o]}function R6(e,r,s){if(s.biff==5)return _6(e);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),o=e.read_shift(4);return[a,n,o]}function _6(e){var r=e.read_shift(1)>>>5&3,s=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[r,s,a]}function D6(e,r,s){var a=e.read_shift(1)>>>5&3;e.l+=s&&s.biff==2?3:4;var n=e.read_shift(s&&s.biff==2?1:2);return[a,n]}function O6(e,r,s){var a=e.read_shift(1)>>>5&3,n=e.read_shift(s&&s.biff==2?1:2);return[a,n]}function F6(e,r,s){var a=e.read_shift(1)>>>5&3;return e.l+=4,s.biff<8&&e.l--,s.biff==12&&(e.l+=2),[a]}function I6(e,r,s){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),o=4;if(s)switch(s.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[a,n]}var M6=Ms,L6=Ms,B6=Ms;function Bc(e,r,s){return e.l+=2,[QI(e)]}function mx(e){return e.l+=6,[]}var H6=Bc,V6=mx,U6=mx,$6=Bc;function c2(e){return e.l+=2,[ns(e),e.read_shift(2)&1]}var G6=Bc,W6=c2,z6=mx,K6=Bc,X6=Bc,q6=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Y6(e){e.l+=2;var r=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),o=e.read_shift(2),c=q6[s>>2&31];return{ixti:r,coltype:s&3,rt:c,idx:a,c:n,C:o}}function J6(e){return e.l+=2,[e.read_shift(4)]}function Q6(e,r,s){return e.l+=5,e.l+=2,e.l+=s.biff==2?1:4,["PTGSHEET"]}function Z6(e,r,s){return e.l+=s.biff==2?4:5,["PTGENDSHEET"]}function e8(e){var r=e.read_shift(1)>>>5&3,s=e.read_shift(2);return[r,s]}function t8(e){var r=e.read_shift(1)>>>5&3,s=e.read_shift(2);return[r,s]}function r8(e){return e.l+=4,[0,0]}var k1={1:{n:"PtgExp",f:w6},2:{n:"PtgTbl",f:B6},3:{n:"PtgAdd",f:rs},4:{n:"PtgSub",f:rs},5:{n:"PtgMul",f:rs},6:{n:"PtgDiv",f:rs},7:{n:"PtgPower",f:rs},8:{n:"PtgConcat",f:rs},9:{n:"PtgLt",f:rs},10:{n:"PtgLe",f:rs},11:{n:"PtgEq",f:rs},12:{n:"PtgGe",f:rs},13:{n:"PtgGt",f:rs},14:{n:"PtgNe",f:rs},15:{n:"PtgIsect",f:rs},16:{n:"PtgUnion",f:rs},17:{n:"PtgRange",f:rs},18:{n:"PtgUplus",f:rs},19:{n:"PtgUminus",f:rs},20:{n:"PtgPercent",f:rs},21:{n:"PtgParen",f:rs},22:{n:"PtgMissArg",f:rs},23:{n:"PtgStr",f:S6},26:{n:"PtgSheet",f:Q6},27:{n:"PtgEndSheet",f:Z6},28:{n:"PtgErr",f:b6},29:{n:"PtgBool",f:E6},30:{n:"PtgInt",f:j6},31:{n:"PtgNum",f:T6},32:{n:"PtgArray",f:i6},33:{n:"PtgFunc",f:g6},34:{n:"PtgFuncVar",f:v6},35:{n:"PtgName",f:P6},36:{n:"PtgRef",f:f6},37:{n:"PtgArea",f:t6},38:{n:"PtgMemArea",f:D6},39:{n:"PtgMemErr",f:M6},40:{n:"PtgMemNoMem",f:L6},41:{n:"PtgMemFunc",f:O6},42:{n:"PtgRefErr",f:F6},43:{n:"PtgAreaErr",f:s6},44:{n:"PtgRefN",f:x6},45:{n:"PtgAreaN",f:n6},46:{n:"PtgMemAreaN",f:e8},47:{n:"PtgMemNoMemN",f:t8},57:{n:"PtgNameX",f:R6},58:{n:"PtgRef3d",f:p6},59:{n:"PtgArea3d",f:r6},60:{n:"PtgRefErr3d",f:I6},61:{n:"PtgAreaErr3d",f:a6},255:{}},s8={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},a8={1:{n:"PtgElfLel",f:c2},2:{n:"PtgElfRw",f:K6},3:{n:"PtgElfCol",f:H6},6:{n:"PtgElfRwV",f:X6},7:{n:"PtgElfColV",f:$6},10:{n:"PtgElfRadical",f:G6},11:{n:"PtgElfRadicalS",f:z6},13:{n:"PtgElfColS",f:V6},15:{n:"PtgElfColSV",f:U6},16:{n:"PtgElfRadicalLel",f:W6},25:{n:"PtgList",f:Y6},29:{n:"PtgSxName",f:J6},255:{}},n8={0:{n:"PtgAttrNoop",f:r8},1:{n:"PtgAttrSemi",f:u6},2:{n:"PtgAttrIf",f:c6},4:{n:"PtgAttrChoose",f:l6},8:{n:"PtgAttrGoto",f:o6},16:{n:"PtgAttrSum",f:N6},32:{n:"PtgAttrBaxcel",f:C1},33:{n:"PtgAttrBaxcel",f:C1},64:{n:"PtgAttrSpace",f:h6},65:{n:"PtgAttrSpaceSemi",f:m6},128:{n:"PtgAttrIfError",f:d6},255:{}};function Hc(e,r,s,a){if(a.biff<8)return Ms(e,r);for(var n=e.l+r,o=[],c=0;c!==s.length;++c)switch(s[c][0]){case"PtgArray":s[c][1]=k6(e,0,a),o.push(s[c][1]);break;case"PtgMemArea":s[c][2]=C6(e,s[c][1],a),o.push(s[c][2]);break;case"PtgExp":a&&a.biff==12&&(s[c][1][1]=e.read_shift(4),o.push(s[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+s[c][0]}return r=n-e.l,r!==0&&o.push(Ms(e,r)),o}function Vc(e,r,s){for(var a=e.l+r,n,o,c=[];a!=e.l;)r=a-e.l,o=e[e.l],n=k1[o]||k1[s8[o]],(o===24||o===25)&&(n=(o===24?a8:n8)[e[e.l+1]]),!n||!n.f?Ms(e,r):c.push([n.n,n.f(e,r,s)]);return c}function i8(e){for(var r=[],s=0;s<e.length;++s){for(var a=e[s],n=[],o=0;o<a.length;++o){var c=a[o];if(c)switch(c[0]){case 2:n.push('"'+c[1].replace(/"/g,'""')+'"');break;default:n.push(c[1])}else n.push("")}r.push(n.join(","))}return r.join(";")}var l8={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function o8(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function d2(e,r,s){if(!e)return"SH33TJSERR0";if(s.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[r];if(s.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!a)return"SH33TJSERR1";var n="";if(s.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return s.SID!=null?e.SheetNames[s.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function P1(e,r,s){var a=d2(e,r,s);return a=="#REF"?a:o8(a,s)}function Ds(e,r,s,a,n){var o=n&&n.biff||8,c={s:{c:0,r:0}},d=[],h,m,f,p=0,g=0,N,y="";if(!e[0]||!e[0][0])return"";for(var w=-1,b="",C=0,A=e[0].length;C<A;++C){var E=e[0][C];switch(E[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=d.pop(),m=d.pop(),w>=0){switch(e[0][w][1][0]){case 0:b=Wr(" ",e[0][w][1][1]);break;case 1:b=Wr("\r",e[0][w][1][1]);break;default:if(b="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}m=m+b,w=-1}d.push(m+l8[E[0]]+h);break;case"PtgIsect":h=d.pop(),m=d.pop(),d.push(m+" "+h);break;case"PtgUnion":h=d.pop(),m=d.pop(),d.push(m+","+h);break;case"PtgRange":h=d.pop(),m=d.pop(),d.push(m+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=sc(E[1][1],c,n),d.push(ac(f,o));break;case"PtgRefN":f=s?sc(E[1][1],s,n):E[1][1],d.push(ac(f,o));break;case"PtgRef3d":p=E[1][1],f=sc(E[1][2],c,n),y=P1(a,p,n),d.push(y+"!"+ac(f,o));break;case"PtgFunc":case"PtgFuncVar":var R=E[1][0],V=E[1][1];R||(R=0),R&=127;var P=R==0?[]:d.slice(-R);d.length-=R,V==="User"&&(V=P.shift()),d.push(V+"("+P.join(",")+")");break;case"PtgBool":d.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":d.push(E[1]);break;case"PtgNum":d.push(String(E[1]));break;case"PtgStr":d.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":d.push(E[1]);break;case"PtgAreaN":N=d1(E[1][1],s?{s}:c,n),d.push(mm(N,n));break;case"PtgArea":N=d1(E[1][1],c,n),d.push(mm(N,n));break;case"PtgArea3d":p=E[1][1],N=E[1][2],y=P1(a,p,n),d.push(y+"!"+mm(N,n));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=E[1][2];var k=(a.names||[])[g-1]||(a[0]||[])[g],z=k?k.Name:"SH33TJSNAME"+String(g);z&&z.slice(0,6)=="_xlfn."&&!n.xlfn&&(z=z.slice(6)),d.push(z);break;case"PtgNameX":var W=E[1][1];g=E[1][2];var te;if(n.biff<=5)W<0&&(W=-W),a[W]&&(te=a[W][g]);else{var de="";if(((a[W]||[])[0]||[])[0]==14849||(((a[W]||[])[0]||[])[0]==1025?a[W][g]&&a[W][g].itab>0&&(de=a.SheetNames[a[W][g].itab-1]+"!"):de=a.SheetNames[g-1]+"!"),a[W]&&a[W][g])de+=a[W][g].Name;else if(a[0]&&a[0][g])de+=a[0][g].Name;else{var H=(d2(a,W,n)||"").split(";;");H[g-1]?de=H[g-1]:de+="SH33TJSERRX"}d.push(de);break}te||(te={Name:"SH33TJSERRY"}),d.push(te.Name);break;case"PtgParen":var ue="(",I=")";if(w>=0){switch(b="",e[0][w][1][0]){case 2:ue=Wr(" ",e[0][w][1][1])+ue;break;case 3:ue=Wr("\r",e[0][w][1][1])+ue;break;case 4:I=Wr(" ",e[0][w][1][1])+I;break;case 5:I=Wr("\r",e[0][w][1][1])+I;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}w=-1}d.push(ue+d.pop()+I);break;case"PtgRefErr":d.push("#REF!");break;case"PtgRefErr3d":d.push("#REF!");break;case"PtgExp":f={c:E[1][1],r:E[1][0]};var X={c:s.c,r:s.r};if(a.sharedf[Gt(f)]){var oe=a.sharedf[Gt(f)];d.push(Ds(oe,c,X,a,n))}else{var xe=!1;for(h=0;h!=a.arrayf.length;++h)if(m=a.arrayf[h],!(f.c<m[0].s.c||f.c>m[0].e.c)&&!(f.r<m[0].s.r||f.r>m[0].e.r)){d.push(Ds(m[1],c,X,a,n)),xe=!0;break}xe||d.push(E[1])}break;case"PtgArray":d.push("{"+i8(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=C;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":d.push("");break;case"PtgAreaErr":d.push("#REF!");break;case"PtgAreaErr3d":d.push("#REF!");break;case"PtgList":d.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var he=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&w>=0&&he.indexOf(e[0][C][0])==-1){E=e[0][w];var F=!0;switch(E[1][0]){case 4:F=!1;case 0:b=Wr(" ",E[1][1]);break;case 5:F=!1;case 1:b=Wr("\r",E[1][1]);break;default:if(b="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}d.push((F?b:"")+d.pop()+(F?"":b)),w=-1}}if(d.length>1&&n.WTF)throw new Error("bad formula stack");return d[0]}function c8(e,r,s){var a=e.l+r,n=s.biff==2?1:2,o,c=e.read_shift(n);if(c==65535)return[[],Ms(e,r-2)];var d=Vc(e,c,s);return r!==c+n&&(o=Hc(e,r-c-n,d,s)),e.l=a,[d,o]}function d8(e,r,s){var a=e.l+r,n=s.biff==2?1:2,o,c=e.read_shift(n);if(c==65535)return[[],Ms(e,r-2)];var d=Vc(e,c,s);return r!==c+n&&(o=Hc(e,r-c-n,d,s)),e.l=a,[d,o]}function u8(e,r,s,a){var n=e.l+r,o=Vc(e,a,s),c;return n!==e.l&&(c=Hc(e,n-e.l,o,s)),[o,c]}function h8(e,r,s){var a=e.l+r,n,o=e.read_shift(2),c=Vc(e,o,s);return o==65535?[[],Ms(e,r-2)]:(r!==o+2&&(n=Hc(e,a-o-2,c,s)),[c,n])}function m8(e){var r;if(bn(e,e.l+6)!==65535)return[Os(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function pm(e,r,s){var a=e.l+r,n=on(e);s.biff==2&&++e.l;var o=m8(e),c=e.read_shift(1);s.biff!=2&&(e.read_shift(1),s.biff>=5&&e.read_shift(4));var d=d8(e,a-e.l,s);return{cell:n,val:o[0],formula:d,shared:c>>3&1,tt:o[1]}}function Zu(e,r,s){var a=e.read_shift(4),n=Vc(e,a,s),o=e.read_shift(4),c=o>0?Hc(e,o,n,s):null;return[n,c]}var f8=Zu,e0=Zu,x8=Zu,p8=Zu,g8={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},u2={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},v8={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function R1(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,s){return s.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function gm(e){var r=e.split(":"),s=r[0].split(".")[0];return[s,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var oc={},Wl={};function cc(e,r){if(e){var s=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(s=[1,1,1,1,.5,.5]),e.left==null&&(e.left=s[0]),e.right==null&&(e.right=s[1]),e.top==null&&(e.top=s[2]),e.bottom==null&&(e.bottom=s[3]),e.header==null&&(e.header=s[4]),e.footer==null&&(e.footer=s[5])}}function h2(e,r,s,a,n,o){try{a.cellNF&&(e.z=zt[r])}catch(d){if(a.WTF)throw d}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=ys(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(zt[r]==null&&Xi(y_[r]||"General",r),e.t==="e")e.w=e.w||ol[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=yc(e.v);else if(e.t==="d"){var c=Js(e.v);(c|0)===c?e.w=c.toString(10):e.w=yc(c)}else{if(e.v===void 0)return"";e.w=Ji(e.v,Wl)}else e.t==="d"?e.w=Aa(r,Js(e.v),Wl):e.w=Aa(r,e.v,Wl)}catch(d){if(a.WTF)throw d}if(a.cellStyles&&s!=null)try{e.s=o.Fills[s],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=_u(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=_u(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(d){if(a.WTF&&o.Fills)throw d}}}function y8(e,r){var s=qr(r);s.s.r<=s.e.r&&s.s.c<=s.e.c&&s.s.r>=0&&s.s.c>=0&&(e["!ref"]=sr(s))}var N8=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,w8=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,b8=/<(?:\w:)?hyperlink [^>]*>/mg,j8=/"(\w*:\w*)"/,E8=/<(?:\w:)?col\b[^>]*[\/]?>/g,T8=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,S8=/<(?:\w:)?pageMargins[^>]*\/>/g,m2=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,A8=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,C8=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function k8(e,r,s,a,n,o,c){if(!e)return e;a||(a={"!id":{}});var d=r.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},m="",f="",p=e.match(w8);p?(m=e.slice(0,p.index),f=e.slice(p.index+p[0].length)):m=f=e;var g=m.match(m2);g?fx(g[0],d,n,s):(g=m.match(A8))&&P8(g[0],g[1]||"",d,n,s);var N=(m.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(N>0){var y=m.slice(N,N+50).match(j8);y&&y8(d,y[1])}var w=m.match(C8);w&&w[1]&&I8(w[1],n);var b=[];if(r.cellStyles){var C=m.match(E8);C&&D8(b,C)}p&&M8(p[1],d,r,h,o,c);var A=f.match(T8);A&&(d["!autofilter"]=O8(A[0]));var E=[],R=f.match(N8);if(R)for(N=0;N!=R.length;++N)E[N]=qr(R[N].slice(R[N].indexOf('"')+1));var V=f.match(b8);V&&R8(d,V,a);var P=f.match(S8);if(P&&(d["!margins"]=_8(Mt(P[0]))),!d["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(d["!ref"]=sr(h)),r.sheetRows>0&&d["!ref"]){var k=qr(d["!ref"]);r.sheetRows<=+k.e.r&&(k.e.r=r.sheetRows-1,k.e.r>h.e.r&&(k.e.r=h.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>h.e.c&&(k.e.c=h.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),d["!fullref"]=d["!ref"],d["!ref"]=sr(k))}return b.length>0&&(d["!cols"]=b),E.length>0&&(d["!merges"]=E),d}function fx(e,r,s,a){var n=Mt(e);s.Sheets[a]||(s.Sheets[a]={}),n.codeName&&(s.Sheets[a].CodeName=lr(kr(n.codeName)))}function P8(e,r,s,a,n){fx(e.slice(0,e.indexOf(">")),s,a,n)}function R8(e,r,s){for(var a=Array.isArray(e),n=0;n!=r.length;++n){var o=Mt(kr(r[n]),!0);if(!o.ref)return;var c=((s||{})["!id"]||[])[o.id];c?(o.Target=c.Target,o.location&&(o.Target+="#"+lr(o.location))):(o.Target="#"+lr(o.location),c={Target:o.Target,TargetMode:"Internal"}),o.Rel=c,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var d=qr(o.ref),h=d.s.r;h<=d.e.r;++h)for(var m=d.s.c;m<=d.e.c;++m){var f=Gt({c:m,r:h});a?(e[h]||(e[h]=[]),e[h][m]||(e[h][m]={t:"z",v:void 0}),e[h][m].l=o):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=o)}}}function _8(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(s){e[s]&&(r[s]=parseFloat(e[s]))}),r}function D8(e,r){for(var s=!1,a=0;a!=r.length;++a){var n=Mt(r[a],!0);n.hidden&&(n.hidden=Br(n.hidden));var o=parseInt(n.min,10)-1,c=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!s&&n.width&&(s=!0,hx(n.width)),ql(n);o<=c;)e[o++]=Ts(n)}}function O8(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}var F8=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function I8(e,r){r.Views||(r.Views=[{}]),(e.match(F8)||[]).forEach(function(s,a){var n=Mt(s);r.Views[a]||(r.Views[a]={}),+n.zoomScale&&(r.Views[a].zoom=+n.zoomScale),Br(n.rightToLeft)&&(r.Views[a].RTL=!0)})}var M8=(function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,s=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,o=Nc("v"),c=Nc("f");return function(h,m,f,p,g,N){for(var y=0,w="",b=[],C=[],A=0,E=0,R=0,V="",P,k,z=0,W=0,te,de,H=0,ue=0,I=Array.isArray(N.CellXf),X,oe=[],xe=[],he=Array.isArray(m),F=[],ee={},M=!1,_=!!f.sheetStubs,ne=h.split(r),ae=0,G=ne.length;ae!=G;++ae){w=ne[ae].trim();var ie=w.length;if(ie!==0){var Me=0;e:for(y=0;y<ie;++y)switch(w[y]){case">":if(w[y-1]!="/"){++y;break e}if(f&&f.cellStyles){if(k=Mt(w.slice(Me,y),!0),z=k.r!=null?parseInt(k.r,10):z+1,W=-1,f.sheetRows&&f.sheetRows<z)continue;ee={},M=!1,k.ht&&(M=!0,ee.hpt=parseFloat(k.ht),ee.hpx=Ec(ee.hpt)),k.hidden=="1"&&(M=!0,ee.hidden=!0),k.outlineLevel!=null&&(M=!0,ee.level=+k.outlineLevel),M&&(F[z-1]=ee)}break;case"<":Me=y;break}if(Me>=y)break;if(k=Mt(w.slice(Me,y),!0),z=k.r!=null?parseInt(k.r,10):z+1,W=-1,!(f.sheetRows&&f.sheetRows<z)){p.s.r>z-1&&(p.s.r=z-1),p.e.r<z-1&&(p.e.r=z-1),f&&f.cellStyles&&(ee={},M=!1,k.ht&&(M=!0,ee.hpt=parseFloat(k.ht),ee.hpx=Ec(ee.hpt)),k.hidden=="1"&&(M=!0,ee.hidden=!0),k.outlineLevel!=null&&(M=!0,ee.level=+k.outlineLevel),M&&(F[z-1]=ee)),b=w.slice(y).split(e);for(var Ee=0;Ee!=b.length&&b[Ee].trim().charAt(0)=="<";++Ee);for(b=b.slice(Ee),y=0;y!=b.length;++y)if(w=b[y].trim(),w.length!==0){if(C=w.match(s),A=y,E=0,R=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,C!=null&&C.length===2){for(A=0,V=C[1],E=0;E!=V.length&&!((R=V.charCodeAt(E)-64)<1||R>26);++E)A=26*A+R;--A,W=A}else++W;for(E=0;E!=w.length&&w.charCodeAt(E)!==62;++E);if(++E,k=Mt(w.slice(0,E),!0),k.r||(k.r=Gt({r:z-1,c:W})),V=w.slice(E),P={t:""},(C=V.match(o))!=null&&C[1]!==""&&(P.v=lr(C[1])),f.cellFormula){if((C=V.match(c))!=null&&C[1]!==""){if(P.f=lr(kr(C[1])).replace(/\r\n/g,`
`),f.xlfn||(P.f=A1(P.f)),C[0].indexOf('t="array"')>-1)P.F=(V.match(n)||[])[1],P.F.indexOf(":")>-1&&oe.push([qr(P.F),P.F]);else if(C[0].indexOf('t="shared"')>-1){de=Mt(C[0]);var ye=lr(kr(C[1]));f.xlfn||(ye=A1(ye)),xe[parseInt(de.si,10)]=[de,ye,k.r]}}else(C=V.match(/<f[^>]*\/>/))&&(de=Mt(C[0]),xe[de.si]&&(P.f=XI(xe[de.si][1],xe[de.si][2],k.r)));var je=Xs(k.r);for(E=0;E<oe.length;++E)je.r>=oe[E][0].s.r&&je.r<=oe[E][0].e.r&&je.c>=oe[E][0].s.c&&je.c<=oe[E][0].e.c&&(P.F=oe[E][1])}if(k.t==null&&P.v===void 0)if(P.f||P.F)P.v=0,P.t="n";else if(_)P.t="z";else continue;else P.t=k.t||"n";switch(p.s.c>W&&(p.s.c=W),p.e.c<W&&(p.e.c=W),P.t){case"n":if(P.v==""||P.v==null){if(!_)continue;P.t="z"}else P.v=parseFloat(P.v);break;case"s":if(typeof P.v>"u"){if(!_)continue;P.t="z"}else te=oc[parseInt(P.v,10)],P.v=te.t,P.r=te.r,f.cellHTML&&(P.h=te.h);break;case"str":P.t="s",P.v=P.v!=null?kr(P.v):"",f.cellHTML&&(P.h=tx(P.v));break;case"inlineStr":C=V.match(a),P.t="s",C!=null&&(te=ux(C[1]))?(P.v=te.t,f.cellHTML&&(P.h=te.h)):P.v="";break;case"b":P.v=Br(P.v);break;case"d":f.cellDates?P.v=ys(P.v,1):(P.v=Js(ys(P.v,1)),P.t="n");break;case"e":(!f||f.cellText!==!1)&&(P.w=P.v),P.v=Oj[P.v];break}if(H=ue=0,X=null,I&&k.s!==void 0&&(X=N.CellXf[k.s],X!=null&&(X.numFmtId!=null&&(H=X.numFmtId),f.cellStyles&&X.fillId!=null&&(ue=X.fillId))),h2(P,H,ue,f,g,N),f.cellDates&&I&&P.t=="n"&&Zl(zt[H])&&(P.t="d",P.v=Ju(P.v)),k.cm&&f.xlmeta){var We=(f.xlmeta.Cell||[])[+k.cm-1];We&&We.type=="XLDAPR"&&(P.D=!0)}if(he){var Y=Xs(k.r);m[Y.r]||(m[Y.r]=[]),m[Y.r][Y.c]=P}else m[k.r]=P}}}}F.length>0&&(m["!rows"]=F)}})();function L8(e,r){var s={},a=e.l+r;s.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=a,o&7&&(s.level=o&7),o&16&&(s.hidden=!0),o&32&&(s.hpt=n/20),s}var B8=ll;function H8(){}function V8(e,r){var s={},a=e[e.l];return++e.l,s.above=!(a&64),s.left=!(a&128),e.l+=18,s.name=cD(e),s}function U8(e){var r=Ca(e);return[r]}function $8(e){var r=il(e);return[r]}function G8(e){var r=Ca(e),s=e.read_shift(1);return[r,s,"b"]}function W8(e){var r=il(e),s=e.read_shift(1);return[r,s,"b"]}function z8(e){var r=Ca(e),s=e.read_shift(1);return[r,s,"e"]}function K8(e){var r=il(e),s=e.read_shift(1);return[r,s,"e"]}function X8(e){var r=Ca(e),s=e.read_shift(4);return[r,s,"s"]}function q8(e){var r=il(e),s=e.read_shift(4);return[r,s,"s"]}function Y8(e){var r=Ca(e),s=Os(e);return[r,s,"n"]}function f2(e){var r=il(e),s=Os(e);return[r,s,"n"]}function J8(e){var r=Ca(e),s=ox(e);return[r,s,"n"]}function Q8(e){var r=il(e),s=ox(e);return[r,s,"n"]}function Z8(e){var r=Ca(e),s=ix(e);return[r,s,"is"]}function eM(e){var r=Ca(e),s=Is(e);return[r,s,"str"]}function tM(e){var r=il(e),s=Is(e);return[r,s,"str"]}function rM(e,r,s){var a=e.l+r,n=Ca(e);n.r=s["!row"];var o=e.read_shift(1),c=[n,o,"b"];if(s.cellFormula){e.l+=2;var d=e0(e,a-e.l,s);c[3]=Ds(d,null,n,s.supbooks,s)}else e.l=a;return c}function sM(e,r,s){var a=e.l+r,n=Ca(e);n.r=s["!row"];var o=e.read_shift(1),c=[n,o,"e"];if(s.cellFormula){e.l+=2;var d=e0(e,a-e.l,s);c[3]=Ds(d,null,n,s.supbooks,s)}else e.l=a;return c}function aM(e,r,s){var a=e.l+r,n=Ca(e);n.r=s["!row"];var o=Os(e),c=[n,o,"n"];if(s.cellFormula){e.l+=2;var d=e0(e,a-e.l,s);c[3]=Ds(d,null,n,s.supbooks,s)}else e.l=a;return c}function nM(e,r,s){var a=e.l+r,n=Ca(e);n.r=s["!row"];var o=Is(e),c=[n,o,"str"];if(s.cellFormula){e.l+=2;var d=e0(e,a-e.l,s);c[3]=Ds(d,null,n,s.supbooks,s)}else e.l=a;return c}var iM=ll;function lM(e,r){var s=e.l+r,a=ll(e),n=lx(e),o=Is(e),c=Is(e),d=Is(e);e.l=s;var h={rfx:a,relId:n,loc:o,display:d};return c&&(h.Tooltip=c),h}function oM(){}function cM(e,r,s){var a=e.l+r,n=Rj(e),o=e.read_shift(1),c=[n];if(c[2]=o,s.cellFormula){var d=f8(e,a-e.l,s);c[1]=d}else e.l=a;return c}function dM(e,r,s){var a=e.l+r,n=ll(e),o=[n];if(s.cellFormula){var c=p8(e,a-e.l,s);o[1]=c,e.l=a}else e.l=a;return o}var uM=["left","right","top","bottom","header","footer"];function hM(e){var r={};return uM.forEach(function(s){r[s]=Os(e)}),r}function mM(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function fM(){}function xM(){}function pM(e,r,s,a,n,o,c){if(!e)return e;var d=r||{};a||(a={"!id":{}});var h=d.dense?[]:{},m,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,g=!1,N,y,w,b,C,A,E,R,V,P=[];d.biff=12,d["!row"]=0;var k=0,z=!1,W=[],te={},de=d.supbooks||n.supbooks||[[]];if(de.sharedf=te,de.arrayf=W,de.SheetNames=n.SheetNames||n.Sheets.map(function(he){return he.name}),!d.supbooks&&(d.supbooks=de,n.Names))for(var H=0;H<n.Names.length;++H)de[0][H+1]=n.Names[H];var ue=[],I=[],X=!1;Fu[16]={n:"BrtShortReal",f:f2};var oe;if(_n(e,function(F,ee,M){if(!g)switch(M){case 148:m=F;break;case 0:N=F,d.sheetRows&&d.sheetRows<=N.r&&(g=!0),R=Ss(b=N.r),d["!row"]=N.r,(F.hidden||F.hpt||F.level!=null)&&(F.hpt&&(F.hpx=Ec(F.hpt)),I[F.r]=F);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:F[2]},F[2]){case"n":y.v=F[1];break;case"s":E=oc[F[1]],y.v=E.t,y.r=E.r;break;case"b":y.v=!!F[1];break;case"e":y.v=F[1],d.cellText!==!1&&(y.w=ol[y.v]);break;case"str":y.t="s",y.v=F[1];break;case"is":y.t="s",y.v=F[1].t;break}if((w=c.CellXf[F[0].iStyleRef])&&h2(y,w.numFmtId,null,d,o,c),C=F[0].c==-1?C+1:F[0].c,d.dense?(h[b]||(h[b]=[]),h[b][C]=y):h[hs(C)+R]=y,d.cellFormula){for(z=!1,k=0;k<W.length;++k){var _=W[k];N.r>=_[0].s.r&&N.r<=_[0].e.r&&C>=_[0].s.c&&C<=_[0].e.c&&(y.F=sr(_[0]),z=!0)}!z&&F.length>3&&(y.f=F[3])}if(f.s.r>N.r&&(f.s.r=N.r),f.s.c>C&&(f.s.c=C),f.e.r<N.r&&(f.e.r=N.r),f.e.c<C&&(f.e.c=C),d.cellDates&&w&&y.t=="n"&&Zl(zt[w.numFmtId])){var ne=$i(y.v);ne&&(y.t="d",y.v=new Date(ne.y,ne.m-1,ne.d,ne.H,ne.M,ne.S,ne.u))}oe&&(oe.type=="XLDAPR"&&(y.D=!0),oe=void 0);break;case 1:case 12:if(!d.sheetStubs||p)break;y={t:"z",v:void 0},C=F[0].c==-1?C+1:F[0].c,d.dense?(h[b]||(h[b]=[]),h[b][C]=y):h[hs(C)+R]=y,f.s.r>N.r&&(f.s.r=N.r),f.s.c>C&&(f.s.c=C),f.e.r<N.r&&(f.e.r=N.r),f.e.c<C&&(f.e.c=C),oe&&(oe.type=="XLDAPR"&&(y.D=!0),oe=void 0);break;case 176:P.push(F);break;case 49:oe=((d.xlmeta||{}).Cell||[])[F-1];break;case 494:var ae=a["!id"][F.relId];for(ae?(F.Target=ae.Target,F.loc&&(F.Target+="#"+F.loc),F.Rel=ae):F.relId==""&&(F.Target="#"+F.loc),b=F.rfx.s.r;b<=F.rfx.e.r;++b)for(C=F.rfx.s.c;C<=F.rfx.e.c;++C)d.dense?(h[b]||(h[b]=[]),h[b][C]||(h[b][C]={t:"z",v:void 0}),h[b][C].l=F):(A=Gt({c:C,r:b}),h[A]||(h[A]={t:"z",v:void 0}),h[A].l=F);break;case 426:if(!d.cellFormula)break;W.push(F),V=d.dense?h[b][C]:h[hs(C)+R],V.f=Ds(F[1],f,{r:N.r,c:C},de,d),V.F=sr(F[0]);break;case 427:if(!d.cellFormula)break;te[Gt(F[0].s)]=F[1],V=d.dense?h[b][C]:h[hs(C)+R],V.f=Ds(F[1],f,{r:N.r,c:C},de,d);break;case 60:if(!d.cellStyles)break;for(;F.e>=F.s;)ue[F.e--]={width:F.w/256,hidden:!!(F.flags&1),level:F.level},X||(X=!0,hx(F.w/256)),ql(ue[F.e+1]);break;case 161:h["!autofilter"]={ref:sr(F)};break;case 476:h["!margins"]=F;break;case 147:n.Sheets[s]||(n.Sheets[s]={}),F.name&&(n.Sheets[s].CodeName=F.name),(F.above||F.left)&&(h["!outline"]={above:F.above,left:F.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),F.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!ee.T){if(!p||d.WTF)throw new Error("Unexpected record 0x"+M.toString(16))}}},d),delete d.supbooks,delete d["!row"],!h["!ref"]&&(f.s.r<2e6||m&&(m.e.r>0||m.e.c>0||m.s.r>0||m.s.c>0))&&(h["!ref"]=sr(m||f)),d.sheetRows&&h["!ref"]){var xe=qr(h["!ref"]);d.sheetRows<=+xe.e.r&&(xe.e.r=d.sheetRows-1,xe.e.r>f.e.r&&(xe.e.r=f.e.r),xe.e.r<xe.s.r&&(xe.s.r=xe.e.r),xe.e.c>f.e.c&&(xe.e.c=f.e.c),xe.e.c<xe.s.c&&(xe.s.c=xe.e.c),h["!fullref"]=h["!ref"],h["!ref"]=sr(xe))}return P.length>0&&(h["!merges"]=P),ue.length>0&&(h["!cols"]=ue),I.length>0&&(h["!rows"]=I),h}function gM(e){var r=[],s=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var c=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(r[+c[1]]=s?+c[2]:c[2])});var n=lr((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){a=o.replace(/<.*?>/g,"")}),[r,n,a]}function vM(e,r,s,a,n,o){var c=o||{"!type":"chart"};if(!e)return o;var d=0,h=0,m="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var g=gM(p);f.s.r=f.s.c=0,f.e.c=d,m=hs(d),g[0].forEach(function(N,y){c[m+Ss(y)]={t:"n",v:N,z:g[1]},h=y}),f.e.r<h&&(f.e.r=h),++d}),d>0&&(c["!ref"]=sr(f)),c}function yM(e,r,s,a,n){if(!e)return e;a||(a={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},c,d=e.match(m2);return d&&fx(d[0],o,n,s),(c=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=c[1]),a["!id"][o["!rel"]]&&(o["!drawel"]=a["!id"][o["!rel"]]),o}function NM(e,r){e.l+=10;var s=Is(e);return{name:s}}function wM(e,r,s,a,n){if(!e)return e;a||(a={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},c=!1;return _n(e,function(h,m,f){switch(f){case 550:o["!rel"]=h;break;case 651:n.Sheets[s]||(n.Sheets[s]={}),h.name&&(n.Sheets[s].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(m.T>0)){if(!(m.T<0)){if(!c||r.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},r),a["!id"][o["!rel"]]&&(o["!drawel"]=a["!id"][o["!rel"]]),o}var x2=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],bM=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],jM=[],EM=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function _1(e,r){for(var s=0;s!=e.length;++s)for(var a=e[s],n=0;n!=r.length;++n){var o=r[n];if(a[o[0]]==null)a[o[0]]=o[1];else switch(o[2]){case"bool":typeof a[o[0]]=="string"&&(a[o[0]]=Br(a[o[0]]));break;case"int":typeof a[o[0]]=="string"&&(a[o[0]]=parseInt(a[o[0]],10));break}}}function D1(e,r){for(var s=0;s!=r.length;++s){var a=r[s];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=Br(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function p2(e){D1(e.WBProps,x2),D1(e.CalcPr,EM),_1(e.WBView,bM),_1(e.Sheets,jM),Wl.date1904=Br(e.WBProps.date1904)}var TM="][*?/\\".split("");function SM(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var s=!0;return TM.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),s}var AM=/<\w+:workbook/;function CM(e,r){if(!e)throw new Error("Could not find file");var s={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",o={},c=0;if(e.replace(Bs,function(h,m){var f=Mt(h);switch(ln(f[0])){case"<?xml":break;case"<workbook":h.match(AM)&&(n="xmlns"+h.match(/<(\w+):/)[1]),s.xmlns=f[n];break;case"</workbook>":break;case"<fileVersion":delete f[0],s.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":x2.forEach(function(p){if(f[p[0]]!=null)switch(p[2]){case"bool":s.WBProps[p[0]]=Br(f[p[0]]);break;case"int":s.WBProps[p[0]]=parseInt(f[p[0]],10);break;default:s.WBProps[p[0]]=f[p[0]]}}),f.codeName&&(s.WBProps.CodeName=kr(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],s.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=lr(kr(f.name)),delete f[0],s.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":o={},o.Name=kr(f.name),f.comment&&(o.Comment=f.comment),f.localSheetId&&(o.Sheet=+f.localSheetId),Br(f.hidden||"0")&&(o.Hidden=!0),c=m+h.length;break;case"</definedName>":o.Ref=lr(kr(e.slice(c,m))),s.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete f[0],s.CalcPr=f;break;case"<calcPr/>":delete f[0],s.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&r.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return h}),z_.indexOf(s.xmlns)===-1)throw new Error("Unknown Namespace: "+s.xmlns);return p2(s),s}function kM(e,r){var s={};return s.Hidden=e.read_shift(4),s.iTabID=e.read_shift(4),s.strRelID=tf(e),s.name=Is(e),s}function PM(e,r){var s={},a=e.read_shift(4);s.defaultThemeVersion=e.read_shift(4);var n=r>8?Is(e):"";return n.length>0&&(s.CodeName=n),s.autoCompressPictures=!!(a&65536),s.backupFile=!!(a&64),s.checkCompatibility=!!(a&4096),s.date1904=!!(a&1),s.filterPrivacy=!!(a&8),s.hidePivotFieldList=!!(a&1024),s.promptedSolutions=!!(a&16),s.publishItems=!!(a&2048),s.refreshAllConnections=!!(a&262144),s.saveExternalLinkValues=!!(a&128),s.showBorderUnselectedTables=!!(a&4),s.showInkAnnotation=!!(a&32),s.showObjects=["all","placeholders","none"][a>>13&3],s.showPivotChartFilter=!!(a&32768),s.updateLinks=["userSet","never","always"][a>>8&3],s}function RM(e,r){var s={};return e.read_shift(4),s.ArchID=e.read_shift(4),e.l+=r-8,s}function _M(e,r,s){var a=e.l+r;e.l+=4,e.l+=1;var n=e.read_shift(4),o=dD(e),c=x8(e,0,s),d=lx(e);e.l=a;var h={Name:o,Ptg:c};return n<268435455&&(h.Sheet=n),d&&(h.Comment=d),h}function DM(e,r){var s={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;r||(r={}),r.biff=12;var o=[],c=[[]];return c.SheetNames=[],c.XTI=[],Fu[16]={n:"BrtFRTArchID$",f:RM},_n(e,function(h,m,f){switch(f){case 156:c.SheetNames.push(h.name),s.Sheets.push(h);break;case 153:s.WBProps=h;break;case 39:h.Sheet!=null&&(r.SID=h.Sheet),h.Ref=Ds(h.Ptg,null,null,c,r),delete r.SID,delete h.Ptg,o.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([f,h]):c[0]=[f,h],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(h),c.XTI=c.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(f),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(f),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!m.T){if(!n||r.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},r),p2(s),s.Names=o,s.supbooks=c,s}function OM(e,r,s){return r.slice(-4)===".bin"?DM(e,s):CM(e,s)}function FM(e,r,s,a,n,o,c,d){return r.slice(-4)===".bin"?pM(e,a,s,n,o,c,d):k8(e,a,s,n,o,c,d)}function IM(e,r,s,a,n,o,c,d){return r.slice(-4)===".bin"?wM(e,a,s,n,o):yM(e,a,s,n,o)}function MM(e,r,s,a,n,o,c,d){return r.slice(-4)===".bin"?WI():zI()}function LM(e,r,s,a,n,o,c,d){return r.slice(-4)===".bin"?$I():GI()}function BM(e,r,s,a){return r.slice(-4)===".bin"?iI(e,s,a):eI(e,s,a)}function HM(e,r,s){return r2(e,s)}function VM(e,r,s){return r.slice(-4)===".bin"?bF(e,s):NF(e,s)}function UM(e,r,s){return r.slice(-4)===".bin"?HI(e,s):FI(e,s)}function $M(e,r,s){return r.slice(-4)===".bin"?_I(e):PI(e)}function GM(e,r,s,a){return s.slice(-4)===".bin"?DI(e,r,s,a):void 0}function WM(e,r,s){return r.slice(-4)===".bin"?CI(e,r,s):kI(e,r,s)}var g2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,v2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ma(e,r){var s=e.split(/\s+/),a=[];if(a[0]=s[0],s.length===1)return a;var n=e.match(g2),o,c,d,h;if(n)for(h=0;h!=n.length;++h)o=n[h].match(v2),(c=o[1].indexOf(":"))===-1?a[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?d="xmlns"+o[1].slice(6):d=o[1].slice(c+1),a[d]=o[2].slice(1,o[2].length-1));return a}function zM(e){var r=e.split(/\s+/),s={};if(r.length===1)return s;var a=e.match(g2),n,o,c,d;if(a)for(d=0;d!=a.length;++d)n=a[d].match(v2),(o=n[1].indexOf(":"))===-1?s[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?c="xmlns"+n[1].slice(6):c=n[1].slice(o+1),s[c]=n[2].slice(1,n[2].length-1));return s}var dc;function KM(e,r){var s=dc[e]||lr(e);return s==="General"?Ji(r):Aa(s,r)}function XM(e,r,s,a){var n=a;switch((s[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=Br(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=ys(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+s[0])}e[lr(r)]=n}function qM(e,r,s){if(e.t!=="z"){if(!s||s.cellText!==!1)try{e.t==="e"?e.w=e.w||ol[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=yc(e.v):e.w=Ji(e.v):e.w=KM(r||"General",e.v)}catch(o){if(s.WTF)throw o}try{var a=dc[r]||r||"General";if(s.cellNF&&(e.z=a),s.cellDates&&e.t=="n"&&Zl(a)){var n=$i(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(o){if(s.WTF)throw o}}}function YM(e,r,s){if(s.cellStyles&&r.Interior){var a=r.Interior;a.Pattern&&(a.patternType=XF[a.Pattern]||a.Pattern)}e[r.ID]=r}function JM(e,r,s,a,n,o,c,d,h,m){var f="General",p=a.StyleID,g={};m=m||{};var N=[],y=0;for(p===void 0&&d&&(p=d.StyleID),p===void 0&&c&&(p=c.StyleID);o[p]!==void 0&&(o[p].nf&&(f=o[p].nf),o[p].Interior&&N.push(o[p].Interior),!!o[p].Parent);)p=o[p].Parent;switch(s.Type){case"Boolean":a.t="b",a.v=Br(e);break;case"String":a.t="s",a.r=t1(lr(e)),a.v=e.indexOf("<")>-1?lr(r||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(ys(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=lr(e):a.v<60&&(a.v=a.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=Oj[e],m.cellText!==!1&&(a.w=e);break;default:e==""&&r==""?a.t="z":(a.t="s",a.v=t1(r||e));break}if(qM(a,f,m),m.cellFormula!==!1)if(a.Formula){var w=lr(a.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),a.f=Gl(w,n),delete a.Formula,a.ArrayRange=="RC"?a.F=Gl("RC:RC",n):a.ArrayRange&&(a.F=Gl(a.ArrayRange,n),h.push([qr(a.F),a.F]))}else for(y=0;y<h.length;++y)n.r>=h[y][0].s.r&&n.r<=h[y][0].e.r&&n.c>=h[y][0].s.c&&n.c<=h[y][0].e.c&&(a.F=h[y][1]);m.cellStyles&&(N.forEach(function(b){!g.patternType&&b.patternType&&(g.patternType=b.patternType)}),a.s=g),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function QM(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function vm(e,r){var s=r||{};ij();var a=Wo(rx(e));(s.type=="binary"||s.type=="array"||s.type=="base64")&&(a=kr(a));var n=a.slice(0,1024).toLowerCase(),o=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var c=Ts(s);return c.type="string",bc.to_workbook(a,c)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Nt){n.indexOf("<"+Nt)>=0&&(o=!0)}),o)return lL(a,s);dc={"General Number":"General","General Date":zt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":zt[15],"Short Date":zt[14],"Long Time":zt[19],"Medium Time":zt[18],"Short Time":zt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:zt[2],Standard:zt[4],Percent:zt[10],Scientific:zt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var d,h=[],m,f={},p=[],g=s.dense?[]:{},N="",y={},w={},b=Ma('<Data ss:Type="String">'),C=0,A=0,E=0,R={s:{r:2e6,c:2e6},e:{r:0,c:0}},V={},P={},k="",z=0,W=[],te={},de={},H=0,ue=[],I=[],X={},oe=[],xe,he=!1,F=[],ee=[],M={},_=0,ne=0,ae={Sheets:[],WBProps:{date1904:!1}},G={};wc.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var ie="";d=wc.exec(a);)switch(d[3]=(ie=d[3]).toLowerCase()){case"data":if(ie=="data"){if(d[1]==="/"){if((m=h.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&h.push([d[3],!0]);break}if(h[h.length-1][1])break;d[1]==="/"?JM(a.slice(C,d.index),k,b,h[h.length-1][0]=="comment"?X:y,{c:A,r:E},V,oe[A],w,F,s):(k="",b=Ma(d[0]),C=d.index+d[0].length);break;case"cell":if(d[1]==="/")if(I.length>0&&(y.c=I),(!s.sheetRows||s.sheetRows>E)&&y.v!==void 0&&(s.dense?(g[E]||(g[E]=[]),g[E][A]=y):g[hs(A)+Ss(E)]=y),y.HRef&&(y.l={Target:lr(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(_=A+(parseInt(y.MergeAcross,10)|0),ne=E+(parseInt(y.MergeDown,10)|0),W.push({s:{c:A,r:E},e:{c:_,r:ne}})),!s.sheetStubs)y.MergeAcross?A=_+1:++A;else if(y.MergeAcross||y.MergeDown){for(var Me=A;Me<=_;++Me)for(var Ee=E;Ee<=ne;++Ee)(Me>A||Ee>E)&&(s.dense?(g[Ee]||(g[Ee]=[]),g[Ee][Me]={t:"z"}):g[hs(Me)+Ss(Ee)]={t:"z"});A=_+1}else++A;else y=zM(d[0]),y.Index&&(A=+y.Index-1),A<R.s.c&&(R.s.c=A),A>R.e.c&&(R.e.c=A),d[0].slice(-2)==="/>"&&++A,I=[];break;case"row":d[1]==="/"||d[0].slice(-2)==="/>"?(E<R.s.r&&(R.s.r=E),E>R.e.r&&(R.e.r=E),d[0].slice(-2)==="/>"&&(w=Ma(d[0]),w.Index&&(E=+w.Index-1)),A=0,++E):(w=Ma(d[0]),w.Index&&(E=+w.Index-1),M={},(w.AutoFitHeight=="0"||w.Height)&&(M.hpx=parseInt(w.Height,10),M.hpt=t2(M.hpx),ee[E]=M),w.Hidden=="1"&&(M.hidden=!0,ee[E]=M));break;case"worksheet":if(d[1]==="/"){if((m=h.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"));p.push(N),R.s.r<=R.e.r&&R.s.c<=R.e.c&&(g["!ref"]=sr(R),s.sheetRows&&s.sheetRows<=R.e.r&&(g["!fullref"]=g["!ref"],R.e.r=s.sheetRows-1,g["!ref"]=sr(R))),W.length&&(g["!merges"]=W),oe.length>0&&(g["!cols"]=oe),ee.length>0&&(g["!rows"]=ee),f[N]=g}else R={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=A=0,h.push([d[3],!1]),m=Ma(d[0]),N=lr(m.Name),g=s.dense?[]:{},W=[],F=[],ee=[],G={name:N,Hidden:0},ae.Sheets.push(G);break;case"table":if(d[1]==="/"){if((m=h.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else{if(d[0].slice(-2)=="/>")break;h.push([d[3],!1]),oe=[],he=!1}break;case"style":d[1]==="/"?YM(V,P,s):P=Ma(d[0]);break;case"numberformat":P.nf=lr(Ma(d[0]).Format||"General"),dc[P.nf]&&(P.nf=dc[P.nf]);for(var ye=0;ye!=392&&zt[ye]!=P.nf;++ye);if(ye==392){for(ye=57;ye!=392;++ye)if(zt[ye]==null){Xi(P.nf,ye);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(xe=Ma(d[0]),xe.Hidden&&(xe.hidden=!0,delete xe.Hidden),xe.Width&&(xe.wpx=parseInt(xe.Width,10)),!he&&xe.wpx>10){he=!0,zs=Zj;for(var je=0;je<oe.length;++je)oe[je]&&ql(oe[je])}he&&ql(xe),oe[xe.Index-1||oe.length]=xe;for(var We=0;We<+xe.Span;++We)oe[oe.length]=Ts(xe);break;case"namedrange":if(d[1]==="/")break;ae.Names||(ae.Names=[]);var Y=Mt(d[0]),Dt={Name:Y.Name,Ref:Gl(Y.RefersTo.slice(1),{r:0,c:0})};ae.Sheets.length>0&&(Dt.Sheet=ae.Sheets.length-1),ae.Names.push(Dt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(d[0].slice(-2)==="/>")break;d[1]==="/"?k+=a.slice(z,d.index):z=d.index+d[0].length;break;case"interior":if(!s.cellStyles)break;P.Interior=Ma(d[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(d[0].slice(-2)==="/>")break;d[1]==="/"?FD(te,ie,a.slice(H,d.index)):H=d.index+d[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(d[1]==="/"){if((m=h.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else h.push([d[3],!1]);break;case"comment":if(d[1]==="/"){if((m=h.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"));QM(X),I.push(X)}else h.push([d[3],!1]),m=Ma(d[0]),X={a:m.Author};break;case"autofilter":if(d[1]==="/"){if((m=h.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else if(d[0].charAt(d[0].length-2)!=="/"){var we=Ma(d[0]);g["!autofilter"]={ref:Gl(we.Range).replace(/\$/g,"")},h.push([d[3],!0])}break;case"name":break;case"datavalidation":if(d[1]==="/"){if((m=h.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&h.push([d[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(d[1]==="/"){if((m=h.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&h.push([d[3],!0]);break;case"null":break;default:if(h.length==0&&d[3]=="document"||h.length==0&&d[3]=="uof")return B1(a,s);var ot=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(d[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ot=!1}break;case"componentoptions":switch(d[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ot=!1}break;case"excelworkbook":switch(d[3]){case"date1904":ae.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ot=!1}break;case"workbookoptions":switch(d[3]){case"owcversion":break;case"height":break;case"width":break;default:ot=!1}break;case"worksheetoptions":switch(d[3]){case"visible":if(d[0].slice(-2)!=="/>")if(d[1]==="/")switch(a.slice(H,d.index)){case"SheetHidden":G.Hidden=1;break;case"SheetVeryHidden":G.Hidden=2;break}else H=d.index+d[0].length;break;case"header":g["!margins"]||cc(g["!margins"]={},"xlml"),isNaN(+Mt(d[0]).Margin)||(g["!margins"].header=+Mt(d[0]).Margin);break;case"footer":g["!margins"]||cc(g["!margins"]={},"xlml"),isNaN(+Mt(d[0]).Margin)||(g["!margins"].footer=+Mt(d[0]).Margin);break;case"pagemargins":var Ye=Mt(d[0]);g["!margins"]||cc(g["!margins"]={},"xlml"),isNaN(+Ye.Top)||(g["!margins"].top=+Ye.Top),isNaN(+Ye.Left)||(g["!margins"].left=+Ye.Left),isNaN(+Ye.Right)||(g["!margins"].right=+Ye.Right),isNaN(+Ye.Bottom)||(g["!margins"].bottom=+Ye.Bottom);break;case"displayrighttoleft":ae.Views||(ae.Views=[]),ae.Views[0]||(ae.Views[0]={}),ae.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ot=!1}break;case"pivottable":case"pivotcache":switch(d[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ot=!1}break;case"pagebreaks":switch(d[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ot=!1}break;case"autofilter":switch(d[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ot=!1}break;case"querytable":switch(d[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ot=!1}break;case"datavalidation":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ot=!1}break;case"sorting":case"conditionalformatting":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ot=!1}break;case"mapinfo":case"schema":case"data":switch(d[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ot=!1}break;case"smarttags":break;default:ot=!1;break}if(ot||d[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+d[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(d[0].slice(-2)==="/>")break;d[1]==="/"?XM(de,ie,ue,a.slice(H,d.index)):(ue=d,H=d.index+d[0].length);break}if(s.WTF)throw"Unrecognized tag: "+d[3]+"|"+h.join("|")}var Ue={};return!s.bookSheets&&!s.bookProps&&(Ue.Sheets=f),Ue.SheetNames=p,Ue.Workbook=ae,Ue.SSF=Ts(zt),Ue.Props=te,Ue.Custprops=de,Ue}function nf(e,r){switch(gx(r=r||{}),r.type||"base64"){case"base64":return vm(xa(e),r);case"binary":case"buffer":case"file":return vm(e,r);case"array":return vm(nl(e),r)}}function ZM(e){var r={},s=e.content;if(s.l=28,r.AnsiUserType=s.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=mD(s),s.length-s.l<=4)return r;var a=s.read_shift(4);if(a==0||a>40||(s.l-=4,r.Reserved1=s.read_shift(0,"lpstr-ansi"),s.length-s.l<=4)||(a=s.read_shift(4),a!==1907505652)||(r.UnicodeClipboardFormat=fD(s),a=s.read_shift(4),a==0||a>40))return r;s.l-=4,r.Reserved2=s.read_shift(0,"lpwstr")}var eL=[60,1084,2066,2165,2175];function tL(e,r,s,a,n){var o=a,c=[],d=s.slice(s.l,s.l+o);if(n&&n.enc&&n.enc.insitu&&d.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(d)}c.push(d),s.l+=o;for(var h=bn(s,s.l),m=lf[h],f=0;m!=null&&eL.indexOf(h)>-1;)o=bn(s,s.l+2),f=s.l+4,h==2066?f+=4:(h==2165||h==2175)&&(f+=12),d=s.slice(f,s.l+4+o),c.push(d),s.l+=4+o,m=lf[h=bn(s,s.l)];var p=ii(c);Es(p,0);var g=0;p.lens=[];for(var N=0;N<c.length;++N)p.lens.push(g),g+=c[N].length;if(p.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+a;return r.f(p,p.length,n)}function Qa(e,r,s){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=zt[a])}catch(o){if(r.WTF)throw o}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ol[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=yc(e.v):e.w=Ji(e.v):e.w=Aa(a,e.v,{date1904:!!s,dateNF:r&&r.dateNF})}catch(o){if(r.WTF)throw o}if(r.cellDates&&a&&e.t=="n"&&Zl(zt[a]||String(a))){var n=$i(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function ou(e,r,s){return{v:e,ixfe:r,t:s}}function rL(e,r){var s={opts:{}},a={},n=r.dense?[]:{},o={},c={},d=null,h=[],m="",f={},p,g="",N,y,w,b,C={},A=[],E,R,V=[],P=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},z={},W=function(et){return et<8?qi[et]:et<64&&P[et-8]||qi[et]},te=function(et,Ft,kt){var er=Ft.XF.data;if(!(!er||!er.patternType||!kt||!kt.cellStyles)){Ft.s={},Ft.s.patternType=er.patternType;var B;(B=jc(W(er.icvFore)))&&(Ft.s.fgColor={rgb:B}),(B=jc(W(er.icvBack)))&&(Ft.s.bgColor={rgb:B})}},de=function(et,Ft,kt){if(!(M>1)&&!(kt.sheetRows&&et.r>=kt.sheetRows)){if(kt.cellStyles&&Ft.XF&&Ft.XF.data&&te(et,Ft,kt),delete Ft.ixfe,delete Ft.XF,p=et,g=Gt(et),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),et.r<c.s.r&&(c.s.r=et.r),et.c<c.s.c&&(c.s.c=et.c),et.r+1>c.e.r&&(c.e.r=et.r+1),et.c+1>c.e.c&&(c.e.c=et.c+1),kt.cellFormula&&Ft.f){for(var er=0;er<A.length;++er)if(!(A[er][0].s.c>et.c||A[er][0].s.r>et.r)&&!(A[er][0].e.c<et.c||A[er][0].e.r<et.r)){Ft.F=sr(A[er][0]),(A[er][0].s.c!=et.c||A[er][0].s.r!=et.r)&&delete Ft.f,Ft.f&&(Ft.f=""+Ds(A[er][1],c,et,F,H));break}}kt.dense?(n[et.r]||(n[et.r]=[]),n[et.r][et.c]=Ft):n[g]=Ft}},H={enc:!1,sbcch:0,snames:[],sharedf:C,arrayf:A,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(H.password=r.password);var ue,I=[],X=[],oe=[],xe=[],he=!1,F=[];F.SheetNames=H.snames,F.sharedf=H.sharedf,F.arrayf=H.arrayf,F.names=[],F.XTI=[];var ee=0,M=0,_=0,ne=[],ae=[],G;H.codepage=1200,Ua(1200);for(var ie=!1;e.l<e.length-1;){var Me=e.l,Ee=e.read_shift(2);if(Ee===0&&ee===10)break;var ye=e.l===e.length?0:e.read_shift(2),je=lf[Ee];if(je&&je.f){if(r.bookSheets&&ee===133&&Ee!==133)break;if(ee=Ee,je.r===2||je.r==12){var We=e.read_shift(2);if(ye-=2,!H.enc&&We!==Ee&&((We&255)<<8|We>>8)!==Ee)throw new Error("rt mismatch: "+We+"!="+Ee);je.r==12&&(e.l+=10,ye-=10)}var Y={};if(Ee===10?Y=je.f(e,ye,H):Y=tL(Ee,je,e,ye,H),M==0&&[9,521,1033,2057].indexOf(ee)===-1)continue;switch(Ee){case 34:s.opts.Date1904=k.WBProps.date1904=Y;break;case 134:s.opts.WriteProtect=!0;break;case 47:if(H.enc||(e.l=0),H.enc=Y,!r.password)throw new Error("File is password-protected");if(Y.valid==null)throw new Error("Encryption scheme unsupported");if(!Y.valid)throw new Error("Password is incorrect");break;case 92:H.lastuser=Y;break;case 66:var Dt=Number(Y);switch(Dt){case 21010:Dt=1200;break;case 32768:Dt=1e4;break;case 32769:Dt=1252;break}Ua(H.codepage=Dt),ie=!0;break;case 317:H.rrtabid=Y;break;case 25:H.winlocked=Y;break;case 439:s.opts.RefreshAll=Y;break;case 12:s.opts.CalcCount=Y;break;case 16:s.opts.CalcDelta=Y;break;case 17:s.opts.CalcIter=Y;break;case 13:s.opts.CalcMode=Y;break;case 14:s.opts.CalcPrecision=Y;break;case 95:s.opts.CalcSaveRecalc=Y;break;case 15:H.CalcRefMode=Y;break;case 2211:s.opts.FullCalc=Y;break;case 129:Y.fDialog&&(n["!type"]="dialog"),Y.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),Y.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:V.push(Y);break;case 430:F.push([Y]),F[F.length-1].XTI=[];break;case 35:case 547:F[F.length-1].push(Y);break;case 24:case 536:G={Name:Y.Name,Ref:Ds(Y.rgce,c,null,F,H)},Y.itab>0&&(G.Sheet=Y.itab-1),F.names.push(G),F[0]||(F[0]=[],F[0].XTI=[]),F[F.length-1].push(Y),Y.Name=="_xlnm._FilterDatabase"&&Y.itab>0&&Y.rgce&&Y.rgce[0]&&Y.rgce[0][0]&&Y.rgce[0][0][0]=="PtgArea3d"&&(ae[Y.itab-1]={ref:sr(Y.rgce[0][0][1][2])});break;case 22:H.ExternCount=Y;break;case 23:F.length==0&&(F[0]=[],F[0].XTI=[]),F[F.length-1].XTI=F[F.length-1].XTI.concat(Y),F.XTI=F.XTI.concat(Y);break;case 2196:if(H.biff<8)break;G!=null&&(G.Comment=Y[1]);break;case 18:n["!protect"]=Y;break;case 19:Y!==0&&H.WTF&&console.error("Password verifier: "+Y);break;case 133:o[Y.pos]=Y,H.snames.push(Y.name);break;case 10:{if(--M)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,n["!ref"]=sr(c),r.sheetRows&&r.sheetRows<=c.e.r){var we=c.e.r;c.e.r=r.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=sr(c),c.e.r=we}c.e.r++,c.e.c++}I.length>0&&(n["!merges"]=I),X.length>0&&(n["!objects"]=X),oe.length>0&&(n["!cols"]=oe),xe.length>0&&(n["!rows"]=xe),k.Sheets.push(z)}m===""?f=n:a[m]=n,n=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(H.biff===8&&(H.biff={9:2,521:3,1033:4}[Ee]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Y.BIFFVer]||8),H.biffguess=Y.BIFFVer==0,Y.BIFFVer==0&&Y.dt==4096&&(H.biff=5,ie=!0,Ua(H.codepage=28591)),H.biff==8&&Y.BIFFVer==0&&Y.dt==16&&(H.biff=2),M++)break;if(n=r.dense?[]:{},H.biff<8&&!ie&&(ie=!0,Ua(H.codepage=r.codepage||1252)),H.biff<5||Y.BIFFVer==0&&Y.dt==4096){m===""&&(m="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var ot={pos:e.l-ye,name:m};o[ot.pos]=ot,H.snames.push(m)}else m=(o[Me]||{name:""}).name;Y.dt==32&&(n["!type"]="chart"),Y.dt==64&&(n["!type"]="macro"),I=[],X=[],H.arrayf=A=[],oe=[],xe=[],he=!1,z={Hidden:(o[Me]||{hs:0}).hs,name:m}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(r.dense?(n[Y.r]||[])[Y.c]:n[Gt({c:Y.c,r:Y.r})])&&++Y.c,E={ixfe:Y.ixfe,XF:V[Y.ixfe]||{},v:Y.val,t:"n"},_>0&&(E.z=ne[E.ixfe>>8&63]),Qa(E,r,s.opts.Date1904),de({c:Y.c,r:Y.r},E,r);break;case 5:case 517:E={ixfe:Y.ixfe,XF:V[Y.ixfe],v:Y.val,t:Y.t},_>0&&(E.z=ne[E.ixfe>>8&63]),Qa(E,r,s.opts.Date1904),de({c:Y.c,r:Y.r},E,r);break;case 638:E={ixfe:Y.ixfe,XF:V[Y.ixfe],v:Y.rknum,t:"n"},_>0&&(E.z=ne[E.ixfe>>8&63]),Qa(E,r,s.opts.Date1904),de({c:Y.c,r:Y.r},E,r);break;case 189:for(var Ye=Y.c;Ye<=Y.C;++Ye){var Ue=Y.rkrec[Ye-Y.c][0];E={ixfe:Ue,XF:V[Ue],v:Y.rkrec[Ye-Y.c][1],t:"n"},_>0&&(E.z=ne[E.ixfe>>8&63]),Qa(E,r,s.opts.Date1904),de({c:Ye,r:Y.r},E,r)}break;case 6:case 518:case 1030:{if(Y.val=="String"){d=Y;break}if(E=ou(Y.val,Y.cell.ixfe,Y.tt),E.XF=V[E.ixfe],r.cellFormula){var Nt=Y.formula;if(Nt&&Nt[0]&&Nt[0][0]&&Nt[0][0][0]=="PtgExp"){var qe=Nt[0][0][1][0],Bt=Nt[0][0][1][1],jt=Gt({r:qe,c:Bt});C[jt]?E.f=""+Ds(Y.formula,c,Y.cell,F,H):E.F=((r.dense?(n[qe]||[])[Bt]:n[jt])||{}).F}else E.f=""+Ds(Y.formula,c,Y.cell,F,H)}_>0&&(E.z=ne[E.ixfe>>8&63]),Qa(E,r,s.opts.Date1904),de(Y.cell,E,r),d=Y}break;case 7:case 519:if(d)d.val=Y,E=ou(Y,d.cell.ixfe,"s"),E.XF=V[E.ixfe],r.cellFormula&&(E.f=""+Ds(d.formula,c,d.cell,F,H)),_>0&&(E.z=ne[E.ixfe>>8&63]),Qa(E,r,s.opts.Date1904),de(d.cell,E,r),d=null;else throw new Error("String record expects Formula");break;case 33:case 545:{A.push(Y);var Ze=Gt(Y[0].s);if(N=r.dense?(n[Y[0].s.r]||[])[Y[0].s.c]:n[Ze],r.cellFormula&&N){if(!d||!Ze||!N)break;N.f=""+Ds(Y[1],c,Y[0],F,H),N.F=sr(Y[0])}}break;case 1212:{if(!r.cellFormula)break;if(g){if(!d)break;C[Gt(d.cell)]=Y[0],N=r.dense?(n[d.cell.r]||[])[d.cell.c]:n[Gt(d.cell)],(N||{}).f=""+Ds(Y[0],c,p,F,H)}}break;case 253:E=ou(h[Y.isst].t,Y.ixfe,"s"),h[Y.isst].h&&(E.h=h[Y.isst].h),E.XF=V[E.ixfe],_>0&&(E.z=ne[E.ixfe>>8&63]),Qa(E,r,s.opts.Date1904),de({c:Y.c,r:Y.r},E,r);break;case 513:r.sheetStubs&&(E={ixfe:Y.ixfe,XF:V[Y.ixfe],t:"z"},_>0&&(E.z=ne[E.ixfe>>8&63]),Qa(E,r,s.opts.Date1904),de({c:Y.c,r:Y.r},E,r));break;case 190:if(r.sheetStubs)for(var Xt=Y.c;Xt<=Y.C;++Xt){var ze=Y.ixfe[Xt-Y.c];E={ixfe:ze,XF:V[ze],t:"z"},_>0&&(E.z=ne[E.ixfe>>8&63]),Qa(E,r,s.opts.Date1904),de({c:Xt,r:Y.r},E,r)}break;case 214:case 516:case 4:E=ou(Y.val,Y.ixfe,"s"),E.XF=V[E.ixfe],_>0&&(E.z=ne[E.ixfe>>8&63]),Qa(E,r,s.opts.Date1904),de({c:Y.c,r:Y.r},E,r);break;case 0:case 512:M===1&&(c=Y);break;case 252:h=Y;break;case 1054:if(H.biff==4){ne[_++]=Y[1];for(var ht=0;ht<_+163&&zt[ht]!=Y[1];++ht);ht>=163&&Xi(Y[1],_+163)}else Xi(Y[1],Y[0]);break;case 30:{ne[_++]=Y;for(var nt=0;nt<_+163&&zt[nt]!=Y;++nt);nt>=163&&Xi(Y,_+163)}break;case 229:I=I.concat(Y);break;case 93:X[Y.cmo[0]]=H.lastobj=Y;break;case 438:H.lastobj.TxO=Y;break;case 127:H.lastobj.ImData=Y;break;case 440:for(b=Y[0].s.r;b<=Y[0].e.r;++b)for(w=Y[0].s.c;w<=Y[0].e.c;++w)N=r.dense?(n[b]||[])[w]:n[Gt({c:w,r:b})],N&&(N.l=Y[1]);break;case 2048:for(b=Y[0].s.r;b<=Y[0].e.r;++b)for(w=Y[0].s.c;w<=Y[0].e.c;++w)N=r.dense?(n[b]||[])[w]:n[Gt({c:w,r:b})],N&&N.l&&(N.l.Tooltip=Y[1]);break;case 28:{if(H.biff<=5&&H.biff>=2)break;N=r.dense?(n[Y[0].r]||[])[Y[0].c]:n[Gt(Y[0])];var Ot=X[Y[2]];N||(r.dense?(n[Y[0].r]||(n[Y[0].r]=[]),N=n[Y[0].r][Y[0].c]={t:"z"}):N=n[Gt(Y[0])]={t:"z"},c.e.r=Math.max(c.e.r,Y[0].r),c.s.r=Math.min(c.s.r,Y[0].r),c.e.c=Math.max(c.e.c,Y[0].c),c.s.c=Math.min(c.s.c,Y[0].c)),N.c||(N.c=[]),y={a:Y[1],t:Ot.TxO.t},N.c.push(y)}break;case 2173:EI(V[Y.ixfe],Y.ext);break;case 125:{if(!H.cellStyles)break;for(;Y.e>=Y.s;)oe[Y.e--]={width:Y.w/256,level:Y.level||0,hidden:!!(Y.flags&1)},he||(he=!0,hx(Y.w/256)),ql(oe[Y.e+1])}break;case 520:{var lt={};Y.level!=null&&(xe[Y.r]=lt,lt.level=Y.level),Y.hidden&&(xe[Y.r]=lt,lt.hidden=!0),Y.hpt&&(xe[Y.r]=lt,lt.hpt=Y.hpt,lt.hpx=Ec(Y.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||cc(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ee]]=Y;break;case 161:n["!margins"]||cc(n["!margins"]={}),n["!margins"].header=Y.header,n["!margins"].footer=Y.footer;break;case 574:Y.RTL&&(k.Views[0].RTL=!0);break;case 146:P=Y;break;case 2198:ue=Y;break;case 140:R=Y;break;case 442:m?z.CodeName=Y||z.name:k.WBProps.CodeName=Y||"ThisWorkbook";break}}else je||console.error("Missing Info for XLS Record 0x"+Ee.toString(16)),e.l+=ye}return s.SheetNames=nn(o).sort(function(Jt,et){return Number(Jt)-Number(et)}).map(function(Jt){return o[Jt].name}),r.bookSheets||(s.Sheets=a),!s.SheetNames.length&&f["!ref"]?(s.SheetNames.push("Sheet1"),s.Sheets&&(s.Sheets.Sheet1=f)):s.Preamble=f,s.Sheets&&ae.forEach(function(Jt,et){s.Sheets[s.SheetNames[et]]["!autofilter"]=Jt}),s.Strings=h,s.SSF=Ts(zt),H.enc&&(s.Encryption=H.enc),ue&&(s.Themes=ue),s.Metadata={},R!==void 0&&(s.Metadata.Country=R),F.names.length>0&&(k.Names=F.names),s.Workbook=k,s}var O1={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function sL(e,r,s){var a=rr.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=g1(a,ND,O1.DSI);for(var o in n)r[o]=n[o]}catch(m){if(s.WTF)throw m}var c=rr.find(e,"/!SummaryInformation");if(c&&c.size>0)try{var d=g1(c,wD,O1.SI);for(var h in d)r[h]==null&&(r[h]=d[h])}catch(m){if(s.WTF)throw m}r.HeadingPairs&&r.TitlesOfParts&&(Ij(r.HeadingPairs,r.TitlesOfParts,r,s),delete r.HeadingPairs,delete r.TitlesOfParts)}function y2(e,r){r||(r={}),gx(r),Xb(),r.codepage&&qf(r.codepage);var s,a;if(e.FullPaths){if(rr.find(e,"/encryption"))throw new Error("File is password-protected");s=rr.find(e,"!CompObj"),a=rr.find(e,"/Workbook")||rr.find(e,"/Book")}else{switch(r.type){case"base64":e=Ha(xa(e));break;case"binary":e=Ha(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Es(e,0),a={content:e}}var n,o;if(s&&ZM(s),r.bookProps&&!r.bookSheets)n={};else{var c=tr?"buffer":"array";if(a&&a.content)n=rL(a.content,r);else if((o=rr.find(e,"PerfectOffice_MAIN"))&&o.content)n=lc.to_workbook(o.content,(r.type=c,r));else if((o=rr.find(e,"NativeContent_MAIN"))&&o.content)n=lc.to_workbook(o.content,(r.type=c,r));else throw(o=rr.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&rr.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=UI(e))}var d={};return e.FullPaths&&sL(e,d,r),n.Props=n.Custprops=d,r.bookFiles&&(n.cfb=e),n}var Fu={0:{f:L8},1:{f:U8},2:{f:J8},3:{f:z8},4:{f:G8},5:{f:Y8},6:{f:eM},7:{f:X8},8:{f:nM},9:{f:aM},10:{f:rM},11:{f:sM},12:{f:$8},13:{f:Q8},14:{f:K8},15:{f:W8},16:{f:f2},17:{f:tM},18:{f:q8},19:{f:ix},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:_M},40:{},42:{},43:{f:rI},44:{f:tI},45:{f:sI},46:{f:nI},47:{f:aI},48:{},49:{f:iD},50:{},51:{f:SI},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Xj},62:{f:Z8},63:{f:RI},64:{f:fM},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ms,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:mM},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:V8},148:{f:B8,p:16},151:{f:oM},152:{},153:{f:PM},154:{},155:{},156:{f:kM},157:{},158:{},159:{T:1,f:wF},160:{T:-1},161:{T:1,f:ll},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:iM},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:TI},336:{T:-1},337:{f:AI,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:tf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Kj},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:cM},427:{f:dM},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:hM},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:H8},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:lM},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:tf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:BI},633:{T:1},634:{T:-1},635:{T:1,f:LI},636:{T:-1},637:{f:oD},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:NM},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:xM},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},lf={6:{f:pm},10:{f:ei},12:{f:ns},13:{f:ns},14:{f:Qr},15:{f:Qr},16:{f:Os},17:{f:Qr},18:{f:Qr},19:{f:ns},20:{f:w1},21:{f:w1},23:{f:Kj},24:{f:j1},25:{f:Qr},26:{},27:{},28:{f:IO},29:{},34:{f:Qr},35:{f:b1},38:{f:Os},39:{f:Os},40:{f:Os},41:{f:Os},42:{f:Qr},43:{f:Qr},47:{f:HF},49:{f:gO},51:{f:ns},60:{},61:{f:fO},64:{f:Qr},65:{f:pO},66:{f:ns},77:{},80:{},81:{},82:{},85:{f:ns},89:{},90:{},91:{},92:{f:iO},93:{f:LO},94:{},95:{f:Qr},96:{},97:{},99:{f:Qr},125:{f:Xj},128:{f:AO},129:{f:lO},130:{f:ns},131:{f:Qr},132:{f:Qr},133:{f:oO},134:{},140:{f:GO},141:{f:ns},144:{},146:{f:zO},151:{},152:{},153:{},154:{},155:{},156:{f:ns},157:{},158:{},160:{f:JO},161:{f:XO},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:jO},190:{f:EO},193:{f:ei},197:{},198:{},199:{},200:{},201:{},202:{f:Qr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ns},220:{},221:{f:Qr},222:{},224:{f:SO},225:{f:nO},226:{f:ei},227:{},229:{f:MO},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:cO},253:{f:vO},255:{f:dO},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Vj},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Qr},353:{f:ei},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:kO},431:{f:Qr},432:{},433:{},434:{},437:{},438:{f:VO},439:{f:Qr},440:{f:UO},441:{},442:{f:Lc},443:{},444:{f:ns},445:{},446:{},448:{f:ei},449:{f:mO,r:2},450:{f:ei},512:{f:y1},513:{f:YO},515:{f:CO},516:{f:yO},517:{f:N1},519:{f:QO},520:{f:uO},523:{},545:{f:E1},549:{f:v1},566:{},574:{f:xO},638:{f:bO},659:{},1048:{},1054:{f:NO},1084:{},1212:{f:DO},2048:{f:$O},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:nu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ei},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:KO,r:12},2173:{f:jI,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Qr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:_O,r:12},2197:{},2198:{f:gI,r:12},2199:{},2200:{},2201:{},2202:{f:OO,r:12},2203:{f:ei},2204:{},2205:{},2206:{},2207:{},2211:{f:hO},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ns},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:qO},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:WO},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:y1},1:{},2:{f:rF},3:{f:tF},4:{f:eF},5:{f:N1},7:{f:sF},8:{},9:{f:nu},11:{},22:{f:ns},30:{f:wO},31:{},32:{},33:{f:E1},36:{},37:{f:v1},50:{f:aF},62:{},52:{},67:{},68:{f:ns},69:{},86:{},126:{},127:{f:ZO},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:nF},223:{},234:{},354:{},421:{},518:{f:pm},521:{f:nu},536:{f:j1},547:{f:b1},561:{},579:{},1030:{f:pm},1033:{f:nu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function La(e,r,s,a){var n=r;if(!isNaN(n)){var o=(s||[]).length||0,c=e.next(4);c.write_shift(2,n),c.write_shift(2,o),o>0&&Cj(s)&&e.push(s)}}function F1(e,r){var s=r||{},a=s.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),c=n.index,d=o&&o.index||e.length,h=C_(e.slice(c,d),/(:?<tr[^>]*>)/i,"<tr>"),m=-1,f=0,p=0,g=0,N={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(c=0;c<h.length;++c){var w=h[c].trim(),b=w.slice(0,3).toLowerCase();if(b=="<tr"){if(++m,s.sheetRows&&s.sheetRows<=m){--m;break}f=0;continue}if(!(b!="<td"&&b!="<th")){var C=w.split(/<\/t[dh]>/i);for(d=0;d<C.length;++d){var A=C[d].trim();if(A.match(/<t[dh]/i)){for(var E=A,R=0;E.charAt(0)=="<"&&(R=E.indexOf(">"))>-1;)E=E.slice(R+1);for(var V=0;V<y.length;++V){var P=y[V];P.s.c==f&&P.s.r<m&&m<=P.e.r&&(f=P.e.c+1,V=-1)}var k=Mt(A.slice(0,A.indexOf(">")));g=k.colspan?+k.colspan:1,((p=+k.rowspan)>1||g>1)&&y.push({s:{r:m,c:f},e:{r:m+(p||1)-1,c:f+g-1}});var z=k.t||k["data-t"]||"";if(!E.length){f+=g;continue}if(E=xj(E),N.s.r>m&&(N.s.r=m),N.e.r<m&&(N.e.r=m),N.s.c>f&&(N.s.c=f),N.e.c<f&&(N.e.c=f),!E.length){f+=g;continue}var W={t:"s",v:E};s.raw||!E.trim().length||z=="s"||(E==="TRUE"?W={t:"b",v:!0}:E==="FALSE"?W={t:"b",v:!1}:isNaN(Wa(E))?isNaN(Xl(E).getDate())||(W={t:"d",v:ys(E)},s.cellDates||(W={t:"n",v:Js(W.v)}),W.z=s.dateNF||zt[14]):W={t:"n",v:Wa(E)}),s.dense?(a[m]||(a[m]=[]),a[m][f]=W):a[Gt({r:m,c:f})]=W,f+=g}}}}return a["!ref"]=sr(N),y.length&&(a["!merges"]=y),a}function aL(e,r,s,a){for(var n=e["!merges"]||[],o=[],c=r.s.c;c<=r.e.c;++c){for(var d=0,h=0,m=0;m<n.length;++m)if(!(n[m].s.r>s||n[m].s.c>c)&&!(n[m].e.r<s||n[m].e.c<c)){if(n[m].s.r<s||n[m].s.c<c){d=-1;break}d=n[m].e.r-n[m].s.r+1,h=n[m].e.c-n[m].s.c+1;break}if(!(d<0)){var f=Gt({r:s,c}),p=a.dense?(e[s]||[])[c]:e[f],g=p&&p.v!=null&&(p.h||tx(p.w||(Pn(p),p.w)||""))||"",N={};d>1&&(N.rowspan=d),h>1&&(N.colspan=h),a.editable?g='<span contenteditable="true">'+g+"</span>":p&&(N["data-t"]=p&&p.t||"z",p.v!=null&&(N["data-v"]=p.v),p.z!=null&&(N["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+p.l.Target+'">'+g+"</a>")),N.id=(a.id||"sjs")+"-"+f,o.push(G_("td",g,N))}}var y="<tr>";return y+o.join("")+"</tr>"}var nL='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',iL="</body></html>";function lL(e,r){var s=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!s||s.length==0)throw new Error("Invalid HTML: could not find <table>");if(s.length==1)return bi(F1(s[0],r),r);var a=yx();return s.forEach(function(n,o){Nx(a,F1(n,r),"Sheet"+(o+1))}),a}function oL(e,r,s){var a=[];return a.join("")+"<table"+(s&&s.id?' id="'+s.id+'"':"")+">"}function cL(e,r){var s=r||{},a=s.header!=null?s.header:nL,n=s.footer!=null?s.footer:iL,o=[a],c=eo(e["!ref"]);s.dense=Array.isArray(e),o.push(oL(e,c,s));for(var d=c.s.r;d<=c.e.r;++d)o.push(aL(e,c,d,s));return o.push("</table>"+n),o.join("")}function N2(e,r,s){var a=s||{},n=0,o=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var c=typeof a.origin=="string"?Xs(a.origin):a.origin;n=c.r,o=c.c}var d=r.getElementsByTagName("tr"),h=Math.min(a.sheetRows||1e7,d.length),m={s:{r:0,c:0},e:{r:n,c:o}};if(e["!ref"]){var f=eo(e["!ref"]);m.s.r=Math.min(m.s.r,f.s.r),m.s.c=Math.min(m.s.c,f.s.c),m.e.r=Math.max(m.e.r,f.e.r),m.e.c=Math.max(m.e.c,f.e.c),n==-1&&(m.e.r=n=f.e.r+1)}var p=[],g=0,N=e["!rows"]||(e["!rows"]=[]),y=0,w=0,b=0,C=0,A=0,E=0;for(e["!cols"]||(e["!cols"]=[]);y<d.length&&w<h;++y){var R=d[y];if(I1(R)){if(a.display)continue;N[w]={hidden:!0}}var V=R.children;for(b=C=0;b<V.length;++b){var P=V[b];if(!(a.display&&I1(P))){var k=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):xj(P.innerHTML),z=P.getAttribute("data-z")||P.getAttribute("z");for(g=0;g<p.length;++g){var W=p[g];W.s.c==C+o&&W.s.r<w+n&&w+n<=W.e.r&&(C=W.e.c+1-o,g=-1)}E=+P.getAttribute("colspan")||1,((A=+P.getAttribute("rowspan")||1)>1||E>1)&&p.push({s:{r:w+n,c:C+o},e:{r:w+n+(A||1)-1,c:C+o+(E||1)-1}});var te={t:"s",v:k},de=P.getAttribute("data-t")||P.getAttribute("t")||"";k!=null&&(k.length==0?te.t=de||"z":a.raw||k.trim().length==0||de=="s"||(k==="TRUE"?te={t:"b",v:!0}:k==="FALSE"?te={t:"b",v:!1}:isNaN(Wa(k))?isNaN(Xl(k).getDate())||(te={t:"d",v:ys(k)},a.cellDates||(te={t:"n",v:Js(te.v)}),te.z=a.dateNF||zt[14]):te={t:"n",v:Wa(k)})),te.z===void 0&&z!=null&&(te.z=z);var H="",ue=P.getElementsByTagName("A");if(ue&&ue.length)for(var I=0;I<ue.length&&!(ue[I].hasAttribute("href")&&(H=ue[I].getAttribute("href"),H.charAt(0)!="#"));++I);H&&H.charAt(0)!="#"&&(te.l={Target:H}),a.dense?(e[w+n]||(e[w+n]=[]),e[w+n][C+o]=te):e[Gt({c:C+o,r:w+n})]=te,m.e.c<C+o&&(m.e.c=C+o),C+=E}}++w}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),m.e.r=Math.max(m.e.r,w-1+n),e["!ref"]=sr(m),w>=h&&(e["!fullref"]=sr((m.e.r=d.length-y+w-1+n,m))),e}function w2(e,r){var s=r||{},a=s.dense?[]:{};return N2(a,e,r)}function dL(e,r){return bi(w2(e,r),r)}function I1(e){var r="",s=uL(e);return s&&(r=s(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function uL(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function hL(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),s=lr(r.replace(/<[^>]*>/g,""));return[s]}var M1={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function b2(e,r){var s=r||{},a=rx(e),n=[],o,c,d={name:""},h="",m=0,f,p,g={},N=[],y=s.dense?[]:{},w,b,C={value:""},A="",E=0,R=[],V=-1,P=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},z=0,W={},te=[],de={},H=0,ue=0,I=[],X=1,oe=1,xe=[],he={Names:[]},F={},ee=["",""],M=[],_={},ne="",ae=0,G=!1,ie=!1,Me=0;for(wc.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=wc.exec(a);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"":w[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?y["!ref"]=sr(k):y["!ref"]="A1:A1",s.sheetRows>0&&s.sheetRows<=k.e.r&&(y["!fullref"]=y["!ref"],k.e.r=s.sheetRows-1,y["!ref"]=sr(k)),te.length&&(y["!merges"]=te),I.length&&(y["!rows"]=I),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),N.push(f.name),g[f.name]=y,ie=!1):w[0].charAt(w[0].length-2)!=="/"&&(f=Mt(w[0],!1),V=P=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,y=s.dense?[]:{},te=[],I=[],ie=!0);break;case"table-row-group":w[1]==="/"?--z:++z;break;case"table-row":case"":if(w[1]==="/"){V+=X,X=1;break}if(p=Mt(w[0],!1),p.?V=p.-1:V==-1&&(V=0),X=+p["number-rows-repeated"]||1,X<10)for(Me=0;Me<X;++Me)z>0&&(I[V+Me]={level:z});P=-1;break;case"covered-table-cell":w[1]!=="/"&&++P,s.sheetStubs&&(s.dense?(y[V]||(y[V]=[]),y[V][P]={t:"z"}):y[Gt({r:V,c:P})]={t:"z"}),A="",R=[];break;case"table-cell":case"":if(w[0].charAt(w[0].length-2)==="/")++P,C=Mt(w[0],!1),oe=parseInt(C["number-columns-repeated"]||"1",10),b={t:"z",v:null},C.formula&&s.cellFormula!=!1&&(b.f=R1(lr(C.formula))),(C.||C["value-type"])=="string"&&(b.t="s",b.v=lr(C["string-value"]||""),s.dense?(y[V]||(y[V]=[]),y[V][P]=b):y[Gt({r:V,c:P})]=b),P+=oe-1;else if(w[1]!=="/"){++P,A="",E=0,R=[],oe=1;var Ee=X?V+X-1:V;if(P>k.e.c&&(k.e.c=P),P<k.s.c&&(k.s.c=P),V<k.s.r&&(k.s.r=V),Ee>k.e.r&&(k.e.r=Ee),C=Mt(w[0],!1),M=[],_={},b={t:C.||C["value-type"],v:null},s.cellFormula)if(C.formula&&(C.formula=lr(C.formula)),C["number-matrix-columns-spanned"]&&C["number-matrix-rows-spanned"]&&(H=parseInt(C["number-matrix-rows-spanned"],10)||0,ue=parseInt(C["number-matrix-columns-spanned"],10)||0,de={s:{r:V,c:P},e:{r:V+H-1,c:P+ue-1}},b.F=sr(de),xe.push([de,b.F])),C.formula)b.f=R1(C.formula);else for(Me=0;Me<xe.length;++Me)V>=xe[Me][0].s.r&&V<=xe[Me][0].e.r&&P>=xe[Me][0].s.c&&P<=xe[Me][0].e.c&&(b.F=xe[Me][1]);switch((C["number-columns-spanned"]||C["number-rows-spanned"])&&(H=parseInt(C["number-rows-spanned"],10)||0,ue=parseInt(C["number-columns-spanned"],10)||0,de={s:{r:V,c:P},e:{r:V+H-1,c:P+ue-1}},te.push(de)),C["number-columns-repeated"]&&(oe=parseInt(C["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=Br(C["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(C.value);break;case"percentage":b.t="n",b.v=parseFloat(C.value);break;case"currency":b.t="n",b.v=parseFloat(C.value);break;case"date":b.t="d",b.v=ys(C["date-value"]),s.cellDates||(b.t="n",b.v=Js(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=T_(C["time-value"])/86400,s.cellDates&&(b.t="d",b.v=Ju(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(C.);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",C["string-value"]!=null&&(A=lr(C["string-value"]),R=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(G=!1,b.t==="s"&&(b.v=A||"",R.length&&(b.R=R),G=E==0),F.Target&&(b.l=F),M.length>0&&(b.c=M,M=[]),A&&s.cellText!==!1&&(b.w=A),G&&(b.t="z",delete b.v),(!G||s.sheetStubs)&&!(s.sheetRows&&s.sheetRows<=V))for(var ye=0;ye<X;++ye){if(oe=parseInt(C["number-columns-repeated"]||"1",10),s.dense)for(y[V+ye]||(y[V+ye]=[]),y[V+ye][P]=ye==0?b:Ts(b);--oe>0;)y[V+ye][P+oe]=Ts(b);else for(y[Gt({r:V+ye,c:P})]=b;--oe>0;)y[Gt({r:V+ye,c:P+oe})]=Ts(b);k.e.c<=P&&(k.e.c=P)}oe=parseInt(C["number-columns-repeated"]||"1",10),P+=oe-1,oe=0,b={},A="",R=[]}F={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((o=n.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&n.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((o=n.pop())[0]!==w[3])throw"Bad state: "+o;_.t=A,R.length&&(_.R=R),_.a=ne,M.push(_)}else w[0].charAt(w[0].length-2)!=="/"&&n.push([w[3],!1]);ne="",ae=0,A="",E=0,R=[];break;case"creator":w[1]==="/"?ne=a.slice(ae,w.index):ae=w.index+w[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((o=n.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&n.push([w[3],!1]);A="",E=0,R=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(W[d.name]=h,(o=n.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&(h="",d=Mt(w[0],!1),n.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":c=Mt(w[0],!1),h+=M1[w[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":c=Mt(w[0],!1),h+=M1[w[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":h+=a.slice(m,w.index);break}else m=w.index+w[0].length;break;case"named-range":c=Mt(w[0],!1),ee=gm(c["cell-range-address"]);var je={Name:c.name,Ref:ee[0]+"!"+ee[1]};ie&&(je.Sheet=N.length),he.Names.push(je);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(w[1]==="/"&&(!C||!C["string-value"])){var We=hL(a.slice(E,w.index));A=(A.length>0?A+`
`:"")+We[0]}else Mt(w[0],!1),E=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{ee=gm(Mt(w[0])["target-range-address"]),g[ee[0]]["!autofilter"]={ref:ee[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(F=Mt(w[0],!1),!F.href)break;F.Target=lr(F.href),delete F.href,F.Target.charAt(0)=="#"&&F.Target.indexOf(".")>-1?(ee=gm(F.Target.slice(1)),F.Target="#"+ee[0]+"!"+ee[1]):F.Target.match(/^\.\.[\\\/]/)&&(F.Target=F.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(s.WTF)throw new Error(w)}}var Y={Sheets:g,SheetNames:N,Workbook:he};return s.bookSheets&&delete Y.Sheets,Y}function L1(e,r){r=r||{},Sa(e,"META-INF/manifest.xml")&&CD(as(e,"META-INF/manifest.xml"),r);var s=ha(e,"content.xml");if(!s)throw new Error("Missing content.xml in ODS / UOF file");var a=b2(kr(s),r);return Sa(e,"meta.xml")&&(a.Props=Fj(as(e,"meta.xml"))),a}function B1(e,r){return b2(e,r)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function xx(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function of(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):kr(nl(e))}function cf(e){var r=e.reduce(function(n,o){return n+o.length},0),s=new Uint8Array(r),a=0;return e.forEach(function(n){s.set(n,a),a+=n.length}),s}function H1(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function mL(e,r){for(var s=(e[r+15]&127)<<7|e[r+14]>>1,a=e[r+14]&1,n=r+13;n>=r;--n)a=a*256+e[n];return(e[r+15]&128?-a:a)*Math.pow(10,s-6176)}function Tc(e,r){var s=r?r[0]:0,a=e[s]&127;e:if(e[s++]>=128&&(a|=(e[s]&127)<<7,e[s++]<128||(a|=(e[s]&127)<<14,e[s++]<128)||(a|=(e[s]&127)<<21,e[s++]<128)||(a+=(e[s]&127)*Math.pow(2,28),++s,e[s++]<128)||(a+=(e[s]&127)*Math.pow(2,35),++s,e[s++]<128)||(a+=(e[s]&127)*Math.pow(2,42),++s,e[s++]<128)))break e;return r&&(r[0]=s),a}function ms(e){var r=0,s=e[r]&127;e:if(e[r++]>=128){if(s|=(e[r]&127)<<7,e[r++]<128||(s|=(e[r]&127)<<14,e[r++]<128)||(s|=(e[r]&127)<<21,e[r++]<128))break e;s|=(e[r]&127)<<28}return s}function Fs(e){for(var r=[],s=[0];s[0]<e.length;){var a=s[0],n=Tc(e,s),o=n&7;n=Math.floor(n/8);var c=0,d;if(n==0)break;switch(o){case 0:{for(var h=s[0];e[s[0]++]>=128;);d=e.slice(h,s[0])}break;case 5:c=4,d=e.slice(s[0],s[0]+c),s[0]+=c;break;case 1:c=8,d=e.slice(s[0],s[0]+c),s[0]+=c;break;case 2:c=Tc(e,s),d=e.slice(s[0],s[0]+c),s[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(n," at offset ").concat(a))}var m={data:d,type:o};r[n]==null?r[n]=[m]:r[n].push(m)}return r}function px(e,r){return e?.map(function(s){return r(s.data)})||[]}function fL(e){for(var r,s=[],a=[0];a[0]<e.length;){var n=Tc(e,a),o=Fs(e.slice(a[0],a[0]+n));a[0]+=n;var c={id:ms(o[1][0].data),messages:[]};o[2].forEach(function(d){var h=Fs(d.data),m=ms(h[3][0].data);c.messages.push({meta:h,data:e.slice(a[0],a[0]+m)}),a[0]+=m}),(r=o[3])!=null&&r[0]&&(c.merge=ms(o[3][0].data)>>>0>0),s.push(c)}return s}function xL(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var s=[0],a=Tc(r,s),n=[];s[0]<r.length;){var o=r[s[0]]&3;if(o==0){var c=r[s[0]++]>>2;if(c<60)++c;else{var d=c-59;c=r[s[0]],d>1&&(c|=r[s[0]+1]<<8),d>2&&(c|=r[s[0]+2]<<16),d>3&&(c|=r[s[0]+3]<<24),c>>>=0,c++,s[0]+=d}n.push(r.slice(s[0],s[0]+c)),s[0]+=c;continue}else{var h=0,m=0;if(o==1?(m=(r[s[0]]>>2&7)+4,h=(r[s[0]++]&224)<<3,h|=r[s[0]++]):(m=(r[s[0]++]>>2)+1,o==2?(h=r[s[0]]|r[s[0]+1]<<8,s[0]+=2):(h=(r[s[0]]|r[s[0]+1]<<8|r[s[0]+2]<<16|r[s[0]+3]<<24)>>>0,s[0]+=4)),n=[cf(n)],h==0)throw new Error("Invalid offset 0");if(h>n[0].length)throw new Error("Invalid offset beyond length");if(m>=h)for(n.push(n[0].slice(-h)),m-=h;m>=n[n.length-1].length;)n.push(n[n.length-1]),m-=n[n.length-1].length;n.push(n[0].slice(-h,-h+m))}}var f=cf(n);if(f.length!=a)throw new Error("Unexpected length: ".concat(f.length," != ").concat(a));return f}function pL(e){for(var r=[],s=0;s<e.length;){var a=e[s++],n=e[s]|e[s+1]<<8|e[s+2]<<16;s+=3,r.push(xL(a,e.slice(s,s+n))),s+=n}if(s!==e.length)throw new Error("data is not a valid framed stream!");return cf(r)}function gL(e,r,s,a){var n=xx(e),o=n.getUint32(4,!0),c=(a>1?12:8)+H1(o&(a>1?3470:398))*4,d=-1,h=-1,m=NaN,f=new Date(2001,0,1);o&512&&(d=n.getUint32(c,!0),c+=4),c+=H1(o&(a>1?12288:4096))*4,o&16&&(h=n.getUint32(c,!0),c+=4),o&32&&(m=n.getFloat64(c,!0),c+=8),o&64&&(f.setTime(f.getTime()+n.getFloat64(c,!0)*1e3),c+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:m};break;case 3:p={t:"s",v:r[h]};break;case 5:p={t:"d",v:f};break;case 6:p={t:"b",v:m>0};break;case 7:p={t:"n",v:m/86400};break;case 8:p={t:"e",v:0};break;case 9:if(d>-1)p={t:"s",v:s[d]};else if(h>-1)p={t:"s",v:r[h]};else if(!isNaN(m))p={t:"n",v:m};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function vL(e,r,s){var a=xx(e),n=a.getUint32(8,!0),o=12,c=-1,d=-1,h=NaN,m=NaN,f=new Date(2001,0,1);n&1&&(h=mL(e,o),o+=16),n&2&&(m=a.getFloat64(o,!0),o+=8),n&4&&(f.setTime(f.getTime()+a.getFloat64(o,!0)*1e3),o+=8),n&8&&(d=a.getUint32(o,!0),o+=4),n&16&&(c=a.getUint32(o,!0),o+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:h};break;case 3:p={t:"s",v:r[d]};break;case 5:p={t:"d",v:f};break;case 6:p={t:"b",v:m>0};break;case 7:p={t:"n",v:m/86400};break;case 8:p={t:"e",v:0};break;case 9:if(c>-1)p={t:"s",v:s[c]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return p}function yL(e,r,s){switch(e[0]){case 0:case 1:case 2:case 3:return gL(e,r,s,e[0]);case 5:return vL(e,r,s);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function hi(e){var r=Fs(e);return Tc(r[1][0].data)}function V1(e,r){var s=Fs(r.data),a=ms(s[1][0].data),n=s[3],o=[];return(n||[]).forEach(function(c){var d=Fs(c.data),h=ms(d[1][0].data)>>>0;switch(a){case 1:o[h]=of(d[3][0].data);break;case 8:{var m=e[hi(d[9][0].data)][0],f=Fs(m.data),p=e[hi(f[1][0].data)][0],g=ms(p.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var N=Fs(p.data);o[h]=N[3].map(function(y){return of(y.data)}).join("")}break}}),o}function NL(e,r){var s,a,n,o,c,d,h,m,f,p,g,N,y,w,b=Fs(e),C=ms(b[1][0].data)>>>0,A=ms(b[2][0].data)>>>0,E=((a=(s=b[8])==null?void 0:s[0])==null?void 0:a.data)&&ms(b[8][0].data)>0||!1,R,V;if((o=(n=b[7])==null?void 0:n[0])!=null&&o.data&&r!=0)R=(d=(c=b[7])==null?void 0:c[0])==null?void 0:d.data,V=(m=(h=b[6])==null?void 0:h[0])==null?void 0:m.data;else if((p=(f=b[4])==null?void 0:f[0])!=null&&p.data&&r!=1)R=(N=(g=b[4])==null?void 0:g[0])==null?void 0:N.data,V=(w=(y=b[3])==null?void 0:y[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var P=E?4:1,k=xx(R),z=[],W=0;W<R.length/2;++W){var te=k.getUint16(W*2,!0);te<65535&&z.push([W,te])}if(z.length!=A)throw"Expected ".concat(A," cells, found ").concat(z.length);var de=[];for(W=0;W<z.length-1;++W)de[z[W][0]]=V.subarray(z[W][1]*P,z[W+1][1]*P);return z.length>=1&&(de[z[z.length-1][0]]=V.subarray(z[z.length-1][1]*P)),{R:C,cells:de}}function wL(e,r){var s,a=Fs(r.data),n=(s=a?.[7])!=null&&s[0]?ms(a[7][0].data)>>>0>0?1:0:-1,o=px(a[5],function(c){return NL(c,n)});return{nrows:ms(a[4][0].data)>>>0,data:o.reduce(function(c,d){return c[d.R]||(c[d.R]=[]),d.cells.forEach(function(h,m){if(c[d.R][m])throw new Error("Duplicate cell r=".concat(d.R," c=").concat(m));c[d.R][m]=h}),c},[])}}function bL(e,r,s){var a,n=Fs(r.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(ms(n[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(o.e.c=(ms(n[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));s["!ref"]=sr(o);var c=Fs(n[4][0].data),d=V1(e,e[hi(c[4][0].data)][0]),h=(a=c[17])!=null&&a[0]?V1(e,e[hi(c[17][0].data)][0]):[],m=Fs(c[3][0].data),f=0;m[1].forEach(function(p){var g=Fs(p.data),N=e[hi(g[2][0].data)][0],y=ms(N.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var w=wL(e,N);w.data.forEach(function(b,C){b.forEach(function(A,E){var R=Gt({r:f+C,c:E}),V=yL(A,d,h);V&&(s[R]=V)})}),f+=w.nrows})}function jL(e,r){var s=Fs(r.data),a={"!ref":"A1"},n=e[hi(s[2][0].data)],o=ms(n[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return bL(e,n[0],a),a}function EL(e,r){var s,a=Fs(r.data),n={name:(s=a[1])!=null&&s[0]?of(a[1][0].data):"",sheets:[]},o=px(a[2],hi);return o.forEach(function(c){e[c].forEach(function(d){var h=ms(d.meta[1][0].data);h==6e3&&n.sheets.push(jL(e,d))})}),n}function TL(e,r){var s=yx(),a=Fs(r.data),n=px(a[1],hi);if(n.forEach(function(o){e[o].forEach(function(c){var d=ms(c.meta[1][0].data);if(d==2){var h=EL(e,c);h.sheets.forEach(function(m,f){Nx(s,m,f==0?h.name:h.name+"_"+f,!0)})}})}),s.SheetNames.length==0)throw new Error("Empty NUMBERS file");return s}function ym(e){var r,s,a,n,o={},c=[];if(e.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var m;try{m=pL(h.content)}catch(p){return console.log("?? "+h.content.length+" "+(p.message||p))}var f;try{f=fL(m)}catch(p){return console.log("## "+(p.message||p))}f.forEach(function(p){o[p.id]=p.messages,c.push(p.id)})}}),!c.length)throw new Error("File has no messages");var d=((n=(a=(s=(r=o?.[1])==null?void 0:r[0])==null?void 0:s.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&ms(o[1][0].meta[1][0].data)==1&&o[1][0];if(d||c.forEach(function(h){o[h].forEach(function(m){var f=ms(m.meta[1][0].data)>>>0;if(f==1)if(!d)d=m;else throw new Error("Document has multiple roots")})}),!d)throw new Error("Cannot find Document root");return TL(o,d)}function SL(e){return function(s){for(var a=0;a!=e.length;++a){var n=e[a];s[n[0]]===void 0&&(s[n[0]]=n[1]),n[2]==="n"&&(s[n[0]]=Number(s[n[0]]))}}}function gx(e){SL([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function AL(e){return Vl.WS.indexOf(e)>-1?"sheet":e==Vl.CS?"chart":e==Vl.DS?"dialog":e==Vl.MS?"macro":e&&e.length?e:"sheet"}function CL(e,r){if(!e)return 0;try{e=r.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,AL(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function kL(e,r,s,a,n,o,c,d,h,m,f,p){try{o[a]=nc(ha(e,s,!0),r);var g=as(e,r),N;switch(d){case"sheet":N=FM(g,r,n,h,o[a],m,f,p);break;case"chart":if(N=IM(g,r,n,h,o[a],m,f,p),!N||!N["!drawel"])break;var y=Ko(N["!drawel"].Target,r),w=rf(y),b=OI(ha(e,y,!0),nc(ha(e,w,!0),y)),C=Ko(b,y),A=rf(C);N=vM(ha(e,C,!0),C,h,nc(ha(e,A,!0),C),m,N);break;case"macro":N=MM(g,r,n,h,o[a],m,f,p);break;case"dialog":N=LM(g,r,n,h,o[a],m,f,p);break;default:throw new Error("Unrecognized sheet type "+d)}c[a]=N;var E=[];o&&o[a]&&nn(o[a]).forEach(function(R){var V="";if(o[a][R].Type==Vl.CMNT){V=Ko(o[a][R].Target,r);var P=UM(as(e,V,!0),V,h);if(!P||!P.length)return;S1(N,P,!1)}o[a][R].Type==Vl.TCMNT&&(V=Ko(o[a][R].Target,r),E=E.concat(II(as(e,V,!0),h)))}),E&&E.length&&S1(N,E,!0,h.people||[])}catch(R){if(h.WTF)throw R}}function ja(e){return e.charAt(0)=="/"?e.slice(1):e}function PL(e,r){if(ij(),r=r||{},gx(r),Sa(e,"META-INF/manifest.xml")||Sa(e,"objectdata.xml"))return L1(e,r);if(Sa(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof ym<"u"){if(e.FileIndex)return ym(e);var s=rr.utils.cfb_new();return Zy(e).forEach(function(I){R_(s,I,P_(e,I))}),ym(s)}throw new Error("Unsupported NUMBERS file")}if(!Sa(e,"[Content_Types].xml"))throw Sa(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Sa(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=Zy(e),n=SD(ha(e,"[Content_Types].xml")),o=!1,c,d;if(n.workbooks.length===0&&(d="xl/workbook.xml",as(e,d,!0)&&n.workbooks.push(d)),n.workbooks.length===0){if(d="xl/workbook.bin",!as(e,d,!0))throw new Error("Could not find workbook");n.workbooks.push(d),o=!0}n.workbooks[0].slice(-3)=="bin"&&(o=!0);var h={},m={};if(!r.bookSheets&&!r.bookProps){if(oc=[],n.sst)try{oc=VM(as(e,ja(n.sst)),n.sst,r)}catch(I){if(r.WTF)throw I}r.cellStyles&&n.themes.length&&(h=HM(ha(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],r)),n.style&&(m=BM(as(e,ja(n.style)),n.style,h,r))}n.links.map(function(I){try{var X=nc(ha(e,rf(ja(I))),I);return GM(as(e,ja(I)),X,I,r)}catch{}});var f=OM(as(e,ja(n.workbooks[0])),n.workbooks[0],r),p={},g="";n.coreprops.length&&(g=as(e,ja(n.coreprops[0]),!0),g&&(p=Fj(g)),n.extprops.length!==0&&(g=as(e,ja(n.extprops[0]),!0),g&&RD(g,p,r)));var N={};(!r.bookSheets||r.bookProps)&&n.custprops.length!==0&&(g=ha(e,ja(n.custprops[0]),!0),g&&(N=DD(g,r)));var y={};if((r.bookSheets||r.bookProps)&&(f.Sheets?c=f.Sheets.map(function(X){return X.name}):p.Worksheets&&p.SheetNames.length>0&&(c=p.SheetNames),r.bookProps&&(y.Props=p,y.Custprops=N),r.bookSheets&&typeof c<"u"&&(y.SheetNames=c),r.bookSheets?y.SheetNames:r.bookProps))return y;c={};var w={};r.bookDeps&&n.calcchain&&(w=$M(as(e,ja(n.calcchain)),n.calcchain));var b=0,C={},A,E;{var R=f.Sheets;p.Worksheets=R.length,p.SheetNames=[];for(var V=0;V!=R.length;++V)p.SheetNames[V]=R[V].name}var P=o?"bin":"xml",k=n.workbooks[0].lastIndexOf("/"),z=(n.workbooks[0].slice(0,k+1)+"_rels/"+n.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");Sa(e,z)||(z="xl/_rels/workbook."+P+".rels");var W=nc(ha(e,z,!0),z.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(r.xlmeta=WM(as(e,ja(n.metadata[0])),n.metadata[0],r)),(n.people||[]).length>=1&&(r.people=MI(as(e,ja(n.people[0])),r)),W&&(W=CL(W,f.Sheets));var te=as(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=p.Worksheets;++b){var de="sheet";if(W&&W[b]?(A="xl/"+W[b][1].replace(/[\/]?xl\//,""),Sa(e,A)||(A=W[b][1]),Sa(e,A)||(A=z.replace(/_rels\/.*$/,"")+W[b][1]),de=W[b][2]):(A="xl/worksheets/sheet"+(b+1-te)+"."+P,A=A.replace(/sheet0\./,"sheet.")),E=A.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(b!=r.sheets)continue e;break;case"string":if(p.SheetNames[b].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var H=!1,ue=0;ue!=r.sheets.length;++ue)typeof r.sheets[ue]=="number"&&r.sheets[ue]==b&&(H=1),typeof r.sheets[ue]=="string"&&r.sheets[ue].toLowerCase()==p.SheetNames[b].toLowerCase()&&(H=1);if(!H)continue e}}kL(e,A,E,p.SheetNames[b],b,C,c,de,r,f,h,m)}return y={Directory:n,Workbook:f,Props:p,Custprops:N,Deps:w,Sheets:c,SheetNames:p.SheetNames,Strings:oc,Styles:m,Themes:h,SSF:Ts(zt)},r&&r.bookFiles&&(e.files?(y.keys=a,y.files=e.files):(y.keys=[],y.files={},e.FullPaths.forEach(function(I,X){I=I.replace(/^Root Entry[\/]/,""),y.keys.push(I),y.files[I]=e.FileIndex[X]}))),r&&r.bookVBA&&(n.vba.length>0?y.vbaraw=as(e,ja(n.vba[0]),!0):n.defaults&&n.defaults.bin===VI&&(y.vbaraw=as(e,"xl/vbaProject.bin",!0))),y}function RL(e,r){var s=r||{},a="Workbook",n=rr.find(e,a);try{if(a="/!DataSpaces/Version",n=rr.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(jF(n.content),a="/!DataSpaces/DataSpaceMap",n=rr.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=TF(n.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=rr.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=SF(n.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=rr.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);CF(n.content)}catch{}if(a="/EncryptionInfo",n=rr.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var d=kF(n.content);if(a="/EncryptedPackage",n=rr.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(d[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(d[1],n.content,s.password||"",s);if(d[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(d[1],n.content,s.password||"",s);throw new Error("File is password-protected")}function vx(e,r){var s="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":s=xa(e.slice(0,12));break;case"binary":s=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[s.charCodeAt(0),s.charCodeAt(1),s.charCodeAt(2),s.charCodeAt(3),s.charCodeAt(4),s.charCodeAt(5),s.charCodeAt(6),s.charCodeAt(7)]}function _L(e,r){return rr.find(e,"EncryptedPackage")?RL(e,r):y2(e,r)}function DL(e,r){var s,a=e,n=r||{};return n.type||(n.type=tr&&Buffer.isBuffer(e)?"buffer":"base64"),s=hj(a,n),PL(s,n)}function j2(e,r){var s=0;e:for(;s<e.length;)switch(e.charCodeAt(s)){case 10:case 13:case 32:++s;break;case 60:return nf(e.slice(s),r);default:break e}return bc.to_workbook(e,r)}function OL(e,r){var s="",a=vx(e,r);switch(r.type){case"base64":s=xa(e);break;case"binary":s=e;break;case"buffer":s=e.toString("binary");break;case"array":s=Qi(e);break;default:throw new Error("Unrecognized type "+r.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(s=kr(s)),r.type="binary",j2(s,r)}function FL(e,r){var s=e;return r.type=="base64"&&(s=xa(s)),s=vc.utils.decode(1200,s.slice(2),"str"),r.type="binary",j2(s,r)}function IL(e){return e.match(/[^\x00-\x7F]/)?Xo(e):e}function Nm(e,r,s,a){return a?(s.type="string",bc.to_workbook(e,s)):bc.to_workbook(r,s)}function df(e,r){Xb();var s=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return df(new Uint8Array(e),(s=Ts(s),s.type="array",s));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!s.type&&(s.type=typeof Deno<"u"?"buffer":"array");var a=e,n=[0,0,0,0],o=!1;if(s.cellStyles&&(s.cellNF=!0,s.sheetStubs=!0),Wl={},s.dateNF&&(Wl.dateNF=s.dateNF),s.type||(s.type=tr&&Buffer.isBuffer(e)?"buffer":"base64"),s.type=="file"&&(s.type=tr?"buffer":"binary",a=j_(e),typeof Uint8Array<"u"&&!tr&&(s.type="array")),s.type=="string"&&(o=!0,s.type="binary",s.codepage=65001,a=IL(e)),s.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),d=new Uint8Array(c);if(d.foo="bar",!d.foo)return s=Ts(s),s.type="array",df(Yf(a),s)}switch((n=vx(a,s))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return _L(rr.read(a,s),s);break;case 9:if(n[1]<=8)return y2(a,s);break;case 60:return nf(a,s);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return dF(a,s);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return oF.to_workbook(a,s);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?DL(a,s):Nm(e,a,s,o);case 239:return n[3]===60?nf(a,s):Nm(e,a,s,o);case 255:if(n[1]===254)return FL(a,s);if(n[1]===0&&n[2]===2&&n[3]===0)return lc.to_workbook(a,s);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return lc.to_workbook(a,s);break;case 3:case 131:case 139:case 140:return T1.to_workbook(a,s);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return VF.to_workbook(a,s);break;case 10:case 13:case 32:return OL(a,s);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return iF.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?T1.to_workbook(a,s):Nm(e,a,s,o)}function ML(e,r,s,a,n,o,c,d){var h=Ss(s),m=d.defval,f=d.raw||!Object.prototype.hasOwnProperty.call(d,"raw"),p=!0,g=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:s,enumerable:!1})}catch{g.__rowNum__=s}else g.__rowNum__=s;if(!c||e[s])for(var N=r.s.c;N<=r.e.c;++N){var y=c?e[s][N]:e[a[N]+h];if(y===void 0||y.t===void 0){if(m===void 0)continue;o[N]!=null&&(g[o[N]]=m);continue}var w=y.v;switch(y.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(o[N]!=null){if(w==null)if(y.t=="e"&&w===null)g[o[N]]=null;else if(m!==void 0)g[o[N]]=m;else if(f&&w===null)g[o[N]]=null;else continue;else g[o[N]]=f&&(y.t!=="n"||y.t==="n"&&d.rawNumbers!==!1)?w:Pn(y,w,d);w!=null&&(p=!1)}}return{row:g,isempty:p}}function uf(e,r){if(e==null||e["!ref"]==null)return[];var s={t:"n",v:0},a=0,n=1,o=[],c=0,d="",h={s:{r:0,c:0},e:{r:0,c:0}},m=r||{},f=m.range!=null?m.range:e["!ref"];switch(m.header===1?a=1:m.header==="A"?a=2:Array.isArray(m.header)?a=3:m.header==null&&(a=0),typeof f){case"string":h=qr(f);break;case"number":h=qr(e["!ref"]),h.s.r=f;break;default:h=f}a>0&&(n=0);var p=Ss(h.s.r),g=[],N=[],y=0,w=0,b=Array.isArray(e),C=h.s.r,A=0,E={};b&&!e[C]&&(e[C]=[]);var R=m.skipHidden&&e["!cols"]||[],V=m.skipHidden&&e["!rows"]||[];for(A=h.s.c;A<=h.e.c;++A)if(!(R[A]||{}).hidden)switch(g[A]=hs(A),s=b?e[C][A]:e[g[A]+p],a){case 1:o[A]=A-h.s.c;break;case 2:o[A]=g[A];break;case 3:o[A]=m.header[A-h.s.c];break;default:if(s==null&&(s={w:"__EMPTY",t:"s"}),d=c=Pn(s,null,m),w=E[c]||0,!w)E[c]=1;else{do d=c+"_"+w++;while(E[d]);E[c]=w,E[d]=1}o[A]=d}for(C=h.s.r+n;C<=h.e.r;++C)if(!(V[C]||{}).hidden){var P=ML(e,h,C,g,a,o,b,m);(P.isempty===!1||(a===1?m.blankrows!==!1:m.blankrows))&&(N[y++]=P.row)}return N.length=y,N}var U1=/"/g;function LL(e,r,s,a,n,o,c,d){for(var h=!0,m=[],f="",p=Ss(s),g=r.s.c;g<=r.e.c;++g)if(a[g]){var N=d.dense?(e[s]||[])[g]:e[a[g]+p];if(N==null)f="";else if(N.v!=null){h=!1,f=""+(d.rawNumbers&&N.t=="n"?N.v:Pn(N,null,d));for(var y=0,w=0;y!==f.length;++y)if((w=f.charCodeAt(y))===n||w===o||w===34||d.forceQuotes){f='"'+f.replace(U1,'""')+'"';break}f=="ID"&&(f='"ID"')}else N.f!=null&&!N.F?(h=!1,f="="+N.f,f.indexOf(",")>=0&&(f='"'+f.replace(U1,'""')+'"')):f="";m.push(f)}return d.blankrows===!1&&h?null:m.join(c)}function E2(e,r){var s=[],a=r??{};if(e==null||e["!ref"]==null)return"";var n=qr(e["!ref"]),o=a.FS!==void 0?a.FS:",",c=o.charCodeAt(0),d=a.RS!==void 0?a.RS:`
`,h=d.charCodeAt(0),m=new RegExp((o=="|"?"\\|":o)+"+$"),f="",p=[];a.dense=Array.isArray(e);for(var g=a.skipHidden&&e["!cols"]||[],N=a.skipHidden&&e["!rows"]||[],y=n.s.c;y<=n.e.c;++y)(g[y]||{}).hidden||(p[y]=hs(y));for(var w=0,b=n.s.r;b<=n.e.r;++b)(N[b]||{}).hidden||(f=LL(e,n,b,p,c,h,o,a),f!=null&&(a.strip&&(f=f.replace(m,"")),(f||a.blankrows!==!1)&&s.push((w++?d:"")+f)));return delete a.dense,s.join("")}function BL(e,r){r||(r={}),r.FS="	",r.RS=`
`;var s=E2(e,r);return s}function HL(e){var r="",s,a="";if(e==null||e["!ref"]==null)return[];var n=qr(e["!ref"]),o="",c=[],d,h=[],m=Array.isArray(e);for(d=n.s.c;d<=n.e.c;++d)c[d]=hs(d);for(var f=n.s.r;f<=n.e.r;++f)for(o=Ss(f),d=n.s.c;d<=n.e.c;++d)if(r=c[d]+o,s=m?(e[f]||[])[d]:e[r],a="",s!==void 0){if(s.F!=null){if(r=s.F,!s.f)continue;a=s.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(s.f!=null)a=s.f;else{if(s.t=="z")continue;if(s.t=="n"&&s.v!=null)a=""+s.v;else if(s.t=="b")a=s.v?"TRUE":"FALSE";else if(s.w!==void 0)a="'"+s.w;else{if(s.v===void 0)continue;s.t=="s"?a="'"+s.v:a=""+s.v}}h[h.length]=r+"="+a}return h}function T2(e,r,s){var a=s||{},n=+!a.skipHeader,o=e||{},c=0,d=0;if(o&&a.origin!=null)if(typeof a.origin=="number")c=a.origin;else{var h=typeof a.origin=="string"?Xs(a.origin):a.origin;c=h.r,d=h.c}var m,f={s:{c:0,r:0},e:{c:d,r:c+r.length-1+n}};if(o["!ref"]){var p=qr(o["!ref"]);f.e.c=Math.max(f.e.c,p.e.c),f.e.r=Math.max(f.e.r,p.e.r),c==-1&&(c=p.e.r+1,f.e.r=c+r.length-1+n)}else c==-1&&(c=0,f.e.r=r.length-1+n);var g=a.header||[],N=0;r.forEach(function(w,b){nn(w).forEach(function(C){(N=g.indexOf(C))==-1&&(g[N=g.length]=C);var A=w[C],E="z",R="",V=Gt({c:d+N,r:c+b+n});m=Sc(o,V),A&&typeof A=="object"&&!(A instanceof Date)?o[V]=A:(typeof A=="number"?E="n":typeof A=="boolean"?E="b":typeof A=="string"?E="s":A instanceof Date?(E="d",a.cellDates||(E="n",A=Js(A)),R=a.dateNF||zt[14]):A===null&&a.nullError&&(E="e",A=0),m?(m.t=E,m.v=A,delete m.w,delete m.R,R&&(m.z=R)):o[V]=m={t:E,v:A},R&&(m.z=R))})}),f.e.c=Math.max(f.e.c,d+g.length-1);var y=Ss(c);if(n)for(N=0;N<g.length;++N)o[hs(N+d)+y]={t:"s",v:g[N]};return o["!ref"]=sr(f),o}function VL(e,r){return T2(null,e,r)}function Sc(e,r,s){if(typeof r=="string"){if(Array.isArray(e)){var a=Xs(r);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Sc(e,Gt(r)):Sc(e,Gt({r,c:s||0}))}function UL(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var s=e.SheetNames.indexOf(r);if(s>-1)return s;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function yx(){return{SheetNames:[],Sheets:{}}}function Nx(e,r,s,a){var n=1;if(!s)for(;n<=65535&&e.SheetNames.indexOf(s="Sheet"+n)!=-1;++n,s=void 0);if(!s||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(s)>=0){var o=s.match(/(^.*?)(\d+)$/);n=o&&+o[2]||0;var c=o&&o[1]||s;for(++n;n<=65535&&e.SheetNames.indexOf(s=c+n)!=-1;++n);}if(SM(s),e.SheetNames.indexOf(s)>=0)throw new Error("Worksheet with name |"+s+"| already exists!");return e.SheetNames.push(s),e.Sheets[s]=r,s}function $L(e,r,s){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=UL(e,r);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),s){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+s)}e.Workbook.Sheets[a].Hidden=s}function GL(e,r){return e.z=r,e}function S2(e,r,s){return r?(e.l={Target:r},s&&(e.l.Tooltip=s)):delete e.l,e}function WL(e,r,s){return S2(e,"#"+r,s)}function zL(e,r,s){e.c||(e.c=[]),e.c.push({t:r,a:s||"SheetJS"})}function KL(e,r,s,a){for(var n=typeof r!="string"?r:qr(r),o=typeof r=="string"?r:sr(r),c=n.s.r;c<=n.e.r;++c)for(var d=n.s.c;d<=n.e.c;++d){var h=Sc(e,c,d);h.t="n",h.F=o,delete h.v,c==n.s.r&&d==n.s.c&&(h.f=s,a&&(h.D=!0))}return e}var XL={encode_col:hs,encode_row:Ss,encode_cell:Gt,encode_range:sr,decode_col:nx,decode_row:ax,split_cell:nD,decode_cell:Xs,decode_range:eo,format_cell:Pn,sheet_add_aoa:Pj,sheet_add_json:T2,sheet_add_dom:N2,aoa_to_sheet:to,json_to_sheet:VL,table_to_sheet:w2,table_to_book:dL,sheet_to_csv:E2,sheet_to_txt:BL,sheet_to_json:uf,sheet_to_html:cL,sheet_to_formulae:HL,sheet_to_row_object_array:uf,sheet_get_cell:Sc,book_new:yx,book_append_sheet:Nx,book_set_sheet_visibility:$L,cell_set_number_format:GL,cell_set_hyperlink:S2,cell_set_internal_link:WL,cell_add_comment:zL,sheet_set_array_formula:KL,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const A2=()=>{const e=Ls(),{user:r}=Ns(),[s,a]=T.useState([]),[n,o]=T.useState([]),[c,d]=T.useState({name:"",quantity:""}),[h,m]=T.useState(null),[f,p]=T.useState(0),[g,N]=T.useState(""),y=async()=>{try{const k=await(await fetch(`${Fe}/store/inventory`)).json();a(k)}catch(P){console.error("Error fetching inventory",P)}},w=async()=>{try{const k=await(await fetch(`${Fe}/store/orders/pending`)).json();o(k)}catch(P){console.error("Error fetching purchase orders",P)}};T.useEffect(()=>{y(),w()},[]);const b=async P=>{try{const k=await fetch(`${Fe}/store/orders/${P}/check-stock`,{method:"POST",headers:{"Content-Type":"application/json"}}),z=await k.json();k.ok?(z.message.toLowerCase().includes("insufficient")?dt({title:"Insufficient Stock ",description:z.message,variant:"destructive"}):dt({title:"Stock Allocated ",description:z.message}),y(),w()):dt({title:"Error",description:z.error,variant:"destructive"})}catch(k){console.error(k),dt({title:"Error",description:"Failed to check stock",variant:"destructive"})}},C=async P=>{try{const k=await fetch(`${Fe}/store/orders/${P}/verify-purchase`,{method:"POST",headers:{"Content-Type":"application/json"}}),z=await k.json();k.ok?(dt({title:"Purchase Verified ",description:z.message}),y(),w()):dt({title:"Error",description:z.error,variant:"destructive"})}catch(k){console.error(k),dt({title:"Error",description:"Failed to verify purchase",variant:"destructive"})}},A=async()=>{if(!(!c.name||!c.quantity))try{const P=await fetch(`${Fe}/store/inventory`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),k=await P.json();P.ok?(dt({title:"Item Added ",description:k.message}),d({name:"",quantity:""}),y()):dt({title:"Error",description:k.error,variant:"destructive"})}catch(P){console.error(P),dt({title:"Error",description:"Failed to add item",variant:"destructive"})}},E=async()=>{if(!h){dt({title:"No file selected",description:"Please select an Excel file to import",variant:"destructive"});return}try{const P=new FileReader;P.onload=async k=>{const z=new Uint8Array(k.target.result),W=df(z,{type:"array"}),te=W.SheetNames[0],de=W.Sheets[te],I=XL.sheet_to_json(de,{header:1}).slice(1).map(xe=>({name:xe[0]?String(xe[0]).trim():"",quantity:xe[1]?parseInt(xe[1]):0,category:xe[2]?String(xe[2]).trim():"Raw Material"})).filter(xe=>xe.name&&xe.quantity>0);if(I.length===0){dt({title:"No valid data",description:"No valid items found in the Excel file",variant:"destructive"});return}const X=await fetch(`${Fe}/store/inventory/bulk`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(I)}),oe=await X.json();X.ok?(dt({title:"Import Successful ",description:oe.message}),m(null),y()):dt({title:"Import Failed",description:oe.error,variant:"destructive"})},P.readAsArrayBuffer(h)}catch(P){console.error(P),dt({title:"Import Error",description:"Failed to process the Excel file",variant:"destructive"})}},R=s.filter(P=>P.name.toLowerCase().includes(g.toLowerCase())),V=n.length;return t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50",children:[t.jsx("div",{className:"max-w-7xl mx-auto bg-white shadow-md border-b-4 border-blue-800 rounded-b-lg",children:t.jsx("div",{className:"px-4 sm:px-6 py-4 sm:py-6",children:t.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:justify-between sm:items-center sm:space-y-0",children:[t.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4",children:[t.jsxs(pe,{onClick:()=>e(r?.department==="admin"?"/dashboard/admin":"/dashboard"),variant:"outline",className:"border border-gray-300 bg-white text-gray-800 text-sm placeholder-gray-500 w-full sm:w-auto",children:[t.jsx(qs,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-600 to-blue-800 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx(XN,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Store Department"}),t.jsx("p",{className:"text-gray-600 text-sm sm:text-base font-medium",children:"Inventory Management System"})]})]})]}),t.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 px-4 py-4 sm:px-6 rounded-lg shadow-sm w-full sm:w-auto",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(Nr,{className:"w-5 h-5 text-blue-600"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 text-xs font-medium",children:"Store Team"}),t.jsx("p",{className:"text-blue-600 text-xs font-medium",children:"Inventory Management"})]})]})})]})})}),t.jsx("div",{className:"max-w-7xl mx-auto px-6 py-4",children:t.jsx(Rn,{className:"mb-4"})}),t.jsx("div",{className:"max-w-7xl mx-auto px-6",children:t.jsxs("div",{className:"flex space-x-2 border-b border-blue-200 mb-8",children:[t.jsx("button",{className:`relative px-6 py-3 text-lg font-semibold focus:outline-none transition-colors border-b-4 ${f===0?"border-blue-700 text-blue-800 bg-white":"border-transparent text-gray-500 bg-blue-50 hover:text-blue-700"}`,onClick:()=>p(0),children:"Inventory"}),t.jsxs("button",{className:`relative px-6 py-3 text-lg font-semibold focus:outline-none transition-colors border-b-4 ${f===1?"border-blue-700 text-blue-800 bg-white":"border-transparent text-gray-500 bg-blue-50 hover:text-blue-700"}`,onClick:()=>p(1),children:["Stock Verification",V>0&&t.jsx("span",{className:"absolute top-2 right-2 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:V})]})]})}),t.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[f===0?t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[t.jsx("div",{children:t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsx(rt,{children:t.jsxs(at,{className:"text-gray-800 flex items-center",children:[t.jsx(Mm,{className:"w-5 h-5 mr-2"})," Add Inventory"]})}),t.jsx(Ve,{children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(Q,{className:"text-gray-800 font-medium",children:"Item Name"}),t.jsx(Re,{value:c.name,onChange:P=>d({...c,name:P.target.value}),placeholder:"e.g., Steel Rod",className:"w-full border-2 border-gray-300 bg-white text-gray-900 mt-1 p-3 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 placeholder:text-gray-500"})]}),t.jsxs("div",{children:[t.jsx(Q,{className:"text-gray-800 font-medium",children:"Quantity"}),t.jsx(Re,{type:"number",value:c.quantity,onChange:P=>d({...c,quantity:P.target.value}),placeholder:"e.g., 100",className:"w-full border-2 border-gray-300 bg-white text-gray-900 mt-1 p-3 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 placeholder:text-gray-500"})]}),t.jsxs(pe,{onClick:A,className:"w-full bg-green-600 hover:bg-green-700 text-white font-medium",children:[t.jsx(Mm,{className:"w-4 h-4 mr-2"}),"Add Item"]}),t.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[t.jsx(Q,{className:"text-gray-800 font-medium",children:"Import from Excel"}),t.jsx(Re,{type:"file",accept:".xlsx,.xls",onChange:P=>m(P.target.files[0]),className:"w-full border-2 border-gray-300 bg-white text-gray-900 mt-1 p-3 focus:border-blue-500 focus:ring-2 focus:ring-blue-200"}),t.jsxs(pe,{onClick:E,className:"w-full mt-2 bg-blue-600 hover:bg-blue-700 text-white font-medium",disabled:!h,children:[t.jsx(sk,{className:"w-4 h-4 mr-2"}),"Import Excel"]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Excel should have columns: Product Name, Quantity, Category (optional)"})]})]})})]})}),t.jsx("div",{children:t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsx(rt,{children:t.jsxs(at,{className:"text-gray-800 flex items-center",children:[t.jsx(Cv,{className:"w-5 h-5 mr-2"})," Inventory"]})}),t.jsx(Ve,{children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"relative",children:[t.jsx(fi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),t.jsx(Re,{value:g,onChange:P=>N(P.target.value),placeholder:"Search inventory items...",className:"w-full pl-10 border-2 border-gray-300 bg-white text-gray-900 p-3 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 placeholder:text-gray-500"})]}),t.jsx("div",{className:"space-y-3",children:R.length>0?R.map((P,k)=>t.jsxs("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded-lg flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-800 font-medium",children:P.name}),t.jsxs(Lt,{className:"bg-green-500/20 text-green-400 border-0",children:["Qty: ",P.quantity]})]},k)):g?t.jsx("p",{className:"text-gray-400 text-center py-4",children:"No items match your search"}):t.jsx("p",{className:"text-gray-400 text-center py-4",children:"No items"})})]})})]})})]}):t.jsx("div",{children:t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsx(rt,{children:t.jsxs(at,{className:"text-gray-800 flex items-center",children:[t.jsx(Cv,{className:"w-5 h-5 mr-2"})," Purchase Orders"]})}),t.jsx(Ve,{children:t.jsx("div",{className:"space-y-4",children:n.length>0?n.map(P=>t.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg space-y-2",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("span",{className:"text-gray-800 font-semibold text-lg",children:["Order #",P.id]}),t.jsx("span",{className:"text-xs text-gray-500",children:P.createdAt?`Created: ${P.createdAt}`:""})]}),t.jsxs("p",{className:"text-gray-800 font-medium",children:["Product: ",P.product_name||P.productName," (Qty: ",P.quantity,")"]}),P.materials&&P.materials.length>0&&t.jsxs("div",{className:"mb-2",children:[t.jsx("span",{className:"text-gray-700 font-medium",children:"Materials:"}),t.jsx("ul",{className:"list-disc list-inside ml-4",children:P.materials.map((k,z)=>t.jsx("li",{className:"text-gray-600 text-sm",children:typeof k=="string"?k:`${k.name||k} (Qty: ${k.quantity||"-"}, Unit Cost: ${k.unit_cost||0})`},z))})]}),t.jsxs("p",{className:"text-sm text-gray-600",children:["Status: ",t.jsx("span",{className:"capitalize",children:P.status})]}),t.jsxs("div",{className:"flex space-x-2",children:[P.status==="pending_store_check"&&t.jsx(pe,{size:"sm",onClick:()=>b(P.id),className:"bg-yellow-600 hover:bg-yellow-700 text-white",children:"Check Stock"}),P.status==="finance_approved"&&t.jsxs(pe,{size:"sm",onClick:()=>C(P.id),className:"bg-blue-600 hover:bg-blue-700 text-white",children:[t.jsx(dr,{className:"w-4 h-4 mr-1"})," Verify & Send Stock"]})]})]},P.id)):t.jsx("p",{className:"text-gray-400 text-center py-4",children:"No purchase orders"})})})]})}),t.jsxs("div",{className:"mt-12 bg-white border-2 border-gray-200 rounded-lg p-6 shadow-sm text-center text-gray-600",children:[t.jsx("p",{className:"font-medium",children:" Inventory Management System"}),t.jsx("p",{className:"text-sm mt-1",children:"For technical support, contact IT Department"})]})]})]})};var cu={},$1;function qL(){if($1)return cu;$1=1,cu.match=o,cu.parse=c;var e=/(?:(only|not)?\s*([^\s\(\)]+)(?:\s*and)?\s*)?(.+)?/i,r=/\(\s*([^\s\:\)]+)\s*(?:\:\s*([^\s\)]+))?\s*\)/,s=/^(?:(min|max)-)?(.+)/,a=/(em|rem|px|cm|mm|in|pt|pc)?$/,n=/(dpi|dpcm|dppx)?$/;function o(f,p){return c(f).some(function(g){var N=g.inverse,y=g.type==="all"||p.type===g.type;if(y&&N||!(y||N))return!1;var w=g.expressions.every(function(b){var C=b.feature,A=b.modifier,E=b.value,R=p[C];if(!R)return!1;switch(C){case"orientation":case"scan":return R.toLowerCase()===E.toLowerCase();case"width":case"height":case"device-width":case"device-height":E=m(E),R=m(R);break;case"resolution":E=h(E),R=h(R);break;case"aspect-ratio":case"device-aspect-ratio":case"device-pixel-ratio":E=d(E),R=d(R);break;case"grid":case"color":case"color-index":case"monochrome":E=parseInt(E,10)||1,R=parseInt(R,10)||0;break}switch(A){case"min":return R>=E;case"max":return R<=E;default:return R===E}});return w&&!N||!w&&N})}function c(f){return f.split(",").map(function(p){p=p.trim();var g=p.match(e),N=g[1],y=g[2],w=g[3]||"",b={};return b.inverse=!!N&&N.toLowerCase()==="not",b.type=y?y.toLowerCase():"all",w=w.match(/\([^\)]+\)/g)||[],b.expressions=w.map(function(C){var A=C.match(r),E=A[1].toLowerCase().match(s);return{modifier:E[1],feature:E[2],value:A[2]}}),b})}function d(f){var p=Number(f),g;return p||(g=f.match(/^(\d+)\s*\/\s*(\d+)$/),p=g[1]/g[2]),p}function h(f){var p=parseFloat(f),g=String(f).match(n)[1];switch(g){case"dpcm":return p/2.54;case"dppx":return p*96;default:return p}}function m(f){var p=parseFloat(f),g=String(f).match(a)[1];switch(g){case"em":return p*16;case"rem":return p*16;case"cm":return p*96/2.54;case"mm":return p*96/2.54/10;case"in":return p*96;case"pt":return p*72;case"pc":return p*72/12;default:return p}}return cu}var wm,G1;function YL(){if(G1)return wm;G1=1;var e=qL().match,r=typeof window<"u"?window.matchMedia:null;function s(n,o,c){var d=this,h;r&&!c&&(h=r.call(window,n)),h?(this.matches=h.matches,this.media=h.media,h.addListener(p)):(this.matches=e(n,o),this.media=n),this.addListener=m,this.removeListener=f,this.dispose=g;function m(N){h&&h.addListener(N)}function f(N){h&&h.removeListener(N)}function p(N){d.matches=N.matches,d.media=N.media}function g(){h&&h.removeListener(p)}}function a(n,o,c){return new s(n,o,c)}return wm=a,wm}var JL=YL();const QL=yi(JL);var ZL=/[A-Z]/g,e5=/^ms-/,bm={};function t5(e){return"-"+e.toLowerCase()}function C2(e){if(bm.hasOwnProperty(e))return bm[e];var r=e.replace(ZL,t5);return bm[e]=e5.test(r)?"-"+r:r}function r5(e,r){if(e===r)return!0;if(!e||!r)return!1;const s=Object.keys(e),a=Object.keys(r),n=s.length;if(a.length!==n)return!1;for(let o=0;o<n;o++){const c=s[o];if(e[c]!==r[c]||!Object.prototype.hasOwnProperty.call(r,c))return!1}return!0}const Gs=Ct.oneOfType([Ct.string,Ct.number]),k2={all:Ct.bool,grid:Ct.bool,aural:Ct.bool,braille:Ct.bool,handheld:Ct.bool,print:Ct.bool,projection:Ct.bool,screen:Ct.bool,tty:Ct.bool,tv:Ct.bool,embossed:Ct.bool},s5={orientation:Ct.oneOf(["portrait","landscape"]),scan:Ct.oneOf(["progressive","interlace"]),aspectRatio:Ct.string,deviceAspectRatio:Ct.string,height:Gs,deviceHeight:Gs,width:Gs,deviceWidth:Gs,color:Ct.bool,colorIndex:Ct.bool,monochrome:Ct.bool,resolution:Gs,type:Object.keys(k2)},{type:H5,...a5}=s5,n5={minAspectRatio:Ct.string,maxAspectRatio:Ct.string,minDeviceAspectRatio:Ct.string,maxDeviceAspectRatio:Ct.string,minHeight:Gs,maxHeight:Gs,minDeviceHeight:Gs,maxDeviceHeight:Gs,minWidth:Gs,maxWidth:Gs,minDeviceWidth:Gs,maxDeviceWidth:Gs,minColor:Ct.number,maxColor:Ct.number,minColorIndex:Ct.number,maxColorIndex:Ct.number,minMonochrome:Ct.number,maxMonochrome:Ct.number,minResolution:Gs,maxResolution:Gs,...a5},i5={...k2,...n5};var l5={all:i5};const o5=e=>`not ${e}`,c5=(e,r)=>{const s=C2(e);return typeof r=="number"&&(r=`${r}px`),r===!0?s:r===!1?o5(s):`(${s}: ${r})`},d5=e=>e.join(" and "),u5=e=>{const r=[];return Object.keys(l5.all).forEach(s=>{const a=e[s];a!=null&&r.push(c5(s,a))}),d5(r)},h5=T.createContext(void 0),m5=e=>e.query||u5(e),W1=e=>e?Object.keys(e).reduce((s,a)=>(s[C2(a)]=e[a],s),{}):void 0,P2=()=>{const e=T.useRef(!1);return T.useEffect(()=>{e.current=!0},[]),e.current},f5=e=>{const r=T.useContext(h5),s=()=>W1(e)||W1(r),[a,n]=T.useState(s);return T.useEffect(()=>{const o=s();r5(a,o)||n(o)},[e,r]),a},x5=e=>{const r=()=>m5(e),[s,a]=T.useState(r);return T.useEffect(()=>{const n=r();s!==n&&a(n)},[e]),s},p5=(e,r)=>{const s=()=>QL(e,r||{},!!r),[a,n]=T.useState(s),o=P2();return T.useEffect(()=>{if(o){const c=s();return n(c),()=>{c&&c.dispose()}}},[e,r]),a},g5=e=>{const[r,s]=T.useState(e.matches);return T.useEffect(()=>{const a=n=>{s(n.matches)};return e.addListener(a),s(e.matches),()=>{e.removeListener(a)}},[e]),r},z1=(e,r,s)=>{const a=f5(r),n=x5(e);if(!n)throw new Error("Invalid or missing MediaQuery!");const o=p5(n,a),c=g5(o);return P2(),T.useEffect(()=>{},[c]),T.useEffect(()=>()=>{o&&o.dispose()},[]),c},R2=()=>{z1({maxWidth:768}),z1({minWidth:769});const e=Ls(),{user:r}=Ns(),[s,a]=T.useState([]),[n,o]=T.useState(!0),[c,d]=T.useState({}),[h,m]=T.useState([]);T.useEffect(()=>{f(),g()},[]);const f=async()=>{try{const I=await fetch(`${Fe}/assembly-orders`);if(I.ok){const X=await I.json();a(X)}else{const X=await I.text();console.error("Failed to fetch orders:",I.status,X),dt({title:"Error",description:"Failed to fetch assembly orders",variant:"destructive"})}}catch(I){console.error("Error fetching assembly orders:",I),dt({title:"Error",description:"Failed to connect to server",variant:"destructive"})}finally{o(!1)}},p=s.filter(I=>I.status==="rework"),g=async()=>{try{const I=await fetch(`${Fe}/purchase-orders`);if(!I.ok)throw new Error(`HTTP error! status: ${I.status}`);const X=await I.json();m(Array.isArray(X)?X:[])}catch(I){console.error("Error fetching purchase orders:",I),m([])}},N=async(I,X)=>{try{d(xe=>({...xe,[I]:!0})),console.log("Updating order:",I,"with data:",X);const oe=await fetch(`${Fe}/assembly-orders/${I}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(X)});if(oe.ok){const xe=await oe.json();return console.log("Updated order received:",xe),a(he=>he.map(F=>F.id===I?xe:F)),xe}else{const xe=await oe.json().catch(()=>({error:"Unknown error"}));throw console.error("Update failed:",oe.status,xe),new Error(xe.error||"Failed to update assembly order")}}catch(oe){return console.error("Error updating assembly order:",oe),dt({title:"Error",description:oe.message||"Failed to update assembly order",variant:"destructive"}),null}finally{d(oe=>({...oe,[I]:!1}))}},y=async I=>{const X={status:"in_progress",startedAt:new Date().toISOString(),progress:0};await N(I,X)&&dt({title:" Assembly Started!",description:"Production has begun for this order."})},w=async(I,X)=>{const oe=s.find(M=>M.id===I);if(!oe){console.error("Order not found:",I);return}const xe=oe.progress||0,he=Math.min(xe+X,100);console.log(`Updating progress for order ${I}: ${xe} -> ${he}`),await N(I,{progress:he})&&dt({title:" Progress Updated",description:`Assembly progress: ${he}%`})},b=async I=>{const X={status:"completed",completedAt:new Date().toISOString(),progress:100,qualityCheck:!0,testingPassed:!0};if(await N(I,X))try{const xe=s.find(F=>F.id===I);(await fetch(`${Fe}/showroom/products`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:xe.productName,category:"General",costPrice:E(xe),salePrice:R(xe),productionOrderId:xe.productionOrderId})})).ok?dt({title:" Assembly Completed!",description:"Product is ready for showroom display after quality testing."}):dt({title:" Assembly Completed!",description:"Product is ready for showroom display after quality testing."})}catch{dt({title:" Assembly Completed!",description:"Product is ready for showroom display after quality testing."})}},C=async I=>{const X={status:"paused",pausedAt:new Date().toISOString()};await N(I,X)&&dt({title:" Assembly Paused",description:"Assembly has been temporarily paused."})},A=async I=>{const X={status:"in_progress",resumedAt:new Date().toISOString()};await N(I,X)&&dt({title:" Assembly Resumed",description:"Assembly work has been resumed."})},E=I=>(I.quantity||1)*100,R=I=>E(I)*1.5,V=I=>{switch(I){case"pending":return"bg-amber-50 text-amber-800 border border-amber-200";case"in_progress":return"bg-blue-50 text-blue-800 border border-blue-200";case"paused":return"bg-orange-50 text-orange-800 border border-orange-200";case"completed":return"bg-green-50 text-green-800 border border-green-200";default:return"bg-gray-50 text-gray-800 border border-gray-200"}},P=I=>{switch(I){case"pending":return t.jsx(Ka,{className:"w-4 h-4"});case"in_progress":return t.jsx(qd,{className:"w-4 h-4"});case"paused":return t.jsx(Dv,{className:"w-4 h-4"});case"completed":return t.jsx(dr,{className:"w-4 h-4"});default:return t.jsx(Ks,{className:"w-4 h-4"})}},[k,z]=T.useState(0),W=["pending","in_progress","paused"],te=["completed"],de=s.filter(I=>W.includes(I.status)),H=s.filter(I=>te.includes(I.status)),ue=de.length;return n?t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx(Cr,{className:"w-12 h-12 animate-spin mx-auto mb-4 text-blue-600"}),t.jsx("p",{className:"text-gray-800 text-lg font-medium",children:"Loading Assembly dashboard..."}),t.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Please wait while we retrieve the data"})]})}):t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50",children:[t.jsx("div",{className:"max-w-7xl mx-auto bg-white shadow-md border-b-4 border-orange-800 rounded-b-lg",children:t.jsx("div",{className:"px-4 sm:px-6 py-4 sm:py-6",children:t.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:justify-between sm:items-center sm:space-y-0",children:[t.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4",children:[t.jsxs(pe,{onClick:()=>e(r?.department==="admin"?"/dashboard/admin":"/dashboard"),variant:"outline",className:"border border-gray-300 bg-white text-gray-800 text-sm placeholder-gray-500 w-full sm:w-auto",children:[t.jsx(qs,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]}),t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-orange-600 to-orange-800 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx(Jo,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Assembly Operations"}),t.jsx("p",{className:"text-gray-600 text-sm sm:text-base font-medium",children:"Product Assembly Management System"})]})]})]}),t.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 border-2 border-orange-200 px-4 py-4 sm:px-6 rounded-lg shadow-sm w-full sm:w-auto",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(Nr,{className:"w-5 h-5 text-orange-600"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-900 font-bold text-sm",children:"Assembly Team"}),t.jsx("p",{className:"text-orange-600 text-xs font-medium",children:"Product Assembly Management"})]})]})})]})})}),t.jsx("div",{className:"max-w-7xl mx-auto px-6 py-4",children:t.jsx(Rn,{className:"mb-4"})}),t.jsx("div",{className:"max-w-7xl mx-auto px-6",children:t.jsxs("div",{className:"flex space-x-2 border-b border-orange-200 mb-8",children:[t.jsxs("button",{className:`relative px-6 py-3 text-lg font-semibold focus:outline-none transition-colors border-b-4 ${k===0?"border-orange-700 text-orange-800 bg-white":"border-transparent text-gray-500 bg-orange-50 hover:text-orange-700"}`,onClick:()=>z(0),children:["Pending Assembly",ue>0&&t.jsx("span",{className:"absolute top-2 right-2 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:ue})]}),t.jsx("button",{className:`px-6 py-3 text-lg font-semibold focus:outline-none transition-colors border-b-4 ${k===1?"border-orange-700 text-orange-800 bg-white":"border-transparent text-gray-500 bg-orange-50 hover:text-orange-700"}`,onClick:()=>z(1),children:"Completed Assembly Orders"})]})}),p.length>0&&t.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:t.jsxs("div",{className:"bg-red-50 border-2 border-red-200 rounded-lg p-6 mb-8",children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[t.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:t.jsx(Cr,{className:"w-5 h-5 text-red-600"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold text-red-800",children:"Rework Required"}),t.jsx("p",{className:"text-red-600 text-sm",children:"Products that failed showroom testing and need reassembly"})]})]}),t.jsx("div",{className:"space-y-4",children:p.map(I=>t.jsxs(He,{className:"bg-white border-2 border-red-200 shadow-lg",children:[t.jsx(rt,{children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx(at,{className:"text-red-800 text-xl font-bold",children:I.productName}),t.jsxs("p",{className:"text-gray-700 mt-1 font-medium",children:["Assembly Order #",I.id," | Production Order #",I.productionOrderId]}),t.jsxs("p",{className:"text-gray-700 mt-1 font-medium",children:["Quantity: ",I.quantity]}),t.jsx("p",{className:"text-red-600 text-sm font-medium",children:"Status: Failed showroom testing - requires rework"})]}),t.jsxs(Lt,{className:"bg-red-100 text-red-800 border border-red-300 font-bold",children:[t.jsx(Cr,{className:"w-4 h-4 mr-1"}),"Rework Required"]})]})}),t.jsx(Ve,{children:t.jsxs("div",{className:"flex space-x-3",children:[t.jsxs(pe,{onClick:()=>y(I.id),disabled:c[I.id],className:"bg-red-600 hover:bg-red-700 text-white disabled:opacity-50 font-medium",children:[t.jsx(qd,{className:"w-4 h-4 mr-2"}),"Start Rework Assembly"]}),t.jsxs(pe,{onClick:()=>w(I.id,100),disabled:c[I.id],className:"bg-green-600 hover:bg-green-700 text-white disabled:opacity-50 font-medium",children:[t.jsx(dr,{className:"w-4 h-4 mr-2"}),"Complete Rework"]})]})})]},`rework-${I.id}`))})]})}),t.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:t.jsxs("div",{className:"space-y-6",children:[k===0?de.length===0?t.jsx(He,{className:"bg-white border-2 border-gray-200 shadow-lg",children:t.jsxs(Ve,{className:"p-8 text-center",children:[t.jsx(Jo,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"No Pending Assembly Orders"}),t.jsx("p",{className:"text-gray-600",children:"Assembly orders will appear here when materials are ready."})]})}):de.map((I,X)=>t.jsx("div",{className:"opacity-100 translate-y-0",children:t.jsxs(He,{className:"bg-white border-2 border-gray-200 shadow-lg",children:[t.jsx(rt,{children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx(at,{className:"text-gray-900 text-xl font-bold",children:I.productName}),t.jsxs("p",{className:"text-gray-700 mt-1 font-medium",children:["Assembly Order #",I.id," | Production Order #",I.productionOrderId]}),t.jsxs("p",{className:"text-gray-700 mt-1 font-medium",children:["Quantity: ",I.quantity]}),t.jsxs("p",{className:"text-gray-600 text-sm font-medium",children:["Created: ",h.find(oe=>oe.productionOrderId===I.productionOrderId)?.createdAt||I.createdAt]}),I.startedAt&&t.jsxs("p",{className:"text-blue-700 text-sm font-medium",children:["Started: ",new Date(I.startedAt).toLocaleDateString()]}),I.completedAt&&t.jsxs("p",{className:"text-green-700 text-sm font-medium",children:["Completed: ",new Date(I.completedAt).toLocaleDateString()]})]}),t.jsxs("div",{className:"flex flex-col items-end space-y-2",children:[t.jsxs(Lt,{className:`${V(I.status)} font-bold`,children:[P(I.status),t.jsx("span",{className:"ml-1 capitalize",children:I.status?.replace("_"," ")||"Pending"})]}),c[I.id]&&t.jsxs("div",{className:"flex items-center text-blue-600 text-sm font-medium",children:[t.jsx(Cr,{className:"w-3 h-3 mr-1 animate-spin"}),"Updating..."]})]})]})}),t.jsx(Ve,{children:t.jsxs("div",{className:"space-y-4",children:[(I.status==="in_progress"||I.status==="paused")&&t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("span",{className:"text-gray-900 font-bold",children:"Assembly Progress"}),t.jsxs("span",{className:"text-blue-600 font-bold",children:[I.progress||0,"%"]})]}),t.jsx("div",{className:"w-full bg-gray-300 rounded-full h-3",children:t.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 h-3 rounded-full transition-all duration-500",style:{width:`${I.progress||0}%`}})})]}),I.status==="in_progress"&&(I.progress||0)<100&&t.jsxs("div",{className:"flex space-x-2",children:[t.jsx(pe,{onClick:()=>w(I.id,25),size:"sm",disabled:c[I.id],className:"bg-blue-600 hover:bg-blue-700 text-white disabled:opacity-50 font-medium",children:"+25% Progress"}),t.jsx(pe,{onClick:()=>w(I.id,50),size:"sm",disabled:c[I.id],className:"bg-blue-600 hover:bg-blue-700 text-white disabled:opacity-50 font-medium",children:"+50% Progress"}),t.jsx(pe,{onClick:()=>w(I.id,100-(I.progress||0)),size:"sm",disabled:c[I.id],className:"bg-green-600 hover:bg-green-700 text-white disabled:opacity-50 font-medium",children:"Complete (100%)"})]}),t.jsxs("div",{className:"flex space-x-3 pt-4",children:[I.status==="pending"&&t.jsxs(pe,{onClick:()=>y(I.id),disabled:c[I.id],className:"bg-orange-600 hover:bg-orange-700 text-white disabled:opacity-50 font-medium",children:[t.jsx(qd,{className:"w-4 h-4 mr-2"}),"Start Assembly"]}),I.status==="in_progress"&&t.jsxs(t.Fragment,{children:[t.jsxs(pe,{onClick:()=>C(I.id),variant:"outline",disabled:c[I.id],className:"border-2 border-amber-300 text-amber-700 hover:disabled:opacity-50 font-medium",children:[t.jsx(Dv,{className:"w-4 h-4 mr-2"}),"Pause"]}),(I.progress||0)>=100&&t.jsxs(pe,{onClick:()=>b(I.id),disabled:c[I.id],className:"bg-green-600 hover:bg-green-700 text-white disabled:opacity-50 font-medium",children:[t.jsx(dr,{className:"w-4 h-4 mr-2"}),"Complete & Test"]})]}),I.status==="paused"&&t.jsxs(pe,{onClick:()=>A(I.id),disabled:c[I.id],className:"bg-blue-600 hover:bg-blue-700 text-white disabled:opacity-50 font-medium",children:[t.jsx(qd,{className:"w-4 h-4 mr-2"}),"Resume Assembly"]})]})]})})]})},I.id)):H.length===0?t.jsx(He,{className:"bg-white border-2 border-gray-200 shadow-lg",children:t.jsxs(Ve,{className:"p-8 text-center",children:[t.jsx(Jo,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"No Completed Assembly Orders"}),t.jsx("p",{className:"text-gray-600",children:"Completed assembly orders will appear here."})]})}):H.map((I,X)=>t.jsx("div",{className:"opacity-100 translate-y-0",children:t.jsxs(He,{className:"bg-white border-2 border-gray-200 shadow-lg",children:[t.jsx(rt,{children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx(at,{className:"text-gray-900 text-xl font-bold",children:I.productName}),t.jsxs("p",{className:"text-gray-700 mt-1 font-medium",children:["Assembly Order #",I.id," | Production Order #",I.productionOrderId]}),t.jsxs("p",{className:"text-gray-700 mt-1 font-medium",children:["Quantity: ",I.quantity]}),t.jsxs("p",{className:"text-gray-600 text-sm font-medium",children:["Created: ",h.find(oe=>oe.productionOrderId===I.productionOrderId)?.createdAt||I.createdAt]}),I.startedAt&&t.jsxs("p",{className:"text-blue-700 text-sm font-medium",children:["Started: ",new Date(I.startedAt).toLocaleDateString()]}),I.completedAt&&t.jsxs("p",{className:"text-green-700 text-sm font-medium",children:["Completed: ",new Date(I.completedAt).toLocaleDateString()]})]}),t.jsx("div",{className:"flex flex-col items-end space-y-2",children:t.jsxs(Lt,{className:`${V(I.status)} font-bold`,children:[P(I.status),t.jsx("span",{className:"ml-1 capitalize",children:I.status?.replace("_"," ")||"Completed"})]})})]})}),t.jsx(Ve,{children:t.jsxs("div",{className:"flex items-center text-green-700 bg-green-50 border-2 border-green-200 px-4 py-2 rounded-lg",children:[t.jsx(dr,{className:"w-4 h-4 mr-2"}),t.jsx("span",{className:"font-bold",children:"Ready for Showroom"})]})})]})},I.id)),t.jsx("div",{className:"mt-12 bg-white border-2 border-gray-200 rounded-lg p-6 shadow-sm",children:t.jsxs("div",{className:"text-center text-gray-600",children:[t.jsx("p",{className:"font-medium",children:" Product Assembly Management System"}),t.jsx("p",{className:"text-sm mt-1",children:"For technical support, contact IT Department"})]})})]})})]})},_2=()=>{const e=Ls(),{user:r}=Ns(),[s,a]=T.useState([]),[n,o]=T.useState([]),[c,d]=T.useState({totalRevenue:0,totalExpenses:0,netProfit:0,recentTransactions:[],pendingApprovals:0}),[h,m]=T.useState(!0),[f,p]=T.useState(null),g=async()=>{try{const P=await fetch(`${Fe}/finance/purchase-orders`);if(!P.ok)throw new Error("Failed to fetch purchase orders");const k=await P.json();a(k)}catch(P){p("Failed to load purchase orders"),console.error("Error fetching purchase orders:",P)}},N=async()=>{try{const P=await fetch(`${Fe}/finance/dashboard`);if(!P.ok)throw new Error("Failed to fetch dashboard data");const k=await P.json();d(k)}catch(P){p("Failed to load dashboard data"),console.error("Error fetching dashboard data:",P)}},y=async()=>{try{const P=await fetch(`${Fe}/finance/sales-payments/pending`);if(!P.ok)throw new Error("Failed to fetch pending sales payments");const k=await P.json();o(k)}catch(P){console.error("Error fetching pending sales payments:",P)}},w=async()=>{m(!0),p(null);try{await Promise.all([g(),N(),y()])}catch{p("Failed to refresh data")}finally{m(!1)}};T.useEffect(()=>{w()},[]);const b=async(P,k)=>{try{const z=await fetch(`${Fe}/finance/purchase-orders/${P}/approve`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({approved:k})});if(!z.ok)throw new Error("Failed to process approval");const W=await z.json();await w(),dt({title:k?" Finance Approved":" Purchase Rejected",description:k?`Order #${P} approved and sent to store for processing.`:`Order #${P} has been rejected.`,variant:k?"default":"destructive"})}catch(z){dt({title:"Error",description:"Failed to process the approval. Please try again.",variant:"destructive"}),console.error("Error handling approval:",z)}},C=async(P,k)=>{try{if(!(await fetch(`${Fe}/finance/sales-payments/${P}/approve`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({approved:k})})).ok)throw new Error("Failed to update sales payment status");await w(),dt({title:k?"Payment Approved":"Payment Rejected",description:`Sales order #${P} has been ${k?"approved":"rejected"}.`})}catch(z){dt({title:"Error",description:"Failed to update payment status",variant:"destructive"}),console.error("Error approving sales payment:",z)}},A=P=>!P||!Array.isArray(P)?0:P.reduce((k,z)=>{const W=z.quantity||0,te=z.unit_cost||0;return k+W*te},0),[E,R]=T.useState(0),V=(s?.length||0)+(n?.length||0);return h?t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx(Cr,{className:"w-12 h-12 animate-spin mx-auto mb-4 text-blue-600"}),t.jsx("p",{className:"text-gray-800 text-lg font-medium",children:"Loading Finance dashboard..."}),t.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Please wait while we retrieve the data"})]})}):t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50",children:[t.jsx("div",{className:"max-w-7xl mx-auto bg-white shadow-md border-b-4 border-blue-800 rounded-b-lg",children:t.jsx("div",{className:"px-4 py-6 sm:px-6",children:t.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:justify-between sm:items-center sm:space-y-0",children:[t.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4",children:[t.jsxs(pe,{onClick:()=>e(r?.department==="admin"?"/dashboard/admin":"/dashboard"),variant:"outline",className:"border border-gray-300 bg-white text-gray-800 text-sm placeholder-gray-500",children:[t.jsx(qs,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-600 to-green-800 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx(An,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Finance Department"}),t.jsx("p",{className:"text-gray-600 text-sm sm:text-base font-medium",children:"Financial Management & Approval System"})]})]})]}),t.jsx("div",{className:"bg-gradient-to-r from-green-50 to-indigo-50 border-2 border-green-200 px-4 py-4 sm:px-6 rounded-lg shadow-sm w-full sm:w-auto",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(Nr,{className:"w-5 h-5 text-blue-600"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 text-xs font-medium",children:"Finance Team"}),t.jsx("p",{className:"text-green-600 text-xs font-medium",children:"Financial Management"})]})]})})]})})}),t.jsx("div",{className:"max-w-7xl mx-auto px-6 py-4",children:t.jsx(Rn,{className:"mb-4"})}),t.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8 sm:px-6",children:[t.jsxs("div",{className:"flex space-x-2 border-b border-green-200 mb-8",children:[t.jsxs("button",{className:`relative px-6 py-3 text-lg font-semibold focus:outline-none transition-colors border-b-4 ${E===0?"border-green-700 text-green-800 bg-white":"border-transparent text-gray-500 bg-green-50 hover:text-green-700"}`,onClick:()=>R(0),children:["Finance Approval",V>0&&t.jsx("span",{className:"absolute top-2 right-2 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:V})]}),t.jsx("button",{className:`px-6 py-3 text-lg font-semibold focus:outline-none transition-colors border-b-4 ${E===1?"border-green-700 text-green-800 bg-white":"border-transparent text-gray-500 bg-green-50 hover:text-green-700"}`,onClick:()=>R(1),children:"Financial Performance Overview"})]}),E===0?t.jsxs(t.Fragment,{children:[f&&t.jsx(He,{className:"mb-6 bg-red-50 border-2 border-red-200 shadow-lg",children:t.jsx(Ve,{className:"p-4",children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(Sr,{className:"w-5 h-5 text-red-600"}),t.jsx("span",{className:"text-red-700 font-medium",children:f})]})})}),s.length===0&&n.length===0&&t.jsx(He,{className:"bg-white border border-gray-300 shadow-sm",children:t.jsxs(Ve,{className:"p-8 text-center",children:[t.jsx(An,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"No Orders for Finance Approvals"}),t.jsx("p",{className:"text-gray-600",children:"All purchase orders and sales payments have been processed."})]})}),s.length>0&&t.jsxs(He,{className:"mb-8 bg-white border-2 border-gray-200 shadow-lg",children:[t.jsxs(rt,{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white",children:[t.jsxs(at,{className:"text-white flex items-center font-bold text-xl",children:[t.jsx(Ga,{className:"w-6 h-6 mr-3"}),"Purchase Orders Awaiting Approval (",s.length,")"]}),t.jsx("p",{className:"text-blue-100 text-sm font-medium mt-1",children:"Review and approve purchase requests"})]}),t.jsx(Ve,{className:"space-y-6 p-6",children:s.map(P=>t.jsxs(ds.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"p-6 bg-gray-50 border-2 border-gray-200 rounded-lg",children:[t.jsx("div",{className:"flex justify-between items-start mb-4",children:t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[t.jsxs("h3",{className:"font-bold text-gray-900 text-lg",children:["Order #",P.id," - ",P.productName]}),t.jsx("span",{className:"px-3 py-1 bg-amber-100 text-amber-800 text-sm font-medium rounded-full border border-amber-300",children:P.status.replace(/_/g," ").toUpperCase()})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[t.jsxs("div",{className:"text-gray-700",children:[t.jsx("span",{className:"font-bold",children:"Quantity:"})," ",P.quantity," units"]}),t.jsx("div",{className:"text-gray-700",children:t.jsxs("span",{className:"font-bold text-green-900",children:["Total Cost :  ",A(P.materials).toLocaleString()," "]})}),t.jsxs("div",{className:"flex items-center text-gray-700",children:[t.jsx(tn,{className:"w-4 h-4 mr-1"}),t.jsx("span",{className:"font-bold",children:"Created:"})," ",P.createdAt]})]})]})}),P.materials&&P.materials.length>0&&t.jsxs("div",{className:"mb-4 p-4 bg-white border-2 border-gray-200 rounded-lg",children:[t.jsx("p",{className:"text-sm font-bold text-gray-900 mb-3",children:"Required Materials:"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:P.materials.map((k,z)=>t.jsxs("div",{className:"flex justify-between text-sm bg-gray-50 p-2 rounded",children:[t.jsx("span",{className:"text-gray-900 font-medium",children:k.name}),t.jsxs("span",{className:"text-gray-700 font-medium",children:[k.quantity," units  ",k.unit_cost||0," = ",((k.quantity||0)*(k.unit_cost||0)).toLocaleString()]})]},z))})]}),t.jsxs("div",{className:"flex gap-4 pt-4 border-t border-gray-200",children:[t.jsxs(pe,{onClick:()=>b(P.id,!0),className:"bg-green-600 hover:bg-green-700 text-white font-medium px-6",children:[t.jsx(Lm,{className:"w-4 h-4 mr-2"}),"Approve Purchase"]}),t.jsxs(pe,{onClick:()=>b(P.id,!1),className:"bg-red-600 hover:bg-red-700 text-white font-medium px-6",children:[t.jsx(en,{className:"w-4 h-4 mr-2"}),"Reject Purchase"]})]})]},P.id))})]}),n.length>0&&t.jsxs(He,{className:"mb-8 bg-white border-2 border-gray-200 shadow-lg",children:[t.jsxs(rt,{className:"bg-gradient-to-r from-purple-600 to-purple-700 text-white",children:[t.jsxs(at,{className:"text-white flex items-center font-bold text-xl",children:[t.jsx(Ga,{className:"w-6 h-6 mr-3"}),"Sales Payments Awaiting Approval (",n.length,")"]}),t.jsx("p",{className:"text-purple-100 text-sm font-medium mt-1",children:"Review and approve sales payment requests"})]}),t.jsx(Ve,{className:"space-y-6 p-6",children:n.map(P=>t.jsxs(ds.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"p-6 bg-gray-50 border-2 border-gray-200 rounded-lg",children:[t.jsx("div",{className:"flex justify-between items-start mb-4",children:t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[t.jsxs("h3",{className:"font-bold text-gray-900 text-lg",children:["Sales Order ",P.orderNumber," - ",P.customerName]}),t.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 text-sm font-medium rounded-full border border-purple-300",children:P.paymentStatus.replace(/_/g," ").toUpperCase()})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[t.jsxs("div",{className:"text-gray-700",children:[t.jsx("span",{className:"font-bold",children:"Amount:"})," ",P.pendingApprovalAmount??P.finalAmount]}),t.jsxs("div",{className:"text-gray-700",children:[t.jsx("span",{className:"font-bold",children:"Product:"})," ",P.showroomProduct?.name]}),t.jsxs("div",{className:"flex items-center text-gray-700",children:[t.jsx(tn,{className:"w-4 h-4 mr-1"}),t.jsx("span",{className:"font-bold",children:"Requested:"})," ",P.createdAt]})]})]})}),t.jsxs("div",{className:"flex gap-4 pt-4 border-t border-gray-200",children:[t.jsxs(pe,{onClick:()=>C(P.id,!0),className:"bg-green-600 hover:bg-green-700 text-white font-medium px-6",children:[t.jsx(Lm,{className:"w-4 h-4 mr-2"}),"Approve Payment"]}),t.jsxs(pe,{onClick:()=>C(P.id,!1),className:"bg-red-600 hover:bg-red-700 text-white font-medium px-6",children:[t.jsx(en,{className:"w-4 h-4 mr-2"}),"Reject Payment"]})]})]},P.id))})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[t.jsx(He,{className:"bg-white border-2 border-gray-200 shadow-lg",children:t.jsx(Ve,{className:"p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Total Revenue"}),t.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["",c.totalRevenue.toLocaleString()]})]}),t.jsx(Cn,{className:"w-8 h-8 text-green-600"})]})})}),t.jsx(He,{className:"bg-white border-2 border-gray-200 shadow-lg",children:t.jsx(Ve,{className:"p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Total Expenses"}),t.jsxs("p",{className:"text-2xl font-bold text-red-600",children:["",c.totalExpenses.toLocaleString()]})]}),t.jsx(tk,{className:"w-8 h-8 text-red-600"})]})})}),t.jsx(He,{className:`${c.netProfit>=0?"bg-green-50 border-green-200":"bg-red-50 border-red-200"} border-2 shadow-lg`,children:t.jsx(Ve,{className:"p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Net Profit"}),t.jsxs("p",{className:`text-2xl font-bold ${c.netProfit>=0?"text-green-700":"text-red-700"}`,children:["",c.netProfit.toLocaleString()]})]}),t.jsx("span",{className:"text-3xl",children:""})]})})})]}),t.jsxs(He,{className:"bg-white border-2 border-gray-200 shadow-lg",children:[t.jsxs(rt,{className:"bg-gradient-to-r from-gray-700 to-gray-800 text-white",children:[t.jsxs(at,{className:"text-white text-xl font-bold flex items-center",children:[t.jsx(Ga,{className:"w-6 h-6 mr-3"}),"Financial Summary & Reports"]}),t.jsx("p",{className:"text-gray-200 text-sm font-medium mt-1",children:"Overall financial performance overview"})]}),t.jsx(Ve,{className:"p-8",children:t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center p-6 bg-green-50 border-2 border-green-200 rounded-lg",children:[t.jsx("span",{className:"font-bold text-gray-900 text-lg",children:"Total Revenue (from sold products)"}),t.jsxs("span",{className:"font-bold text-green-700 text-xl",children:["+ ",c.totalRevenue.toLocaleString()]})]}),t.jsxs("div",{className:"flex justify-between items-center p-6 bg-red-50 border-2 border-red-200 rounded-lg",children:[t.jsx("span",{className:"font-bold text-gray-900 text-lg",children:"Total Approved Expenses"}),t.jsxs("span",{className:"font-bold text-red-700 text-xl",children:["- ",c.totalExpenses.toLocaleString()]})]}),t.jsxs("div",{className:"flex justify-between items-center p-6 bg-blue-50 border-4 border-blue-300 rounded-lg shadow-lg",children:[t.jsx("span",{className:"font-bold text-2xl text-gray-900",children:"Net Profit"}),t.jsxs("span",{className:`font-bold text-2xl ${c.netProfit>=0?"text-green-700":"text-red-700"}`,children:["",c.netProfit.toLocaleString()]})]})]})})]})]}),t.jsx("div",{className:"mt-12 bg-white border-2 border-gray-200 rounded-lg p-6 shadow-sm",children:t.jsxs("div",{className:"text-center text-gray-600",children:[t.jsx("p",{className:"font-medium",children:" Financial Management & Approval System"}),t.jsx("p",{className:"text-sm mt-1",children:"For financial queries, contact Finance IT Support"})]})})]})]})},D2=Kt.createContext({open:!1,onOpenChange:()=>{}});function mr({open:e,onOpenChange:r,children:s}){return t.jsx(D2.Provider,{value:{open:e,onOpenChange:r},children:s})}function qo({children:e}){return e}function fr({children:e,className:r}){const{open:s}=Kt.useContext(D2);return s?t.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[t.jsx("div",{className:"fixed inset-0 bg-black/50"}),t.jsx("div",{className:"relative z-10 w-full max-w-2xl rounded-lg border border-border bg-background p-4 "+(r||""),children:e})]}):null}function xr({children:e}){return t.jsx("div",{className:"mb-2",children:e})}function pr({children:e}){return t.jsx("h3",{className:"text-lg font-semibold",children:e})}function Ar({children:e}){return t.jsx("p",{className:"text-sm text-muted-foreground",children:e})}function yr({children:e}){return t.jsx("div",{className:"mt-4 flex justify-end gap-2",children:e})}function v5(e){const[r,s]=T.useState(void 0);return Yi(()=>{if(e){s({width:e.offsetWidth,height:e.offsetHeight});const a=new ResizeObserver(n=>{if(!Array.isArray(n)||!n.length)return;const o=n[0];let c,d;if("borderBoxSize"in o){const h=o.borderBoxSize,m=Array.isArray(h)?h[0]:h;c=m.inlineSize,d=m.blockSize}else c=e.offsetWidth,d=e.offsetHeight;s({width:c,height:d})});return a.observe(e,{box:"border-box"}),()=>a.unobserve(e)}else s(void 0)},[e]),r}function y5(e){const r=T.useRef({value:e,previous:e});return T.useMemo(()=>(r.current.value!==e&&(r.current.previous=r.current.value,r.current.value=e),r.current.previous),[e])}var wx="Radio",[N5,O2]=Ql(wx),[w5,b5]=N5(wx),F2=T.forwardRef((e,r)=>{const{__scopeRadio:s,name:a,checked:n=!1,required:o,disabled:c,value:d="on",onCheck:h,form:m,...f}=e,[p,g]=T.useState(null),N=za(r,b=>g(b)),y=T.useRef(!1),w=p?m||!!p.closest("form"):!0;return t.jsxs(w5,{scope:s,checked:n,disabled:c,children:[t.jsx(es.button,{type:"button",role:"radio","aria-checked":n,"data-state":B2(n),"data-disabled":c?"":void 0,disabled:c,value:d,...f,ref:N,onClick:Or(e.onClick,b=>{n||h?.(),w&&(y.current=b.isPropagationStopped(),y.current||b.stopPropagation())})}),w&&t.jsx(L2,{control:p,bubbles:!y.current,name:a,value:d,checked:n,required:o,disabled:c,form:m,style:{transform:"translateX(-100%)"}})]})});F2.displayName=wx;var I2="RadioIndicator",M2=T.forwardRef((e,r)=>{const{__scopeRadio:s,forceMount:a,...n}=e,o=b5(I2,s);return t.jsx(Lu,{present:a||o.checked,children:t.jsx(es.span,{"data-state":B2(o.checked),"data-disabled":o.disabled?"":void 0,...n,ref:r})})});M2.displayName=I2;var j5="RadioBubbleInput",L2=T.forwardRef(({__scopeRadio:e,control:r,checked:s,bubbles:a=!0,...n},o)=>{const c=T.useRef(null),d=za(c,o),h=y5(s),m=v5(r);return T.useEffect(()=>{const f=c.current;if(!f)return;const p=window.HTMLInputElement.prototype,N=Object.getOwnPropertyDescriptor(p,"checked").set;if(h!==s&&N){const y=new Event("click",{bubbles:a});N.call(f,s),f.dispatchEvent(y)}},[h,s,a]),t.jsx(es.input,{type:"radio","aria-hidden":!0,defaultChecked:s,...n,tabIndex:-1,ref:d,style:{...n.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});L2.displayName=j5;function B2(e){return e?"checked":"unchecked"}var E5=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],t0="RadioGroup",[T5,V5]=Ql(t0,[qu,O2]),H2=qu(),V2=O2(),[S5,A5]=T5(t0),U2=T.forwardRef((e,r)=>{const{__scopeRadioGroup:s,name:a,defaultValue:n,value:o,required:c=!1,disabled:d=!1,orientation:h,dir:m,loop:f=!0,onValueChange:p,...g}=e,N=H2(s),y=zf(m),[w,b]=Bu({prop:o,defaultProp:n??null,onChange:p,caller:t0});return t.jsx(S5,{scope:s,name:a,required:c,disabled:d,value:w,onValueChange:b,children:t.jsx(kb,{asChild:!0,...N,orientation:h,dir:y,loop:f,children:t.jsx(es.div,{role:"radiogroup","aria-required":c,"aria-orientation":h,"data-disabled":d?"":void 0,dir:y,...g,ref:r})})})});U2.displayName=t0;var $2="RadioGroupItem",G2=T.forwardRef((e,r)=>{const{__scopeRadioGroup:s,disabled:a,...n}=e,o=A5($2,s),c=o.disabled||a,d=H2(s),h=V2(s),m=T.useRef(null),f=za(r,m),p=o.value===n.value,g=T.useRef(!1);return T.useEffect(()=>{const N=w=>{E5.includes(w.key)&&(g.current=!0)},y=()=>g.current=!1;return document.addEventListener("keydown",N),document.addEventListener("keyup",y),()=>{document.removeEventListener("keydown",N),document.removeEventListener("keyup",y)}},[]),t.jsx(Pb,{asChild:!0,...d,focusable:!c,active:p,children:t.jsx(F2,{disabled:c,required:o.required,checked:p,...h,...n,name:o.name,ref:f,onCheck:()=>o.onValueChange(n.value),onKeyDown:Or(N=>{N.key==="Enter"&&N.preventDefault()}),onFocus:Or(n.onFocus,()=>{g.current&&m.current?.click()})})})});G2.displayName=$2;var C5="RadioGroupIndicator",W2=T.forwardRef((e,r)=>{const{__scopeRadioGroup:s,...a}=e,n=V2(s);return t.jsx(M2,{...n,...a,ref:r})});W2.displayName=C5;var z2=U2,K2=G2,k5=W2;const X2=T.forwardRef(({className:e,...r},s)=>t.jsx(z2,{className:Pr("grid gap-2",e),...r,ref:s}));X2.displayName=z2.displayName;const hf=T.forwardRef(({className:e,...r},s)=>t.jsx(K2,{ref:s,className:Pr("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...r,children:t.jsx(k5,{className:"flex items-center justify-center",children:t.jsx(YC,{className:"h-2.5 w-2.5 fill-current text-current"})})}));hf.displayName=K2.displayName;const q2=()=>{const{user:e}=Ns(),r=Ls(),[s,a]=T.useState([]),[n,o]=T.useState([]),[c,d]=T.useState(!0),[h,m]=T.useState(null),[f,p]=T.useState(0),[g,N]=T.useState(!1),[y,w]=T.useState(null),[b,C]=T.useState({}),A=[{id:"UT",name:"Unit Testing",description:"Individual component functionality tests",icon:Yh},{id:"IT",name:"Integration Testing",description:"Component interaction tests",icon:ek},{id:"ST",name:"System Testing",description:"Complete system functionality tests",icon:yn},{id:"AT",name:"Acceptance Testing",description:"User acceptance and requirements validation",icon:Nr}],E=async()=>{d(!0),m(null);try{console.log("Fetching completed assembly products...");const X=await fetch(`${Fe}/assembly/completed`);if(!X.ok)throw new Error(`Assembly API error: ${X.status} ${X.statusText}`);const oe=await X.json();console.log("Assembly data received:",oe),a(oe),console.log("Fetching displayed showroom products from sales...");const xe=await fetch(`${Fe}/sales/showroom/available`);if(!xe.ok)throw new Error(`Sales Showroom API error: ${xe.status} ${xe.statusText}`);const he=await xe.json();console.log("Sales Showroom data received:",he),o(he)}catch(X){console.error("Error fetching data:",X),m(X.message),dt({title:"Error Loading Data",description:X.message,variant:"destructive"})}finally{d(!1)}};T.useEffect(()=>{E()},[]);const R=X=>{w(X),N(!0)},V=()=>{N(!1),w(null)},P=(X,oe,xe)=>{C(he=>({...he,[X]:{...he[X],[oe]:xe}}))},k=X=>{const oe=b[X];return oe?A.every(xe=>oe[xe.id]==="pass"):!1},z=X=>{const oe=b[X];return oe?A.filter(he=>oe[he.id]&&oe[he.id]!=="").length:0},W=X=>{if(!X)return;const oe={};for(const[xe,he]of Object.entries(X))oe[xe]=he==="pass";return oe},te=async X=>{if(!k(X)){dt({title:"Testing Required",description:"All tests (UT, IT, ST, AT) must be completed and passed before adding to showroom.",variant:"destructive"});return}try{console.log("Adding product to showroom:",X);const oe=await fetch(`${Fe}/showroom/add`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({product_id:X,test_results:W(b[X])})}),xe=await oe.json();console.log("Add to showroom response:",xe),oe.ok?(a(he=>he.filter(F=>F.id!==X)),o(he=>[...he,xe]),dt({title:" Product Added to Showroom!",description:`${xe.productName} is now displayed in the showroom.`})):xe.failedTests?(dt({title:"Product Sent Back to Assembly",description:`Product sent back due to failed tests: ${xe.failedTests.join(", ")}`,variant:"destructive"}),E()):dt({title:"Error",description:xe.message||"Failed to add product to showroom",variant:"destructive"})}catch(oe){console.error("Error adding to showroom:",oe),dt({title:"Error",description:"Failed to add product to showroom. Please check your connection.",variant:"destructive"})}},de=async X=>{try{console.log("Sending product back to assembly:",X);const oe=await fetch(`${Fe}/showroom/send-back`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({product_id:X,test_results:W(b[X]),reason:"Failed showroom testing"})}),xe=await oe.json();console.log("Send back to assembly response:",xe),oe.ok?(a(he=>he.filter(F=>F.id!==X)),dt({title:" Product Sent Back to Assembly",description:xe.message||`${xe.productName||"Product"} has been sent back for rework due to testing failures.`}),E()):dt({title:"Error",description:xe.message||"Failed to send product back to assembly",variant:"destructive"})}catch(oe){console.error("Error sending back to assembly:",oe),dt({title:"Error",description:"Failed to send product back to assembly. Please check your connection.",variant:"destructive"})}},H=X=>{switch(X){case"available":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-700"}},ue=X=>{switch(X){case"available":return t.jsx(ni,{className:"w-3 h-3"});default:return t.jsx(Ks,{className:"w-3 h-3"})}};if(c)return t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx(Cr,{className:"w-12 h-12 animate-spin mx-auto mb-4 text-blue-600"}),t.jsx("p",{className:"text-gray-800 text-lg font-medium",children:"Loading Showroom dashboard..."}),t.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Please wait while we retrieve the data"})]})});if(h)return t.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:t.jsx(He,{className:"bg-white border border-red-300 shadow-sm p-8 max-w-md",children:t.jsxs(Ve,{className:"text-center",children:[t.jsx(Sr,{className:"w-12 h-12 text-red-600 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"System Error"}),t.jsx("p",{className:"text-gray-600 mb-4",children:h}),t.jsx(pe,{onClick:()=>window.location.reload(),className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Reload System"})]})})});const I=s.length;return t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50",children:[t.jsx("div",{className:"max-w-7xl mx-auto bg-white shadow-md border-b-4 border-green-800 rounded-b-lg",children:t.jsx("div",{className:"px-4 sm:px-6 py-4 sm:py-6",children:t.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:justify-between sm:items-center sm:space-y-0",children:[t.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4",children:[t.jsxs(pe,{onClick:()=>r(e?.department==="admin"?"/dashboard/admin":"/dashboard"),variant:"outline",className:"border border-gray-300 bg-white text-gray-800 text-sm placeholder-gray-500 w-full sm:w-auto",children:[t.jsx(qs,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-600 to-green-800 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx(Il,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Showroom Department"}),t.jsx("p",{className:"text-gray-600 text-sm sm:text-base font-medium",children:"Product Display Management System"})]})]})]}),t.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 px-4 py-4 sm:px-6 rounded-lg shadow-sm w-full sm:w-auto",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(Nr,{className:"w-5 h-5 text-blue-600"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 text-xs font-medium",children:"Showroom Team"}),t.jsx("p",{className:"text-blue-600 text-xs font-medium",children:"Product Display Management"})]})]})})]})})}),t.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-4",children:[t.jsx(Rn,{className:"mb-4"}),t.jsx("div",{className:"max-w-7xl mx-auto px-6",children:t.jsxs("div",{className:"flex space-x-2 border-b border-blue-200 mb-8",children:[t.jsxs("button",{className:`relative px-6 py-3 text-lg font-semibold focus:outline-none transition-colors border-b-4 ${f===0?"border-blue-700 text-blue-800 bg-white":"border-transparent text-gray-500 bg-blue-50 hover:text-blue-700"}`,onClick:()=>p(0),children:["Products Ready for Showroom",I>0&&t.jsx("span",{className:"absolute top-2 right-2 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:I})]}),t.jsx("button",{className:`px-6 py-3 text-lg font-semibold focus:outline-none transition-colors border-b-4 ${f===1?"border-blue-700 text-blue-800 bg-white":"border-transparent text-gray-500 bg-blue-50 hover:text-blue-700"}`,onClick:()=>p(1),children:"Products on Display"})]})}),f===0?t.jsx("div",{className:"px-6 mb-8",children:t.jsxs("div",{className:"bg-white border border-gray-300 rounded-sm shadow-sm",children:[t.jsxs("div",{className:"border-b border-gray-200 bg-gray-50 px-6 py-4",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Products Ready for Showroom"}),t.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Products ready for testing and showroom display"})]}),t.jsx("div",{className:"p-6",children:t.jsx("div",{className:"space-y-4",children:s.length===0?t.jsxs("div",{className:"text-center py-12 border-2 border-dashed border-gray-300 rounded-sm",children:[t.jsx(Ks,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),t.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"No Products Available"}),t.jsx("p",{className:"text-gray-600",children:c?"Loading products...":"Completed products from assembly will appear here."}),!c&&t.jsx("p",{className:"text-gray-500 text-sm mt-2",children:'Ensure assembly orders are marked as "completed" to display them here.'})]}):s.map((X,oe)=>t.jsx("div",{children:t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsx(rt,{className:"bg-gray-50 border-b border-gray-200",children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx(at,{className:"text-gray-800 text-lg font-semibold",children:X.productName}),t.jsxs("div",{className:"mt-2 space-y-1",children:[t.jsxs("p",{className:"text-gray-600 text-sm",children:[t.jsx("span",{className:"font-medium",children:"Quantity:"})," ",X.quantity," units"]}),t.jsxs("p",{className:"text-gray-600 text-sm",children:[t.jsx("span",{className:"font-medium",children:"Assembly Order:"})," #",X.id]}),t.jsxs("p",{className:"text-gray-600 text-sm",children:[t.jsx("span",{className:"font-medium",children:"Completed:"})," ",new Date(X.completedAt).toLocaleDateString()]})]})]}),t.jsxs(Lt,{className:"bg-green-100 text-green-800 border border-green-300",children:[t.jsx(dr,{className:"w-3 h-3 mr-1"}),"Assembly Complete"]})]})}),t.jsxs(Ve,{className:"p-6",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("span",{className:"text-gray-700 text-sm font-medium",children:"Testing Status:"}),t.jsxs("span",{className:"text-gray-600 text-sm",children:[z(X.id),"/",A.length," Tests Completed"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-sm h-3 mb-3",children:t.jsx("div",{className:`h-3 rounded-sm transition-all duration-300 ${k(X.id)?"bg-green-600":z(X.id)>0?"bg-yellow-500":"bg-gray-300"}`,style:{width:`${z(X.id)/A.length*100}%`}})}),t.jsx("div",{className:"grid grid-cols-4 gap-2",children:A.map(xe=>{const he=xe.icon,F=b[X.id]?.[xe.id]||"",ee=F==="pass",M=F==="fail";return t.jsxs("div",{className:`text-center p-2 rounded-sm border ${ee?"bg-green-50 border-green-300":M?"bg-red-50 border-red-300":"bg-gray-50 border-gray-300"}`,children:[t.jsx(he,{className:`w-4 h-4 mx-auto mb-1 ${ee?"text-green-600":M?"text-red-700":"text-gray-400"}`}),t.jsx("span",{className:`text-xs font-medium ${ee?"text-green-700":M?"text-red-700":"text-gray-500"}`,children:xe.id}),ee&&t.jsx("div",{className:"text-green-600 text-xs mt-1",children:""}),M&&t.jsx("div",{className:"text-red-600 text-xs mt-1",children:""})]},xe.id)})})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsxs(pe,{onClick:()=>R(X),variant:"outline",className:"flex-1 border-blue-300 text-blue-700 hover:bg-blue",children:[t.jsx(Yh,{className:"w-4 h-4 mr-2"}),"Conduct Tests"]}),t.jsxs(pe,{onClick:()=>te(X.id),className:`flex-1 ${k(X.id)?"bg-green-600 hover:bg-green-700 text-white":"bg-gray-400 text-gray-600 cursor-not-allowed"}`,disabled:!k(X.id)||n.some(xe=>xe.productionOrderId===X.productionOrderId),children:[t.jsx(Il,{className:"w-4 h-4 mr-2"}),n.some(xe=>xe.productionOrderId===X.productionOrderId)?"In Showroom":k(X.id)?"Add to Showroom":"Testing Required"]}),z(X.id)>0&&!k(X.id)&&t.jsxs(pe,{onClick:()=>de(X.id),variant:"outline",className:"flex-1 border-red-300 text-red-700 hover:bg-red-50",children:[t.jsx(qs,{className:"w-4 h-4 mr-2"}),"Send Back to Assembly"]})]})]})]})},X.id))})})]})}):t.jsx("div",{className:"px-6 mb-8",children:t.jsxs("div",{className:"bg-white border border-gray-300 rounded-sm shadow-sm",children:[t.jsxs("div",{className:"border-b border-gray-200 bg-gray-50 px-6 py-4",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Products on Display"}),t.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Products currently on display for customers"})]}),t.jsx("div",{className:"p-6",children:t.jsx("div",{className:"space-y-4",children:n.length===0?t.jsxs("div",{className:"text-center py-12 border-2 border-dashed border-gray-300 rounded-sm",children:[t.jsx(Il,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),t.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"No Products on Display"}),t.jsx("p",{className:"text-gray-600",children:"Complete product testing to add items to the showroom display."})]}):n.map((X,oe)=>t.jsx("div",{children:t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsx(rt,{className:"bg-blue-50 border-b border-gray-200",children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx(at,{className:"text-gray-800 text-lg font-semibold",children:X.name||X.productName}),t.jsxs("div",{className:"mt-2 space-y-1",children:[t.jsxs("p",{className:"text-gray-600 text-sm",children:[t.jsx("span",{className:"font-medium",children:"Total Quantity:"})," ",X.original_qty," units"]}),t.jsxs("p",{className:"text-gray-600 text-sm",children:[t.jsx("span",{className:"font-medium",children:"Remaining Quantity:"})," ",X.quantity," units"]}),X.customerInterest&&t.jsxs("p",{className:"text-gray-600 text-sm",children:[t.jsx("span",{className:"font-medium",children:"Customer Interest:"})," ",X.customerInterest,"/10",t.jsx("span",{className:"font-medium",children:"Customer Interest:"})," ",X.customerInterest,"/10"]}),t.jsxs("p",{className:"text-gray-600 text-sm",children:[t.jsx("span",{className:"font-medium",children:"Display Date:"})," ",new Date(X.displayedAt).toLocaleDateString()]})]})]}),t.jsxs(Lt,{className:`${H(X.showroomStatus)} border`,children:[ue(X.showroomStatus),t.jsx("span",{className:"ml-1 capitalize",children:X.showroomStatus||"available"})]})]})}),t.jsx(Ve,{className:"p-6",children:t.jsx("div",{className:"flex justify-between items-center",children:(X.showroomStatus==="available"||!X.showroomStatus)&&t.jsx("div",{className:"text-right",children:t.jsx("p",{children:t.jsxs(Lt,{className:"bg-green-100 text-green-800 border border-green-300",children:[t.jsx(ni,{className:"w-3 h-3 mr-1"}),"On Display and Ready for Sales"]})})})})})]})},`showroom-${X.id}`))})})]})}),t.jsx(mr,{open:g,onOpenChange:N,children:t.jsxs(fr,{className:"max-w-lg max-h-[80vh] overflow-y-auto bg-white",children:[t.jsxs(xr,{className:"border-b border-gray-200 pb-4",children:[t.jsxs(pr,{className:"flex items-center gap-2 text-lg text-gray-800",children:[t.jsx("div",{className:"bg-blue-100 p-1 rounded-sm",children:t.jsx(Yh,{className:"w-4 h-4 text-blue-700"})}),"Product Testing Protocol"]}),t.jsxs(Ar,{className:"text-sm text-gray-600 mt-2",children:[t.jsx("strong",{children:"Product:"})," ",y?.productName,t.jsx("br",{}),"Complete all mandatory tests before showroom approval."]})]}),t.jsx("div",{className:"space-y-3 py-4",children:y&&A.map(X=>{const oe=X.icon,xe=b[y.id]?.[X.id]||"",he=xe==="pass",F=xe==="fail";return t.jsx("div",{className:`p-4 border rounded-sm ${he?"bg-green-50 border-green-300":F?"bg-red-50 border-red-300":"bg-gray-50 border-gray-300"}`,children:t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("div",{className:`p-2 rounded-sm ${he?"bg-green-100":F?"bg-red-100":"bg-gray-100"}`,children:t.jsx(oe,{className:`w-4 h-4 ${he?"text-green-700":F?"text-red-700":"text-gray-500"}`})}),t.jsxs("div",{className:"flex-1",children:[t.jsxs(Q,{className:`font-medium text-sm ${he?"text-green-800":F?"text-red-800":"text-gray-700"}`,children:[X.name," (",X.id,")"]}),t.jsx("p",{className:"text-xs text-gray-600 mt-1",children:X.description}),t.jsxs(X2,{value:xe,onValueChange:ee=>P(y.id,X.id,ee),className:"flex space-x-4 mt-2",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(hf,{value:"pass",id:`pass-${X.id}`}),t.jsx(Q,{htmlFor:`pass-${X.id}`,className:"text-sm text-green-700 font-medium",children:"Pass"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(hf,{value:"fail",id:`fail-${X.id}`}),t.jsx(Q,{htmlFor:`fail-${X.id}`,className:"text-sm text-red-700 font-medium",children:"Fail"})]})]})]}),he&&t.jsx(Lt,{className:"bg-green-600 text-white text-xs px-2 py-1 border-0",children:"PASSED"}),F&&t.jsx(Lt,{className:"bg-red-600 text-white text-xs px-2 py-1 border-0",children:"FAILED"})]})},X.id)})}),t.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Testing Progress:"}),t.jsxs("span",{className:"text-sm text-gray-600",children:[y?z(y.id):0,"/",A.length," Tests Completed"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-sm h-3",children:t.jsx("div",{className:`h-3 rounded-sm transition-all duration-300 ${y&&k(y.id)?"bg-green-600":y&&z(y.id)>0?"bg-yellow-500":"bg-gray-300"}`,style:{width:y?`${z(y.id)/A.length*100}%`:"0%"}})}),y&&k(y.id)&&t.jsxs("div",{className:"flex items-center gap-2 mt-3 p-3 bg-green-50 border border-green-300 rounded-sm",children:[t.jsx(dr,{className:"w-4 h-4 text-green-600"}),t.jsx("span",{className:"text-sm font-medium text-green-800",children:"All tests completed successfully. Product approved for showroom display."})]})]}),t.jsxs(yr,{className:"gap-3 pt-4 border-t border-gray-200",children:[t.jsx(pe,{variant:"outline",onClick:V,className:"border-gray-300 text-gray-400",children:"Cancel"}),y&&k(y.id)&&t.jsxs(pe,{onClick:()=>{te(y.id),V()},className:"bg-green-600 hover:bg-green-700 text-white",children:[t.jsx(Il,{className:"w-4 h-4 mr-2"}),"Approve for Showroom"]})]})]})}),t.jsx("div",{className:"mt-12 bg-white border-2 border-gray-200 rounded-lg p-6 shadow-sm",children:t.jsxs("div",{className:"text-center text-gray-600",children:[t.jsx("p",{className:"font-medium",children:" Product Display Management System"}),t.jsx("p",{className:"text-sm mt-1",children:"For technical support, contact IT Department"})]})})]})]})},vr=Kt.forwardRef(({className:e,...r},s)=>t.jsx("textarea",{ref:s,className:Pr("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...r}));vr.displayName="Textarea";function zr({children:e}){return t.jsx("table",{className:"w-full text-sm text-left text-foreground/90",children:e})}function Kr({children:e}){return t.jsx("thead",{className:"text-xs uppercase text-foreground/60",children:e})}function Xr({children:e}){return t.jsx("tbody",{className:"divide-y divide-border/40",children:e})}function At({children:e,className:r}){return t.jsx("tr",{className:r,children:e})}function Pe({children:e,className:r}){return t.jsx("th",{className:r+" px-4 py-3",children:e})}function be({children:e,className:r}){return t.jsx("td",{className:r+" px-4 py-3",children:e})}const Y2=({salesPerson:e=null,isAdmin:r=!1})=>{const[s,a]=T.useState(null),[n,o]=T.useState(!0),[c,d]=T.useState(null),[h,m]=T.useState(new Date().getFullYear()),[f,p]=T.useState(new Date().getMonth()+1),[g,N]=T.useState([]),[y,w]=T.useState([]),[b,C]=T.useState(null),[A,E]=T.useState(null),[R,V]=T.useState(!1),P=r?null:e||localStorage.getItem("username"),[k,z]=T.useState(P);T.useEffect(()=>{r&&W()},[r]);const W=async()=>{try{V(!0);const G=await fetch(`${Fe}/auth/users-by-department?department=sales`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(G.ok){const ie=await G.json();w(ie.users||[])}}catch(G){console.error("Error loading sales users:",G)}finally{V(!1)}};T.useEffect(()=>{if(k&&y.length>0){const G=y.find(ie=>ie.username===k);E(G?G.fullName:null)}},[k,y]),T.useEffect(()=>{te(),de()},[h,f,k]);const te=async()=>{if(!k){d("No salesperson specified"),o(!1);return}try{o(!0),d(null);const G=await fetch(`${Fe}/sales/dashboard?salesPerson=${encodeURIComponent(k)}&year=${h}&month=${f}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!G.ok)throw new Error("Failed to load dashboard");const ie=await G.json();a(ie)}catch(G){console.error("Error loading dashboard:",G),d(G.message)}finally{o(!1)}},de=async()=>{if(k)try{const G=await fetch(`${Fe}/sales/targets/all?salesPerson=${encodeURIComponent(k)}&year=${h}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(G.ok){const ie=await G.json();N(ie.targets||[])}}catch(G){console.error("Error loading all targets:",G)}},H=()=>{te()},ue=G=>{switch(G){case"on_track":return"bg-green-100 text-green-800 border-green-300";case"progressing":return"bg-blue-100 text-blue-800 border-blue-300";case"at_risk":return"bg-red-100 text-red-800 border-red-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}},I=G=>{switch(G){case"on_track":return t.jsx(dr,{className:"w-5 h-5 text-green-600"});case"progressing":return t.jsx(Cn,{className:"w-5 h-5 text-blue-600"});case"at_risk":return t.jsx(Sr,{className:"w-5 h-5 text-red-600"});default:return t.jsx(Yo,{className:"w-5 h-5 text-gray-600"})}},X=G=>G>=100?"bg-gradient-to-r from-green-400 to-green-600":G>=75?"bg-gradient-to-r from-blue-400 to-blue-600":G>=50?"bg-gradient-to-r from-yellow-400 to-yellow-600":"bg-gradient-to-r from-red-400 to-red-600";if(n)return t.jsx("div",{className:"flex items-center justify-center py-20",children:t.jsxs("div",{className:"text-center",children:[t.jsx(Cr,{className:"w-12 h-12 animate-spin mx-auto mb-4 text-blue-600"}),t.jsx("p",{className:"text-gray-800 text-lg font-medium",children:"Loading performance data..."})]})});if(!k&&r&&!R)return t.jsxs("div",{className:"space-y-6",children:[t.jsxs(He,{className:"bg-purple-50 border-purple-200",children:[t.jsxs(rt,{children:[t.jsxs(at,{className:"flex items-center gap-2 text-purple-900",children:[t.jsx(Nr,{className:"w-5 h-5"}),"Select Salesperson"]}),t.jsx(gr,{className:"text-purple-700",children:"Choose a salesperson to view their performance dashboard"})]}),t.jsx(Ve,{children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Salesperson"}),t.jsxs("select",{value:k||"",onChange:G=>{const ie=G.target.value;z(ie),C(ie);const Me=y.find(Ee=>Ee.username===ie);E(Me?Me.fullName:null)},disabled:R,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent disabled:bg-gray-100",children:[t.jsx("option",{value:"",children:"-- Select a salesperson --"}),y.map(G=>t.jsxs("option",{value:G.username,children:[G.fullName," (",G.username,")"]},G.id))]})]})})})]}),t.jsx(He,{className:"bg-blue-50 border-blue-300 border-2",children:t.jsx(Ve,{className:"pt-6",children:t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx(Sr,{className:"h-6 w-6 text-blue-600 mt-0.5 flex-shrink-0"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-blue-900 font-semibold mb-2",children:"No Salesperson Selected"}),t.jsx("p",{className:"text-blue-800 text-sm",children:"Please select a salesperson from the dropdown above to view their performance dashboard."})]})]})})})]});if(c)return t.jsxs("div",{className:"space-y-6",children:[r&&t.jsxs(He,{className:"bg-purple-50 border-purple-200",children:[t.jsxs(rt,{children:[t.jsxs(at,{className:"flex items-center gap-2 text-purple-900",children:[t.jsx(Nr,{className:"w-5 h-5"}),"Select Salesperson"]}),t.jsx(gr,{className:"text-purple-700",children:"Choose a salesperson to view their performance dashboard"})]}),t.jsx(Ve,{children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Salesperson"}),t.jsxs("select",{value:k||"",onChange:G=>{const ie=G.target.value;z(ie),C(ie);const Me=y.find(Ee=>Ee.username===ie);E(Me?Me.fullName:null)},disabled:R,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent disabled:bg-gray-100",children:[t.jsx("option",{value:"",children:"-- Select a salesperson --"}),y.map(G=>t.jsxs("option",{value:G.username,children:[G.fullName," (",G.username,")"]},G.id))]})]})})})]}),t.jsx(He,{className:"bg-red-50 border-red-300 border-2 mb-6",children:t.jsx(Ve,{className:"pt-6",children:t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx(Sr,{className:"h-6 w-6 text-red-600 mt-0.5 flex-shrink-0"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-red-900 font-semibold mb-2",children:"Error Loading Dashboard"}),t.jsx("p",{className:"text-red-800 text-sm mb-4",children:c}),t.jsx(pe,{onClick:H,className:"bg-red-600 hover:bg-red-700",size:"sm",children:"Retry"})]})]})})})]});if(!s)return t.jsxs("div",{className:"space-y-6",children:[r&&t.jsxs(He,{className:"bg-purple-50 border-purple-200",children:[t.jsxs(rt,{children:[t.jsxs(at,{className:"flex items-center gap-2 text-purple-900",children:[t.jsx(Nr,{className:"w-5 h-5"}),"Select Salesperson"]}),t.jsx(gr,{className:"text-purple-700",children:"Choose a salesperson to view their performance dashboard"})]}),t.jsx(Ve,{children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Salesperson"}),t.jsxs("select",{value:k||"",onChange:G=>{const ie=G.target.value;z(ie),C(ie);const Me=y.find(Ee=>Ee.username===ie);E(Me?Me.fullName:null)},disabled:R,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent disabled:bg-gray-100",children:[t.jsx("option",{value:"",children:"-- Select a salesperson --"}),y.map(G=>t.jsxs("option",{value:G.username,children:[G.fullName," (",G.username,")"]},G.id))]})]})})})]}),t.jsx(He,{className:"bg-blue-50 border-blue-300 border-2 mb-6",children:t.jsx(Ve,{className:"pt-6",children:t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx(Sr,{className:"h-6 w-6 text-blue-600 mt-0.5 flex-shrink-0"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-blue-900 font-semibold mb-2",children:"No Data Available"}),t.jsx("p",{className:"text-blue-800 text-sm",children:"No performance data found for this period. Please check your targets and orders."})]})]})})})]});const{target:oe,achieved:xe,remaining:he,exceeded:F,daysMetrics:ee,dailyAverage:M,status:_,monthName:ne}=s,ae=Math.min(xe.percentage||0,100);return t.jsxs("div",{className:"space-y-6",children:[r&&t.jsxs(He,{className:"bg-purple-50 border-purple-200",children:[t.jsxs(rt,{children:[t.jsxs(at,{className:"flex items-center gap-2 text-purple-900",children:[t.jsx(Nr,{className:"w-5 h-5"}),"Select Salesperson"]}),t.jsx(gr,{className:"text-purple-700",children:"Choose a salesperson to view their performance dashboard"})]}),t.jsx(Ve,{children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Salesperson"}),t.jsxs("select",{value:k||"",onChange:G=>{const ie=G.target.value;z(ie),C(ie);const Me=y.find(Ee=>Ee.username===ie);E(Me?Me.fullName:null)},disabled:R,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent disabled:bg-gray-100",children:[t.jsx("option",{value:"",children:"-- Select a salesperson --"}),y.map(G=>t.jsxs("option",{value:G.username,children:[G.fullName," (",G.username,")"]},G.id))]})]})})})]}),t.jsx(He,{className:"bg-gradient-to-r from-blue-600 to-indigo-600 border-0 shadow-lg",children:t.jsx(rt,{className:"text-white",children:t.jsxs("div",{className:"flex items-center justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx(at,{className:"text-3xl text-white mb-2",children:A||k}),t.jsxs(gr,{className:"text-blue-100 text-lg",children:[ne," ",h," Sales Performance"]})]}),t.jsx("div",{className:`px-4 py-3 rounded-lg border-2 ${ue(_)}`,children:t.jsxs("div",{className:"flex items-center gap-2",children:[I(_),t.jsx("span",{className:"font-bold capitalize text-center",children:_.replace("_"," ")})]})})]})})}),t.jsxs(He,{className:"shadow-md",children:[t.jsx(rt,{className:"bg-gray-50 border-b border-gray-200",children:t.jsxs(at,{className:"text-gray-900 flex items-center gap-2",children:[t.jsx(tn,{className:"w-5 h-5 text-blue-600"}),"Select Period"]})}),t.jsx(Ve,{className:"bg-white pt-6",children:t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Year"}),t.jsx("select",{value:h,onChange:G=>m(Number(G.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-800 bg-white",children:Array.from({length:5},(G,ie)=>new Date().getFullYear()-2+ie).map(G=>t.jsx("option",{value:G,children:G},G))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Month"}),t.jsx("select",{value:f,onChange:G=>p(Number(G.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-gray-800 bg-white",children:Array.from({length:12},(G,ie)=>ie+1).map(G=>t.jsx("option",{value:G,children:new Date(2024,G-1).toLocaleString("default",{month:"long"})},G))})]})]})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsx(ds.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:t.jsxs(He,{className:"bg-white border-l-4 border-blue-600 hover:shadow-lg transition-shadow",children:[t.jsx(rt,{className:"pb-3 bg-blue-50",children:t.jsxs(at,{className:"flex items-center gap-2 text-blue-900 text-base font-semibold",children:[t.jsx(Yo,{className:"w-5 h-5 text-blue-600"}),t.jsx("span",{children:"Monthly Target"})]})}),t.jsxs(Ve,{className:"pt-4",children:[t.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:["",(oe.amount||0).toLocaleString("en-IN")]}),t.jsx("p",{className:"text-xs text-gray-700 mt-1 font-medium",children:"Set target amount"})]})]})}),t.jsx(ds.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:t.jsxs(He,{className:"bg-white border-l-4 border-green-600 hover:shadow-lg transition-shadow",children:[t.jsx(rt,{className:"pb-3 bg-green-50",children:t.jsxs(at,{className:"flex items-center gap-2 text-green-900 text-base font-semibold",children:[t.jsx(dr,{className:"w-5 h-5 text-green-600"}),t.jsx("span",{children:"Achieved"})]})}),t.jsxs(Ve,{className:"pt-4",children:[t.jsxs("div",{className:"text-3xl font-bold text-green-600",children:["",(xe.amount||0).toLocaleString("en-IN")]}),t.jsxs("p",{className:"text-xs text-green-700 font-medium mt-1",children:[xe.percentage.toFixed(1),"% of target"]})]})]})}),t.jsx(ds.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:t.jsxs(He,{className:"bg-white border-l-4 border-orange-600 hover:shadow-lg transition-shadow",children:[t.jsx(rt,{className:"pb-3 bg-orange-50",children:t.jsxs(at,{className:"flex items-center gap-2 text-orange-900 text-base font-semibold",children:[t.jsx(zC,{className:"w-5 h-5 text-orange-600"}),t.jsx("span",{children:"Remaining"})]})}),t.jsxs(Ve,{className:"pt-4",children:[t.jsxs("div",{className:"text-3xl font-bold text-orange-600",children:["",(he.amount||0).toLocaleString("en-IN")]}),t.jsxs("p",{className:"text-xs text-orange-700 font-medium mt-1",children:[he.percentage.toFixed(1),"% left"]})]})]})}),t.jsx(ds.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:t.jsxs(He,{className:"bg-white border-l-4 border-purple-600 hover:shadow-lg transition-shadow",children:[t.jsx(rt,{className:"pb-3 bg-purple-50",children:t.jsxs(at,{className:"flex items-center gap-2 text-purple-900 text-base font-semibold",children:[t.jsx(ak,{className:"w-5 h-5 text-purple-600"}),t.jsx("span",{children:"Days Left"})]})}),t.jsxs(Ve,{className:"pt-4",children:[t.jsx("div",{className:"text-3xl font-bold text-purple-600",children:ee.daysRemaining}),t.jsxs("p",{className:"text-xs text-purple-700 font-medium mt-1",children:[ee.daysElapsed," days elapsed"]})]})]})})]}),t.jsx(ds.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.5},children:t.jsxs(He,{className:"bg-white shadow-md",children:[t.jsx(rt,{className:"bg-yellow-50 border-b border-yellow-200",children:t.jsxs(at,{className:"text-yellow-900 flex items-center gap-2",children:[t.jsx(KC,{className:"w-5 h-5 text-yellow-600"}),"Progress Overview"]})}),t.jsx(Ve,{className:"pt-6",children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between mb-2",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Sales Achievement"}),t.jsxs("span",{className:"text-sm font-bold text-gray-900",children:[ae.toFixed(1),"%"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 overflow-hidden",children:t.jsx(ds.div,{initial:{width:0},animate:{width:`${ae}%`},transition:{duration:1,ease:"easeOut"},className:`h-full ${X(ae)} rounded-full shadow-md`})})]}),xe.percentage>=100&&t.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:t.jsxs("p",{className:"text-sm font-medium text-green-800",children:[" Exceeded target! ",t.jsxs("span",{className:"font-bold",children:["",(F||0).toLocaleString("en-IN")]})," above target"]})})]})})]})}),t.jsx(ds.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},children:t.jsxs(He,{className:"bg-white shadow-md",children:[t.jsx(rt,{className:"bg-cyan-50 border-b border-cyan-200",children:t.jsxs(at,{className:"text-cyan-900 flex items-center gap-2",children:[t.jsx(Cn,{className:"w-5 h-5 text-cyan-600"}),"Daily Performance"]})}),t.jsxs(Ve,{className:"pt-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border-2 border-blue-300",children:[t.jsx("p",{className:"text-sm text-blue-900 font-semibold mb-2",children:"Daily Average Needed"}),t.jsxs("p",{className:"text-3xl font-bold text-blue-700",children:["",(M.needed||0).toLocaleString("en-IN")]}),t.jsx("p",{className:"text-xs text-blue-700 font-medium mt-2",children:"To hit your target"})]}),t.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border-2 border-green-300",children:[t.jsx("p",{className:"text-sm text-green-900 font-semibold mb-2",children:"Daily Average Achieved"}),t.jsxs("p",{className:"text-3xl font-bold text-green-700",children:["",(M.achieved||0).toLocaleString("en-IN")]}),t.jsx("p",{className:"text-xs text-green-700 font-medium mt-2",children:"Average so far"})]})]}),t.jsx("div",{className:"mt-4",children:M.onTrack&&t.jsx("div",{className:"bg-green-100 border-2 border-green-400 rounded-lg p-3",children:t.jsxs("p",{className:"text-sm font-medium text-green-800 flex items-center gap-2",children:[t.jsx(dr,{className:"w-5 h-5"})," You are ON TRACK to meet your target!"]})})})]})]})}),oe.details&&t.jsx(ds.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7},children:t.jsxs(He,{className:"bg-white shadow-md",children:[t.jsx(rt,{className:"bg-indigo-50 border-b border-indigo-200",children:t.jsxs(at,{className:"text-indigo-900 flex items-center gap-2",children:[t.jsx(An,{className:"w-5 h-5 text-indigo-600"}),"Target Details"]})}),t.jsxs(Ve,{className:"pt-6",children:[t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Assignment Type"}),t.jsx("p",{className:"text-sm font-bold text-gray-900 mt-1 capitalize",children:oe.details.assignmentType||"N/A"})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Assigned By"}),t.jsx("p",{className:"text-sm font-bold text-gray-900 mt-1",children:oe.details.assignedBy||"N/A"})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Created At"}),t.jsx("p",{className:"text-sm font-bold text-gray-900 mt-1",children:new Date(oe.details.createdAt).toLocaleDateString("en-IN")})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Status"}),t.jsx(Lt,{className:"mt-1 capitalize",children:_})]})]}),oe.details.notes&&t.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[t.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Notes"}),t.jsx("p",{className:"text-sm text-gray-900 mt-1",children:oe.details.notes})]})]})]})}),g.length>0&&t.jsx(ds.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},children:t.jsxs(He,{className:"bg-white shadow-md",children:[t.jsx(rt,{className:"bg-teal-50 border-b border-teal-200",children:t.jsxs(at,{className:"text-teal-900",children:["All Targets for ",h]})}),t.jsx(Ve,{className:"pt-6",children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:g.map((G,ie)=>t.jsxs("div",{className:"p-3 border-2 border-teal-200 rounded-lg hover:bg-teal-50 cursor-pointer transition-colors",children:[t.jsxs("p",{className:"text-sm font-bold text-teal-900",children:[new Date(2024,G.month-1).toLocaleString("default",{month:"short"})," ",G.year]}),t.jsxs("p",{className:"text-lg font-bold text-teal-700",children:["",G.targetAmount.toLocaleString("en-IN")]})]},ie))})})]})})]})},J2=()=>{const e=Ls(),{user:r}=Ns(),[s,a]=T.useState("dashboard"),[n,o]=T.useState([]),[c,d]=T.useState([]),[h,m]=T.useState([]),[f,p]=T.useState({}),[g,N]=T.useState(""),[y,w]=T.useState(!0),[b,C]=T.useState(null),[A,E]=T.useState(null),[R,V]=T.useState(!1),[P,k]=T.useState(!1),[z,W]=T.useState(!1),[te,de]=T.useState(!1),[H,ue]=T.useState(!1),[I,X]=T.useState(!1),[oe,xe]=T.useState(!1),[he,F]=T.useState([]),[ee,M]=T.useState(null),[_,ne]=T.useState(!1),[ae,G]=T.useState({customerResponse:"",negotiatedAmount:"",customerNotes:""}),[ie,Me]=T.useState({pendingOrders:0,pendingApprovals:0,pendingPayments:0,pendingTransport:0,pendingDispatch:0}),{toast:Ee}=Ni(),[ye,je]=T.useState({customerName:"",customerContact:"",customerEmail:"",customerAddress:"",gstNumber:"",deliveryAddress:"",sameAsBilling:!1,showroomProductId:"",unitPrice:"",quantity:1,discountAmount:0,paymentMethod:"",salesPerson:"",notes:"",transportCost:0,totalAmount:0,deliveryType:"self delivery",paymentType:""}),[We,Y]=T.useState({origin:"",destination:"",distance:"",vehicleType:"",distanceCost:0,totalCost:0,discountAmount:0}),[Dt,we]=T.useState(!1),[ot,Ye]=T.useState({isVerifying:!1,isVerified:!1,verificationResult:null,lastVerifiedGst:null}),[Ue,Nt]=T.useState({name:"",contact:"",email:"",address:"",customerType:"retail",creditLimit:0}),[qe,Bt]=T.useState({totalAmount:0,receivedAmount:"",balanceAmount:0,paymentMethod:"cash",utrNumber:"",onlinePaymentDate:"",onlineDetails:"",denoms:{2e3:0,500:0,200:0,100:0,50:0,20:0,10:0,5:0,1:0},cashTotalFromDenoms:0,splitCashAmount:0,splitOnlineAmount:0,handOverTo:""}),[jt,Ze]=T.useState({driverName:"",driverNumber:"",vehicleNumber:""}),[Xt,ze]=T.useState({});T.useEffect(()=>{ht()},[]),T.useEffect(()=>{H&&(R&&A?(Y({origin:A.origin||"",destination:A.destination||"",distance:A.distance||"",vehicleType:A.vehicleType||"",distanceCost:A.distanceCost||0,totalCost:A.transportCost||0,discountAmount:A.transportDiscountAmount||0}),we(A.transportCost>0)):(Y({origin:"",destination:"",distance:"",vehicleType:"",distanceCost:0,totalCost:0,discountAmount:0}),we(!1)))},[H,R,A]),T.useEffect(()=>{if(c.length>0){const B={pendingOrders:c.filter(me=>me.orderStatus==="pending").length,pendingApprovals:c.filter(me=>me.approvalStatus==="pending").length,pendingPayments:c.filter(me=>me.paymentStatus==="pending"||me.paymentStatus==="partial").length,pendingTransport:c.filter(me=>me.deliveryType==="transport"&&!me.transportArranged||he.some(Je=>Je.orderNumber===me.orderNumber)).length,pendingDispatch:c.filter(me=>me.orderStatus==="confirmed"&&me.paymentStatus==="completed"&&me.afterSalesStatus!=="sent_to_dispatch").length};Me(B)}},[c,he]);const ht=async()=>{try{w(!0),console.log("API_BASE:",Fe);const B=[{url:`${Fe}/sales/showroom/available`,setter:o,name:"products"},{url:`${Fe}/sales/orders`,setter:d,name:"orders"},{url:`${Fe}/sales/customers`,setter:m,name:"customers"},{url:`${Fe}/sales/summary`,setter:p,name:"summary"},{url:`${Fe}/transport/approvals/rejected`,setter:F,name:"rejectedApprovals"}];for(const me of B)try{const Je=await fetch(me.url);if(Je.ok){const mt=await Je.json();if(me.name==="orders")try{const wt=await fetch(`${Fe}/approval/pending`);if(wt.ok){const Et=await wt.json(),$t=mt.map(Vt=>{const qt=Et.approvals?.some(ls=>ls.orderNumber===Vt.orderNumber);return{...Vt,approvalStatus:qt?"pending":Vt.approvalStatus}});me.setter($t)}else me.setter(mt)}catch(wt){console.error("Error checking approval status:",wt),me.setter(mt)}else me.setter(mt);console.log(` Loaded ${me.name}:`,mt.length||"N/A")}else console.error(` Failed to load ${me.name}:`,Je.status),Ee({title:`Error fetching ${me.name}`,description:`Status: ${Je.status} - ${Je.statusText}`,variant:"destructive"})}catch(Je){console.error(`Network error fetching ${me.name}:`,Je),Ee({title:"Network Error",description:`Failed to connect to server for ${me.name}`,variant:"destructive"})}}catch(B){console.error("General error in fetchData:",B),Ee({title:"Error",description:"Failed to fetch data - check console for details",variant:"destructive"})}finally{w(!1)}},nt=async()=>{try{const B=ye.deliveryType==="part load"||ye.deliveryType==="company delivery",me={...ye,orderStatus:B?"pending_transport_approval":"pending"};let Je;if(R&&A?Je=await fetch(`${Fe}/sales/orders/${A.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(me)}):Je=await fetch(`${Fe}/sales/orders`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(me)}),Je.ok){const mt=await Je.json(),wt=ye.deliveryType==="part load"||ye.deliveryType==="company delivery";if(R){d(Vt=>Vt.map(qt=>qt.id===A.id?mt:qt));const Et=A.deliveryType!==ye.deliveryType;let $t="Sales order has been updated successfully";if(Et){const Vt=A.deliveryType||"self delivery",qt=ye.deliveryType;Vt==="self delivery"&&(qt==="part load"||qt==="company delivery")?$t=`Delivery type changed to ${qt}. Order status changed to pending transport approval.`:(Vt==="part load"||Vt==="company delivery")&&qt==="self delivery"?$t=`Delivery type changed to ${qt}. Pending transport approval requests have been automatically deleted.`:(Vt==="part load"||Vt==="company delivery")&&(qt==="part load"||qt==="company delivery")&&($t=`Delivery type changed from ${Vt} to ${qt}. Transport approval request updated.`)}Ee({title:"Order Updated",description:$t})}else{d($t=>[mt,...$t]);let Et="Sales order has been created successfully";switch(ye.deliveryType){case"part load":Et="Order created and sent to Transport Department for approval";break;case"company delivery":Et="Order created and sent to Transport Department for approval";break;case"free delivery":Et="Order created and sent for free delivery approval";break;default:Et="Sales order has been created successfully"}Ee({title:"Order Created",description:Et})}k(!1),V(!1),E(null),je({customerName:"",customerContact:"",customerEmail:"",customerAddress:"",gstNumber:"",deliveryAddress:"",sameAsBilling:!1,showroomProductId:"",unitPrice:"",quantity:1,discountAmount:0,paymentMethod:"",salesPerson:"",notes:"",transportCost:0,totalAmount:0,deliveryType:"self delivery"}),ht()}else{const mt=await Je.json();Ee({title:"Error",description:mt.error||"Failed to create order",variant:"destructive"})}}catch(B){console.error("Error creating order:",B),Ee({title:"Error",description:"Failed to create order",variant:"destructive"})}},Ot=async(B,me,Je=null)=>{try{const mt={action:me},wt=await fetch(`${Fe}/sales/transport/approvals/${B}/confirm`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(mt)});if(wt.ok){const Et=await wt.json();Ee({title:"Transport Demand Confirmed",description:Et.message}),ht(),xe(!1),M(null)}else{const Et=await wt.json();Ee({title:"Error",description:Et.error||"Failed to confirm transport demand",variant:"destructive"})}}catch(mt){console.error("Error confirming transport demand:",mt),Ee({title:"Error",description:"Failed to confirm transport demand",variant:"destructive"})}},lt=async()=>{try{const B={negotiatedAmount:parseFloat(ae.negotiatedAmount),customerNotes:ae.customerNotes,salesPerson:r?.username||"Sales Department"},me=await fetch(`${Fe}/sales/transport/approvals/${ee.id}/renegotiate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(B)});if(me.ok){const Je=await me.json();Ee({title:"Sent to Transport",description:"Negotiated amount sent to transport for review"}),ht(),ne(!1),xe(!1),M(null),G({customerResponse:"",negotiatedAmount:"",customerNotes:""})}else{const Je=await me.json();Ee({title:"Error",description:Je.error||"Failed to send negotiation to transport",variant:"destructive"})}}catch(B){console.error("Error sending back to transport:",B),Ee({title:"Error",description:"Failed to send negotiation to transport",variant:"destructive"})}},Jt=async()=>{try{const B=await fetch(`${Fe}/sales/customers`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ue)});if(B.ok){const me=await B.json();m(Je=>[me,...Je]),W(!1),Nt({name:"",contact:"",email:"",address:"",customerType:"retail",creditLimit:0}),Ee({title:"Success",description:"Customer created successfully"})}else{const me=await B.json();Ee({title:"Error",description:me.error||"Failed to create customer",variant:"destructive"})}}catch(B){console.error("Error creating customer:",B),Ee({title:"Error",description:"Failed to create customer",variant:"destructive"})}},et=async()=>{if(!ye.gstNumber.trim()){Ee({title:"Error",description:"Please enter a GST number to verify",variant:"destructive"});return}Ye(B=>({...B,isVerifying:!0}));try{const B=await fetch(`${Fe}/sales/verify-gst`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({gstNumber:ye.gstNumber})}),me=await B.json();B.ok&&me.success?(Ye({isVerifying:!1,isVerified:me.verified,verificationResult:me,lastVerifiedGst:ye.gstNumber}),me.verified?Ee({title:" GST Verified",description:me.message}):Ee({title:" GST Not Verified",description:me.message,variant:"destructive"})):(Ye(Je=>({...Je,isVerifying:!1,isVerified:!1,verificationResult:me})),Ee({title:"Verification Failed",description:me.message||"Failed to verify GST number",variant:"destructive"}))}catch{Ye(me=>({...me,isVerifying:!1,isVerified:!1,verificationResult:null})),Ee({title:"Error",description:"Failed to connect to verification service",variant:"destructive"})}},Ft=async()=>{try{if(!A){Ee({title:"Error",description:"No order selected",variant:"destructive"});return}if(Number(qe.totalAmount)<=0){Ee({title:"Error",description:"Total Amount must be greater than 0",variant:"destructive"});return}if(Number(qe.receivedAmount)<0){Ee({title:"Error",description:"Received Amount cannot be negative",variant:"destructive"});return}if(qe.paymentMethod==="cash"&&Object.entries(qe.denoms).reduce((Je,[mt,wt])=>Je+Number(mt)*Number(wt||0),0)!==Number(qe.receivedAmount)){Ee({title:"Mismatch",description:"Cash denominations total must equal Received Amount",variant:"destructive"});return}if(qe.paymentMethod==="online"&&!qe.utrNumber){Ee({title:"Missing UTR",description:"UTR Number is required for Online payments",variant:"destructive"});return}if(qe.paymentMethod==="split"&&Number(qe.splitCashAmount||0)+Number(qe.splitOnlineAmount||0)!==Number(qe.receivedAmount)){Ee({title:"Mismatch",description:"Split cash + online must equal Received Amount",variant:"destructive"});return}const B=await fetch(`${Fe}/sales/orders/${A.id}/payment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:Number(qe.receivedAmount||0),paymentMethod:qe.paymentMethod,utrNumber:qe.utrNumber,onlinePaymentDate:qe.onlinePaymentDate,onlineDetails:qe.onlineDetails,denoms:qe.denoms,splitCashAmount:qe.splitCashAmount,splitOnlineAmount:qe.splitOnlineAmount,handOverTo:qe.handOverTo,notes:qe.notes})});if(B.ok)de(!1),Bt({totalAmount:0,receivedAmount:0,balanceAmount:0,paymentMethod:"cash",utrNumber:"",onlinePaymentDate:"",onlineDetails:"",denoms:{2e3:0,500:0,200:0,100:0,50:0,20:0,10:0,5:0,1:0},cashTotalFromDenoms:0,splitCashAmount:0,splitOnlineAmount:0,notes:""}),Ee({title:"Success",description:"Payment processed successfully , Sent to Finance for cheak"}),ht();else{const me=await B.json();Ee({title:"Error",description:me.error||"Failed to process payment",variant:"destructive"})}}catch(B){console.error("Error processing payment:",B),Ee({title:"Error",description:"Failed to process payment",variant:"destructive"})}},kt=B=>{const me={pending:{className:"bg-yellow-100 text-yellow-800 border border-yellow-300 shadow-sm",icon:Sr},pending_transport_approval:{className:"bg-orange-100 text-orange-800 border border-orange-300 shadow-sm whitespace-normal break-words",icon:rn},pending_free_delivery_approval:{className:"bg-blue-100 text-blue-800 border border-blue-300 shadow-sm whitespace-normal break-words",icon:Ks},confirmed:{className:"bg-green-100 text-green-800 border border-green-300 shadow-sm",icon:dr},delivered:{className:"bg-green-100 text-green-800 border border-green-300 shadow-sm",icon:dr},cancelled:{className:"bg-red-100 text-red-800 border border-red-300 shadow-sm",icon:Sr}},Je=me[B]||me.pending,mt=Je.icon;let wt=B;return B==="pending_transport_approval"&&(wt=`Pending
Transport Approval`),B==="pending_free_delivery_approval"&&(wt=`Pending
Free Delivery Approval`),t.jsxs(Lt,{className:`${Je.className} flex items-center gap-1.5 px-3 py-1 rounded-md`,style:{whiteSpace:"pre-line",textAlign:"center",lineHeight:"1.1"},children:[t.jsx(mt,{className:"h-3.5 w-3.5"}),t.jsx("span",{className:"font-semibold capitalize",children:wt})]})},er=B=>{const me={pending:{className:"bg-red-100 text-red-800 border border-red-300 shadow-sm font-semibold",icon:Sr},pending_finance_approval:{className:"bg-red-100 text-red-800 border border-red-300 shadow-sm font-semibold whitespace-normal break-words",icon:Sr},partial:{className:"bg-orange-100 text-orange-800 border border-orange-300 shadow-sm font-semibold",icon:Sr},completed:{className:"bg-emerald-100 text-emerald-800 border border-emerald-300 shadow-sm font-semibold",icon:dr},finance_rejected:{className:"bg-red-100 text-red-800 border border-red-300 shadow-sm font-semibold",icon:Sr}},Je=me[B]||me.pending,mt=Je.icon;let wt=B;return B==="pending_finance_approval"&&(wt=`Pending
Finance Approval`),t.jsxs(Lt,{className:`${Je.className} flex items-center gap-1 font-medium`,style:{whiteSpace:"pre-line",textAlign:"center",lineHeight:"1.1"},children:[t.jsx(mt,{className:"h-3 w-3"}),t.jsx("span",{children:wt})]})};return y?t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx(Cr,{className:"w-12 h-12 animate-spin mx-auto mb-4 text-blue-600"}),t.jsx("p",{className:"text-gray-800 text-lg font-medium",children:"Loading Sales dashboard..."}),t.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Please wait while we retrieve the data"})]})}):t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50",children:[t.jsx("div",{className:"max-w-7xl mx-auto bg-white shadow-md border-b-4 border-blue-800 rounded-b-lg",children:t.jsx("div",{className:"px-4 sm:px-6 py-4 sm:py-6",children:t.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:justify-between sm:items-center sm:space-y-0",children:[t.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4",children:[t.jsxs(pe,{onClick:()=>e(r?.department==="admin"?"/dashboard/admin":"/dashboard"),variant:"outline",className:"border border-gray-300 bg-white text-gray-800 text-sm placeholder-gray-500 w-full sm:w-auto",children:[t.jsx(qs,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-600 to-green-800 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx(Cn,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Sales Department"}),t.jsx("p",{className:"text-gray-600 text-sm sm:text-base font-medium",children:"Sales Management System"})]})]})]}),t.jsx("div",{className:"bg-gradient-to-r from-green-50 to-indigo-50 border-2 border-green-200 px-4 py-4 sm:px-6 rounded-lg shadow-sm w-full sm:w-auto",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(Nr,{className:"w-5 h-5 text-blue-600"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 text-xs font-medium",children:"Sales Team"}),t.jsx("p",{className:"text-green-600 text-xs font-medium",children:"Sales Management"})]})]})})]})})}),t.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-4",children:[t.jsx(Rn,{className:"mb-4"}),t.jsxs("div",{className:"px-6 py-6",children:[t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[t.jsx(He,{className:"bg-white border border-gray-300 shadow-sm",children:t.jsx(Ve,{className:"p-4",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Total Orders"}),t.jsx("p",{className:"text-2xl font-bold text-gray-800 mt-1",children:f.totalOrders||0})]}),t.jsx("div",{className:"bg-blue-100 p-2 rounded-sm",children:t.jsx(di,{className:"h-4 w-4 text-gray-400"})})]})})}),t.jsx(He,{className:"bg-white border border-gray-300 shadow-sm",children:t.jsx(Ve,{className:"p-4",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Total Revenue"}),t.jsxs("p",{className:"text-2xl font-bold text-gray-800 mt-1",children:["",f.totalRevenue?.toLocaleString()||0]})]}),t.jsx("div",{className:"bg-green-100 p-2 rounded-sm",children:t.jsx(An,{className:"h-4 w-4 text-gray-400"})})]})})}),t.jsx(He,{className:"bg-white border border-gray-300 shadow-sm",children:t.jsx(Ve,{className:"p-4",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Today's Orders"}),t.jsx("p",{className:"text-2xl font-bold text-gray-800 mt-1",children:f.todayOrders||0})]}),t.jsx("div",{className:"bg-orange-100 p-2 rounded-sm",children:t.jsx(tn,{className:"h-4 w-4 text-gray-400"})})]})})}),t.jsx(He,{className:"bg-white border border-gray-300 shadow-sm",children:t.jsx(Ve,{className:"p-4",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Today's Revenue"}),t.jsxs("p",{className:"text-2xl font-bold text-gray-800 mt-1",children:["",f.todayRevenue?.toLocaleString()||0]})]}),t.jsx("div",{className:"bg-purple-100 p-2 rounded-sm",children:t.jsx(Cn,{className:"h-4 w-4 text-gray-400"})})]})})})]}),t.jsxs(an,{value:s,onValueChange:a,className:"overflow-x-auto",children:[t.jsxs(ma,{className:"flex md:grid md:grid-cols-5 w-full overflow-x-auto overflow-y-hidden md:overflow-x-hidden whitespace-nowrap bg-gray-100 border border-gray-300 pl-60 md:pl-0",children:[t.jsx(xt,{value:"dashboard",className:"text-gray-800",children:"Dashboard"}),t.jsx(xt,{value:"showroom",className:"text-gray-800",children:"Showroom Products"}),t.jsxs(xt,{value:"orders",className:"text-gray-800 relative",children:["Sales Orders",ie.pendingOrders>0&&t.jsx("div",{className:"absolute -top-2 -right-2 flex items-center justify-center rounded-full bg-red-500 text-white text-xs font-bold min-w-[1.25rem] h-5 px-1",children:ie.pendingOrders})]}),t.jsxs(xt,{value:"transport",className:"text-gray-800 relative",children:["Transport Reviews",ie.pendingTransport>0&&t.jsx("div",{className:"absolute -top-2 -right-2 flex items-center justify-center rounded-full bg-red-500 text-white text-xs font-bold min-w-[1.25rem] h-5 px-1",children:ie.pendingTransport})]}),t.jsxs(xt,{value:"afterSales",className:"text-gray-800 relative",children:["After Sales",ie.pendingDispatch>0&&t.jsx("div",{className:"absolute -top-2 -right-2 flex items-center justify-center rounded-full bg-red-500 text-white text-xs font-bold min-w-[1.25rem] h-5 px-1",children:ie.pendingDispatch})]}),t.jsx(xt,{value:"performance",className:"text-gray-800",children:"Sales Performance"})]}),t.jsx(Ut,{value:"dashboard",className:"space-y-6",children:t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsx(rt,{children:t.jsx(at,{className:"text-gray-800",children:"Recent Sales Orders"})}),t.jsx(Ve,{children:t.jsx("div",{className:"space-y-4",children:c.slice(0,5).map(B=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-800",children:B.orderNumber}),t.jsx("p",{className:"text-sm text-gray-600",children:B.customerName})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("p",{className:"font-medium text-gray-800",children:["",B.finalAmount]}),kt(B.orderStatus)]})]},B.id))})})]}),t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsx(rt,{children:t.jsx(at,{className:"text-gray-800",children:"Available Products"})}),t.jsx(Ve,{children:t.jsx("div",{className:"space-y-4",children:n.slice(0,5).map(B=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-800",children:B.name}),t.jsx("p",{className:"text-sm text-gray-600",children:B.category})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("p",{className:"font-medium text-gray-800",children:["",B.salePrice]}),t.jsx(Lt,{variant:"default",children:"Available"})]})]},B.id))})})]})]})}),t.jsx(Ut,{value:"showroom",className:"space-y-6",children:t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsx(rt,{className:"border-b border-gray-200",children:t.jsx("div",{className:"flex justify-between items-center",children:t.jsxs("div",{children:[t.jsx(at,{className:"text-2xl font-bold text-gray-800",children:"Available Showroom Products"}),t.jsx(gr,{className:"text-gray-600 mt-1",children:"Browse and sell products from your showroom"})]})})}),t.jsx(Ve,{className:"pt-6",children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(B=>t.jsxs(He,{className:"bg-gray-50 border border-gray-300 shadow-sm hover:bg-gray-100 transition-colors",children:[t.jsxs(rt,{children:[t.jsx(at,{className:"text-gray-800 text-md",children:B.name}),t.jsx(gr,{className:"text-gray-600",children:B.category})]}),t.jsxs(Ve,{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-600",children:"Sale Price:"}),t.jsxs("span",{className:"font-bold text-gray-800",children:["",B.salePrice]})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-600",children:"Cost Price:"}),t.jsxs("span",{className:"text-gray-600",children:["",B.costPrice]})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-600",children:"Quantity:"}),t.jsx("span",{className:"text-gray-600",children:B.quantity||1})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-gray-600",children:"Displayed:"}),t.jsx("span",{className:"text-gray-600",children:new Date(B.displayedAt).toLocaleDateString()})]}),t.jsxs(pe,{onClick:()=>{C(B),je(me=>({...me,showroomProductId:B.id,unitPrice:B.salePrice})),k(!0)},className:"w-full bg-green-600 hover:bg-green-700",children:[t.jsx(di,{className:"h-4 w-4 mr-2"}),"Sell Product"]})]})]},B.id))})})]})}),t.jsx(Ut,{value:"orders",className:"space-y-6",children:t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsx(rt,{className:"border-b border-gray-200",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx(at,{className:"text-2xl font-bold text-gray-800",children:"Sales Orders"}),t.jsx(gr,{className:"text-gray-600 mt-1",children:"Manage and track all your sales orders"})]}),t.jsxs("div",{className:"relative w-96",children:[t.jsx(Re,{type:"search",placeholder:"Search orders by customer name, order number or status...",className:"pl-10 pr-4 py-2",value:g,onChange:B=>N(B.target.value)}),t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.jsx(fi,{className:"h-5 w-5 text-gray-400"})})]})]})}),t.jsx(Ve,{className:"p-0",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs(zr,{children:[t.jsx(Kr,{children:t.jsxs(At,{className:"border-gray-200",children:[t.jsx(Pe,{className:"text-gray-800",children:"Order #"}),t.jsx(Pe,{className:"text-gray-800",children:"Customer"}),t.jsx(Pe,{className:"text-gray-800",children:"Product"}),t.jsx(Pe,{className:"text-gray-800",children:"Quantity"}),t.jsx(Pe,{className:"text-gray-800",children:"Amount"}),t.jsx(Pe,{className:"text-gray-800",children:"Balance"}),t.jsx(Pe,{className:"text-gray-800",children:"Status"}),t.jsx(Pe,{className:"text-gray-800",children:"Payment"}),t.jsx(Pe,{className:"text-gray-800",children:"Actions"})]})}),t.jsx(Xr,{children:c.filter(B=>{if(!g)return!0;const me=g.toLowerCase();return B.orderNumber?.toLowerCase().includes(me)||B.customerName?.toLowerCase().includes(me)||B.orderStatus?.toLowerCase().includes(me)||B.paymentStatus?.toLowerCase().includes(me)||B.showroomProduct?.name?.toLowerCase().includes(me)}).map(B=>t.jsxs(At,{className:"border-gray-200",children:[t.jsx(be,{className:"text-gray-800 font-medium",children:B.orderNumber}),t.jsx(be,{className:"text-gray-800",children:B.customerName}),t.jsx(be,{className:"text-gray-800",children:B.showroomProduct?.name}),t.jsx(be,{className:"text-gray-800",children:B.quantity}),t.jsxs(be,{className:"text-gray-800",children:["",B.finalAmount]}),t.jsxs(be,{className:"text-gray-800",children:["",Math.max(0,Number(B.balanceAmount??Number(B.finalAmount||0)-Number(B.amountPaid||0)))]}),t.jsx(be,{children:kt(B.orderStatus)}),t.jsx(be,{children:er(B.paymentStatus)}),t.jsx(be,{children:(B.orderStatus!=="confirmed"||B.paymentStatus!=="completed"||B.paymentStatus==="pending")&&t.jsxs("div",{className:"flex items-center gap-2",children:[B.orderStatus!=="confirmed"&&B.paymentStatus!=="completed"&&t.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-yellow-50 border border-yellow-200 rounded text-yellow-700 text-xs",children:[t.jsx(Sr,{className:"h-3 w-3"}),t.jsx("span",{children:"Awaiting Confirmation"})]}),B.paymentStatus!=="completed"&&t.jsx(pe,{size:"sm",variant:"outline",disabled:B.orderStatus!=="confirmed",className:B.orderStatus!=="confirmed"?"cursor-not-allowed opacity-50 bg-gray-100 hover:bg-gray-100":"",onClick:()=>{if(B.orderStatus!=="confirmed"){Ee({title:"Finance Access Blocked",description:"Order must be confirmed before finance processing. Current status: "+(B.orderStatus||"pending"),variant:"destructive"});return}E(B);const me=Math.max(0,Number(B.balanceAmount??Number(B.finalAmount||0)-Number(B.amountPaid||0))),Je=String(B.paymentStatus)==="partial",mt=String(B.paymentStatus)==="finance_rejected";Bt(wt=>({...wt,totalAmount:Je||mt?me:Number(B.finalAmount||0),receivedAmount:"",balanceAmount:me,paymentMethod:wt.paymentMethod||"cash"})),de(!0)},title:B.orderStatus!=="confirmed"?`Finance blocked - Order status: ${B.orderStatus||"pending"}`:"Process Payment",children:t.jsx(An,{className:"h-3 w-3"})}),B.paymentStatus==="pending"&&t.jsx(pe,{size:"sm",variant:"outline",onClick:()=>{E(B),V(!0),je({customerName:B.customerName||"",customerContact:B.customerContact||"",customerEmail:B.customerEmail||"",customerAddress:B.customerAddress||"",gstNumber:B.gstNumber||"",deliveryAddress:B.deliveryAddress||"",sameAsBilling:B.deliveryAddress===B.customerAddress,showroomProductId:B.showroomProductId||"",unitPrice:B.unitPrice||"",quantity:B.quantity||1,discountAmount:B.discountAmount||0,paymentMethod:B.paymentMethod||"",salesPerson:B.salesPerson||"",notes:B.notes||"",transportCost:B.transportCost||0,totalAmount:(B.unitPrice||0)*(B.quantity||1)+(B.transportCost||0),deliveryType:B.deliveryType||"self delivery"}),B.transportCost>0&&(Y({origin:B.origin||"",destination:B.destination||"",distance:B.distance||"",vehicleType:B.vehicleType||"",distanceCost:B.distanceCost||B.transportCost||0,totalCost:B.transportCost||0,discountAmount:B.transportDiscountAmount||0}),we(!0)),k(!0)},title:B.orderStatus!=="confirmed"?`Edit blocked - Order status: ${B.orderStatus||"pending"}`:"Edit Order",children:t.jsx(zi,{className:"h-3 w-3"})})]})})]},B.id))})]})})})]})}),t.jsx(Ut,{value:"transport",className:"space-y-6",children:t.jsxs(He,{className:"border-2 border-gray-200 shadow-lg",children:[t.jsx(rt,{className:"bg-gradient-to-r from-red-500 to-red-600 text-white",children:t.jsxs(at,{className:"flex items-center gap-2",children:[t.jsx(rn,{className:"h-5 w-5"}),"Transport Demand Reviews"]})}),t.jsx(Ve,{className:"p-6 bg-white",children:he.length===0?t.jsxs("div",{className:"text-center py-8 text-gray-600",children:[t.jsx(rn,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),t.jsx("p",{className:"text-lg font-medium",children:"No Transport Demands"}),t.jsx("p",{className:"text-sm",children:"All transport requests have been processed"})]}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs(zr,{children:[t.jsx(Kr,{children:t.jsxs(At,{className:"bg-gray-50",children:[t.jsx(Pe,{className:"text-gray-800 font-medium",children:"Order #"}),t.jsx(Pe,{className:"text-gray-800 font-medium",children:"Customer"}),t.jsx(Pe,{className:"text-gray-800 font-medium",children:"Product"}),t.jsx(Pe,{className:"text-gray-800 font-medium",children:"Delivery Type"}),t.jsx(Pe,{className:"text-gray-800 font-medium",children:"Original Cost"}),t.jsx(Pe,{className:"text-gray-800 font-medium",children:"Demanded Cost"}),t.jsx(Pe,{className:"text-gray-800 font-medium",children:"Transport Notes"}),t.jsx(Pe,{className:"text-gray-800 font-medium",children:"Actions"})]})}),t.jsx(Xr,{children:he.map(B=>t.jsxs(At,{className:"hover:bg-gray-50",children:[t.jsx(be,{className:"font-medium text-gray-800",children:B.orderNumber}),t.jsx(be,{className:"text-gray-800",children:t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:B.customerName}),t.jsx("div",{className:"text-sm text-gray-500",children:B.customerContact})]})}),t.jsx(be,{className:"text-gray-800",children:B.productName}),t.jsx(be,{children:t.jsx(Lt,{className:"bg-amber-100 text-amber-800 border border-amber-300",children:B.deliveryType})}),t.jsxs(be,{className:"text-gray-800",children:["",B.originalTransportCost?.toFixed(2)||"0.00"]}),t.jsxs(be,{className:"text-red-600 font-medium",children:["",B.demandAmount?.toFixed(2)||"0.00"]}),t.jsx(be,{className:"text-gray-600 max-w-xs truncate",children:B.transportNotes||"No notes"}),t.jsx(be,{children:t.jsx("div",{className:"flex gap-2",children:t.jsx(pe,{size:"sm",className:"bg-green-600 hover:bg-green-700 text-white",onClick:()=>{M(B),xe(!0)},children:"Review"})})})]},B.id))})]})})})]})}),t.jsx(Ut,{value:"afterSales",className:"space-y-6",children:t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsx(rt,{className:"border-b border-gray-200",children:t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("div",{children:[t.jsx(at,{className:"text-2xl font-bold text-gray-800",children:"After Sales"}),t.jsx(gr,{className:"text-gray-600 mt-1",children:"Process completed orders and manage dispatch"})]})})}),t.jsx(Ve,{className:"p-0",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs(zr,{children:[t.jsx(Kr,{children:t.jsxs(At,{className:"border-gray-200",children:[t.jsx(Pe,{className:"text-gray-800",children:"Order #"}),t.jsx(Pe,{className:"text-gray-800",children:"Customer"}),t.jsx(Pe,{className:"text-gray-800",children:"Product"}),t.jsx(Pe,{className:"text-gray-800",children:"Delivery Type"}),t.jsx(Pe,{className:"text-gray-800",children:"Status"}),t.jsx(Pe,{className:"text-gray-800",children:"Action"})]})}),t.jsx(Xr,{children:c.map(B=>t.jsxs(At,{className:"border-gray-200",children:[t.jsx(be,{className:"text-gray-800 font-medium",children:B.orderNumber}),t.jsx(be,{className:"text-gray-800",children:B.customerName}),t.jsx(be,{className:"text-gray-800",children:B.showroomProduct?.name}),t.jsx(be,{className:"text-gray-800",children:B.afterSalesStatus==="sent_to_dispatch"||B.orderStatus==="delivered"?t.jsx("span",{className:"capitalize",children:B.deliveryType}):t.jsx("span",{className:"capitalize font-medium text-blue-600",children:B.deliveryType||"self delivery"})}),t.jsx(be,{children:B.orderStatus==="delivered"?kt("delivered"):B.afterSalesStatus==="sent_to_dispatch"?t.jsx(Lt,{variant:"secondary",children:"in-dispatch"}):kt(B.orderStatus||"pending")}),t.jsx(be,{children:B.orderStatus==="delivered"||B.afterSalesStatus==="sent_to_dispatch"?null:B.paymentStatus==="completed"||B.financeBypass===!0?t.jsx(pe,{size:"sm",className:"bg-blue-600 hover:bg-blue-700",disabled:B.approvalStatus==="pending",onClick:async()=>{const me=B.deliveryType||"self delivery";if(B.paymentStatus!=="completed"&&B.financeBypass!==!0){const Et=B.paymentStatus==="finance_rejected"?"Payment rejected by finance - cannot dispatch":"Complete payment before dispatch or use coupon bypass";Ee({title:"Payment pending",description:Et,variant:"destructive"});return}const Je=Xt[B.id];if(me==="self delivery"&&!Je){E(B),Ze({driverName:"",driverNumber:"",vehicleNumber:""}),X(!0);return}const mt=me==="self delivery"?{deliveryType:me,driverDetails:Je}:{deliveryType:me},wt=await fetch(`${Fe}/sales/orders/${B.id}/dispatch`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(mt)});if(wt.ok){let Et;try{Et=await wt.json()}catch{Et={}}const $t=Et?.deliveryType||Et?.dispatch?.deliveryType||me;Ee({title:"Sent to dispatch",description:`Order ${B.orderNumber}`}),d(Vt=>Vt.map(qt=>qt.id===B.id?{...qt,afterSalesStatus:"sent_to_dispatch",deliveryType:$t}:qt))}else{const Et=await wt.json().catch(()=>({}));Ee({title:"Failed to send",description:Et.error||"Try again",variant:"destructive"})}},children:B.approvalStatus==="pending"?"Pending Admin Approval":B.approvalStatus==="approved"?"Send to Dispatch (Bypassed)":B.orderStatus==="pending_free_delivery_approval"?"Pending Free Delivery Approval":B.financeBypass===!0?"Send to Dispatch (Bypassed)":B.deliveryType==="self delivery"&&!Xt[B.id]?"Add Driver Details":"Send to Dispatch"}):t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Lt,{variant:"destructive",children:"Payment pending"}),B.approvalStatus==="pending"?t.jsx(pe,{size:"sm",variant:"outline",className:"border-orange-600 text-orange-700 hover:bg-orange-50",disabled:!0,children:"Pending Admin Approval"}):t.jsx(pe,{size:"sm",variant:"outline",className:"border-blue-600 text-blue-700 hover:bg-blue-50",onClick:async()=>{try{const me=window.prompt("Enter coupon code to bypass finance on partial payment:");if(!me)return;const Je=window.prompt("Enter reason for coupon bypass:");if(!Je)return;const mt={couponCode:me,reason:Je,requestedBy:r?.username||"Sales User"};console.log("Sending coupon request:",mt);const wt=await fetch(`${Fe}/sales/orders/${B.id}/coupon`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(mt)});console.log("Response status:",wt.status);const Et=await wt.json().catch(()=>({}));if(console.log("Response data:",Et),wt.ok)Et.status==="approval_requested"||Et.status==="success"?(Ee({title:"Approval Request Sent",description:`Order ${B.orderNumber} sent to admin for approval`}),d($t=>$t.map(Vt=>Vt.id===B.id?{...Vt,...Et.salesOrder,approvalStatus:"pending"}:Vt))):(Ee({title:"Coupon Applied",description:Et.message||`Order ${B.orderNumber} coupon applied`}),d($t=>$t.map(Vt=>Vt.id===B.id?{...Vt,...Et.salesOrder}:Vt)));else{const $t=await wt.json().catch(()=>({}));console.log("Error response:",$t),Ee({title:"Failed to apply coupon",description:$t.error||"Try again",variant:"destructive"})}}catch(me){console.error("Coupon application error:",me),Ee({title:"Error",description:"Failed to apply coupon. Please try again.",variant:"destructive"})}},children:"Coupon Bypass"})]})})]},B.id))})]})})})]})}),t.jsx(Ut,{value:"performance",className:"space-y-6",children:t.jsx(Y2,{salesPerson:r?.username||r?.fullName,isAdmin:r?.department==="admin"})})]}),t.jsx(mr,{open:P,onOpenChange:k,children:t.jsxs(fr,{className:"bg-gray-900 border-gray-200",children:[t.jsxs(xr,{children:[t.jsx(pr,{children:"Create Sales Order"}),t.jsx(Ar,{children:"Create a new sales order for a showroom product"})]}),t.jsxs("div",{className:"grid gap-4 py-4 max-h-[60vh] overflow-auto pr-2",children:[t.jsxs("div",{className:"bg-gray-800/50 border border-gray-700 rounded-md p-3",children:[t.jsx("label",{className:"text-sm text-gray-300 font-medium",children:"Delivery Type"}),t.jsxs("div",{className:"mt-2 grid grid-cols-2 md:grid-cols-4 gap-2",children:[t.jsx(pe,{type:"button",variant:ye.deliveryType==="self delivery"?"default":"outline",className:ye.deliveryType==="self delivery"?"bg-blue-600 hover:bg-blue-700":"border-gray-600 text-gray-200",onClick:()=>{je(B=>({...B,deliveryType:"self delivery"})),we(!1),je(B=>({...B,transportCost:0,totalAmount:(parseFloat(B.unitPrice)||0)*(B.quantity||1)}))},children:"Self Delivery"}),t.jsx(pe,{type:"button",variant:ye.deliveryType==="company delivery"?"default":"outline",className:ye.deliveryType==="company delivery"?"bg-blue-600 hover:bg-blue-700":"border-gray-600 text-gray-200",onClick:()=>{je(B=>({...B,deliveryType:"company delivery"}))},children:"Company Delivery"}),t.jsx(pe,{type:"button",variant:ye.deliveryType==="part load"?"default":"outline",className:ye.deliveryType==="part load"?"bg-blue-600 hover:bg-blue-700":"border-gray-600 text-gray-200",onClick:()=>{je(B=>({...B,deliveryType:"part load"})),we(!1),je(B=>({...B,transportCost:0,totalAmount:(parseFloat(B.unitPrice)||0)*(B.quantity||1)}))},children:"Part Load"}),t.jsx(pe,{type:"button",variant:ye.deliveryType==="free delivery"?"default":"outline",className:ye.deliveryType==="free delivery"?"bg-blue-600 hover:bg-blue-700":"border-gray-600 text-gray-200",onClick:()=>{je(B=>({...B,deliveryType:"free delivery"})),we(!1),je(B=>({...B,transportCost:0,totalAmount:(parseFloat(B.unitPrice)||0)*(B.quantity||1)}))},children:"Free Delivery"})]}),ye.deliveryType==="company delivery"&&t.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Transport cost can be added via estimation below."}),ye.deliveryType==="free delivery"&&t.jsx("p",{className:"text-xs text-green-400 mt-2",children:"Transport cost is not charged for free delivery."}),ye.deliveryType==="part load"&&t.jsxs(t.Fragment,{children:[t.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"LR details can be added in Transport  Partload Details after order is created."}),t.jsxs("div",{className:"mt-2",children:[t.jsx(Q,{htmlFor:"paymentType",children:"Payment Type *"}),t.jsxs("select",{id:"paymentType",className:"bg-gray-800 border-gray-200 rounded px-2 py-1 w-full text-white",value:ye.paymentType,onChange:B=>{const me=B.target.value;je(Je=>({...Je,paymentType:me,transportCost:me==="to pay"?0:Je.transportCost}))},children:[t.jsx("option",{value:"",children:"Select Payment Type"}),t.jsx("option",{value:"to pay",children:"To pay"}),t.jsx("option",{value:"paid",children:"Paid"})]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"customerName",children:"Customer Name *"}),t.jsx(Re,{id:"customerName",value:ye.customerName,onChange:B=>je(me=>({...me,customerName:B.target.value})),className:"bg-gray-800 border-gray-200"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"customerContact",children:"Contact"}),t.jsx(Re,{id:"customerContact",type:"number",value:ye.customerContact,onChange:B=>je(me=>({...me,customerContact:B.target.value})),className:"bg-gray-800 border-gray-200"})]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"customerEmail",children:"Email"}),t.jsx(Re,{id:"customerEmail",type:"email",value:ye.customerEmail,onChange:B=>je(me=>({...me,customerEmail:B.target.value})),className:"bg-gray-800 border-gray-200"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"totalAmount",children:"Total Amount"}),t.jsx(Re,{id:"totalAmount",type:"number",value:ye.totalAmount,readOnly:!0,className:"bg-gray-700 border-gray-200 cursor-not-allowed"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"unitPrice",children:"Unit Price *"}),t.jsx(Re,{id:"unitPrice",type:"number",value:ye.unitPrice,onChange:B=>{const me=parseFloat(B.target.value)||0,Je=ye.quantity||1;let mt=Dt&&ye.transportCost||0;ye.deliveryType==="part load"&&ye.paymentType==="to pay"&&(mt=0);const wt=me*Je+mt;je(Et=>({...Et,unitPrice:B.target.value,totalAmount:wt,transportCost:mt}))},className:"bg-gray-800 border-gray-200"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"quantity",children:"Quantity"}),t.jsx(Re,{id:"quantity",type:"number",value:ye.quantity,onChange:B=>{const me=parseInt(B.target.value)||1,Je=parseFloat(ye.unitPrice)||0,mt=Dt&&ye.transportCost||0,wt=Je*me+mt;je(Et=>({...Et,quantity:me,totalAmount:wt}))},className:"bg-gray-800 border-gray-200"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"discountAmount",children:"Discount Amount"}),t.jsx(Re,{id:"discountAmount",type:"number",value:ye.discountAmount,onChange:B=>je(me=>({...me,discountAmount:parseFloat(B.target.value)||0})),className:"bg-gray-800 border-gray-200 "})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"salesPerson",children:"Sales Person *"}),t.jsx(Re,{id:"salesPerson",value:ye.salesPerson,onChange:B=>je(me=>({...me,salesPerson:B.target.value})),className:"bg-gray-800 border-gray-200"})]}),t.jsx("div",{className:"flex items-end",children:t.jsx(pe,{type:"button",variant:"outline",onClick:()=>ue(!0),className:`w-full bg-gray-700 border-gray-200 hover:bg-gray-600 ${ye.deliveryType==="part load"&&ye.paymentType==="to pay"?"cursor-not-allowed opacity-60":""}`,disabled:ye.deliveryType==="part load"&&ye.paymentType!=="paid",children:"Check Transport Estimation Cost"})})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"customerAddress",children:"Billing Address"}),t.jsx(vr,{id:"customerAddress",value:ye.customerAddress,onChange:B=>je(me=>({...me,customerAddress:B.target.value,deliveryAddress:me.sameAsBilling?B.target.value:me.deliveryAddress})),className:"bg-gray-800 border-gray-200"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"gstNumber",children:"GST No."}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(Re,{id:"gstNumber",value:ye.gstNumber,onChange:B=>{je(me=>({...me,gstNumber:B.target.value})),ot.lastVerifiedGst!==B.target.value&&Ye(me=>({...me,isVerified:!1,verificationResult:null,lastVerifiedGst:null}))},className:"bg-gray-800 border-gray-200 flex-1",placeholder:"Enter GST number"}),t.jsx(pe,{type:"button",onClick:et,disabled:ot.isVerifying||!ye.gstNumber.trim(),className:`px-4 ${ot.isVerified&&ot.lastVerifiedGst===ye.gstNumber?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700"}`,children:ot.isVerifying?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Verifying..."]}):ot.isVerified&&ot.lastVerifiedGst===ye.gstNumber?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(dr,{className:"w-4 h-4"}),"Verified"]}):"Verify GST"})]}),ot.verificationResult&&ot.lastVerifiedGst===ye.gstNumber&&t.jsxs("div",{className:`mt-2 p-2 rounded text-sm ${ot.isVerified?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-red-500/20 text-red-400 border border-red-500/30"}`,children:[t.jsxs("div",{className:"flex items-center gap-2",children:[ot.isVerified?t.jsx(dr,{className:"w-4 h-4"}):t.jsx(Sr,{className:"w-4 h-4"}),t.jsx("span",{className:"font-medium",children:ot.isVerified?"Verified":"Not Verified"})]}),t.jsx("p",{className:"mt-1",children:ot.verificationResult.message}),ot.verificationResult.details?.businessName&&t.jsxs("p",{className:"mt-1 text-xs",children:["Business: ",ot.verificationResult.details.businessName]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{id:"sameAsBilling",type:"checkbox",checked:ye.sameAsBilling,onChange:B=>je(me=>({...me,sameAsBilling:B.target.checked,deliveryAddress:B.target.checked?me.customerAddress:me.deliveryAddress}))}),t.jsx(Q,{htmlFor:"sameAsBilling",children:"Delivery Address same as Billing Address"})]}),t.jsx(Q,{htmlFor:"deliveryAddress",children:"Delivery Address"}),t.jsx(vr,{id:"deliveryAddress",value:ye.deliveryAddress,onChange:B=>je(me=>({...me,deliveryAddress:B.target.value,sameAsBilling:!1})),className:"bg-gray-800 border-gray-200"})]})]}),t.jsxs(yr,{children:[t.jsx(pe,{variant:"outline",onClick:()=>{k(!1),V(!1),E(null)},children:"Cancel"}),t.jsx(pe,{onClick:nt,className:"bg-blue-600 hover:bg-blue-700",children:R?"Update Order":"Create Order"})]})]})}),t.jsx(mr,{open:z,onOpenChange:W,children:t.jsxs(fr,{className:"bg-gray-900 border-gray-200 text-gray-800",children:[t.jsxs(xr,{children:[t.jsx(pr,{children:"Add New Customer"}),t.jsx(Ar,{children:"Add a new customer to the system"})]}),t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"customerName",children:"Name *"}),t.jsx(Re,{id:"customerName",value:Ue.name,onChange:B=>Nt(me=>({...me,name:B.target.value})),className:"bg-gray-800 border-gray-200 text-gray-800"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"customerContact",children:"Contact"}),t.jsx(Re,{id:"customerContact",value:Ue.contact,onChange:B=>Nt(me=>({...me,contact:B.target.value})),className:"bg-gray-800 border-gray-200 text-gray-800"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"customerEmail",children:"Email"}),t.jsx(Re,{id:"customerEmail",type:"email",value:Ue.email,onChange:B=>Nt(me=>({...me,email:B.target.value})),className:"bg-gray-800 border-gray-200 text-gray-800"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"customerType",children:"Customer Type"}),t.jsxs(br,{value:Ue.customerType,onValueChange:B=>Nt(me=>({...me,customerType:B})),children:[t.jsx(jr,{className:"bg-gray-800 border-gray-200 text-gray-800",children:t.jsx(Er,{})}),t.jsxs(Tr,{className:"bg-gray-800 border-gray-200",children:[t.jsx(st,{value:"retail",children:"Retail"}),t.jsx(st,{value:"wholesale",children:"Wholesale"}),t.jsx(st,{value:"corporate",children:"Corporate"})]})]})]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"customerAddress",children:"Address"}),t.jsx(vr,{id:"customerAddress",value:Ue.address,onChange:B=>Nt(me=>({...me,address:B.target.value})),className:"bg-gray-800 border-gray-200 text-gray-800"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"creditLimit",children:"Credit Limit"}),t.jsx(Re,{id:"creditLimit",type:"number",value:Ue.creditLimit,onChange:B=>Nt(me=>({...me,creditLimit:parseFloat(B.target.value)||0})),className:"bg-gray-800 border-gray-200 text-gray-800"})]})]}),t.jsxs(yr,{children:[t.jsx(pe,{variant:"outline",onClick:()=>W(!1),children:"Cancel"}),t.jsx(pe,{onClick:Jt,className:"bg-blue-600 hover:bg-blue-700",children:"Add Customer"})]})]})}),t.jsx(mr,{open:te,onOpenChange:B=>{if(de(B),B&&A){const me=Number(A.finalAmount||0),Je=Number(A.amountPaid||0),mt=Math.max(0,me-Je),wt=String(A.paymentStatus)==="partial",Et=String(A.paymentStatus)==="finance_rejected";Bt($t=>({...$t,totalAmount:wt||Et?mt:me,balanceAmount:mt}))}},children:t.jsxs(fr,{className:"bg-gray-900 border-gray-200 w-full max-w-2xl",children:[t.jsxs(xr,{children:[t.jsx(pr,{children:"Process Payment"}),t.jsxs(Ar,{children:["Process payment for order: ",A?.orderNumber]})]}),t.jsxs("div",{className:"grid gap-4 py-4 max-h-[70vh] overflow-auto pr-2",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"totalAmount",children:"Total Amount"}),t.jsx(Re,{id:"totalAmount",type:"number",value:qe.totalAmount,onChange:B=>{const me=Number(B.target.value||0),Je=me-Number(qe.receivedAmount||0);Bt(mt=>({...mt,totalAmount:me,balanceAmount:Je}))},className:"bg-gray-800 border-gray-200"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"paymentAmount",children:"Received Amount *"}),t.jsx(Re,{id:"paymentAmount",type:"number",value:qe.receivedAmount===0?"":qe.receivedAmount,onChange:B=>{const me=B.target.value===""?"":Number(B.target.value||0),Je=Number(qe.totalAmount||0)-Number(me||0);Bt(mt=>({...mt,receivedAmount:me,balanceAmount:Je}))},className:"bg-gray-800 border-gray-200"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"balanceAmount",children:"Balance Amount"}),t.jsx(Re,{id:"balanceAmount",type:"number",disabled:!0,value:qe.balanceAmount,className:"bg-gray-800 border-gray-200"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"paymentMethod",children:"Payment Method *"}),t.jsxs(ai,{value:qe.paymentMethod||"cash",onChange:B=>{const me=typeof B=="string"?B:B?.target?.value||"cash";Bt(Je=>({...Je,paymentMethod:me}))},className:"bg-gray-800 border-gray-200",children:[t.jsx("option",{value:"cash",children:"Cash"}),t.jsx("option",{value:"online",children:"Online"}),t.jsx("option",{value:"split",children:"Split (Cash + Online)"})]})]})]}),qe.paymentMethod==="online"&&t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"utr",children:"UTR Number "}),t.jsx(Re,{id:"utr",value:qe.utrNumber,onChange:B=>Bt(me=>({...me,utrNumber:B.target.value})),className:"bg-gray-800 border-gray-200"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"onlineDate",children:"Online Payment Date"}),t.jsx(Re,{id:"onlineDate",type:"date",value:qe.onlinePaymentDate,onChange:B=>Bt(me=>({...me,onlinePaymentDate:B.target.value})),className:"bg-gray-800 border-gray-200"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"onlineDetails",children:"Other Details"}),t.jsx(vr,{id:"onlineDetails",value:qe.onlineDetails,onChange:B=>Bt(me=>({...me,onlineDetails:B.target.value})),className:"bg-gray-800 border-gray-200"})]})]}),qe.paymentMethod==="cash"&&t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:"font-semibold",children:"Cash Denominations"}),t.jsx("div",{className:"grid grid-cols-3 gap-3",children:Object.keys(qe.denoms).map(B=>t.jsxs("div",{className:"space-y-1",children:[t.jsxs(Q,{children:["",B]}),t.jsx(Re,{type:"number",min:"0",value:qe.denoms[B],onChange:me=>{const Je=Math.max(0,parseInt(me.target.value||0));Bt(mt=>{const wt={...mt.denoms,[B]:Je},Et=Object.entries(wt).reduce(($t,[Vt,qt])=>$t+Number(Vt)*Number(qt||0),0);return{...mt,denoms:wt,cashTotalFromDenoms:Et}})},className:"bg-gray-800 border-gray-200"})]},B))}),t.jsxs("div",{className:`text-sm ${qe.cashTotalFromDenoms===Number(qe.receivedAmount||0)?"text-green-500":"text-red-500"}`,children:["Total Cash (from denoms): ",qe.cashTotalFromDenoms]})]}),qe.paymentMethod==="split"&&t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"splitCash",children:"Cash Amount"}),t.jsx(Re,{id:"splitCash",type:"number",value:qe.splitCashAmount,onChange:B=>Bt(me=>({...me,splitCashAmount:Number(B.target.value||0)})),className:"bg-gray-800 border-gray-200"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"splitOnline",children:"Online Amount"}),t.jsx(Re,{id:"splitOnline",type:"number",value:qe.splitOnlineAmount,onChange:B=>Bt(me=>({...me,splitOnlineAmount:Number(B.target.value||0)})),className:"bg-gray-800 border-gray-200"})]})]}),t.jsxs("div",{className:"text-sm text-gray-200",children:["Split total: ",Number(qe.splitCashAmount||0)+Number(qe.splitOnlineAmount||0)]}),t.jsx("div",{className:"font-semibold",children:"Cash Denominations"}),t.jsx("div",{className:"grid grid-cols-3 gap-3",children:Object.keys(qe.denoms).map(B=>t.jsxs("div",{className:"space-y-1",children:[t.jsxs(Q,{children:["",B]}),t.jsx(Re,{type:"number",min:"0",value:qe.denoms[B],onChange:me=>{const Je=Math.max(0,parseInt(me.target.value||0));Bt(mt=>{const wt={...mt.denoms,[B]:Je},Et=Object.entries(wt).reduce(($t,[Vt,qt])=>$t+Number(Vt)*Number(qt||0),0);return{...mt,denoms:wt,cashTotalFromDenoms:Et}})},className:"bg-gray-800 border-gray-200"})]},B))}),t.jsxs("div",{className:`text-sm ${qe.cashTotalFromDenoms===Number(qe.splitCashAmount||0)?"text-green-500":"text-red-500"}`,children:["Total Cash (from denoms): ",qe.cashTotalFromDenoms]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"utrSplit",children:"UTR Number (Online)"}),t.jsx(Re,{id:"utrSplit",value:qe.utrNumber,onChange:B=>Bt(me=>({...me,utrNumber:B.target.value})),className:"bg-gray-800 border-gray-200 "})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"onlineDateSplit",children:"Online Payment Date"}),t.jsx(Re,{id:"onlineDateSplit",type:"date",value:qe.onlinePaymentDate,onChange:B=>Bt(me=>({...me,onlinePaymentDate:B.target.value})),className:"bg-gray-800 border-gray-200"})]})]})]}),t.jsxs(yr,{children:[t.jsx(pe,{variant:"outline",onClick:()=>de(!1),children:"Cancel"}),t.jsx(pe,{onClick:Ft,className:"bg-green-600 hover:bg-green-700",children:"Process Payment"})]})]})}),t.jsx(mr,{open:I,onOpenChange:X,children:t.jsxs(fr,{className:"bg-gray-900 border-gray-200 max-w-md",children:[t.jsxs(xr,{children:[t.jsx(pr,{children:"Add Driver Details"}),t.jsx(Ar,{children:"Provide driver information for self delivery"})]}),t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"driverName",children:"Driver Name *"}),t.jsx(Re,{id:"driverName",value:jt.driverName,onChange:B=>Ze(me=>({...me,driverName:B.target.value})),className:"bg-gray-800 border-gray-200"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"driverNumber",children:"Driver Number *"}),t.jsx(Re,{id:"driverNumber",type:"number",value:jt.driverNumber,onChange:B=>Ze(me=>({...me,driverNumber:B.target.value})),className:"bg-gray-800 border-gray-200"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"vehicleNumber",children:"Vehicle Number * "}),t.jsx(Re,{id:"vehicleNumber",value:jt.vehicleNumber,onChange:B=>Ze(me=>({...me,vehicleNumber:B.target.value})),className:"bg-gray-800 border-gray-200"})]})]}),t.jsxs(yr,{children:[t.jsx(pe,{variant:"outline",onClick:()=>X(!1),children:"Cancel"}),t.jsx(pe,{onClick:async()=>{if(!jt.driverName.trim()||!jt.driverNumber.trim()||!jt.vehicleNumber.trim()){Ee({title:"All fields required",variant:"destructive"});return}const B=A;if(!B){X(!1);return}ze(me=>({...me,[B.id]:{...jt}})),X(!1);try{const me={deliveryType:"self delivery",driverDetails:{...jt}},Je=await fetch(`${Fe}/sales/orders/${B.id}/dispatch`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(me)});if(Je.ok){let mt=await Je.json().catch(()=>({}));const wt=mt?.deliveryType||mt?.dispatch?.deliveryType||"self delivery";Ee({title:"Sent to dispatch",description:`Order ${B.orderNumber}`}),d(Et=>Et.map($t=>$t.id===B.id?{...$t,afterSalesStatus:"sent_to_dispatch",deliveryType:wt}:$t))}else{const mt=await Je.json().catch(()=>({}));Ee({title:"Failed to send",description:mt.error||"Try again",variant:"destructive"})}}catch{Ee({title:"Failed to send",description:"Network error",variant:"destructive"})}},className:"bg-blue-600 hover:bg-blue-700",children:"Proceed"})]})]})}),t.jsx(mr,{open:oe,onOpenChange:xe,children:t.jsxs(fr,{className:"max-w-2xl bg-white",children:[t.jsxs(xr,{children:[t.jsx(pr,{className:"text-gray-800",children:"Review Transport Demand"}),t.jsx("p",{className:"text-gray-600",children:"Transport department has rejected the original cost and provided a demand amount."})]}),ee&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-600",children:"Order Number:"}),t.jsx("p",{className:"font-medium text-gray-800",children:ee.orderNumber})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-600",children:"Customer:"}),t.jsx("p",{className:"font-medium text-gray-800",children:ee.customerName})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-600",children:"Delivery Type:"}),t.jsx("p",{className:"font-medium text-gray-800",children:ee.deliveryType})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-gray-600",children:"Product:"}),t.jsx("p",{className:"font-medium text-gray-800",children:ee.productName})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"p-4 border border-blue-200 rounded-lg",children:[t.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Original Transport Cost"}),t.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["",ee.originalTransportCost?.toFixed(2)||"0.00"]})]}),t.jsxs("div",{className:"p-4 border border-red-200 bg-red-50 rounded-lg",children:[t.jsx("h4",{className:"font-medium text-red-800 mb-2",children:"Transport Demand"}),t.jsxs("p",{className:"text-2xl font-bold text-red-600",children:["",ee.demandAmount?.toFixed(2)||"0.00"]})]})]}),ee.transportNotes&&t.jsxs("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[t.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:"Transport Notes"}),t.jsx("p",{className:"text-gray-700",children:ee.transportNotes})]}),t.jsxs("div",{className:"flex gap-3 pt-4",children:[t.jsx(pe,{className:"flex-1 bg-green-600 hover:bg-green-700 text-white",onClick:()=>Ot(ee.id,"accept_demand"),children:"Accept Demand Amount"}),t.jsx(pe,{className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",onClick:()=>{ne(!0)},children:"Confirm with Customer"}),t.jsx(pe,{variant:"outline",onClick:()=>{xe(!1),M(null)},children:"Cancel"})]})]})]})}),t.jsx(mr,{open:H,onOpenChange:B=>{!B&&!R&&(Y({origin:"",destination:"",distance:"",vehicleType:"",distanceCost:0,totalCost:0,discountAmount:0}),we(!1)),ue(B)},children:t.jsxs(fr,{className:"bg-gray-900 border-gray-200 max-w-lg max-h-[90vh] overflow-y-auto",children:[t.jsxs(xr,{children:[t.jsx(pr,{children:"Transport Cost Estimation"}),t.jsx(Ar,{children:"Calculate transport costs for delivery"})]}),t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(Q,{htmlFor:"origin",className:"text-sm",children:"Origin"}),t.jsx(Re,{id:"origin",value:We.origin,onChange:B=>Y(me=>({...me,origin:B.target.value})),placeholder:"Pickup location",className:"bg-gray-800 border-gray-200 text-sm"})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(Q,{htmlFor:"destination",className:"text-sm",children:"Destination"}),t.jsx(Re,{id:"destination",value:We.destination,onChange:B=>Y(me=>({...me,destination:B.target.value})),placeholder:"Delivery location",className:"bg-gray-800 border-gray-200 text-sm"})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(Q,{htmlFor:"distance",className:"text-sm",children:"Distance (km)"}),t.jsx(Re,{id:"distance",type:"number",value:We.distance,onChange:B=>Y(me=>({...me,distance:B.target.value})),placeholder:"km",className:"bg-gray-800 border-gray-200  text-sm"})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(Q,{htmlFor:"discountAmount",className:"text-sm",children:"Discount Amount ()"}),t.jsx(Re,{id:"discountAmount",type:"number",value:We.discountAmount,onChange:B=>Y(me=>({...me,discountAmount:B.target.value})),placeholder:"Enter discount",className:"bg-gray-800 border-gray-200 text-sm"})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(Q,{htmlFor:"vehicle-type",className:"text-sm",children:"Vehicle Type"}),t.jsxs(ai,{value:We.vehicleType,onChange:B=>{const me=typeof B=="string"?B:B?.target?.value;Y(Je=>({...Je,vehicleType:me}))},className:"bg-gray-800 border-gray-200 text-sm",children:[t.jsx("option",{value:"",children:"Select"}),t.jsx("option",{value:"truck",children:"Truck (20/km)"}),t.jsx("option",{value:"van",children:"Van (14/km)"}),t.jsx("option",{value:"motorcycle",children:"Motorcycle (10/km)"}),t.jsx("option",{value:"pickup",children:"Pickup (7/km)"})]})]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(pe,{size:"sm",onClick:()=>{const B={truck:20,van:14,motorcycle:10,pickup:7},me=parseFloat(We.distance)||0,Je=B[We.vehicleType]||0,mt=me*Je,wt=mt,Et=parseFloat(We.discountAmount)||0,$t=Math.max(wt-Et,0);Y(Vt=>({...Vt,distanceCost:mt,totalCost:$t}))},children:"Calculate Cost"}),t.jsx(pe,{variant:"outline",size:"sm",className:"bg-gray-700 border-gray-200 hover:bg-gray-600",onClick:()=>{Y({origin:"",destination:"",distance:"",weight:"",vehicleType:"",baseCost:0,distanceCost:0,weightCost:0,fuelSurcharge:0,totalCost:0})},children:"Reset"})]}),t.jsxs(He,{className:"bg-gray-800 border-gray-200",children:[t.jsx(rt,{className:"pb-2",children:t.jsx(at,{className:"text-base",children:"Cost Breakdown"})}),t.jsxs(Ve,{className:"pt-2",children:[t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Distance Cost (Distance  Vehicle Rate):"}),t.jsxs("span",{className:"font-medium",children:["",We.distanceCost.toFixed(2)]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Discount:"}),t.jsxs("span",{className:"font-medium",children:["- ",(parseFloat(We.discountAmount)||0).toFixed(2)]})]}),t.jsx("hr",{className:"my-2 border-gray-200"}),t.jsxs("div",{className:"flex justify-between text-base font-semibold",children:[t.jsx("span",{children:"Total Cost:"}),t.jsxs("span",{children:["",We.totalCost.toFixed(2)]})]})]}),We.totalCost>0&&t.jsxs("div",{className:"mt-4 space-y-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{id:"includeTransport",type:"checkbox",checked:Dt,onChange:B=>{const me=B.target.checked;we(me)},className:"rounded"}),t.jsx(Q,{htmlFor:"includeTransport",className:"text-sm",children:"Add to order total"})]}),t.jsx(pe,{className:"w-full",onClick:()=>{const B=parseFloat(ye.unitPrice)||0,me=ye.quantity||1;let Je=B*me;Dt?(Je+=We.totalCost,je(mt=>({...mt,transportCost:We.totalCost,discountAmount:parseFloat(mt.discountAmount)||0,totalAmount:Math.max(Je-(parseFloat(mt.discountAmount)||0),0)})),Ee({title:"Added to total",description:`${We.totalCost.toFixed(2)} added to order total`})):(je(mt=>({...mt,transportCost:0,totalAmount:Je})),Ee({title:"Estimation only",description:`${We.totalCost.toFixed(2)} calculated (not added to order)`})),ue(!1)},children:"Proceed"})]})]})]})]}),t.jsx(yr,{children:t.jsx(pe,{variant:"outline",onClick:()=>ue(!1),className:"bg-gray-700 border-gray-200 hover:bg-gray-600",children:"Close"})})]})}),t.jsx(mr,{open:_,onOpenChange:ne,children:t.jsxs(fr,{className:"max-w-md bg-white max-h-[85vh] overflow-y-auto",children:[t.jsxs(xr,{children:[t.jsx(pr,{className:"text-gray-800 text-lg",children:"Customer Negotiation"}),t.jsxs("p",{className:"text-gray-600 text-sm",children:["Transport has demanded ",ee?.demandAmount?.toLocaleString()," for this order."]})]}),ee&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 gap-3 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-600",children:"Order Number:"}),t.jsx("p",{className:"font-medium text-gray-800 text-sm truncate",children:ee.orderNumber})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-600",children:"Customer:"}),t.jsx("p",{className:"font-medium text-gray-800 text-sm truncate",children:ee.customerName})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-600",children:"Original Transport Cost:"}),t.jsxs("p",{className:"font-medium text-red-600 text-sm",children:["",ee.originalTransportCost?.toLocaleString()]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-600",children:"Transport Demand:"}),t.jsxs("p",{className:"font-bold text-orange-600 text-sm",children:["",ee.demandAmount?.toLocaleString()]})]})]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:"Customer Response:"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-start space-x-2",children:[t.jsx("input",{type:"radio",id:"accept",name:"customerResponse",value:"accept",checked:ae.customerResponse==="accept",onChange:B=>G({...ae,customerResponse:B.target.value}),className:"text-green-600 mt-1"}),t.jsxs("label",{htmlFor:"accept",className:"text-gray-700 font-medium text-sm leading-tight",children:["Customer accepts the demand amount (",ee.demandAmount?.toLocaleString(),")"]})]}),t.jsxs("div",{className:"flex items-start space-x-2",children:[t.jsx("input",{type:"radio",id:"reject",name:"customerResponse",value:"reject",checked:ae.customerResponse==="reject",onChange:B=>G({...ae,customerResponse:B.target.value}),className:"text-red-600 mt-1"}),t.jsx("label",{htmlFor:"reject",className:"text-gray-700 font-medium text-sm leading-tight",children:"Customer rejects and wants to negotiate"})]})]}),ae.customerResponse==="reject"&&t.jsxs("div",{className:"mt-3 space-y-3 p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(Q,{htmlFor:"negotiated_amount",className:"text-gray-700 font-medium text-sm",children:"Customer's Counter Offer ()"}),t.jsx(Re,{id:"negotiated_amount",type:"number",value:ae.negotiatedAmount,onChange:B=>G({...ae,negotiatedAmount:B.target.value}),placeholder:"Enter amount",className:"border-gray-300 text-sm"})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(Q,{htmlFor:"customer_notes",className:"text-gray-700 font-medium text-sm",children:"Customer's Reason/Notes"}),t.jsx(vr,{id:"customer_notes",value:ae.customerNotes,onChange:B=>G({...ae,customerNotes:B.target.value}),placeholder:"Why customer is offering this amount...",rows:2,className:"border-gray-300 text-sm resize-none"})]})]})]}),t.jsxs("div",{className:"flex flex-col gap-2 pt-2",children:[ae.customerResponse==="accept"&&t.jsx(pe,{className:"w-full bg-green-600 hover:bg-green-700 text-white text-sm py-2",onClick:()=>{Ot(ee.id,"accept_demand"),ne(!1),G({customerResponse:"",negotiatedAmount:"",customerNotes:""})},children:"Confirm Acceptance"}),ae.customerResponse==="reject"&&t.jsx(pe,{className:"w-full bg-orange-600 hover:bg-orange-700 text-white text-sm py-2",onClick:lt,disabled:!ae.negotiatedAmount||!ae.customerNotes,children:"Send to Transport for Verification"}),t.jsx(pe,{variant:"outline",className:"w-full text-sm py-2",onClick:()=>{ne(!1),G({customerResponse:"",negotiatedAmount:"",customerNotes:""})},children:"Cancel"})]})]})]})})]}),t.jsx("div",{className:"mt-12 bg-white border-2 border-gray-200 rounded-lg p-6 shadow-sm",children:t.jsxs("div",{className:"text-center text-gray-600",children:[t.jsx("p",{className:"font-medium",children:" Sales Management System"}),t.jsx("p",{className:"text-sm mt-1",children:"For technical support, contact IT Department"})]})})]})]})},Q2=()=>{const e=Ls(),{user:r}=Ns(),[s,a]=T.useState("dashboard"),[n,o]=T.useState([]),[c,d]=T.useState({}),[h,m]=T.useState([]),[f,p]=T.useState(!0),[g,N]=T.useState(null),[y,w]=T.useState(!1),[b,C]=T.useState(!1),{toast:A}=Ni(),[E,R]=T.useState({pendingOrders:0,detailsRequired:0}),[V,P]=T.useState({partyName:"",partyContact:"",partyAddress:"",partyEmail:""}),[k,z]=T.useState({notes:"",customerVehicleNo:"",transporterName:"",vehicleNo:""});T.useEffect(()=>{W();const F=setInterval(()=>{te()},3e4);return()=>clearInterval(F)},[]),T.useEffect(()=>{if(c){const F=(c.pendingOrders||0)+(c.selfDeliveryLoadingQueue||0)+(c.partLoadLoadingQueue||0);R({pendingOrders:F,detailsRequired:c.customerDetailsRequired||0})}},[c]);const W=async()=>{try{p(!0);const[F,ee,M]=await Promise.all([fetch(`${Fe}/dispatch/all`),fetch(`${Fe}/dispatch/summary`),fetch(`${Fe}/dispatch/notifications`)]);if(F.ok){const _=await F.json();o(_)}if(ee.ok){const _=await ee.json();d(_)}if(M.ok){const _=await M.json();m(_),_.forEach(ne=>{ne.isNew&&ne.type==="vehicle_entered"&&A({title:" Vehicle Entered for Loading",description:`${ne.message} - Order: ${ne.orderNumber} | Vehicle: ${ne.vehicleNumber}`,className:"bg-gradient-to-r from-green-100 to-emerald-100 border-2 border-green-500 shadow-2xl text-green-900 font-semibold text-lg p-6",duration:8e3})})}}catch(F){console.error("Error fetching data:",F),A({title:"Error",description:"Failed to fetch dispatch data",variant:"destructive"})}finally{p(!1)}},te=async()=>{try{const F=await fetch(`${Fe}/dispatch/notifications`);if(F.ok){const ee=await F.json();m(ee),ee.forEach(M=>{M.isNew&&M.type==="vehicle_entered"&&A({title:" Vehicle Entered for Loading",description:`${M.message} - Order: ${M.orderNumber} | Vehicle: ${M.vehicleNumber}`,className:"bg-gradient-to-r from-green-100 to-emerald-100 border-2 border-green-500 shadow-2xl text-green-900 font-semibold text-lg p-6",duration:8e3})})}}catch(F){console.error("Error fetching notifications:",F)}},de=async(F,ee)=>{try{const M={notes:k.notes};ee==="self"?M.customerVehicleNo=k.customerVehicleNo:(M.transporterName=k.transporterName,M.vehicleNo=k.vehicleNo);const _=await fetch(`${Fe}/dispatch/process/${F}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)});if(_.ok){const ne=await _.json();w(!1),z({notes:"",customerVehicleNo:"",transporterName:"",vehicleNo:""}),ne.status==="customer_details_required"?A({title:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Sr,{className:"w-5 h-5 text-yellow-500"}),t.jsx("span",{children:"Required"})]}),description:t.jsx("p",{className:"text-sm",children:ne.message}),variant:"destructive"}):A({title:"Success",description:ne.message}),W()}else{const ne=await _.json();A({title:"Error",description:ne.error||"Failed to process order",variant:"destructive"})}}catch(M){console.error("Error processing order:",M),A({title:"Error",description:"Failed to process order",variant:"destructive"})}},H=async F=>{try{const ee=await fetch(`${Fe}/dispatch/customer-details/${F}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(V)});if(ee.ok)C(!1),P({partyName:"",partyContact:"",partyAddress:"",partyEmail:""}),A({title:"Success",description:"Customer details updated successfully"}),W();else{const M=await ee.json();A({title:"Error",description:M.error||"Failed to update customer details",variant:"destructive"})}}catch(ee){console.error("Error updating customer details:",ee),A({title:"Error",description:"Failed to update customer details",variant:"destructive"})}},ue=F=>{const M={pending:{color:"bg-yellow-500",text:"Pending"},customer_details_required:{color:"bg-orange-500",text:"Details Required"},ready_for_pickup:{color:"bg-blue-500",text:"ready_for_load"},assigned_transport:{color:"bg-purple-500",text:"Assigned to Transport"},in_transit:{color:"bg-indigo-500",text:"In Transit"},completed:{color:"bg-green-500",text:"Completed"},cancelled:{color:"bg-red-500",text:"Cancelled"}}[F]||{color:"bg-gray-500",text:F};return t.jsx(Lt,{className:`${M.color} text-white`,children:M.text})},I=(F,ee)=>{const M=(ee||F||"").toLowerCase();switch(M){case"company delivery":return t.jsx(Lt,{className:"bg-blue-100 text-blue-800 border border-blue-300 font-medium",children:"COMPANY DELIVERY"});case"part load":return t.jsx(Lt,{className:"bg-amber-100 text-amber-800 border border-amber-300 font-medium",children:"PART LOAD"});case"self delivery":case"self pickup":case"self":return t.jsx(Lt,{className:"bg-yellow-100 text-yellow-800 border border-yellow-300 font-medium",children:"SELF PICKUP"});case"free delivery":case"free company delivery":return t.jsx(Lt,{className:"bg-green-100 text-green-800 border border-green-300 font-medium",children:"FREE DELIVERY"});default:return t.jsx(Lt,{className:"bg-gray-100 text-gray-800 border border-gray-300 font-medium",children:M.toUpperCase()})}},X=F=>{N(F),w(!0)},oe=F=>{N(F),P({partyName:F.customerName||"",partyContact:F.customerContact||"",partyAddress:F.customerAddress||"",partyEmail:F.customerEmail||""}),C(!0)},xe=n.filter(F=>F.status==="pending"),he=n.filter(F=>F.status==="customer_details_required");return t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50",children:[t.jsx("div",{className:"max-w-7xl mx-auto bg-white shadow-md border-b-4 border-green-800 rounded-b-lg",children:t.jsx("div",{className:"px-4 sm:px-6 py-4 sm:py-6",children:t.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:justify-between sm:items-center sm:space-y-0",children:[t.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4",children:[t.jsxs(pe,{onClick:()=>e(r?.department==="admin"?"/dashboard/admin":"/dashboard"),variant:"outline",className:"border border-gray-300 bg-white text-gray-800 text-sm placeholder-gray-500 w-full sm:w-auto",children:[t.jsx(qs,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-600 to-green-800 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx(Sv,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Dispatch Department"}),t.jsx("p",{className:"text-gray-600 text-sm sm:text-base font-medium",children:"Order Dispatch Management System"})]})]})]}),t.jsx("div",{className:"bg-gradient-to-r from-green-50 to-indigo-50 border-2 border-green-200 px-4 py-4 sm:px-6 rounded-lg shadow-sm w-full sm:w-auto",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(Nr,{className:"w-5 h-5 text-blue-600"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 text-xs font-medium",children:"Dispatch Team"}),t.jsx("p",{className:"text-green-600 text-xs font-medium",children:"Order Dispatch Management"})]})]})})]})})}),t.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-4",children:[t.jsx(Rn,{className:"mb-4"}),t.jsxs("div",{className:"px-6 py-6 space-y-6",children:[t.jsxs(an,{value:s,onValueChange:a,className:"space-y-4",children:[t.jsxs(ma,{className:"flex md:grid md:grid-cols-4 w-full overflow-x-auto overflow-y-hidden md:overflow-x-hidden whitespace-nowrap bg-gray-100 border border-gray-300 pl-24 md:pl-0",children:[t.jsx(xt,{value:"dashboard",className:"text-gray-800",children:"Dashboard"}),t.jsxs(xt,{value:"pending",className:"text-gray-800 relative",children:["Pending Orders",E.pendingOrders>0&&t.jsx("div",{className:"absolute -top-2 -right-2 flex items-center justify-center rounded-full bg-red-500 text-white text-xs font-bold min-w-[1.25rem] h-5 px-1",children:E.pendingOrders})]}),t.jsx(xt,{value:"all-orders",className:"text-gray-800",children:"All Orders"}),t.jsxs(xt,{value:"customer-details",className:"text-gray-800 relative",children:["Customer Details",E.detailsRequired>0&&t.jsx("div",{className:"absolute -top-2 -right-2 flex items-center justify-center rounded-full bg-red-500 text-white text-xs font-bold min-w-[1.25rem] h-5 px-1",children:E.detailsRequired})]})]}),t.jsxs(Ut,{value:"dashboard",className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(at,{className:"text-sm font-medium text-gray-800",children:"Pending Orders"}),t.jsx(Ka,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsx(Ve,{children:t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:c.pendingOrders||0})})]}),t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(at,{className:"text-sm font-medium text-gray-800",children:"Details Required"}),t.jsx(Sr,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsx(Ve,{children:t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:c.customerDetailsRequired||0})})]}),t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(at,{className:"text-sm font-medium text-gray-800",children:"In Transit"}),t.jsx(rn,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsx(Ve,{children:t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:c.inTransit||0})})]}),t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(at,{className:"text-sm font-medium text-gray-800",children:"Completed Today"}),t.jsx(dr,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsx(Ve,{children:t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:c.todayCompleted||0})})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsx(rt,{children:t.jsxs(at,{className:"flex items-center gap-2 text-gray-800",children:[t.jsx(fu,{className:"h-5 w-5"}),"Delivery Types"]})}),t.jsx(Ve,{children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-800",children:"Self Pickup"}),t.jsx(Lt,{className:"bg-blue-100 text-blue-800 border border-blue-300 font-medium",children:c.selfDelivery||0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-800",children:"Company Delivery"}),t.jsx(Lt,{className:"bg-green-100 text-green-800 border border-green-300 font-medium",children:c.transportDelivery||0})]})]})})]}),t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsx(rt,{children:t.jsx(at,{className:"text-gray-800",children:"Recent Activity"})}),t.jsx(Ve,{children:t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-800",children:"Today's Dispatches"}),t.jsx("span",{className:"font-semibold text-gray-800",children:c.todayDispatches||0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-800",children:"Today's Completed"}),t.jsx("span",{className:"font-semibold text-gray-800",children:c.todayCompleted||0})]})]})})]})]})]}),t.jsxs(Ut,{value:"pending",className:"space-y-4",children:[t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{children:[t.jsxs(at,{className:"flex items-center gap-2 text-gray-800",children:[t.jsx(Ks,{className:"h-5 w-5"}),"Pending Dispatch Orders (",xe.length,")"]}),t.jsx(gr,{className:"text-gray-600",children:"Orders waiting to be processed and sent to appropriate departments"})]}),t.jsx(Ve,{className:"overflow-x-auto",children:f?t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx(Cr,{className:"w-12 h-12 animate-spin mx-auto mb-4 text-blue-600"}),t.jsx("p",{className:"text-gray-800 text-lg font-medium",children:"Loading Dispatch dashboard..."}),t.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Please wait while we retrieve the data"})]})}):xe.length===0?t.jsxs("div",{className:"text-center py-8 text-gray-600",children:[t.jsx(Ks,{className:"mx-auto h-12 w-12 mb-4"}),t.jsx("p",{children:"No pending dispatch orders"})]}):t.jsxs(zr,{children:[t.jsx(Kr,{children:t.jsxs(At,{children:[t.jsx(Pe,{className:"text-black",children:"Order #"}),t.jsx(Pe,{className:"text-black",children:"Product"}),t.jsx(Pe,{className:"text-black",children:"Customer"}),t.jsx(Pe,{className:"text-black",children:"Delivery Type"}),t.jsx(Pe,{className:"text-black",children:"Quantity"}),t.jsx(Pe,{className:"text-black",children:"Amount"}),t.jsx(Pe,{className:"text-black",children:"Actions"})]})}),t.jsx(Xr,{children:xe.map(F=>t.jsxs(At,{children:[t.jsx(be,{className:"font-medium text-gray-800",children:F.orderNumber}),t.jsx(be,{className:"text-gray-800",children:F.productName}),t.jsx(be,{children:t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-800",children:F.customerName}),t.jsx("div",{className:"text-sm text-gray-600",children:F.customerContact})]})}),t.jsx(be,{children:I(F.deliveryType,F.originalDeliveryType)}),t.jsx(be,{className:"text-gray-800",children:F.quantity}),t.jsxs(be,{className:"text-gray-800",children:["",F.finalAmount?.toFixed(2)]}),t.jsx(be,{children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(pe,{size:"sm",onClick:()=>X(F),className:"bg-blue-600 hover:bg-blue-700",children:"Process"}),(!F.customerContact||!F.customerAddress)&&t.jsx(pe,{size:"sm",variant:"outline",onClick:()=>oe(F),children:"Update Details"})]})})]},F.id))})]})})]}),t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{children:[t.jsxs(at,{className:"flex items-center gap-2 text-gray-800",children:[t.jsx(Sv,{className:"h-5 w-5"})," Self-Delivery Loading Queue"]}),t.jsx(gr,{className:"text-gray-600",children:"Orders in self-delivery flow. Load when status is Entered for Pickup."})]}),t.jsx(Ve,{className:"overflow-x-auto",children:t.jsxs(zr,{children:[t.jsx(Kr,{children:t.jsxs(At,{children:[t.jsx(Pe,{className:"text-black",children:"Order #"}),t.jsx(Pe,{className:"text-black",children:"Customer"}),t.jsx(Pe,{className:"text-black",children:"Vehicle"}),t.jsx(Pe,{className:"text-black",children:"Driver Name"}),t.jsx(Pe,{className:"text-black",children:"Status"}),t.jsx(Pe,{className:"text-black",children:"Actions"})]})}),t.jsxs(Xr,{children:[n.filter(F=>F.deliveryType==="self"&&["ready_for_load","entered_for_pickup"].includes(F.status)).map(F=>t.jsxs(At,{children:[t.jsx(be,{className:"font-medium text-gray-800",children:F.orderNumber}),t.jsx(be,{className:"text-gray-800",children:F.customerName}),t.jsx(be,{className:"text-gray-800",children:F.customerVehicle||"-"}),t.jsx(be,{className:"text-gray-800",children:F.driverName||"-"}),t.jsx(be,{children:ue(F.status)}),t.jsx(be,{children:t.jsx("div",{className:"flex gap-2",children:t.jsx(pe,{size:"sm",variant:"outline",disabled:F.status!=="entered_for_pickup",onClick:async()=>{const ee=await fetch(`${Fe}/dispatch/self/loaded/${F.id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({notes:"Loaded by dispatch"})});if(ee.ok)A({title:"Loaded",description:`Order ${F.orderNumber} marked loaded`}),W();else{const M=await ee.json().catch(()=>({}));A({title:"Failed",description:M.error||"Try again",variant:"destructive"})}},children:"Mark Loaded"})})})]},F.id)),n.filter(F=>F.deliveryType==="self"&&["ready_for_load","entered_for_pickup"].includes(F.status)).length===0&&t.jsx(At,{children:t.jsx(be,{colSpan:6,className:"text-center py-8 text-gray-600",children:"No self-delivery orders ready for loading."})})]})]})})]}),t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{children:[t.jsxs(at,{className:"flex items-center gap-2 text-gray-800",children:[t.jsx(rn,{className:"h-5 w-5"})," Part Load - Delivery Loading Queue"]}),t.jsx(gr,{className:"text-gray-600",children:"Part Load orders ready for loading. Load when status is Ready for Pickup."})]}),t.jsx(Ve,{className:"overflow-x-auto",children:t.jsxs(zr,{children:[t.jsx(Kr,{children:t.jsxs(At,{children:[t.jsx(Pe,{className:"text-black",children:"Order #"}),t.jsx(Pe,{className:"text-black",children:"Customer"}),t.jsx(Pe,{className:"text-black",children:"Vehicle"}),t.jsx(Pe,{className:"text-black",children:"Driver Name"}),t.jsx(Pe,{className:"text-black",children:"Company"}),t.jsx(Pe,{className:"text-black",children:"Status"}),t.jsx(Pe,{className:"text-black",children:"Actions"})]})}),t.jsxs(Xr,{children:[n.filter(F=>F.originalDeliveryType?.toLowerCase()==="part load"&&["ready_for_pickup","entered_for_pickup"].includes(F.status)).map(F=>t.jsxs(At,{children:[t.jsx(be,{className:"font-medium text-gray-800",children:F.orderNumber}),t.jsx(be,{className:"text-gray-800",children:F.customerName}),t.jsx(be,{className:"text-gray-800",children:F.customerVehicle||F.vehicleNumber||"-"}),t.jsx(be,{className:"text-gray-800",children:F.driverName||"-"}),t.jsx(be,{className:"text-gray-800",children:F.companyName||F.transporterName||"-"}),t.jsx(be,{children:ue(F.status)}),t.jsx(be,{children:t.jsx("div",{className:"flex gap-2",children:t.jsx(pe,{size:"sm",variant:"outline",disabled:F.status!=="entered_for_pickup",onClick:async()=>{const ee=await fetch(`${Fe}/dispatch/part-load/loaded/${F.id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({notes:"Part Load loaded by dispatch"})});if(ee.ok)A({title:"Loaded",description:`Part Load order ${F.orderNumber} marked loaded`}),W();else{const M=await ee.json().catch(()=>({}));A({title:"Failed",description:M.error||"Try again",variant:"destructive"})}},children:"Mark Loaded"})})})]},F.id)),n.filter(F=>F.originalDeliveryType?.toLowerCase()==="part load"&&["ready_for_pickup","entered_for_pickup"].includes(F.status)).length===0&&t.jsx(At,{children:t.jsx(be,{colSpan:7,className:"text-center py-8 text-gray-600",children:"No Part Load orders ready for loading."})})]})]})})]})]}),t.jsx(Ut,{value:"all-orders",className:"space-y-4",children:t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsx(rt,{children:t.jsxs(at,{className:"flex items-center gap-2 text-gray-800",children:[t.jsx(KN,{className:"h-5 w-5"}),"All Dispatch Orders (",n.length,")"]})}),t.jsx(Ve,{className:"overflow-x-auto",children:f?t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx(Cr,{className:"w-12 h-12 animate-spin mx-auto mb-4 text-blue-600"}),t.jsx("p",{className:"text-gray-800 text-lg font-medium",children:"Loading Dispatch dashboard..."}),t.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Please wait while we retrieve the data"})]})}):t.jsxs(zr,{children:[t.jsx(Kr,{children:t.jsxs(At,{children:[t.jsx(Pe,{className:"text-black",children:"Order #"}),t.jsx(Pe,{className:"text-black",children:"Product"}),t.jsx(Pe,{className:"text-black",children:"Customer"}),t.jsx(Pe,{className:"text-black",children:"Delivery Type"}),t.jsx(Pe,{className:"text-black",children:"Status"}),t.jsx(Pe,{className:"text-black",children:"Quantity"}),t.jsx(Pe,{className:"text-black",children:"Created"})]})}),t.jsx(Xr,{children:n.filter(F=>!(F.deliveryType==="self"&&["ready_for_load","entered_for_pickup"].includes(F.status))).map(F=>t.jsxs(At,{children:[t.jsx(be,{className:"font-medium text-gray-800",children:F.orderNumber}),t.jsx(be,{className:"text-gray-800",children:F.productName}),t.jsx(be,{className:"text-gray-800",children:F.customerName}),t.jsx(be,{children:I(F.deliveryType,F.originalDeliveryType)}),t.jsx(be,{children:ue(F.status)}),t.jsx(be,{className:"text-gray-800",children:F.quantity}),t.jsx(be,{className:"text-gray-800",children:F.createdAt})]},F.id))})]})})]})}),t.jsx(Ut,{value:"customer-details",className:"space-y-4",children:t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{children:[t.jsxs(at,{className:"flex items-center gap-2 text-gray-800",children:[t.jsx(Nr,{className:"h-5 w-5"}),"Orders Requiring Customer Details (",he.length,")"]}),t.jsx(gr,{className:"text-gray-600",children:"Orders that need complete customer details before processing"})]}),t.jsx(Ve,{className:"overflow-x-auto",children:he.length===0?t.jsxs("div",{className:"text-center py-8 text-gray-600",children:[t.jsx(Nr,{className:"mx-auto h-12 w-12 mb-4"}),t.jsx("p",{children:"No orders requiring customer details"})]}):t.jsxs(zr,{children:[t.jsx(Kr,{children:t.jsxs(At,{children:[t.jsx(Pe,{className:"text-black",children:"Order #"}),t.jsx(Pe,{className:"text-black",children:"Customer"}),t.jsx(Pe,{className:"text-black",children:"Missing Details"}),t.jsx(Pe,{className:"text-black",children:"Delivery Type"}),t.jsx(Pe,{className:"text-black",children:"Actions"})]})}),t.jsx(Xr,{children:he.map(F=>{const ee=[];return F.customerContact||ee.push("Contact"),F.customerAddress||ee.push("Address"),t.jsxs(At,{children:[t.jsx(be,{className:"font-medium text-gray-800",children:F.orderNumber}),t.jsx(be,{className:"text-gray-800",children:F.customerName}),t.jsx(be,{children:t.jsx("div",{className:"flex gap-1",children:ee.map(M=>t.jsx(Lt,{className:"bg-red-100 text-red-800 border border-red-300 font-medium text-xs",children:M},M))})}),t.jsx(be,{children:I(F.deliveryType,F.originalDeliveryType)}),t.jsx(be,{children:t.jsx(pe,{size:"sm",onClick:()=>oe(F),children:"Update Details"})})]},F.id)})})]})})]})})]}),t.jsx(mr,{open:y,onOpenChange:w,children:t.jsxs(fr,{className:"max-w-md",children:[t.jsxs(xr,{children:[t.jsx(pr,{children:"Process Dispatch Order"}),t.jsx(Ar,{children:g&&t.jsxs(t.Fragment,{children:["Process order ",g.orderNumber," for ",g.deliveryType," delivery"]})})]}),g&&t.jsx("div",{className:"space-y-4",children:t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"notes",children:"Processing Notes"}),t.jsx(vr,{id:"notes",placeholder:"Add any notes for this dispatch...",value:k.notes,onChange:F=>z(ee=>({...ee,notes:F.target.value}))})]})}),t.jsxs(yr,{children:[t.jsx(pe,{variant:"outline",onClick:()=>w(!1),children:"Cancel"}),t.jsx(pe,{onClick:()=>de(g?.id,g?.deliveryType),children:g?.deliveryType==="self"?"Send to Watchman":"Send to Transport"})]})]})}),t.jsx(mr,{open:b,onOpenChange:C,children:t.jsxs(fr,{className:"max-w-md",children:[t.jsxs(xr,{children:[t.jsx(pr,{children:"Update Customer Details"}),t.jsx(Ar,{children:"Complete missing customer information for order processing"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"customerName",children:"Customer Name *"}),t.jsx(Re,{id:"customerName",value:V.partyName,onChange:F=>P(ee=>({...ee,partyName:F.target.value})),placeholder:"Enter customer name"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"customerContact",children:"Contact Number *"}),t.jsx(Re,{id:"customerContact",value:V.partyContact,onChange:F=>P(ee=>({...ee,partyContact:F.target.value})),placeholder:"Enter contact number"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"customerEmail",children:"Email Address"}),t.jsx(Re,{id:"customerEmail",type:"email",value:V.partyEmail,onChange:F=>P(ee=>({...ee,partyEmail:F.target.value})),placeholder:"Enter email address"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"customerAddress",children:"Address *"}),t.jsx(vr,{id:"customerAddress",value:V.partyAddress,onChange:F=>P(ee=>({...ee,partyAddress:F.target.value})),placeholder:"Enter complete address",rows:3})]})]}),t.jsxs(yr,{children:[t.jsx(pe,{variant:"outline",onClick:()=>C(!1),children:"Cancel"}),t.jsx(pe,{onClick:()=>H(g?.id),children:"Update Details"})]})]})})]}),t.jsx("div",{className:"mt-12 bg-white border-2 border-gray-200 rounded-lg p-6 shadow-sm",children:t.jsxs("div",{className:"text-center text-gray-600",children:[t.jsx("p",{className:"font-medium",children:" Sales Management System"}),t.jsx("p",{className:"text-sm mt-1",children:"For technical support, contact IT Department"})]})})]})]})},P5=()=>{const[e,r]=T.useState([]),[s,a]=T.useState([]),[n,o]=T.useState([]),[c,d]=T.useState(null),[h,m]=T.useState(!1),[f,p]=T.useState("System Ready"),[g,N]=T.useState(!1),[y,w]=T.useState(!1),[b,C]=T.useState(!1),[A,E]=T.useState(!1),[R,V]=T.useState(!1),[P,k]=T.useState(!1),[z,W]=T.useState({name:"",phone:"",photo:null}),[te,de]=T.useState({reason:"Office Work",details:""}),[H,ue]=T.useState({phone:"",details:""}),[I,X]=T.useState({phone:"",details:""}),[oe,xe]=T.useState(null),{toast:he}=Ni(),[F,ee]=T.useState(!1),[M,_]=T.useState(null),[ne,ae]=T.useState(null),[G,ie]=T.useState("entry"),[Me,Ee]=T.useState(!1),[ye,je]=T.useState({}),We=T.useRef(null),Y=T.useRef(null),Dt=T.useRef(null),we=T.useRef(null),ot=T.useRef(null);T.useEffect(()=>{Ue(),Nt(),qe();const Oe=setInterval(()=>{Nt(),qe()},3e4);return()=>clearInterval(Oe)},[]),T.useEffect(()=>()=>{ht(),jt(),ot.current&&ot.current.close()},[]);const Ye=async()=>{try{ot.current||(ot.current=new(window.AudioContext||window.webkitAudioContext));const Oe=ot.current;Oe.state==="suspended"&&await Oe.resume();const U=Oe.createOscillator(),ve=Oe.createGain();U.connect(ve),ve.connect(Oe.destination),U.frequency.setValueAtTime(800,Oe.currentTime),U.type="sine",ve.gain.setValueAtTime(.3,Oe.currentTime),ve.gain.exponentialRampToValueAtTime(.01,Oe.currentTime+.3),U.start(Oe.currentTime),U.stop(Oe.currentTime+.3)}catch(Oe){console.error("Error playing beep sound:",Oe)}},Ue=async()=>{try{const Oe=await fetch(`${Fe}/gate-entry/users`);if(Oe.ok){const U=await Oe.json();r(U)}}catch(Oe){console.error("Error loading users:",Oe)}},Nt=async()=>{try{const[Oe,U]=await Promise.all([fetch(`${Fe}/gate-entry/logs?limit=50`),fetch(`${Fe}/gate-entry/going-out-logs?limit=50`)]);if(Oe.ok){const ve=await Oe.json();a(ve)}if(U.ok){const ve=await U.json();o(ve)}}catch(Oe){console.error("Error loading logs:",Oe)}},qe=async()=>{try{const Oe=await fetch(`${Fe}/gate-entry/today-logs`);if(Oe.ok){const U=await Oe.json();d(U)}}catch(Oe){console.error("Error loading today summary:",Oe)}},Bt=async()=>{try{_(null);const Oe=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:640},height:{ideal:480},facingMode:"user"}});We.current&&(We.current.srcObject=Oe,Y.current=Oe,await new Promise(U=>{We.current.onloadedmetadata=()=>{We.current.play().then(()=>{U()}).catch(ve=>{console.error("Error playing video:",ve),U()})}}),ee(!0),he({title:"Camera Started",description:"Camera feed is now active"}))}catch(Oe){console.error("Error accessing camera:",Oe);let U="Failed to access camera. Please check permissions.";Oe.name==="NotAllowedError"?U="Camera access denied. Please allow camera permissions.":Oe.name==="NotFoundError"?U="No camera found on this device.":Oe.name==="NotReadableError"&&(U="Camera is already in use by another application."),_(U),he({title:"Camera Error",description:U,variant:"destructive"})}},jt=()=>{Y.current&&(Y.current.getTracks().forEach(Oe=>Oe.stop()),Y.current=null),We.current&&(We.current.srcObject=null),ee(!1),_(null)},Ze=(Oe=!1)=>{if(!We.current||!Dt.current)return console.warn(" capturePhoto: Video or canvas ref not available"),null;const U=We.current,ve=Dt.current;if(U.readyState<2)return console.warn(` capturePhoto: Video not ready. readyState=${U.readyState} (need >= 2)`),null;if(!U.videoWidth||!U.videoHeight)return console.warn(" capturePhoto: Video dimensions invalid",{videoWidth:U.videoWidth,videoHeight:U.videoHeight}),null;try{ve.width=U.videoWidth,ve.height=U.videoHeight,ve.getContext("2d").drawImage(U,0,0,ve.width,ve.height);const vt=ve.toDataURL("image/jpeg",.8);return console.log(` capturePhoto: Successfully captured photo (${ve.width}x${ve.height})`),Oe&&ae(vt),vt}catch(ct){return console.error(" capturePhoto: Error during capture:",ct),null}},Xt=async()=>{if(!Me)try{Ee(!0);const Oe=Ze();if(!Oe)return;p("Scanning for faces...");const ve=await(await fetch(`${Fe}/gate-entry/recognize-face`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({photo:Oe,action:G})})).json();if(ve.recognized){const ct=ve.user.id,vt=Date.now(),L=ye[ct]||0,ce=3e4;if(vt-L<ce){const Be=Math.ceil((ce-(vt-L))/1e3);p(`Cooldown active for ${ve.user.name} - ${Be}s remaining`);return}if(je(Be=>({...Be,[ct]:vt})),ve.success)p(`Recognized: ${ve.user.name} - ${G==="entry"?"Entry":"Exit"} Recorded`),await Ye(),he({title:"Face Recognized!",description:`${ve.user.name} - ${G==="entry"?"Entry":"Exit"} recorded (${ve.confidence}% confidence)`,duration:3e3}),Nt(),qe(),setTimeout(()=>{p("Recognition Active - Scanning...")},2e3);else{const Be=G==="entry"?"Entry":"Exit";p(`${Be} Blocked: ${ve.message}`),he({title:`${Be} Blocked`,description:ve.message,variant:"destructive",duration:5e3}),setTimeout(()=>{p("Recognition Active - Scanning...")},3e3)}}else p("No face detected - Keep scanning...")}catch(Oe){console.error("Error during face recognition:",Oe),p("Recognition Active - Scanning...")}finally{Ee(!1)}},ze=()=>{we.current&&clearInterval(we.current),we.current=setInterval(()=>{Xt()},2e3)},ht=()=>{we.current&&(clearInterval(we.current),we.current=null)},nt=async()=>{await Bt(),Y.current?(m(!0),p("Recognition Active - Scanning..."),ze(),he({title:"Recognition Started",description:"Face recognition system is now active"})):he({title:"Recognition Failed",description:"Failed to start camera for recognition",variant:"destructive"})},Ot=()=>{ht(),jt(),m(!1),p("System Ready"),he({title:"Recognition Stopped",description:"Face recognition system has been stopped"})},lt=()=>{V(!0)},Jt=()=>{k(!0)},et=()=>{he({title:"Emergency Override",description:"Emergency override activated - all security checks bypassed",variant:"destructive"})},Ft=()=>{if(!oe){he({title:"Error",description:"Please select a user first",variant:"destructive"});return}w(!0)},kt=async()=>{if(!oe){he({title:"Error",description:"Please select a user first",variant:"destructive"});return}try{const Oe=await fetch(`${Fe}/gate-entry/coming-back`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:oe.phone})}),U=await Oe.json();Oe.ok?(he({title:"Coming Back Recorded",description:U.message}),Nt(),qe()):he({title:"Error",description:U.message||"Failed to record coming back",variant:"destructive"})}catch(Oe){console.error("Error recording coming back:",Oe),he({title:"Error",description:"Failed to record coming back",variant:"destructive"})}},er=async()=>{W({name:"",phone:"",photo:null}),ae(null),N(!0)},B=()=>{he({title:"Users Loaded",description:`Found ${e.length} registered users`})},me=async()=>{if(!oe){he({title:"Error",description:"Please select a user to delete",variant:"destructive"});return}if(window.confirm(`Are you sure you want to delete user ${oe.name}?`))try{const Oe=await fetch(`${Fe}/gate-entry/users/${oe.phone}`,{method:"DELETE"}),U=await Oe.json();Oe.ok?(he({title:"User Deleted",description:`${oe.name} has been removed from the system`}),xe(null),Ue()):he({title:"Error",description:U.message||"Failed to delete user",variant:"destructive"})}catch(Oe){console.error("Error deleting user:",Oe),he({title:"Error",description:"Failed to delete user",variant:"destructive"})}},Je=()=>{C(!0)},mt=()=>{E(!0)},wt=async()=>{if(!F){he({title:"Camera not active",description:"Start the camera first.",variant:"destructive"});return}if(!z.name.trim()||!z.phone.trim()){he({title:"Error",description:"Please fill in name and phone first",variant:"destructive"});return}try{p(" Preparing camera for photo capture...");let Oe=[];const U=7,ve=3;await new Promise(L=>setTimeout(L,500)),p(" Capturing 7 photos for face encoding..."),console.log(" Starting photo capture sequence...");for(let L=0;L<U;L++){let ce=null,Be=0;for(;!ce&&Be<ve;){if(Be++,We.current&&We.current.paused){console.warn(" Video was paused, attempting to resume...");try{We.current.play()}catch(Pt){console.warn(" Could not resume video:",Pt)}}if(ce=Ze(),!ce&&Be<ve){const Pt=150+Be*50;console.warn(` Capture attempt ${Be}/${ve} failed, retrying in ${Pt}ms...`),await new Promise(ar=>setTimeout(ar,Pt))}}ce?(Oe.push(ce),console.log(` Photo ${L+1}/7 captured successfully`),p(` Captured ${L+1}/${U} photos...`)):(console.warn(` Photo ${L+1}/7 failed after ${ve} attempts`),p(` Capture ${L+1}/${U} failed, continuing...`)),await new Promise(Pt=>setTimeout(Pt,400))}if(console.log(` Capture complete. Got ${Oe.length}/${U} photos`),Oe.length<3){he({title:" Insufficient Photos",description:`Only captured ${Oe.length} photos. Need at least 3. Please ensure camera is working and lighting is good.`,variant:"destructive"}),p("System Ready");return}p(` Registering user with ${Oe.length} face photos...`),console.log(` Sending ${Oe.length} photos to backend for registration...`);const ct=await fetch(`${Fe}/gate-entry/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:z.name,phone:z.phone,photos:Oe})}),vt=await ct.json();if(console.log(" Backend response:",vt),ct.ok){const L=vt.face_encodings_count||Oe.length;console.log(` Registration successful! Generated ${L} face encodings`),he({title:" User Registered Successfully",description:`Registered with ${L} face encodings from ${Oe.length} photos!`}),N(!1),W({name:"",phone:"",photo:null}),ae(null),jt(),Ue(),p("System Ready")}else console.error(" Registration failed:",vt),he({title:" Registration Failed",description:vt.message||"Failed to register user with captured photos",variant:"destructive"}),p("System Ready")}catch(Oe){console.error(" Error during capture/registration:",Oe),he({title:"Error",description:`Registration failed: ${Oe.message||Oe}`,variant:"destructive"}),p("System Ready")}},Et=async()=>{if(!oe){he({title:"Error",description:"Please select a user",variant:"destructive"});return}try{const Oe=await fetch(`${Fe}/gate-entry/going-out`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:oe.phone,reason_type:te.reason,reason_details:te.details})}),U=await Oe.json();Oe.ok?(he({title:"Going Out Recorded",description:U.message}),w(!1),de({reason:"Office Work",details:""}),Nt(),qe()):he({title:"Error",description:U.message||"Failed to record going out",variant:"destructive"})}catch(Oe){console.error("Error recording going out:",Oe),he({title:"Error",description:"Failed to record going out",variant:"destructive"})}},$t=async()=>{if(!H.phone.trim()){he({title:"Error",description:"Phone number is required",variant:"destructive"});return}try{const Oe=await fetch(`${Fe}/gate-entry/manual-entry`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:H.phone,details:H.details})}),U=await Oe.json();Oe.ok?(he({title:"Success",description:U.message}),V(!1),ue({phone:"",details:""}),Nt(),qe()):he({title:"Error",description:U.message||"Failed to record manual entry",variant:"destructive"})}catch(Oe){console.error("Error recording manual entry:",Oe),he({title:"Error",description:"Failed to record manual entry",variant:"destructive"})}},Vt=async()=>{if(!I.phone.trim()){he({title:"Error",description:"Phone number is required",variant:"destructive"});return}try{const Oe=await fetch(`${Fe}/gate-entry/manual-exit`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:I.phone,details:I.details})}),U=await Oe.json();Oe.ok?(he({title:"Success",description:U.message}),k(!1),X({phone:"",details:""}),Nt(),qe()):he({title:"Error",description:U.message||"Failed to record manual exit",variant:"destructive"})}catch(Oe){console.error("Error recording manual exit:",Oe),he({title:"Error",description:"Failed to record manual exit",variant:"destructive"})}},qt=Oe=>{if(!Oe)return"N/A";try{return new Date(Oe).toLocaleString("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return Oe}},ls=async(Oe="all")=>{try{he({title:"Downloading...",description:"Preparing Excel file for download"});const U=await fetch(`${Fe}/gate-entry/export-logs?type=${Oe}`);if(!U.ok)throw new Error("Failed to download logs");const ve=await U.blob(),ct=window.URL.createObjectURL(ve),vt=document.createElement("a");vt.href=ct,vt.download=`gate_logs_${new Date().toISOString().split("T")[0]}.xlsx`,document.body.appendChild(vt),vt.click(),window.URL.revokeObjectURL(ct),document.body.removeChild(vt),he({title:"Download Complete",description:"Gate logs have been downloaded successfully"})}catch(U){console.error("Error downloading logs:",U),he({title:"Download Failed",description:"Failed to download gate logs",variant:"destructive"})}};return t.jsxs("div",{className:"space-y-4",children:[t.jsx("canvas",{ref:Dt,style:{display:"none"}}),c&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsx(He,{className:"bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:t.jsx(Ve,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-green-600",children:"Total Entries"}),t.jsx("p",{className:"text-3xl font-bold text-green-700",children:c.total_entries||0})]}),t.jsx(Rv,{className:"h-10 w-10 text-green-600 opacity-50"})]})})}),t.jsx(He,{className:"bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200",children:t.jsx(Ve,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-orange-600",children:"Total Exits"}),t.jsx("p",{className:"text-3xl font-bold text-orange-700",children:c.total_exits||0})]}),t.jsx(xu,{className:"h-10 w-10 text-orange-600 opacity-50"})]})})}),t.jsx(He,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:t.jsx(Ve,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-blue-600",children:"Currently Inside"}),t.jsx("p",{className:"text-3xl font-bold text-blue-700",children:c.currently_inside||0})]}),t.jsx(Nr,{className:"h-10 w-10 text-blue-600 opacity-50"})]})})}),t.jsx(He,{className:"bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:t.jsx(Ve,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-purple-600",children:"Currently Out"}),t.jsx("p",{className:"text-3xl font-bold text-purple-700",children:c.currently_out||0})]}),t.jsx(Ka,{className:"h-10 w-10 text-purple-600 opacity-50"})]})})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{children:[t.jsxs(at,{className:"flex items-center gap-2 text-gray-800",children:[t.jsx(yn,{className:"h-5 w-5"}),"Live Camera Feed"]}),t.jsx(gr,{className:"text-gray-600",children:"Camera for face recognition and manual verification"})]}),t.jsxs(Ve,{children:[t.jsxs("div",{className:"aspect-video bg-gray-900 rounded-lg overflow-hidden mb-4 relative",children:[t.jsx("video",{ref:We,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover",style:{display:F?"block":"none"}}),!F&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500 bg-gray-100",children:t.jsxs("div",{className:"text-center",children:[t.jsx(qh,{className:"w-16 h-16 mx-auto mb-2"}),t.jsx("p",{className:"text-lg font-medium",children:"Camera Off"}),t.jsx("p",{className:"text-sm",children:'Click "Start Recognition" to begin'}),M&&t.jsx("p",{className:"text-red-500 text-xs mt-2 max-w-xs",children:M})]})})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx(Q,{className:"text-gray-700 mb-2 block",children:"Recognition Action"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(pe,{variant:G==="entry"?"default":"outline",className:`flex-1 ${G==="entry"?"bg-green-600 hover:bg-green-700":""}`,onClick:()=>ie("entry"),disabled:h,children:[t.jsx(Rv,{className:"h-4 w-4 mr-2"}),"Entry"]}),t.jsxs(pe,{variant:G==="exit"?"default":"outline",className:`flex-1 ${G==="exit"?"bg-red-600 hover:bg-red-700":""}`,onClick:()=>ie("exit"),disabled:h,children:[t.jsx(xu,{className:"h-4 w-4 mr-2"}),"Exit"]})]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(pe,{className:"flex-1 bg-blue-600 hover:bg-blue-700",onClick:nt,disabled:h,children:[t.jsx(dr,{className:"h-4 w-4 mr-2"}),"Start Recognition"]}),t.jsxs(pe,{variant:"outline",className:"flex-1",onClick:Ot,disabled:!h,children:[t.jsx(en,{className:"h-4 w-4 mr-2"}),"Stop Recognition"]})]})]})]}),t.jsx(He,{className:"bg-white border border-gray-300 shadow-sm",children:t.jsx(Ve,{className:"pt-6",children:t.jsxs("div",{className:"text-center py-8",children:[t.jsx("div",{className:"text-2xl font-bold text-gray-800 mb-2",children:f}),t.jsx("div",{className:"text-gray-600",children:h?"Face recognition is active...":"Waiting for recognition to start..."})]})})}),t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsx(rt,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs(at,{className:"text-gray-800",children:["Registered Users (",e.length,")"]}),t.jsx(pe,{size:"sm",variant:"outline",onClick:Ue,children:t.jsx(Cr,{className:"h-4 w-4"})})]})}),t.jsx(Ve,{children:t.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[e.map(Oe=>t.jsx("div",{className:`p-3 rounded-lg border cursor-pointer transition-all ${oe?.id===Oe.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,onClick:()=>xe(Oe),children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-800",children:Oe.name}),t.jsx("div",{className:"text-sm text-gray-600",children:Oe.phone})]}),t.jsx(Lt,{className:`${Oe.status==="active"?"bg-green-100 text-green-800 border-green-300":"bg-gray-100 text-gray-800 border-gray-300"}`,children:Oe.status||"Active"})]})},Oe.id)),e.length===0&&t.jsx("p",{className:"text-gray-600 text-center py-4",children:"No users registered yet"})]})})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsx(rt,{children:t.jsx(at,{className:"text-gray-800",children:"Manual Controls"})}),t.jsxs(Ve,{className:"space-y-3",children:[t.jsxs(pe,{className:"w-full bg-blue-600 hover:bg-blue-700",onClick:lt,children:[t.jsx(Nn,{className:"h-4 w-4 mr-2"}),"Manual Entry"]}),t.jsxs(pe,{className:"w-full bg-orange-600 hover:bg-orange-700",onClick:Jt,children:[t.jsx(qs,{className:"h-4 w-4 mr-2"}),"Manual Exit"]}),t.jsxs(pe,{className:"w-full bg-red-600 hover:bg-red-700",onClick:et,children:[t.jsx(WN,{className:"h-4 w-4 mr-2"}),"Emergency Override"]})]})]}),t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsx(rt,{children:t.jsx(at,{className:"text-gray-800",children:"Going Out"})}),t.jsxs(Ve,{className:"space-y-3",children:[t.jsxs(pe,{className:"w-full bg-purple-600 hover:bg-purple-700",onClick:Ft,disabled:!oe,children:[t.jsx(Nr,{className:"h-4 w-4 mr-2"}),"Going Out"]}),t.jsxs(pe,{className:"w-full bg-indigo-600 hover:bg-indigo-700",onClick:kt,disabled:!oe,children:[t.jsx(qs,{className:"h-4 w-4 mr-2"}),"Coming Back"]})]})]}),t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsx(rt,{children:t.jsx(at,{className:"text-gray-800",children:"User Management"})}),t.jsxs(Ve,{className:"space-y-3",children:[t.jsxs(pe,{className:"w-full bg-green-600 hover:bg-green-700",onClick:er,children:[t.jsx(Nn,{className:"h-4 w-4 mr-2"}),"Register User"]}),t.jsxs(pe,{className:"w-full bg-blue-600 hover:bg-blue-700",onClick:B,children:[t.jsx(Nr,{className:"h-4 w-4 mr-2"}),"View Users"]}),t.jsxs(pe,{className:"w-full bg-red-600 hover:bg-red-700",onClick:me,disabled:!oe,children:[t.jsx(en,{className:"h-4 w-4 mr-2"}),"Delete User"]})]})]}),t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsx(rt,{children:t.jsx(at,{className:"text-gray-800",children:"Reports & Logs"})}),t.jsxs(Ve,{className:"space-y-3",children:[t.jsxs(pe,{className:"w-full bg-yellow-600 hover:bg-yellow-700",onClick:Je,children:[t.jsx(Ga,{className:"h-4 w-4 mr-2"}),"Gate Logs"]}),t.jsxs(pe,{className:"w-full bg-orange-600 hover:bg-orange-700",onClick:mt,children:[t.jsx(fu,{className:"h-4 w-4 mr-2"}),"Going Out Logs"]}),t.jsxs(pe,{className:"w-full bg-green-600 hover:bg-green-700",onClick:()=>ls("all"),children:[t.jsx(Vi,{className:"h-4 w-4 mr-2"}),"Download All Logs"]})]})]})]})]}),t.jsx(mr,{open:g,onOpenChange:Oe=>{N(Oe),Oe||(jt(),ae(null))},children:t.jsxs(fr,{className:"max-w-md max-h-[90vh] overflow-y-auto",children:[t.jsxs(xr,{children:[t.jsxs(pr,{className:"flex items-center gap-2",children:[t.jsx(Nn,{className:"h-5 w-5 text-green-600"}),"Register New User"]}),t.jsx(Ar,{children:"Add a new user to the gate entry system. Capture a photo for identification."})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"userName",children:"Full Name *"}),t.jsx(Re,{id:"userName",value:z.name,onChange:Oe=>W(U=>({...U,name:Oe.target.value})),placeholder:"Enter full name"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"userPhone",children:"Phone Number *"}),t.jsx(Re,{id:"userPhone",type:"tel",value:z.phone,onChange:Oe=>W(U=>({...U,phone:Oe.target.value})),placeholder:"Enter phone number"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{children:"Photo"}),ne?t.jsxs("div",{className:"relative",children:[t.jsx("img",{src:ne,alt:"Captured",className:"w-full rounded-lg border-2 border-green-500"}),t.jsx(pe,{size:"sm",variant:"outline",className:"absolute top-2 right-2",onClick:()=>ae(null),children:"Retake"})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"aspect-video bg-gray-900 rounded-lg overflow-hidden relative",children:[t.jsx("video",{ref:We,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover",style:{display:F?"block":"none"}}),!F&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500 bg-gray-100",children:t.jsxs("div",{className:"text-center",children:[t.jsx(XC,{className:"w-12 h-12 mx-auto mb-2"}),t.jsx("p",{className:"text-sm",children:"Camera Off"}),t.jsx("p",{className:"text-xs text-gray-400 mt-1",children:'Click "Start Camera" below'})]})})]}),t.jsx("div",{className:"flex gap-2 mt-2",children:F?t.jsxs(t.Fragment,{children:[t.jsxs(pe,{className:"flex-1 bg-green-600 hover:bg-green-700",onClick:wt,disabled:!z.name.trim()||!z.phone.trim(),children:[t.jsx(qh,{className:"h-4 w-4 mr-2"}),"Capture & Register (7 photos)"]}),t.jsx(pe,{variant:"outline",onClick:jt,children:"Stop"})]}):t.jsxs(pe,{className:"flex-1 bg-blue-600 hover:bg-blue-700",onClick:Bt,children:[t.jsx(qh,{className:"h-4 w-4 mr-2"}),"Start Camera"]})})]})]})]}),t.jsx(yr,{children:t.jsx(pe,{variant:"outline",onClick:()=>{N(!1),jt(),ae(null)},children:"Cancel"})})]})}),t.jsx(mr,{open:y,onOpenChange:w,children:t.jsxs(fr,{className:"max-w-md max-h-[90vh] overflow-y-auto",children:[t.jsxs(xr,{children:[t.jsxs(pr,{className:"flex items-center gap-2",children:[t.jsx(Nr,{className:"h-5 w-5 text-purple-600"}),"Going Out"]}),t.jsxs(Ar,{children:["Record going out activity for ",oe?.name]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"reason",children:"Reason"}),t.jsxs(br,{value:te.reason,onValueChange:Oe=>de(U=>({...U,reason:Oe})),children:[t.jsx(jr,{children:t.jsx(Er,{placeholder:"Select reason"})}),t.jsxs(Tr,{children:[t.jsx(st,{value:"Office Work",children:"Office Work"}),t.jsx(st,{value:"Personal Work",children:"Personal Work"}),t.jsx(st,{value:"Lunch",children:"Lunch"}),t.jsx(st,{value:"Medical",children:"Medical"}),t.jsx(st,{value:"Other",children:"Other"})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"details",children:"Details"}),t.jsx(Re,{id:"details",value:te.details,onChange:Oe=>de(U=>({...U,details:Oe.target.value})),placeholder:"Additional details (optional)"})]}),oe&&t.jsxs("div",{className:"bg-purple-50 border border-purple-200 p-3 rounded-lg text-sm",children:[t.jsxs("div",{children:[t.jsx("strong",{children:"User:"})," ",oe.name]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Phone:"})," ",oe.phone]})]})]}),t.jsxs(yr,{children:[t.jsx(pe,{variant:"outline",onClick:()=>w(!1),children:"Cancel"}),t.jsxs(pe,{onClick:Et,disabled:!oe,className:"bg-purple-600 hover:bg-purple-700",children:[t.jsx(Nr,{className:"h-4 w-4 mr-1"}),"Record Going Out"]})]})]})}),t.jsx(mr,{open:b,onOpenChange:C,children:t.jsxs(fr,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[t.jsxs(xr,{children:[t.jsxs(pr,{className:"flex items-center gap-2 justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ga,{className:"h-5 w-5 text-yellow-600"}),"Gate Entry Logs"]}),t.jsxs(pe,{onClick:()=>ls("entry"),variant:"outline",size:"sm",className:"ml-auto",children:[t.jsx(Vi,{className:"h-4 w-4 mr-1"}),"Download Excel"]})]}),t.jsx(Ar,{children:"Recent gate entry and exit activities"})]}),t.jsx("div",{className:"space-y-4",children:t.jsxs(zr,{children:[t.jsx(Kr,{children:t.jsxs(At,{children:[t.jsx(Pe,{children:"Name"}),t.jsx(Pe,{children:"Phone"}),t.jsx(Pe,{children:"Action"}),t.jsx(Pe,{children:"Method"}),t.jsx(Pe,{children:"Timestamp"}),t.jsx(Pe,{children:"Status"})]})}),t.jsx(Xr,{children:s.length>0?s.map((Oe,U)=>t.jsxs(At,{children:[t.jsx(be,{className:"font-medium",children:Oe.userName}),t.jsx(be,{children:Oe.userPhone}),t.jsx(be,{children:t.jsx(Lt,{className:Oe.action==="entry"?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800",children:Oe.action})}),t.jsx(be,{className:"text-sm text-gray-600",children:Oe.method}),t.jsx(be,{className:"text-sm",children:qt(Oe.timestamp)}),t.jsx(be,{children:t.jsx(Lt,{variant:"outline",children:Oe.status})})]},U)):t.jsx(At,{children:t.jsx(be,{colSpan:6,className:"text-center text-gray-500",children:"No logs available"})})})]})}),t.jsx(yr,{children:t.jsx(pe,{variant:"outline",onClick:()=>C(!1),children:"Close"})})]})}),t.jsx(mr,{open:A,onOpenChange:E,children:t.jsxs(fr,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[t.jsxs(xr,{children:[t.jsxs(pr,{className:"flex items-center gap-2 justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(fu,{className:"h-5 w-5 text-orange-600"}),"Going Out Logs"]}),t.jsxs(pe,{onClick:()=>ls("going_out"),variant:"outline",size:"sm",className:"ml-auto",children:[t.jsx(Vi,{className:"h-4 w-4 mr-1"}),"Download Excel"]})]}),t.jsx(Ar,{children:"Recent going out and coming back activities"})]}),t.jsx("div",{className:"space-y-4",children:t.jsxs(zr,{children:[t.jsx(Kr,{children:t.jsxs(At,{children:[t.jsx(Pe,{children:"Name"}),t.jsx(Pe,{children:"Phone"}),t.jsx(Pe,{children:"Reason"}),t.jsx(Pe,{children:"Going Out"}),t.jsx(Pe,{children:"Coming Back"}),t.jsx(Pe,{children:"Duration"}),t.jsx(Pe,{children:"Status"})]})}),t.jsx(Xr,{children:n.length>0?n.map((Oe,U)=>t.jsxs(At,{children:[t.jsx(be,{className:"font-medium",children:Oe.userName}),t.jsx(be,{children:Oe.userPhone}),t.jsx(be,{children:t.jsx(Lt,{variant:"outline",children:Oe.reasonType})}),t.jsx(be,{className:"text-sm",children:qt(Oe.goingOutTime)}),t.jsx(be,{className:"text-sm",children:qt(Oe.comingBackTime)}),t.jsx(be,{className:"text-sm",children:Oe.durationMinutes?`${Math.round(Oe.durationMinutes)} min`:"-"}),t.jsx(be,{children:t.jsx(Lt,{className:Oe.status==="out"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800",children:Oe.status})})]},U)):t.jsx(At,{children:t.jsx(be,{colSpan:7,className:"text-center text-gray-500",children:"No logs available"})})})]})}),t.jsx(yr,{children:t.jsx(pe,{variant:"outline",onClick:()=>E(!1),children:"Close"})})]})}),t.jsx(mr,{open:R,onOpenChange:V,children:t.jsxs(fr,{className:"max-w-md max-h-[90vh] overflow-y-auto",children:[t.jsxs(xr,{children:[t.jsxs(pr,{className:"flex items-center gap-2",children:[t.jsx(Nn,{className:"h-5 w-5 text-blue-600"}),"Manual Entry"]}),t.jsx(Ar,{children:"Record manual gate entry for a user"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"manualEntryPhone",children:"Phone Number *"}),t.jsx(Re,{id:"manualEntryPhone",type:"tel",value:H.phone,onChange:Oe=>ue(U=>({...U,phone:Oe.target.value})),placeholder:"Enter phone number"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"manualEntryDetails",children:"Details"}),t.jsx(Re,{id:"manualEntryDetails",value:H.details,onChange:Oe=>ue(U=>({...U,details:Oe.target.value})),placeholder:"Enter details (optional)"})]})]}),t.jsxs(yr,{children:[t.jsx(pe,{variant:"outline",onClick:()=>V(!1),children:"Cancel"}),t.jsx(pe,{onClick:$t,className:"bg-blue-600 hover:bg-blue-700",children:"Record Entry"})]})]})}),t.jsx(mr,{open:P,onOpenChange:k,children:t.jsxs(fr,{className:"max-w-md max-h-[90vh] overflow-y-auto",children:[t.jsxs(xr,{children:[t.jsxs(pr,{className:"flex items-center gap-2",children:[t.jsx(qs,{className:"h-5 w-5 text-orange-600"}),"Manual Exit"]}),t.jsx(Ar,{children:"Record manual gate exit for a user"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"manualExitPhone",children:"Phone Number *"}),t.jsx(Re,{id:"manualExitPhone",type:"tel",value:I.phone,onChange:Oe=>X(U=>({...U,phone:Oe.target.value})),placeholder:"Enter phone number"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"manualExitDetails",children:"Details"}),t.jsx(Re,{id:"manualExitDetails",value:I.details,onChange:Oe=>X(U=>({...U,details:Oe.target.value})),placeholder:"Enter details (optional)"})]})]}),t.jsxs(yr,{children:[t.jsx(pe,{variant:"outline",onClick:()=>k(!1),children:"Cancel"}),t.jsx(pe,{onClick:Vt,className:"bg-orange-600 hover:bg-orange-700",children:"Record Exit"})]})]})})]})},Z2=()=>{const e=Ls(),{user:r}=Ns(),[s,a]=T.useState("dashboard"),[n,o]=T.useState([]),[c,d]=T.useState([]),[h,m]=T.useState({}),[f,p]=T.useState([]),[g,N]=T.useState(!0),[y,w]=T.useState(null),[b,C]=T.useState(!1),[A,E]=T.useState(!1),[R,V]=T.useState(""),[P,k]=T.useState({pendingPickups:0,companyVehicleReturns:0}),{toast:z}=Ni(),[W,te]=T.useState([]),[de,H]=T.useState({}),[ue,I]=T.useState(!1),[X,oe]=T.useState("add"),[xe,he]=T.useState(null),[F,ee]=T.useState(""),[M,_]=T.useState({guestName:"",guestContact:"",guestEmail:"",guestCompany:"",meetingPerson:"",meetingPersonDepartment:"",meetingPersonContact:"",visitDate:"",visitTime:"",purpose:"",vehicleNumber:"",idProofType:"",idProofNumber:"",notes:""}),[ne,ae]=T.useState({customerName:"",vehicleNo:"",driverName:"",note:""}),[G,ie]=T.useState(!1),[Me,Ee]=T.useState(null),ye=T.useRef(null),je=T.useRef(null),We=T.useRef(null),Y=T.useRef(null),[Dt,we]=T.useState(!1),[ot,Ye]=T.useState(null),[Ue,Nt]=T.useState(null),[qe,Bt]=T.useState(null),[jt,Ze]=T.useState(null);T.useEffect(()=>{const U=ye.current;if(!U)return;let ve;const ct=()=>{(U.videoWidth||0)===0?ve=window.setTimeout(()=>{const vt=ye.current;vt&&((vt.videoWidth||0)===0?we(!0):we(!1))},200):we(!1)};if(Me){U.srcObject=Me,U.addEventListener("loadedmetadata",ct);const vt=U.play();vt&&typeof vt.then=="function"&&vt.catch(()=>{})}else{try{U.pause()}catch{}U.srcObject=null,we(!1)}return Ye(null),Nt(null),()=>{ve&&window.clearTimeout(ve),U.removeEventListener("loadedmetadata",ct);try{U.pause()}catch{}U.srcObject&&(U.srcObject=null)}},[Me]);const[Xt,ze]=T.useState({rejectionReason:""});T.useEffect(()=>{ht(),nt()},[]),T.useEffect(()=>{k({pendingPickups:n.length,companyVehicleReturns:f.length})},[n,f]);const ht=async()=>{try{N(!0);const[U,ve,ct]=await Promise.all([fetch(`${Fe}/watchman/pending-pickups`),fetch(`${Fe}/watchman/gate-passes`),fetch(`${Fe}/watchman/summary`)]);if(U.ok){const vt=await U.json();o(vt)}if(ve.ok){const vt=await ve.json();d(vt)}if(ct.ok){const vt=await ct.json();m(vt)}try{const vt=await fetch(`${Fe}/watchman/company-vehicle-returns`);if(vt.ok){const L=await vt.json();p(L||[])}}catch(vt){console.warn("Failed to fetch company vehicle returns",vt)}}catch(U){console.error("Error fetching data:",U),z({title:"Error",description:"Failed to fetch watchman data",variant:"destructive"})}finally{N(!1)}},nt=async()=>{try{const[U,ve]=await Promise.all([fetch(`${Fe}/watchman/guests`),fetch(`${Fe}/watchman/guests/summary`)]);if(U.ok){const ct=await U.json();te(ct)}if(ve.ok){const ct=await ve.json();H(ct)}}catch(U){console.error("Error fetching guests:",U),z({title:"Error",description:"Failed to fetch guest list",variant:"destructive"})}},Ot=async U=>{try{let ve;if(U==="send_in"&&ot&&ot!=="manual"||U==="release"&&Ue&&Ue!=="manual"){const vt=await(await fetch(U==="send_in"?ot:Ue)).blob(),L=new FormData;L.append("action",U),L.append("customerName",ne.customerName||""),L.append("vehicleNo",ne.vehicleNo||""),L.append("driverName",ne.driverName||""),L.append("note",ne.note||""),U==="send_in"?L.append("sendInPhoto",vt,`sendin_${y.gatePassId}.jpg`):L.append("afterLoadingPhoto",vt,`afterload_${y.gatePassId}.jpg`),ve=await fetch(`${Fe}/watchman/verify/${y.gatePassId}`,{method:"POST",body:L})}else if(U==="send_in"&&ot==="manual"||U==="release"&&Ue==="manual"){const ct=new FormData;ct.append("action",U),ct.append("customerName",ne.customerName||""),ct.append("vehicleNo",ne.vehicleNo||""),ct.append("driverName",ne.driverName||""),ct.append("note",ne.note||""),U==="send_in"&&qe&&ct.append("sendInPhoto",qe,qe.name),U==="release"&&jt&&ct.append("afterLoadingPhoto",jt,jt.name),ve=await fetch(`${Fe}/watchman/verify/${y.gatePassId}`,{method:"POST",body:ct})}else{const ct={...ne,action:U};ve=await fetch(`${Fe}/watchman/verify/${y.gatePassId}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ct)})}if(ve.ok){const ct=await ve.json();if(ct.status==="identity_mismatch"){z({title:"Identity Mismatch",description:ct.message,variant:"destructive"});return}C(!1),ae({customerName:"",vehicleNo:"",driverName:"",note:""}),Ye(null),Nt(null),Bt(null),Ze(null),z({title:"Success",description:ct.message}),ht()}else{const ct=await ve.json();z({title:"Error",description:ct.error||"Failed to verify pickup",variant:"destructive"})}}catch(ve){console.error("Error verifying pickup:",ve),z({title:"Error",description:"Failed to verify pickup",variant:"destructive"})}},lt=async()=>{try{if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){const U=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});if(Ee(U),ye.current){const ve=ye.current;ve.srcObject=U,await new Promise(ct=>{const vt=()=>{ve.removeEventListener("loadedmetadata",vt),ct()};ve.addEventListener("loadedmetadata",vt)});try{await ve.play()}catch{}(ve.videoWidth||0)===0?(await new Promise(ct=>setTimeout(ct,150)),(ve.videoWidth||0)===0?(we(!0),z({title:"Camera failed",description:"Could not initialize camera preview. Use the file upload fallback below.",variant:"destructive"})):we(!1)):we(!1)}ie(!0)}else z({title:"Camera not available",description:"Your browser does not support camera access",variant:"destructive"})}catch(U){console.error("Could not start camera",U),z({title:"Camera error",description:"Permission denied or no camera available",variant:"destructive"})}},Jt=()=>{if(Me&&(Me.getTracks().forEach(U=>U.stop()),Ee(null),ye.current)){try{ye.current.pause()}catch{}try{ye.current.srcObject=null}catch{}}ie(!1)},et=()=>{if(!ye.current||!je.current)return null;const U=ye.current,ve=je.current;return U.readyState!==4?null:(ve.width=U.videoWidth||640,ve.height=U.videoHeight||480,ve.getContext("2d").drawImage(U,0,0,ve.width,ve.height),ve.toDataURL("image/jpeg",.8))},Ft=async U=>{try{const ve=et();if(!ve){z({title:"Capture Failed",description:"Could not capture photo. Please try again.",variant:"destructive"});return}U==="send_in"?Ye(ve):U==="release"&&Nt(ve),Jt(),z({title:"Photo Captured",description:"Review the photo below. Click 'Verify & "+(U==="send_in"?"Send In":"Release")+"' to submit or take another photo."})}catch(ve){console.error("Error capturing photo:",ve),z({title:"Error",description:"Failed to capture photo",variant:"destructive"})}},kt=async()=>{try{const U=await fetch(`${Fe}/watchman/reject/${y.gatePassId}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Xt)});if(U.ok){const ve=await U.json();E(!1),ze({rejectionReason:""}),z({title:"Pickup Rejected",description:ve.message,variant:"destructive"}),ht()}else{const ve=await U.json();z({title:"Error",description:ve.error||"Failed to reject pickup",variant:"destructive"})}}catch(U){console.error("Error rejecting pickup:",U),z({title:"Error",description:"Failed to reject pickup",variant:"destructive"})}},er=U=>{const ct={pending:{className:"bg-yellow-100 text-yellow-800 border border-yellow-300",text:"Pending Verification"},verified:{className:"bg-green-100 text-green-800 border border-green-300",text:"Verified & Released"},entered_for_pickup:{className:"bg-blue-100 text-blue-800 border border-blue-300",text:"Entered for Pickup"},rejected:{className:"bg-red-100 text-red-800 border border-red-300",text:"Rejected"}}[U]||{className:"bg-gray-100 text-gray-800 border border-gray-300",text:U};return t.jsx(Lt,{className:`${ct.className} font-medium`,children:ct.text})},B=U=>{w(U),ae({customerName:U.customerName||"",vehicleNo:U.customerVehicle||"",driverName:U.driverName||""}),C(!0)},me=U=>{w(U),ze({rejectionReason:""}),E(!0)},Je=c.filter(U=>{if(!R.trim())return!0;const ve=R.toLowerCase();return U.customerName?.toLowerCase().includes(ve)||U.orderNumber?.toLowerCase().includes(ve)||U.productName?.toLowerCase().includes(ve)||U.customerVehicle?.toLowerCase().includes(ve)}),mt=(U,ve=null)=>{oe(U),he(ve),_(ve&&(U==="edit"||U==="view")?{guestName:ve.guestName||"",guestContact:ve.guestContact||"",guestEmail:ve.guestEmail||"",guestCompany:ve.guestCompany||"",meetingPerson:ve.meetingPerson||"",meetingPersonDepartment:ve.meetingPersonDepartment||"",meetingPersonContact:ve.meetingPersonContact||"",visitDate:ve.visitDate||"",visitTime:ve.visitTime||"",purpose:ve.purpose||"",vehicleNumber:ve.vehicleNumber||"",idProofType:ve.idProofType||"",idProofNumber:ve.idProofNumber||"",notes:ve.notes||""}:{guestName:"",guestContact:"",guestEmail:"",guestCompany:"",meetingPerson:"",meetingPersonDepartment:"",meetingPersonContact:"",visitDate:"",visitTime:"",purpose:"",vehicleNumber:"",idProofType:"",idProofNumber:"",notes:""}),I(!0)},wt=()=>{I(!1),oe("add"),he(null)},Et=async()=>{try{if(!M.guestName||!M.meetingPerson||!M.visitDate||!M.purpose){z({title:"Missing Information",description:"Guest name, meeting person, visit date, and purpose are required.",variant:"destructive"});return}const U=X==="add"?`${Fe}/watchman/guests`:`${Fe}/watchman/guests/${xe.id}`;if(!(await fetch(U,{method:X==="add"?"POST":"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)})).ok)throw new Error("Failed to save guest");z({title:"Success",description:`Guest ${X==="add"?"added":"updated"} successfully`}),wt(),nt()}catch(U){z({title:"Error",description:U.message,variant:"destructive"})}},$t=async U=>{try{console.log("Checking in guest:",U),console.log("API URL:",`${Fe}/watchman/guests/${U}/check-in`);const ve=await fetch(`${Fe}/watchman/guests/${U}/check-in`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(console.log("Check-in response status:",ve.status),!ve.ok){const vt=await ve.json();throw console.error("Check-in error:",vt),new Error(vt.error||"Failed to check in guest")}const ct=await ve.json();console.log("Check-in successful:",ct),z({title:"Success",description:"Guest checked in successfully"}),nt()}catch(ve){console.error("Check-in exception:",ve),z({title:"Error",description:ve.message,variant:"destructive"})}},Vt=async U=>{try{const ve=await fetch(`${Fe}/watchman/guests/${U}/check-out`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!ve.ok){const ct=await ve.json();throw new Error(ct.error||"Failed to check out guest")}z({title:"Success",description:"Guest checked out successfully"}),nt()}catch(ve){z({title:"Error",description:ve.message,variant:"destructive"})}},qt=async U=>{if(confirm("Are you sure you want to delete this guest entry?"))try{if(!(await fetch(`${Fe}/watchman/guests/${U}`,{method:"DELETE"})).ok)throw new Error("Failed to delete guest");z({title:"Success",description:"Guest entry deleted successfully"}),nt()}catch(ve){z({title:"Error",description:ve.message,variant:"destructive"})}},ls=U=>{const ct={scheduled:{className:"bg-blue-100 text-blue-800 border border-blue-300",text:"Scheduled"},checked_in:{className:"bg-green-100 text-green-800 border border-green-300",text:"Checked In"},checked_out:{className:"bg-gray-100 text-gray-800 border border-gray-300",text:"Checked Out"},cancelled:{className:"bg-red-100 text-red-800 border border-red-300",text:"Cancelled"}}[U]||{className:"bg-gray-100 text-gray-800 border border-gray-300",text:U};return t.jsx(Lt,{className:`${ct.className} font-medium`,children:ct.text})},Oe=W.filter(U=>{if(!F.trim())return!0;const ve=F.toLowerCase();return U.guestName?.toLowerCase().includes(ve)||U.meetingPerson?.toLowerCase().includes(ve)||U.guestCompany?.toLowerCase().includes(ve)||U.purpose?.toLowerCase().includes(ve)});return t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50",children:[t.jsx("div",{className:"max-w-7xl mx-auto bg-white shadow-md border-b-4 border-green-800 rounded-b-lg",children:t.jsx("div",{className:"px-4 sm:px-6 py-4 sm:py-6",children:t.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:justify-between sm:items-center sm:space-y-0",children:[t.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4",children:[t.jsxs(pe,{onClick:()=>e(r?.department==="admin"?"/dashboard/admin":"/dashboard"),variant:"outline",className:"border border-gray-300 bg-white text-gray-800 text-sm placeholder-gray-500 w-full sm:w-auto",children:[t.jsx(qs,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-600 to-green-800 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx(yn,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Security Department"}),t.jsx("p",{className:"text-gray-600 text-sm sm:text-base font-medium",children:"Access Control & Security Management"})]})]})]}),t.jsx("div",{className:"bg-gradient-to-r from-green-50 to-indigo-50 border-2 border-green-200 px-4 py-4 sm:px-6 rounded-lg shadow-sm w-full sm:w-auto",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(Nr,{className:"w-5 h-5 text-blue-600"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 text-xs font-medium",children:"Security Team"}),t.jsx("p",{className:"text-green-600 text-xs font-medium",children:"Security Management"})]})]})})]})})}),t.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-4",children:[t.jsx("div",{className:"px-6 py-6",children:t.jsxs(an,{value:s,onValueChange:a,className:"space-y-4",children:[t.jsxs(ma,{className:"flex md:grid md:grid-cols-6 w-full overflow-x-auto overflow-y-hidden md:overflow-x-hidden whitespace-nowrap bg-gray-100 border border-gray-300 pl-4 md:pl-0",children:[t.jsx(xt,{value:"dashboard",className:"text-gray-800",children:"Dashboard"}),t.jsxs(xt,{value:"pending",className:"text-gray-800 relative",children:["Pending",P.pendingPickups>0&&t.jsx("div",{className:"absolute -top-2 -right-2 flex items-center justify-center rounded-full bg-red-500 text-white text-xs font-bold min-w-[1.25rem] h-5 px-1",children:P.pendingPickups})]}),t.jsx(xt,{value:"all-passes",className:"text-gray-800",children:"All Passes"}),t.jsx(xt,{value:"gate-entry",className:"text-gray-800",children:"Gate Entry"}),t.jsxs(xt,{value:"company-vehicle-returns",className:"text-gray-800 relative",children:["Companys Vehicle Return",P.companyVehicleReturns>0&&t.jsx("div",{className:"absolute -top-2 -right-2 flex items-center justify-center rounded-full bg-red-500 text-white text-xs font-bold min-w-[1.25rem] h-5 px-1",children:P.companyVehicleReturns})]}),t.jsx(xt,{value:"guest-list",className:"text-gray-800",children:"Guest List"})]}),t.jsxs(Ut,{value:"dashboard",className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(at,{className:"text-sm font-medium text-gray-800",children:"Pending Verification"}),t.jsx(Ka,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsx(Ve,{children:t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:h.todayPending||0})})]}),t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(at,{className:"text-sm font-medium text-gray-800",children:"Entered Today"}),t.jsx(Nn,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsx(Ve,{children:t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:h.todayEntered||0})})]}),t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(at,{className:"text-sm font-medium text-gray-800",children:"Verified Today"}),t.jsx(dr,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsx(Ve,{children:t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:h.todayVerified||0})})]}),t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(at,{className:"text-sm font-medium text-gray-800",children:"Rejected Today"}),t.jsx(en,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsx(Ve,{children:t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:h.todayRejected||0})})]}),t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(at,{className:"text-sm font-medium text-gray-800",children:"Total Activity"}),t.jsx(fu,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsx(Ve,{children:t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:h.todayTotal||0})})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsx(rt,{children:t.jsxs(at,{className:"flex items-center gap-2 text-gray-800",children:[t.jsx(yn,{className:"h-5 w-5"}),"Security Summary"]})}),t.jsx(Ve,{children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-800",children:"Total Pending"}),t.jsx(Lt,{className:"bg-yellow-100 text-yellow-800 border border-yellow-300 font-medium",children:h.totalPending||0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-800",children:"Total Verified"}),t.jsx(Lt,{className:"bg-green-100 text-green-800 border border-green-300 font-medium",children:h.totalVerified||0})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-800",children:"Total Rejected"}),t.jsx(Lt,{className:"bg-red-100 text-red-800 border border-red-300 font-medium",children:h.totalRejected||0})]})]})})]}),t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsx(rt,{children:t.jsx(at,{className:"text-gray-800",children:"Recent Pickups"})}),t.jsx(Ve,{children:t.jsxs("div",{className:"space-y-2 text-sm",children:[n.slice(0,5).map(U=>t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-800",children:U.customerName}),t.jsx("div",{className:"text-xs text-gray-600",children:U.orderNumber})]}),er(U.status)]},U.gatePassId)),n.length===0&&t.jsx("p",{className:"text-gray-600 text-center",children:"No recent pickups"})]})})]})]})]}),t.jsx(Ut,{value:"pending",className:"space-y-4",children:t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{children:[t.jsxs(at,{className:"flex items-center gap-2 text-gray-800",children:[t.jsx(yn,{className:"h-5 w-5"}),"Pending Customer Pickups (",n.length,")"]}),t.jsx(gr,{className:"text-gray-600",children:"Customers waiting for verification and product pickup"})]}),t.jsx(Ve,{className:"overflow-x-auto",children:g?t.jsx("div",{className:"flex justify-center py-8",children:t.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):n.length===0?t.jsxs("div",{className:"text-center py-8 text-gray-600",children:[t.jsx(yn,{className:"mx-auto h-12 w-12 mb-4"}),t.jsx("p",{children:"No pending customer pickups"})]}):t.jsxs(zr,{children:[t.jsx(Kr,{children:t.jsxs(At,{children:[t.jsx(Pe,{className:"text-black",children:"Gate Pass #"}),t.jsx(Pe,{className:"text-black",children:"Order #"}),t.jsx(Pe,{className:"text-black",children:"Customer"}),t.jsx(Pe,{className:"text-black",children:"Product"}),t.jsx(Pe,{className:"text-black",children:"Vehicle"}),t.jsx(Pe,{className:"text-black",children:"Driver Name"}),t.jsx(Pe,{className:"text-black",children:"Driver Contact"}),t.jsx(Pe,{className:"text-black",children:"Ready Status"}),t.jsx(Pe,{className:"text-black",children:"Issued At"}),t.jsx(Pe,{className:"text-black",children:"Actions"})]})}),t.jsx(Xr,{children:n.map(U=>t.jsxs(At,{children:[t.jsxs(be,{className:"font-medium text-gray-800",children:["GP-",U.gatePassId]}),t.jsx(be,{className:"font-medium text-gray-800",children:U.orderNumber}),t.jsx(be,{children:t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-800",children:U.customerName}),t.jsx("div",{className:"text-sm text-gray-600",children:U.customerContact})]})}),t.jsx(be,{children:t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-800",children:U.productName}),t.jsxs("div",{className:"text-sm text-gray-600",children:["Qty: ",U.quantity]})]})}),t.jsx(be,{className:"font-medium text-gray-800",children:U.customerVehicle||"Not provided"}),t.jsx(be,{className:"font-medium text-gray-800",children:U.driverName}),t.jsx(be,{className:"font-medium text-gray-800",children:U.driverContact||"Not provided"}),t.jsx(be,{className:"text-center",children:U.dispatchStatus==="ready_for_pickup"||U.dispatchStatus==="ready_for_load"||U.dispatchStatus==="entered_for_pickup"||U.dispatchStatus==="loaded"?t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsx(dr,{className:"h-6 w-6 text-green-600"}),t.jsx("span",{className:"ml-2 text-green-600 font-semibold",children:U.dispatchStatus==="loaded"?"Loaded":U.dispatchStatus==="entered_for_pickup"?"Sent In":"Ready"})]}):t.jsxs("div",{className:"flex items-center justify-center",children:[t.jsx(en,{className:"h-6 w-6 text-red-500"}),t.jsx("span",{className:"ml-2 text-red-500 font-semibold",children:"Not Ready"})]})}),t.jsx(be,{className:"font-medium text-gray-800",children:new Date(U.issuedAt).toLocaleString()}),t.jsx(be,{children:t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(pe,{size:"sm",onClick:()=>B(U),className:"bg-green-600 hover:bg-green-700",children:[t.jsx(dr,{className:"h-4 w-4 mr-1"}),"Verify"]}),t.jsxs(pe,{size:"sm",variant:"destructive",onClick:()=>me(U),children:[t.jsx(en,{className:"h-4 w-4 mr-1"}),"Reject"]})]})})]},U.gatePassId))})]})})]})}),t.jsx(Ut,{value:"all-passes",className:"space-y-4",children:t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{children:[t.jsxs(at,{className:"flex items-center gap-2 text-gray-800",children:[t.jsx(Ga,{className:"h-5 w-5"}),"All Gate Passes (",Je.length,")"]}),t.jsx(gr,{className:"text-gray-600",children:"Search by customer name, order number, product name, or vehicle number"})]}),t.jsxs(Ve,{className:"overflow-x-auto",children:[t.jsxs("div",{className:"flex gap-2 mb-4",children:[t.jsx(Re,{placeholder:"Enter customer name, order number, product, or vehicle...",value:R,onChange:U=>V(U.target.value),onKeyPress:U=>U.key==="Enter"&&V(U.target.value)}),t.jsxs(pe,{onClick:()=>V(R),children:[t.jsx(fi,{className:"h-4 w-4 mr-1"}),"Search"]})]}),g?t.jsx("div",{className:"flex justify-center py-8",children:t.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):t.jsxs(zr,{children:[t.jsx(Kr,{children:t.jsxs(At,{children:[t.jsx(Pe,{className:"text-black",children:"Gate Pass #"}),t.jsx(Pe,{className:"text-black",children:"Order #"}),t.jsx(Pe,{className:"text-black",children:"Customer"}),t.jsx(Pe,{className:"text-black",children:"Product"}),t.jsx(Pe,{className:"text-black",children:"Delivery Type"}),t.jsx(Pe,{className:"text-black",children:"Status"}),t.jsx(Pe,{className:"text-black",children:"Issued"}),t.jsx(Pe,{className:"text-black",children:"Verified"})]})}),t.jsx(Xr,{children:Je.map(U=>{const ve=(U.deliveryType||U.originalDeliveryType||"N/A").toUpperCase();let ct="px-2 py-1 rounded font-semibold border whitespace-nowrap ";return ve==="PART LOAD"?ct+="bg-blue-100 text-blue-800 border-blue-200":ve==="SELF"?ct+="bg-green-100 text-green-800 border-green-200":ct+="bg-gray-100 text-gray-800 border-gray-200",t.jsxs(At,{children:[t.jsxs(be,{className:"font-medium text-gray-800",children:["GP-",U.gatePassId]}),t.jsx(be,{className:"text-gray-800",children:U.orderNumber}),t.jsx(be,{className:"text-gray-800",children:U.customerName}),t.jsx(be,{children:t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-800",children:U.productName}),t.jsxs("div",{className:"text-sm text-gray-600",children:["Qty: ",U.quantity]})]})}),t.jsx(be,{children:t.jsx("span",{className:ct,children:ve})}),t.jsx(be,{className:"text-gray-800",children:er(U.status)}),t.jsx(be,{className:"text-gray-800",children:new Date(U.issuedAt).toLocaleString()}),t.jsx(be,{className:"text-gray-800",children:U.verifiedAt?new Date(U.verifiedAt).toLocaleString():"-"})]},U.gatePassId)})})]})]})]})}),t.jsx(Ut,{value:"gate-entry",className:"space-y-4",children:t.jsx(P5,{})}),t.jsx(Ut,{value:"company-vehicle-returns",className:"space-y-4",children:t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{children:[t.jsx(at,{className:"flex items-center gap-2 text-gray-800",children:"Companys Vehicle Return"}),t.jsx(gr,{className:"text-gray-600",children:"Vehicles returning to site sent by Transport Department"})]}),t.jsxs(Ve,{children:[t.jsx("div",{className:"flex justify-end mb-4",children:t.jsx(pe,{onClick:async()=>{try{const U=await fetch(`${Fe}/watchman/company-vehicle-returns`);if(!U.ok)throw new Error("Failed to fetch");const ve=await U.json();p(ve||[])}catch{z({title:"Error",description:"Failed to load returns",variant:"destructive"})}},className:"bg-gray-100",children:"Refresh"})}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs(zr,{children:[t.jsx(Kr,{children:t.jsxs(At,{children:[t.jsx(Pe,{className:"text-black",children:"Vehicle"}),t.jsx(Pe,{className:"text-black",children:"Driver"}),t.jsx(Pe,{className:"text-black",children:"Contact"}),t.jsx(Pe,{className:"text-black",children:"Status"}),t.jsx(Pe,{className:"text-black",children:"Reported At"}),t.jsx(Pe,{className:"text-black",children:"Actions"})]})}),t.jsx(Xr,{children:f.length===0?t.jsx(At,{children:t.jsx(be,{colSpan:6,className:"text-center py-8 text-gray-600",children:"No company vehicle returns"})}):f.map(U=>t.jsxs(At,{children:[t.jsx(be,{className:"font-medium text-gray-800",children:U.data?.vehicleNumber||U.vehicleNumber}),t.jsx(be,{className:"text-gray-800",children:U.data?.driverName||U.driverName}),t.jsx(be,{className:"text-gray-800",children:U.data?.driverContact||U.driverContact||"-"}),t.jsx(be,{className:"text-gray-800",children:U.data?.status||U.status||"returning"}),t.jsx(be,{className:"text-gray-800",children:new Date(U.timestamp).toLocaleString()}),t.jsx(be,{children:t.jsx("div",{className:"flex gap-2",children:t.jsx(pe,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:async()=>{try{const ve=U.data?.vehicleId||U.vehicleId||U.id,ct=await fetch(`${Fe}/watchman/company-vehicle-returns/${ve}/check-in`,{method:"POST"}),vt=await ct.json().catch(()=>({}));if(ct.ok){z({title:"Checked In",description:"Vehicle checked in and marked available"}),ht();try{const L=new CustomEvent("vehicle-checked-in",{detail:{vehicleId:ve}});window.dispatchEvent(L)}catch{}}else z({title:"Error",description:vt.error||"Failed to check in",variant:"destructive"})}catch(ve){console.error(ve),z({title:"Error",description:"Failed to check in vehicle",variant:"destructive"})}},children:"Check In"})})})]},U.id||U.vehicleId||U.data?.vehicleId))})]})})]})]})}),t.jsx(Ut,{value:"guest-list",className:"space-y-4",children:t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsx(rt,{children:t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[t.jsxs("div",{children:[t.jsxs(at,{className:"text-gray-800 flex items-center gap-2",children:[t.jsx($o,{className:"h-5 w-5"}),"Guest List Management"]}),t.jsx(gr,{children:"Track and manage visitor entries"})]}),t.jsxs(pe,{onClick:()=>mt("add"),className:"bg-green-600 hover:bg-green-700",children:[t.jsx(ri,{className:"h-4 w-4 mr-2"}),"Add Guest"]})]})}),t.jsxs(Ve,{children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[t.jsx(He,{className:"bg-blue-50 border border-blue-200",children:t.jsx(Ve,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Total Guests"}),t.jsx("p",{className:"text-2xl font-bold text-blue-800",children:de.todayGuests||0})]}),t.jsx(tn,{className:"h-8 w-8 text-blue-600"})]})})}),t.jsx(He,{className:"bg-green-50 border border-green-200",children:t.jsx(Ve,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Checked In"}),t.jsx("p",{className:"text-2xl font-bold text-green-800",children:de.checkedIn||0})]}),t.jsx($o,{className:"h-8 w-8 text-green-600"})]})})}),t.jsx(He,{className:"bg-orange-50 border border-orange-200",children:t.jsx(Ve,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-orange-600 font-medium",children:"Scheduled"}),t.jsx("p",{className:"text-2xl font-bold text-orange-800",children:de.scheduled||0})]}),t.jsx(Ka,{className:"h-8 w-8 text-orange-600"})]})})}),t.jsx(He,{className:"bg-gray-50 border border-gray-200",children:t.jsx(Ve,{className:"pt-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Checked Out"}),t.jsx("p",{className:"text-2xl font-bold text-gray-800",children:de.checkedOut||0})]}),t.jsx(Bm,{className:"h-8 w-8 text-gray-600"})]})})})]}),t.jsx("div",{className:"mb-4",children:t.jsxs("div",{className:"relative",children:[t.jsx(fi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),t.jsx(Re,{placeholder:"Search by guest name, meeting person, company, or purpose...",value:F,onChange:U=>ee(U.target.value),className:"pl-10 border-gray-300"})]})}),g?t.jsx("div",{className:"text-center py-8 text-gray-600",children:"Loading guests..."}):Oe.length===0?t.jsx("div",{className:"text-center py-8 text-gray-600",children:"No guests found"}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs(zr,{children:[t.jsx(Kr,{children:t.jsxs(At,{children:[t.jsx(Pe,{className:"text-gray-800",children:"Guest Name"}),t.jsx(Pe,{className:"text-gray-800",children:"Contact"}),t.jsx(Pe,{className:"text-gray-800",children:"Company"}),t.jsx(Pe,{className:"text-gray-800",children:"Meeting Person"}),t.jsx(Pe,{className:"text-gray-800",children:"Visit Date"}),t.jsx(Pe,{className:"text-gray-800",children:"Purpose"}),t.jsx(Pe,{className:"text-gray-800",children:"In Time"}),t.jsx(Pe,{className:"text-gray-800",children:"Out Time"}),t.jsx(Pe,{className:"text-gray-800",children:"Status"}),t.jsx(Pe,{className:"text-gray-800",children:"Actions"})]})}),t.jsx(Xr,{children:Oe.map(U=>t.jsxs(At,{children:[t.jsx(be,{className:"font-medium text-gray-800",children:t.jsxs("div",{children:[t.jsx("div",{children:U.guestName}),U.guestEmail&&t.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[t.jsx(Im,{className:"h-3 w-3"}),U.guestEmail]})]})}),t.jsx(be,{className:"text-gray-800",children:U.guestContact&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(ZC,{className:"h-3 w-3"}),U.guestContact]})}),t.jsx(be,{className:"text-gray-800",children:U.guestCompany&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(zN,{className:"h-3 w-3"}),U.guestCompany]})}),t.jsx(be,{className:"text-gray-800",children:t.jsxs("div",{children:[t.jsx("div",{children:U.meetingPerson}),U.meetingPersonDepartment&&t.jsx("div",{className:"text-xs text-gray-500",children:U.meetingPersonDepartment})]})}),t.jsx(be,{className:"text-gray-800",children:t.jsxs("div",{children:[t.jsx("div",{children:new Date(U.visitDate).toLocaleDateString()}),U.visitTime&&t.jsx("div",{className:"text-xs text-gray-500",children:U.visitTime})]})}),t.jsx(be,{className:"text-gray-800",children:t.jsx("div",{className:"max-w-xs truncate",title:U.purpose,children:U.purpose})}),t.jsx(be,{className:"text-gray-800",children:U.inTime?new Date(U.inTime).toLocaleTimeString():"-"}),t.jsx(be,{className:"text-gray-800",children:U.outTime?new Date(U.outTime).toLocaleTimeString():"-"}),t.jsx(be,{children:ls(U.status)}),t.jsx(be,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[U.status==="scheduled"&&t.jsxs(pe,{size:"sm",onClick:()=>$t(U.id),className:"bg-green-600 hover:bg-green-700",children:[t.jsx($o,{className:"h-3 w-3 mr-1"}),"Check In"]}),U.status==="checked_in"&&t.jsxs(pe,{size:"sm",onClick:()=>Vt(U.id),className:"bg-blue-600 hover:bg-blue-700",children:[t.jsx(Bm,{className:"h-3 w-3 mr-1"}),"Check Out"]}),(U.status==="scheduled"||U.status==="checked_in")&&t.jsx(pe,{size:"sm",variant:"outline",onClick:()=>mt("edit",U),children:t.jsx(zi,{className:"h-3 w-3"})}),t.jsx(pe,{size:"sm",variant:"outline",onClick:()=>qt(U.id),className:"text-red-600 hover:text-red-700",children:t.jsx(jf,{className:"h-3 w-3"})})]})})]},U.id))})]})})]})]})})]})}),t.jsx(mr,{open:b,onOpenChange:C,children:t.jsxs(fr,{className:"max-w-md max-h-[80vh] flex flex-col overflow-hidden",children:[t.jsxs(xr,{children:[t.jsxs(pr,{className:"flex items-center gap-2",children:[t.jsx(dr,{className:"h-5 w-5 text-green-600"}),"Verify Customer Pickup"]}),t.jsx(Ar,{children:y&&t.jsxs(t.Fragment,{children:["Verify identity for ",y.customerName," - Gate Pass #",y.gatePassId]})})]}),t.jsxs("div",{className:"space-y-4 overflow-y-auto px-2 flex-1",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"verifyCustomerName",children:"Customer Name Verification"}),t.jsx(Re,{id:"verifyCustomerName",value:ne.customerName,onChange:U=>ae(ve=>({...ve,customerName:U.target.value})),placeholder:"Enter customer name for verification"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"verifyDriverName",children:"Driver Name"}),t.jsx(Re,{id:"verifyDriverName",value:ne.driverName,onChange:U=>ae(ve=>({...ve,driverName:U.target.value})),placeholder:"Enter driver name"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"verifyVehicle",children:"Vehicle Number"}),t.jsx(Re,{id:"verifyVehicle",value:ne.vehicleNo,onChange:U=>ae(ve=>({...ve,vehicleNo:U.target.value})),placeholder:"Enter vehicle number"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"verifyNote",children:"Note"}),t.jsx(Re,{id:"verifyNote",value:ne.note,onChange:U=>ae(ve=>({...ve,note:U.target.value})),placeholder:"Add any notes about the driver or verification"})]}),y&&t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Expected Customer:"})," ",y.customerName]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Product:"})," ",y.productName]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Quantity:"})," ",y.quantity]}),t.jsx("div",{className:"mt-3",children:G?t.jsxs("div",{className:"space-y-2",children:[t.jsx("video",{ref:ye,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full max-h-60 bg-black",style:{objectFit:"cover"}}),t.jsx("canvas",{ref:je,style:{display:"none"}}),t.jsxs("div",{className:"flex gap-2 flex-wrap",children:[(y?.dispatchStatus==="ready_for_pickup"||y?.dispatchStatus==="ready_for_load")&&t.jsx(pe,{variant:"outline",onClick:()=>Ft("send_in"),disabled:!G||!y,children:"Capture Photo"}),y?.dispatchStatus==="loaded"&&t.jsx(pe,{variant:"outline",onClick:()=>Ft("release"),disabled:!G||!y,children:"Capture Photo"}),t.jsx(pe,{variant:"ghost",onClick:Jt,children:"Stop Camera"})]}),Dt&&t.jsxs("div",{className:"mt-2 space-y-2",children:[t.jsx("p",{className:"text-sm text-red-400",children:"Camera preview failed. You can attach a photo manually."}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[(y?.dispatchStatus==="ready_for_pickup"||y?.dispatchStatus==="ready_for_load")&&t.jsxs(t.Fragment,{children:[t.jsx("input",{ref:We,type:"file",accept:"image/*",style:{display:"none"},onChange:U=>{const ve=U.target.files&&U.target.files[0];Bt(ve||null),Ye(ve?"manual":null)}}),t.jsx(pe,{variant:"outline",onClick:()=>We.current&&We.current.click(),children:"Choose Send-In Photo"})]}),y?.dispatchStatus==="loaded"&&t.jsxs(t.Fragment,{children:[t.jsx("input",{ref:Y,type:"file",accept:"image/*",style:{display:"none"},onChange:U=>{const ve=U.target.files&&U.target.files[0];Ze(ve||null),Nt(ve?"manual":null)}}),t.jsx(pe,{variant:"outline",onClick:()=>Y.current&&Y.current.click(),children:"Choose After Loading Photo"})]}),t.jsx(pe,{variant:"secondary",onClick:async()=>{const U=y?.dispatchStatus==="loaded"?jt:qe,ve=y?.dispatchStatus==="loaded"?"afterLoadingPhoto":"sendInPhoto",ct=new FormData;ct.append("action",y?.dispatchStatus==="loaded"?"release":"send_in"),ct.append("customerName",ne.customerName||""),ct.append("vehicleNo",ne.vehicleNo||""),ct.append("driverName",ne.driverName||""),ct.append(ve,U,U?.name||"manual.jpg");const vt=await fetch(`${Fe}/watchman/verify/${y.gatePassId}`,{method:"POST",body:ct});if(vt.ok){const L=await vt.json();z({title:"Uploaded",description:L.message}),C(!1),ht()}},disabled:y?.dispatchStatus==="loaded"?!jt:!qe,children:"Upload Chosen"})]})]})]}):t.jsx(pe,{variant:"outline",onClick:lt,className:"mb-2",children:"Start Camera"})}),(y?.dispatchStatus==="ready_for_pickup"||y?.dispatchStatus==="ready_for_load")&&ot||y?.dispatchStatus==="loaded"&&Ue?t.jsxs("div",{className:"mt-4 space-y-3 p-3 bg-blue-50 border border-blue-200 rounded",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h4",{className:"font-semibold text-sm text-blue-900",children:" Captured Photo Preview"}),t.jsx(Lt,{className:"bg-green-600",children:"Ready to Submit"})]}),ot&&ot!=="manual"&&t.jsx("img",{src:ot,alt:"Captured Send-In Photo",className:"w-full max-h-64 rounded border border-blue-300",style:{objectFit:"contain"}}),Ue&&Ue!=="manual"&&t.jsx("img",{src:Ue,alt:"Captured Release Photo",className:"w-full max-h-64 rounded border border-blue-300",style:{objectFit:"contain"}}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(pe,{variant:"outline",onClick:()=>{y?.dispatchStatus==="ready_for_pickup"||y?.dispatchStatus==="ready_for_load"?Ye(null):Nt(null),lt()},className:"flex-1",children:" Take Another Photo"}),t.jsx(pe,{variant:"secondary",onClick:()=>lt(),className:"flex-1",children:" Clear & Retake"})]})]}):null]})]}),t.jsxs(yr,{children:[t.jsx(pe,{variant:"outline",onClick:()=>C(!1),children:"Cancel"}),y?.dispatchStatus==="ready_for_pickup"||y?.dispatchStatus==="ready_for_load"?t.jsxs(pe,{onClick:()=>Ot("send_in"),className:"bg-blue-600 hover:bg-blue-700",disabled:y?.status==="entered_for_pickup"||y?.status==="loaded"||y?.status==="verified",children:[t.jsx(dr,{className:"h-4 w-4 mr-1"}),"Verify & Send In"]}):y?.dispatchStatus==="loaded"?t.jsxs(pe,{onClick:()=>Ot("release"),className:"bg-green-600 hover:bg-green-700",children:[t.jsx(dr,{className:"h-4 w-4 mr-1"}),"Verify & Release"]}):null]})]})}),t.jsx(mr,{open:A,onOpenChange:E,children:t.jsxs(fr,{className:"max-w-md",children:[t.jsxs(xr,{children:[t.jsxs(pr,{className:"flex items-center gap-2",children:[t.jsx(WN,{className:"h-5 w-5 text-red-600"}),"Reject Customer Pickup"]}),t.jsx(Ar,{children:y&&t.jsxs(t.Fragment,{children:["Reject pickup for ",y.customerName," - Gate Pass #",y.gatePassId]})})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"rejectionReason",children:"Reason for Rejection *"}),t.jsx(Re,{id:"rejectionReason",value:Xt.rejectionReason,onChange:U=>ze(ve=>({...ve,rejectionReason:U.target.value})),placeholder:"e.g., Invalid ID, Wrong vehicle, Security concerns..."})]}),y&&t.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 p-3 rounded-lg text-sm",children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Customer:"})," ",y.customerName]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Order:"})," ",y.orderNumber]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Product:"})," ",y.productName]})]})]}),t.jsxs(yr,{children:[t.jsx(pe,{variant:"outline",onClick:()=>E(!1),children:"Cancel"}),t.jsxs(pe,{variant:"destructive",onClick:kt,disabled:!Xt.rejectionReason.trim(),children:[t.jsx(en,{className:"h-4 w-4 mr-1"}),"Reject Pickup"]})]})]})}),t.jsx(mr,{open:ue,onOpenChange:I,children:t.jsxs(fr,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[t.jsxs(xr,{children:[t.jsxs(pr,{className:"flex items-center gap-2",children:[t.jsx($o,{className:"h-5 w-5 text-green-600"}),X==="add"?"Add New Guest":X==="edit"?"Edit Guest":"Guest Details"]}),t.jsx(Ar,{children:X==="add"?"Register a new visitor":"Update visitor information"})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsxs("h3",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2",children:[t.jsx(Nn,{className:"h-4 w-4"}),"Guest Information"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"guestName",children:"Guest Name *"}),t.jsx(Re,{id:"guestName",value:M.guestName,onChange:U=>_(ve=>({...ve,guestName:U.target.value})),placeholder:"Enter guest name",disabled:X==="view"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"guestContact",children:"Contact Number"}),t.jsx(Re,{id:"guestContact",value:M.guestContact,onChange:U=>_(ve=>({...ve,guestContact:U.target.value})),placeholder:"Enter contact number",disabled:X==="view"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"guestEmail",children:"Email"}),t.jsx(Re,{id:"guestEmail",type:"email",value:M.guestEmail,onChange:U=>_(ve=>({...ve,guestEmail:U.target.value})),placeholder:"Enter email address",disabled:X==="view"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"guestCompany",children:"Company"}),t.jsx(Re,{id:"guestCompany",value:M.guestCompany,onChange:U=>_(ve=>({...ve,guestCompany:U.target.value})),placeholder:"Enter company name",disabled:X==="view"})]})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("h3",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2",children:[t.jsx(Nr,{className:"h-4 w-4"}),"Meeting Information"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"meetingPerson",children:"Meeting Person *"}),t.jsx(Re,{id:"meetingPerson",value:M.meetingPerson,onChange:U=>_(ve=>({...ve,meetingPerson:U.target.value})),placeholder:"Person to meet",disabled:X==="view"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"meetingPersonDepartment",children:"Department"}),t.jsx(Re,{id:"meetingPersonDepartment",value:M.meetingPersonDepartment,onChange:U=>_(ve=>({...ve,meetingPersonDepartment:U.target.value})),placeholder:"Department",disabled:X==="view"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"meetingPersonContact",children:"Contact Number"}),t.jsx(Re,{id:"meetingPersonContact",value:M.meetingPersonContact,onChange:U=>_(ve=>({...ve,meetingPersonContact:U.target.value})),placeholder:"Contact number",disabled:X==="view"})]})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("h3",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2",children:[t.jsx(tn,{className:"h-4 w-4"}),"Visit Details"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"visitDate",children:"Visit Date *"}),t.jsx(Re,{id:"visitDate",type:"date",value:M.visitDate,onChange:U=>_(ve=>({...ve,visitDate:U.target.value})),disabled:X==="view"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"visitTime",children:"Visit Time"}),t.jsx(Re,{id:"visitTime",type:"time",value:M.visitTime,onChange:U=>_(ve=>({...ve,visitTime:U.target.value})),disabled:X==="view"})]}),t.jsxs("div",{className:"space-y-2 md:col-span-2",children:[t.jsx(Q,{htmlFor:"purpose",children:"Purpose of Visit *"}),t.jsx(vr,{id:"purpose",value:M.purpose,onChange:U=>_(ve=>({...ve,purpose:U.target.value})),placeholder:"Enter purpose of visit",rows:3,disabled:X==="view"})]})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("h3",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2",children:[t.jsx(Ga,{className:"h-4 w-4"}),"Additional Information"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"vehicleNumber",children:"Vehicle Number"}),t.jsx(Re,{id:"vehicleNumber",value:M.vehicleNumber,onChange:U=>_(ve=>({...ve,vehicleNumber:U.target.value})),placeholder:"Enter vehicle number",disabled:X==="view"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"idProofType",children:"ID Proof Type"}),t.jsxs(br,{value:M.idProofType,onValueChange:U=>_(ve=>({...ve,idProofType:U})),disabled:X==="view",children:[t.jsx(jr,{children:t.jsx(Er,{placeholder:"Select ID type"})}),t.jsxs(Tr,{children:[t.jsx(st,{value:"Aadhar Card",children:"Aadhar Card"}),t.jsx(st,{value:"PAN Card",children:"PAN Card"}),t.jsx(st,{value:"Driving License",children:"Driving License"}),t.jsx(st,{value:"Passport",children:"Passport"}),t.jsx(st,{value:"Voter ID",children:"Voter ID"})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"idProofNumber",children:"ID Proof Number"}),t.jsx(Re,{id:"idProofNumber",value:M.idProofNumber,onChange:U=>_(ve=>({...ve,idProofNumber:U.target.value})),placeholder:"Enter ID proof number",disabled:X==="view"})]}),t.jsxs("div",{className:"space-y-2 md:col-span-2",children:[t.jsx(Q,{htmlFor:"notes",children:"Notes"}),t.jsx(vr,{id:"notes",value:M.notes,onChange:U=>_(ve=>({...ve,notes:U.target.value})),placeholder:"Additional notes",rows:2,disabled:X==="view"})]})]})]})]}),t.jsxs(yr,{children:[t.jsx(pe,{variant:"outline",onClick:wt,children:"Cancel"}),X!=="view"&&t.jsxs(pe,{onClick:Et,className:"bg-green-600 hover:bg-green-700",children:[t.jsx(bf,{className:"h-4 w-4 mr-2"}),X==="add"?"Add Guest":"Update Guest"]})]})]})}),t.jsx("div",{className:"mt-12 bg-white border-2 border-gray-200 rounded-lg p-6 shadow-sm",children:t.jsxs("div",{className:"text-center text-gray-600",children:[t.jsx("p",{className:"font-medium",children:" Security Management System"}),t.jsx("p",{className:"text-sm mt-1",children:"For technical support, contact IT Department"})]})})]})]})},eE=()=>{const[e,r]=T.useState([]),s=Ls(),{user:a}=Ns(),{toast:n}=Ni(),[o,c]=T.useState({}),[d,h]=T.useState([]),[m,f]=T.useState([]),[p,g]=T.useState({}),[N,y]=T.useState([]),[w,b]=T.useState([]),[C,A]=T.useState([]),[E,R]=T.useState([]),[V,P]=T.useState(!0),[k,z]=T.useState({pendingApprovals:0,activeOrders:0,partLoadOrders:0,afterDelivery:0}),[W,te]=T.useState([]),[de,H]=T.useState([]),[ue,I]=T.useState(null),[X,oe]=T.useState(!1),[xe,he]=T.useState(!1),[F,ee]=T.useState({driverName:"",driverNumber:"",vehicleNumber:"",companyName:"",expectedDeliveryDate:""}),[M,_]=T.useState({lrNumber:"",loadingDate:"",unloadingDate:"",deliveryDate:""}),[ne,ae]=T.useState([]),[G,ie]=T.useState(null),[Me,Ee]=T.useState(!1),[ye,je]=T.useState("approve"),[We,Y]=T.useState({demandAmount:"",notes:""}),[Dt,we]=T.useState({assignVehicle:null,updateStatus:null,addVehicle:!1,manageVehicles:!1}),[ot,Ye]=T.useState(null),[Ue,Nt]=T.useState({transporterName:"",vehicleNo:""}),[qe,Bt]=T.useState({status:"",location:"",remarks:""}),[jt,Ze]=T.useState({license_plate:"",vehicle_type:"",capacity:"",driver_name:"",driver_phone:""}),[Xt,ze]=T.useState({open:!1,vehicle:null}),[ht,nt]=T.useState({vehicle_type:"",capacity:"",driver_name:"",driver_phone:"",status:"available",current_location:"",notes:""}),[Ot,lt]=T.useState({origin:"",destination:"",distance:"",weight:"",vehicleType:"",baseCost:0,distanceCost:0,weightCost:0,fuelSurcharge:0,totalCost:0});T.useEffect(()=>{et(),Ft(),kt(),er(),B(),Je(),me(),Et()},[]),T.useEffect(()=>{const L=ce=>{console.log("Vehicle checked in event received",ce?.detail),Ft()};return window.addEventListener("vehicle-checked-in",L),()=>window.removeEventListener("vehicle-checked-in",L)},[]),T.useEffect(()=>{const L=setInterval(async()=>{try{await Promise.all([Ft(),et(!0),kt(!0),er(!0),B(!0),Je(!0),me(!0)])}catch(ce){console.log("Background refresh failed:",ce)}},3e4);return()=>clearInterval(L)},[]),T.useEffect(()=>{Me||(Y({demandAmount:"",notes:""}),console.log("Dialog closed, resetting approval form"))},[Me]),T.useEffect(()=>{const L=w.filter(ce=>{const Be=(ce.status||"").toUpperCase().replace(/\s+/g,"");return console.log("Delivery status:",ce.status,"Normalized:",Be),Be==="PENDING"||Be==="INTRANSIT"||Be.includes("TRANSIT")||Be.includes("PEND")});console.log("Deliveries:",w),console.log("Active deliveries count (pending + in transit):",L.length),console.log("Active deliveries:",L),z({pendingApprovals:ne.length,activeOrders:L.length,partLoadOrders:W.length,afterDelivery:e.length})},[ne,w,W,e]);const Jt=async()=>{try{const L=await fetch(`${Fe}/fleet/available`);if(!L.ok)throw new Error(`HTTP ${L.status}`);const ce=await L.json();y(ce)}catch(L){console.error("Error fetching available vehicles:",L),y([])}},et=async(L=!1)=>{try{const ce=await fetch(`${Fe}/transport/summary`);if(!ce.ok)throw new Error(`HTTP ${ce.status}`);const Be=await ce.json();c(Be)}catch(ce){console.error("Error fetching dashboard data:",ce),L||n({title:"Error",description:"Failed to load dashboard data",variant:"destructive"})}},Ft=async(L=!1)=>{try{const ce=await fetch(`${Fe}/fleet`);if(!ce.ok)throw new Error(`HTTP ${ce.status}: ${ce.statusText}`);const Be=await ce.json();console.log("Fleet vehicles:",Be),h(Array.isArray(Be)?Be:[])}catch(ce){console.error("Error fetching vehicles:",ce),L||n({title:"Error",description:"Failed to load vehicles",variant:"destructive"})}},kt=async(L=!1)=>{try{console.log(" Fetching transport deliveries...");const ce=await fetch(`${Fe}/transport/all`);if(console.log(" Response status:",ce.status),!ce.ok)throw new Error(`HTTP ${ce.status}: ${ce.statusText}`);const Be=await ce.json();console.log(" Received deliveries data:",Be),console.log(" Number of deliveries:",Be.length),b(Array.isArray(Be)?Be:[])}catch(ce){console.error(" Error fetching deliveries:",ce),L||n({title:"Error",description:"Failed to load deliveries: "+ce.message,variant:"destructive"})}finally{P(!1)}},er=async(L=!1)=>{try{console.log(" Fetching active transport orders...");const ce=await fetch(`${Fe}/transport/active-orders`);if(console.log(" Response status:",ce.status),!ce.ok)throw new Error(`HTTP ${ce.status}: ${ce.statusText}`);const Be=await ce.json();console.log(" Received active transport orders data:",Be),console.log(" Number of active transport orders:",Be.length),A(Array.isArray(Be)?Be:[])}catch(ce){console.error(" Error fetching active transport orders:",ce),L||n({title:"Error",description:"Failed to load active transport orders: "+ce.message,variant:"destructive"})}},B=async(L=!1)=>{try{console.log(" Fetching completed transport orders...");const ce=await fetch(`${Fe}/transport/completed-orders`);if(console.log(" Response status:",ce.status),!ce.ok)throw new Error(`HTTP ${ce.status}: ${ce.statusText}`);const Be=await ce.json();console.log(" Received completed transport orders data:",Be),console.log(" Number of completed transport orders:",Be.length),R(Array.isArray(Be)?Be:[])}catch(ce){console.error(" Error fetching completed transport orders:",ce),L||n({title:"Error",description:"Failed to load completed transport orders: "+ce.message,variant:"destructive"})}},me=async(L=!1)=>{try{console.log(" Fetching completed part load orders...");const ce=await fetch(`${Fe}/transport/part-load/completed`);if(console.log(" Response status:",ce.status),!ce.ok)throw new Error(`HTTP ${ce.status}: ${ce.statusText}`);const Be=await ce.json();console.log(" Received completed part load orders data:",Be),console.log(" Number of completed part load orders:",Be.length);const Pt=Be.map(ar=>({...ar,driverName:ar.driverName||"",driverNumber:ar.driverNumber||""}));console.log("Processed orders with driver details:",Pt),r(Array.isArray(Pt)?Pt:[]),H(Array.isArray(Pt)?Pt:[])}catch(ce){console.error(" Error fetching completed part load orders:",ce),L||n({title:"Error",description:"Failed to load completed part load orders: "+ce.message,variant:"destructive"})}},Je=async(L=!1)=>{try{console.log(" Fetching part load orders needing driver details...");const ce=await fetch(`${Fe}/transport/part-load/pending-driver-details`);if(console.log(" Response status:",ce.status),!ce.ok)throw new Error(`HTTP ${ce.status}: ${ce.statusText}`);const Be=await ce.json();console.log(" Received part load orders data:",Be),console.log(" Number of part load orders:",Be.length),te(Array.isArray(Be)?Be:[])}catch(ce){console.error(" Error fetching part load orders:",ce),L||n({title:"Error",description:"Failed to load part load orders: "+ce.message,variant:"destructive"})}},mt=async L=>{L.preventDefault();try{if(console.log("All available orders:",e),console.log("Currently selected order:",ue),console.log("Form data:",M),!ue||!ue.transportJobId){n({title:"Error",description:"No part load order selected. Please try again.",variant:"destructive"});return}const ce=!!(ue.lrNumber||ue.loadingDate||ue.unloadingDate||ue.deliveryDate),Be={"LR Number":M.lrNumber,"Loading Date":M.loadingDate,"Unloading Date":M.unloadingDate,"Delivery Date":M.deliveryDate};for(const[ws,O]of Object.entries(Be))if(!O||O.toString().trim()===""){n({title:"Validation Error",description:`${ws} is required`,variant:"destructive"});return}const Pt={lrNumber:M.lrNumber,loadingDate:M.loadingDate,unloadingDate:M.unloadingDate,deliveryDate:M.deliveryDate};console.log("Submitting data:",Pt),console.log("For order ID:",ue.transportJobId);const ar=await fetch(`${Fe}/transport/part-load/${ue.transportJobId}/after-delivery`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Pt)}),$r=await ar.json();if(ar.ok)n({title:"Success",description:ce?"After delivery details updated successfully":"After delivery details saved successfully"}),he(!1),_({lrNumber:"",loadingDate:"",unloadingDate:"",deliveryDate:""}),I(null),await Je();else throw new Error($r.error||"Failed to save after delivery details")}catch(ce){console.error(" Error submitting after delivery details:",ce),n({title:"Error",description:ce.message||"Failed to save after delivery details",variant:"destructive"})}},wt=async()=>{try{const L=!!(ue?.driverName||ue?.driverNumber||ue?.vehicleNumber||ue?.companyName);if(!F.driverName.trim()){n({title:"Validation Error",description:"Driver name is required",variant:"destructive"});return}if(!F.driverNumber.trim()){n({title:"Validation Error",description:"Driver number is required",variant:"destructive"});return}if(!F.vehicleNumber.trim()){n({title:"Validation Error",description:"Vehicle number is required",variant:"destructive"});return}if(!F.companyName.trim()){n({title:"Validation Error",description:"Company name is required",variant:"destructive"});return}if(!F.expectedDeliveryDate.trim()){n({title:"Validation Error",description:"Expected delivery date is required",variant:"destructive"});return}const ce=new Date(F.expectedDeliveryDate),Be=new Date;if(Be.setHours(0,0,0,0),ce<Be){n({title:"Validation Error",description:"Expected delivery date cannot be in the past",variant:"destructive"});return}if(!ue?.transportJobId){n({title:"Error",description:"No part load order selected",variant:"destructive"});return}console.log(" Submitting driver details for part load order:",ue.transportJobId),console.log(" Driver details:",F);const Pt={...F,transporterName:F.companyName},ar=await fetch(`${Fe}/transport/part-load/${ue.transportJobId}/fill-driver-details`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(F)});console.log(" Response status:",ar.status);const $r=await ar.json();console.log(" Response data:",$r),ar.ok?(console.log(" Driver details submitted successfully"),n({title:"Success",description:L?"Driver details updated successfully":"Driver details submitted to watchman successfully"}),oe(!1),I(null),ee({driverName:"",driverNumber:"",vehicleNumber:"",companyName:"",expectedDeliveryDate:""}),await Je()):(console.log(" Failed to submit driver details:",$r),n({title:"Error",description:$r.error||"Failed to submit driver details",variant:"destructive"}))}catch(L){console.error(" Error submitting driver details:",L),n({title:"Error",description:`Error submitting driver details: ${L.message}`,variant:"destructive"})}},Et=async(L=!1)=>{try{console.log(" Fetching pending transport approvals...");const ce=await fetch(`${Fe}/transport/approvals/pending`);if(console.log(" Response status:",ce.status),!ce.ok)throw new Error(`HTTP ${ce.status}: ${ce.statusText}`);const Be=await ce.json();console.log(" Received pending approvals data:",Be),console.log(" Number of pending approvals:",Be.length),ae(Array.isArray(Be)?Be:[])}catch(ce){console.error(" Error fetching pending approvals:",ce),L||n({title:"Error",description:"Failed to load pending approvals: "+ce.message,variant:"destructive"})}},$t=async()=>{try{if(!G?.id){n({title:"Error",description:"No approval selected",variant:"destructive"});return}if(ye==="reject"){if(!We.demandAmount.trim()){n({title:"Validation Error",description:"Demand amount is required for rejection",variant:"destructive"});return}if(!We.notes.trim()){n({title:"Validation Error",description:"Notes are required for rejection",variant:"destructive"});return}const ar=parseFloat(We.demandAmount);if(isNaN(ar)||ar<=0){n({title:"Validation Error",description:"Please enter a valid positive amount",variant:"destructive"});return}}console.log(" Processing transport approval decision:",{approvalId:G.id,action:ye,formData:We});const L={action:ye,demandAmount:ye==="reject"?parseFloat(We.demandAmount):null,notes:We.notes||null,reviewedBy:a?.username||"Transport Department"},ce=await fetch(`${Fe}/transport/approvals/${G.id}/${ye}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)});if(console.log(" API_BASE:",Fe),console.log(" Full URL:",`${Fe}/transport/approvals/${G.id}/${ye}`),console.log(" Payload sent:",L),console.log(" Response status:",ce.status),!ce.ok){let ar=`Failed to ${ye} order`;try{const $r=await ce.json();ar=$r.error||$r.message||ar}catch{ar=`${ar} (HTTP ${ce.status}: ${ce.statusText})`}console.log(` Failed to ${ye} order:`,ar),n({title:"Error",description:ar,variant:"destructive"});return}const Be=await ce.json();console.log(" Response data:",Be);const Pt=ye==="approve"?"approved":"rejected";console.log(` Order ${Pt} successfully`),n({title:"Success",description:`Order ${G.orderNumber} has been ${Pt}`}),Ee(!1),ie(null),je("approve"),Y({demandAmount:"",notes:""}),await Et()}catch(L){console.error(` Error ${ye}ing order:`,L),console.error(" Error details:",{name:L.name,message:L.message,stack:L.stack});let ce=`Error ${ye}ing order`;L.name==="TypeError"&&L.message.includes("fetch")?ce="Network error: Unable to connect to server. The backend endpoint '/transport/approvals/{id}/decide' may not be implemented. Please contact IT support.":L.message.includes("Failed to fetch")?ce="Connection failed: Please check if the backend server is running and accessible.":L.message&&(ce=`${ce}: ${L.message}`),n({title:"Error",description:ce,variant:"destructive"})}},Vt=async()=>{try{if(console.log(" Starting vehicle assignment..."),console.log(" Selected delivery:",ot),console.log(" Vehicle assignment data:",Ue),!Ue.transporterName.trim()){n({title:"Validation Error",description:"Transporter name is required",variant:"destructive"});return}if(!Ue.vehicleNo.trim()){n({title:"Validation Error",description:"Please select a vehicle",variant:"destructive"});return}if(!ot?.transportJobId){n({title:"Error",description:"No delivery selected",variant:"destructive"});return}const L=`${Fe}/transport/assign/${ot.transportJobId}`;console.log(" Making API call to:",L);const ce=await fetch(L,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ue)});console.log(" Response status:",ce.status);const Be=await ce.json();if(console.log(" Response data:",Be),ce.ok){console.log(" Vehicle assigned successfully");try{await fetch(`${Fe}/transport/status/${ot.transportJobId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"in_transit",notes:"Transit started after assignment"})})}catch{}n({title:"Success",description:"Assigned and set In Transit"}),we(Pt=>({...Pt,assignVehicle:null})),Nt({transporterName:"",vehicleNo:""}),Ye(null),await Promise.all([kt(),et(),Ft()])}else console.log(" Assignment failed:",Be),n({title:"Error",description:Be.error||"Failed to assign vehicle",variant:"destructive"})}catch(L){console.error(" Error assigning vehicle:",L),n({title:"Error",description:`Error assigning vehicle: ${L.message}`,variant:"destructive"})}},qt=async()=>{try{if(console.log(" Starting status update..."),console.log(" Selected delivery:",ot),console.log(" Status update data:",qe),!qe.status){n({title:"Validation Error",description:"Status is required",variant:"destructive"});return}if(!ot?.transportJobId){n({title:"Error",description:"No delivery selected",variant:"destructive"});return}const L=`${Fe}/transport/status/${ot.transportJobId}`;console.log(" Making API call to:",L);const ce=await fetch(L,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(qe)});console.log(" Response status:",ce.status);const Be=await ce.json();console.log(" Response data:",Be),ce.ok?(console.log(" Status updated successfully"),n({title:"Success",description:"Status updated successfully"}),we(Pt=>({...Pt,updateStatus:null})),Bt({status:"",location:"",remarks:""}),Ye(null),await Promise.all([kt(),et(),Ft()])):(console.log(" Status update failed:",Be),n({title:"Error",description:Be.error||"Failed to update status",variant:"destructive"}))}catch(L){console.error(" Error updating status:",L),n({title:"Error",description:`Error updating status: ${L.message}`,variant:"destructive"})}},ls=async()=>{try{if(console.log(" Add Vehicle clicked",jt),!jt.license_plate.trim()||!jt.vehicle_type.trim()||!jt.driver_name.trim()){n({title:"Validation Error",description:"License plate, vehicle type, and driver name are required",variant:"destructive"});return}const L={vehicleNumber:jt.license_plate,vehicleType:jt.vehicle_type,capacity:jt.capacity?jt.capacity+" kg":"",driverName:jt.driver_name,driverContact:jt.driver_phone},ce=await fetch("/api/fleet/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)});console.log(" Add Vehicle response status:",ce.status);const Be=await ce.json().catch(()=>({}));console.log(" Add Vehicle response json:",Be),ce.ok?(n({title:"Success",description:"Vehicle added successfully"}),we(Pt=>({...Pt,addVehicle:!1})),Ze({license_plate:"",vehicle_type:"",capacity:"",driver_name:"",driver_phone:""}),await Promise.all([Ft(),et()])):n({title:"Error",description:Be.error||`Failed to add vehicle (HTTP ${ce.status})`,variant:"destructive"})}catch(L){console.error(" Error adding vehicle:",L),n({title:"Error",description:"Error adding vehicle",variant:"destructive"})}},Oe=L=>{nt({vehicle_type:L.vehicleType||"",capacity:(L.capacity||"").toString().replace(/\s*kg$/i,""),driver_name:L.driverName||"",driver_phone:L.driverContact||"",status:L.status||"available",current_location:L.currentLocation||"",notes:L.notes||""}),ze({open:!0,vehicle:L})},U=async()=>{try{if(console.log(" Save Edit Vehicle clicked",Xt.vehicle,ht),!Xt.vehicle?.id)return;const L=Xt.vehicle.id,ce={vehicleType:ht.vehicle_type,capacity:ht.capacity?`${ht.capacity} kg`:"",driverName:ht.driver_name,driverContact:ht.driver_phone,status:ht.status,currentLocation:ht.current_location,notes:ht.notes},Be=await fetch(`/api/fleet/${L}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ce)});console.log(" Edit Vehicle response status:",Be.status);const Pt=await Be.json().catch(()=>({}));console.log(" Edit Vehicle response json:",Pt),Be.ok?(n({title:"Updated",description:"Vehicle details updated"}),ze({open:!1,vehicle:null}),await Promise.all([Ft(),et()])):n({title:"Error",description:Pt.error||`Failed to update vehicle (HTTP ${Be.status})`,variant:"destructive"})}catch(L){console.error(" Error updating vehicle:",L),n({title:"Error",description:"Error updating vehicle",variant:"destructive"})}},ve=async L=>{try{const ce=await fetch(`/api/fleet/${L}`,{method:"DELETE"}),Be=await ce.json().catch(()=>({}));ce.ok?(n({title:"Deleted",description:"Vehicle removed from fleet"}),await Promise.all([Ft(),et()])):n({title:"Error",description:Be.error||"Failed to delete vehicle",variant:"destructive"})}catch{n({title:"Error",description:"Error deleting vehicle",variant:"destructive"})}},ct=L=>{const Be={pending:{className:"bg-yellow-100 text-yellow-800 border border-yellow-300",icon:Ka},assigned:{className:"bg-blue-100 text-blue-800 border border-blue-300",icon:rn},in_transit:{className:"bg-purple-100 text-purple-800 border border-purple-300",icon:_v},delivered:{className:"bg-green-100 text-green-800 border border-green-300",icon:dr},failed:{className:"bg-red-100 text-red-800 border border-red-300",icon:Sr}}[L]||{className:"bg-gray-100 text-gray-800 border border-gray-300",icon:Ka},Pt=Be.icon;return t.jsxs(Lt,{className:`${Be.className} flex items-center gap-1 font-medium`,children:[t.jsx(Pt,{className:"w-3 h-3"}),L?.replace("_"," ").toUpperCase()]})},vt=L=>{const Be={available:{className:"bg-green-100 text-green-800 border border-green-300"},assigned:{className:"bg-blue-100 text-blue-800 border border-blue-300"},maintenance:{className:"bg-red-100 text-red-800 border border-red-300"}}[L]||{className:"bg-gray-100 text-gray-800 border border-gray-300"};return t.jsx(Lt,{className:`${Be.className} font-medium`,children:L?.toUpperCase()})};return V?t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx(Cr,{className:"w-12 h-12 animate-spin mx-auto mb-4 text-blue-600"}),t.jsx("p",{className:"text-gray-800 text-lg font-medium",children:"Loading Transport dashboard..."}),t.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Please wait while we retrieve the data"})]})}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50",children:[t.jsx("div",{className:"max-w-7xl mx-auto bg-white shadow-md border-b-4 border-blue-800 rounded-b-lg",children:t.jsx("div",{className:"px-4 py-6 sm:px-6",children:t.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:justify-between sm:items-center sm:space-y-0",children:[t.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4",children:[t.jsxs(pe,{onClick:()=>s(a?.department==="admin"?"/dashboard/admin":"/dashboard"),variant:"outline",className:"border border-gray-300 bg-white text-gray-800 text-sm placeholder-gray-500",children:[t.jsx(qs,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-600 to-green-800 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx(rn,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Transport Department"}),t.jsx("p",{className:"text-gray-600 text-sm sm:text-base font-medium",children:"Fleet Management System"})]})]})]}),t.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 px-4 py-4 sm:px-6 rounded-lg shadow-sm w-full sm:w-auto",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(Nr,{className:"w-5 h-5 text-blue-600"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 text-xs font-medium",children:"Transport Team"}),t.jsx("p",{className:"text-blue-600 text-xs font-medium",children:"Fleet Management"})]})]})})]})})}),t.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-4",children:[t.jsx(Rn,{className:"mb-4"}),t.jsx("div",{className:"px-6 py-6",children:t.jsxs(an,{defaultValue:"dashboard",className:"space-y-4",children:[t.jsxs(ma,{className:"flex md:grid md:grid-cols-6 w-full overflow-x-auto overflow-y-hidden md:overflow-x-hidden whitespace-nowrap bg-gray-100 border border-gray-300 pl-80 md:pl-0",children:[t.jsx(xt,{value:"dashboard",className:"text-gray-800",children:"Dashboard"}),t.jsxs(xt,{value:"approvals",className:"text-gray-800 relative",children:["Approvals",k.pendingApprovals>0&&t.jsx("div",{className:"absolute -top-2 -right-2 flex items-center justify-center rounded-full bg-red-500 text-white text-xs font-bold min-w-[1.25rem] h-5 px-1",children:k.pendingApprovals})]}),t.jsxs(xt,{value:"part-load",className:"text-gray-800 relative",children:["Part Load Orders",k.partLoadOrders>0&&t.jsx("div",{className:"absolute -top-2 -right-2 flex items-center justify-center rounded-full bg-red-500 text-white text-xs font-bold min-w-[1.25rem] h-5 px-1",children:k.partLoadOrders})]}),t.jsxs(xt,{value:"deliveries",className:"text-gray-800 relative",children:["Deliveries",k.activeOrders>0&&t.jsx("div",{className:"absolute -top-2 -right-2 flex items-center justify-center rounded-full bg-red-500 text-white text-xs font-bold min-w-[1.25rem] h-5 px-1",children:k.activeOrders})]}),t.jsx(xt,{value:"vehicles",className:"text-gray-800",children:"Fleet"}),t.jsx(xt,{value:"cost-estimation",className:"text-gray-800",children:"Cost Estimation"})]}),t.jsxs(Ut,{value:"dashboard",className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(at,{className:"text-sm font-medium text-gray-800",children:"Total Deliveries"}),t.jsx(Ks,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Ve,{children:[t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:o.totalActive||0}),t.jsx("p",{className:"text-xs text-gray-600",children:"Active deliveries in system"})]})]}),t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(at,{className:"text-sm font-medium text-gray-800",children:"Available Vehicles"}),t.jsx(rn,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Ve,{children:[t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:d.filter(L=>L.status==="available").length}),t.jsx("p",{className:"text-xs text-gray-600",children:"Ready for assignment"})]})]}),t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(at,{className:"text-sm font-medium text-gray-800",children:"In Transit"}),t.jsx(_v,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Ve,{children:[t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:o.inTransitJobs||0}),t.jsx("p",{className:"text-xs text-gray-600",children:"Currently on delivery"})]})]}),t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(at,{className:"text-sm font-medium text-gray-800",children:"Today's Deliveries"}),t.jsx(dr,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Ve,{children:[t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:o.todayDelivered||0}),t.jsx("p",{className:"text-xs text-gray-600",children:"Completed today"})]})]})]}),t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsx(rt,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4"}),t.jsx(Ve,{}),t.jsxs(Ve,{children:[t.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg border",children:[t.jsx("h4",{className:"text-sm font-medium text-gray-800 mb-2",children:"Status Legend:"}),t.jsxs("div",{className:"flex flex-wrap gap-4 text-xs",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),t.jsx("span",{className:"text-gray-700",children:"Green: Pending payment"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),t.jsx("span",{className:"text-gray-700",children:"Yellow: Partial payment"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),t.jsx("span",{className:"text-gray-700",children:"Red: Payment completed OR in dispatch - ready for transport"})]})]})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs(zr,{children:[t.jsx(Kr,{children:t.jsxs(At,{children:[t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Order #"}),t.jsx(Pe,{className:"min-w-[120px] text-black",children:"Customer"}),t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Amount"}),t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Transport Cost"}),t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Payment Status"}),t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Order Status"}),t.jsx(Pe,{className:"min-w-[120px] text-black",children:"Sales Person"}),t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Created"})]})}),t.jsx(Xr,{children:C.length===0?t.jsx(At,{children:t.jsx(be,{colSpan:8,className:"text-center py-8 text-gray-600",children:"No active transport orders found."})}):C.map(L=>t.jsxs(At,{className:`${L.colorStatus==="green"?"bg-green-100 hover:bg-green-200":L.colorStatus==="yellow"?"bg-yellow-100 hover:bg-yellow-200":"bg-red-100 hover:bg-red-200"}`,children:[t.jsx(be,{className:`font-medium text-xs sm:text-sm ${L.colorStatus==="green"?"text-green-900":L.colorStatus==="yellow"?"text-yellow-900":"text-red-900"}`,children:L.orderNumber}),t.jsx(be,{className:`text-xs sm:text-sm ${L.colorStatus==="green"?"text-green-900":L.colorStatus==="yellow"?"text-yellow-900":"text-red-900"}`,children:t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:L.customerName}),t.jsx("div",{className:`text-xs truncate max-w-[150px] ${L.colorStatus==="green"?"text-green-700":L.colorStatus==="yellow"?"text-yellow-700":"text-red-700"}`,children:L.customerContact})]})}),t.jsxs(be,{className:`text-xs sm:text-sm ${L.colorStatus==="green"?"text-green-900":L.colorStatus==="yellow"?"text-yellow-900":"text-red-900"}`,children:["",L.finalAmount?.toLocaleString()||0]}),t.jsxs(be,{className:`text-xs sm:text-sm ${L.colorStatus==="green"?"text-green-900":L.colorStatus==="yellow"?"text-yellow-900":"text-red-900"}`,children:["",L.transportCost?.toLocaleString()||0]}),t.jsx(be,{className:"text-xs sm:text-sm",children:t.jsx(Lt,{variant:L.paymentStatus==="completed"?"default":L.paymentStatus==="partial"?"secondary":"outline",className:`capitalize ${L.paymentStatus==="pending"||!L.paymentStatus?"bg-gray-200 text-gray-800 border-gray-400":""}`,children:L.paymentStatus||"pending"})}),t.jsx(be,{className:"text-xs sm:text-sm",children:L.orderStatus==="pending_transport_approval"?t.jsx(Lt,{className:"capitalize bg-orange-100 text-orange-800 border border-orange-300",children:"Pending Transport Approval"}):t.jsx(Lt,{variant:L.orderStatus==="in_dispatch"?"default":L.orderStatus==="confirmed"?"secondary":"outline",className:`capitalize ${L.orderStatus==="pending"||!L.orderStatus?"bg-gray-200 text-gray-800 border-gray-400":""}`,children:L.orderStatus||"pending"})}),t.jsx(be,{className:`text-xs sm:text-sm ${L.colorStatus==="green"?"text-green-900":L.colorStatus==="yellow"?"text-yellow-900":"text-red-900"}`,children:L.salesPerson||"N/A"}),t.jsx(be,{className:`text-xs sm:text-sm ${L.colorStatus==="green"?"text-green-700":L.colorStatus==="yellow"?"text-yellow-700":"text-red-700"}`,children:new Date(L.createdAt).toLocaleDateString()})]},L.orderId))})]})})]})]}),t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx(at,{className:"text-gray-800",children:"Completed Transport Orders"}),t.jsxs(gr,{className:"text-gray-600",children:["Delivered company orders (",E.length," orders)"]})]}),t.jsxs(pe,{variant:"outline",size:"sm",onClick:B,className:"w-full sm:w-auto",children:[t.jsx(Cr,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),t.jsx(Ve,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs(zr,{children:[t.jsx(Kr,{children:t.jsxs(At,{children:[t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Order #"}),t.jsx(Pe,{className:"min-w-[120px] text-black",children:"Customer"}),t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Amount"}),t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Transport Cost"}),t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Delivered"})]})}),t.jsx(Xr,{children:E.length===0?t.jsx(At,{children:t.jsx(be,{colSpan:6,className:"text-center py-8 text-gray-600",children:"No completed transport orders found."})}):E.map(L=>t.jsxs(At,{className:"hover:bg-gray-50",children:[t.jsx(be,{className:"font-medium text-xs sm:text-sm text-gray-800",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 bg-gray-500 rounded-full"}),L.orderNumber]})}),t.jsx(be,{className:"text-xs sm:text-sm text-gray-800",children:t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:L.customerName}),t.jsx("div",{className:"text-xs text-gray-500 truncate max-w-[150px]",children:L.customerContact})]})}),t.jsxs(be,{className:"text-xs sm:text-sm text-gray-800",children:["",L.finalAmount?.toLocaleString()||0]}),t.jsxs(be,{className:"text-xs sm:text-sm text-gray-800",children:["",L.transportCost?.toLocaleString()||0]}),t.jsx(be,{className:"text-xs sm:text-sm text-gray-600",children:new Date(L.updatedAt).toLocaleDateString()})]},L.orderId))})]})})})]})]}),t.jsx(Ut,{value:"approvals",className:"space-y-4",children:t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx(at,{className:"text-gray-800",children:"Pending Transport Approvals"}),t.jsxs(gr,{className:"text-gray-600",children:["Sales orders requiring transport approval (",ne.length," orders)"]})]}),t.jsxs(pe,{variant:"outline",size:"sm",onClick:Et,className:"w-full sm:w-auto",children:[t.jsx(Cr,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),t.jsx(Ve,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs(zr,{children:[t.jsx(Kr,{children:t.jsxs(At,{children:[t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Order #"}),t.jsx(Pe,{className:"min-w-[120px] text-black",children:"Customer"}),t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Product"}),t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Delivery Type"}),t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Transport Cost"}),t.jsx(Pe,{className:"min-w-[120px] text-black",children:"Sales Person"}),t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Created"}),t.jsx(Pe,{className:"min-w-[120px] text-black",children:"Actions"})]})}),t.jsx(Xr,{children:ne.length===0?t.jsx(At,{children:t.jsx(be,{colSpan:8,className:"text-center py-8 text-gray-600",children:"No pending approvals found."})}):ne.map(L=>t.jsxs(At,{className:"hover:bg-gray-50",children:[t.jsx(be,{className:"font-medium text-xs sm:text-sm text-gray-800",children:L.orderNumber}),t.jsx(be,{className:"text-xs sm:text-sm text-gray-800",children:t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:L.customerName}),t.jsx("div",{className:"text-xs text-gray-500 truncate max-w-[150px]",children:L.customerContact})]})}),t.jsx(be,{className:"text-xs sm:text-sm text-gray-800",children:L.productName}),t.jsx(be,{className:"text-xs sm:text-sm",children:t.jsx(Lt,{className:"bg-amber-100 text-amber-800 border border-amber-300",children:L.deliveryType})}),t.jsxs(be,{className:"text-xs sm:text-sm text-gray-800",children:["",L.transportCost?.toFixed(2)||"0.00"]}),t.jsx(be,{className:"text-xs sm:text-sm text-gray-800",children:L.salesPerson||"N/A"}),t.jsx(be,{className:"text-xs sm:text-sm text-gray-600",children:new Date(L.createdAt).toLocaleDateString()}),t.jsx(be,{children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(pe,{size:"sm",className:"bg-green-600 hover:bg-green-700 text-white",onClick:()=>{ie(L),je("approve"),Y({demandAmount:"",notes:""}),Ee(!0)},children:"Approve"}),t.jsx(pe,{size:"sm",variant:"outline",className:"border-red-300 text-red-600 hover:bg-red-50",onClick:()=>{ie(L),je("reject"),Y({demandAmount:"",notes:""}),console.log("Setting rejection form with empty values:",{demandAmount:"",notes:""}),Ee(!0)},children:"Reject"})]})})]},L.id))})]})})})]})}),t.jsxs(Ut,{value:"part-load",className:"space-y-4",children:[t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx(at,{className:"text-gray-800",children:"Part Load Orders"}),t.jsxs(gr,{className:"text-gray-600",children:["Part Load orders needing driver details (",W.length," orders)"]})]}),t.jsxs(pe,{variant:"outline",size:"sm",onClick:Je,className:"w-full sm:w-auto",children:[t.jsx(Cr,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),t.jsx(Ve,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs(zr,{children:[t.jsx(Kr,{children:t.jsxs(At,{children:[t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Order #"}),t.jsx(Pe,{className:"min-w-[120px] text-black",children:"Customer"}),t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Product"}),t.jsx(Pe,{className:"min-w-[80px] text-black",children:"Quantity"}),t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Transport Cost"}),t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Status"}),t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Created"}),t.jsx(Pe,{className:"min-w-[120px] text-black",children:"Actions"})]})}),t.jsx(Xr,{children:W.length===0?t.jsx(At,{children:t.jsx(be,{colSpan:8,className:"text-center py-8 text-gray-600",children:"No Part Load orders needing driver details."})}):W.map(L=>t.jsxs(At,{className:"hover:bg-gray-50",children:[t.jsx(be,{className:"font-medium text-xs sm:text-sm text-gray-800",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 bg-amber-500 rounded-full"}),L.orderNumber]})}),t.jsx(be,{className:"text-xs sm:text-sm text-gray-800",children:t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:L.customerName}),t.jsx("div",{className:"text-xs text-gray-500 truncate max-w-[150px]",children:L.customerContact})]})}),t.jsx(be,{className:"text-xs sm:text-sm text-gray-800",children:L.productName}),t.jsx(be,{className:"text-xs sm:text-sm text-gray-800",children:L.quantity}),t.jsxs(be,{className:"text-xs sm:text-sm text-gray-800",children:["",L.transportCost?.toLocaleString()||0]}),t.jsx(be,{children:t.jsx(Lt,{className:"bg-amber-100 text-amber-800 border border-amber-300 font-medium",children:L.status})}),t.jsx(be,{className:"text-xs sm:text-sm text-gray-600",children:new Date(L.createdAt).toLocaleDateString()}),t.jsx(be,{children:t.jsx(pe,{size:"sm",className:`${L.driverName&&L.driverNumber&&L.vehicleNumber&&L.companyName?"bg-green-600 hover:bg-green-700 text-white":"bg-blue-600 hover:bg-blue-700 text-white"}`,onClick:()=>{I(L),ee({driverName:L.driverName||"",driverNumber:L.driverNumber||"",vehicleNumber:L.vehicleNumber||"",companyName:L.companyName||""}),oe(!0)},children:L.driverName&&L.driverNumber&&L.vehicleNumber&&L.companyName?"Edit Driver Details":"Fill Driver Details"})})]},L.transportJobId))})]})})})]}),t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm mt-6",children:[t.jsx(rt,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:t.jsxs("div",{children:[t.jsx(at,{className:"text-gray-800",children:"After Delivery Details"}),t.jsx(gr,{className:"text-gray-600",children:"Completed part load orders requiring delivery details"})]})}),t.jsx(Ve,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs(zr,{children:[t.jsx(Kr,{children:t.jsxs(At,{children:[t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Order #"}),t.jsx(Pe,{className:"min-w-[120px] text-black",children:"Customer"}),t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Product"}),t.jsx(Pe,{className:"min-w-[80px] text-black",children:"Quantity"}),t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Driver Details"}),t.jsx(Pe,{className:"min-w-[120px] text-black",children:"Actions"})]})}),t.jsx(Xr,{children:e.length===0?t.jsx(At,{children:t.jsx(be,{colSpan:6,className:"text-center py-8 text-gray-600",children:"No completed part load orders requiring delivery details."})}):e.map(L=>t.jsxs(At,{className:"hover:bg-gray-50",children:[t.jsx(be,{className:"font-medium text-xs sm:text-sm text-gray-800",children:L.orderNumber}),t.jsx(be,{className:"text-xs sm:text-sm text-gray-800",children:L.customerName}),t.jsx(be,{className:"text-xs sm:text-sm text-gray-800",children:L.productName}),t.jsx(be,{className:"text-xs sm:text-sm text-gray-800",children:L.quantity}),t.jsx(be,{className:"text-xs sm:text-sm text-gray-800",children:L.driverName?`${L.driverName}${L.driverNumber?` (${L.driverNumber})`:""}`:"No driver assigned"}),t.jsx(be,{children:L.hasDeliveryDetails?t.jsxs("div",{className:"flex space-x-2",children:[t.jsx(pe,{size:"sm",className:"bg-blue-100 text-gray-900 border border-blue-300 font-semibold",disabled:!0,children:" Filled"}),t.jsx(pe,{size:"sm",className:"bg-yellow-100 text-gray-900 border border-yellow-300 hover:bg-yellow-200 transition-colors duration-200 font-semibold",onClick:()=>{_({lrNumber:L.lrNo||"",loadingDate:L.loadingDate?new Date(L.loadingDate).toISOString().split("T")[0]:"",unloadingDate:L.unloadingDate?new Date(L.unloadingDate).toISOString().split("T")[0]:"",deliveryDate:L.actualDeliveryDate?new Date(L.actualDeliveryDate).toISOString().split("T")[0]:""});const ce={...L,transportJobId:L.transportJobId||L.id||L.dispatchId};I(ce),he(!0)},children:"Edit Details"})]}):t.jsx(pe,{size:"sm",className:"bg-green-100 text-green-800 border border-green-300 hover:bg-green-200 transition-colors duration-200 font-medium",onClick:()=>{_({lrNumber:"",loadingDate:"",unloadingDate:"",deliveryDate:""});const ce={...L,transportJobId:L.transportJobId||L.id||L.dispatchId};console.log("Setting selected order with ID:",ce.transportJobId),I(ce),setTimeout(()=>{he(!0)},100)},children:"Fill Delivery Details"})})]},L.transportJobId))})]})})})]})]}),t.jsx(Ut,{value:"deliveries",className:"space-y-4",children:t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx(at,{className:"text-gray-800",children:"Delivery Management"}),t.jsxs(gr,{className:"text-gray-600",children:["Manage delivery assignments and track status (",w.length," orders)"]})]}),t.jsx(pe,{variant:"outline",size:"sm",onClick:kt,className:"w-full sm:w-auto",children:"Refresh"})]}),t.jsx(Ve,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs(zr,{children:[t.jsx(Kr,{children:t.jsxs(At,{children:[t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Order ID"}),t.jsx(Pe,{className:"min-w-[120px] text-black",children:"Customer"}),t.jsx(Pe,{className:"min-w-[150px] hidden sm:table-cell text-black",children:"Address"}),t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Vehicle"}),t.jsx(Pe,{className:"min-w-[120px] hidden md:table-cell text-black",children:"Driver"}),t.jsx(Pe,{className:"min-w-[120px] text-black",children:"Delivery Type"}),t.jsx(Pe,{className:"min-w-[80px] text-black",children:"Status"}),t.jsx(Pe,{className:"min-w-[120px] text-black",children:"Actions"})]})}),t.jsx(Xr,{children:w.length===0?t.jsx(At,{children:t.jsx(be,{colSpan:7,className:"text-center py-8 text-gray-600",children:"No deliveries found. Orders from dispatch will appear here."})}):w.filter(L=>["company delivery","free delivery"].includes((L.deliveryType||"").toLowerCase())).map(L=>t.jsxs(At,{children:[t.jsx(be,{className:"font-medium text-xs sm:text-sm text-gray-800",children:L.orderNumber}),t.jsx(be,{className:"text-xs sm:text-sm text-gray-800",children:L.customerName}),t.jsx(be,{className:"hidden sm:table-cell text-xs sm:text-sm max-w-[200px] truncate text-gray-800",children:L.customerAddress}),t.jsx(be,{className:"text-xs sm:text-sm text-gray-800",children:L.vehicleNo||"Not Assigned"}),t.jsx(be,{className:"hidden md:table-cell text-xs sm:text-sm text-gray-800",children:L.transporterName||"Not Assigned"}),t.jsx(be,{className:"text-xs sm:text-sm",children:t.jsx("span",{className:`font-bold px-2 py-1 rounded border inline-block
                                ${L.deliveryType?.toLowerCase()==="company delivery"?"bg-blue-100 text-blue-800 border-blue-300":""}
                                ${L.deliveryType?.toLowerCase()==="free delivery"?"bg-green-100 text-green-800 border-green-300":""}
                              `,children:L.deliveryType||""})}),t.jsx(be,{children:ct(L.status)}),t.jsx(be,{children:t.jsxs("div",{className:"flex space-x-2",children:[L.status==="pending"&&t.jsxs(mr,{open:Dt.assignVehicle===L.transportJobId,onOpenChange:ce=>{ce?(we(Be=>({...Be,assignVehicle:L.transportJobId})),Ye(L),Jt()):(we(Be=>({...Be,assignVehicle:null})),Ye(null),Nt({transporterName:"",vehicleNo:""}))},children:[t.jsx(qo,{asChild:!0,children:t.jsxs(pe,{size:"sm",className:"text-xs sm:text-sm",onClick:()=>{we(ce=>({...ce,assignVehicle:L.transportJobId})),Ye(L),Jt()},children:[t.jsx("span",{className:"hidden sm:inline",children:"Assign Vehicle"}),t.jsx("span",{className:"sm:hidden",children:"Assign"})]})}),t.jsxs(fr,{children:[t.jsxs(xr,{children:[t.jsx(pr,{children:"Assign Vehicle"}),t.jsx(Ar,{children:"Assign a vehicle and driver for delivery"})]}),t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"text-xs text-gray-200",children:["Order qty: ",L.quantity]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"available_vehicle",children:"Available Vehicles"}),t.jsxs(ai,{className:"z-[9999]",value:Ue.vehicleNo,onChange:ce=>{const Be=typeof ce=="string"?ce:ce?.target?.value,Pt=N.find(ar=>ar.vehicleNumber===Be);Nt({transporterName:Pt?.driverName||"",vehicleNo:Be||""})},children:[t.jsx("option",{value:"",children:"Select available vehicle"}),N.map(ce=>{const Be=parseInt((ce.capacity||"").toString().replace(/[^0-9]/g,""))||0;return t.jsxs("option",{value:ce.vehicleNumber,children:[ce.vehicleNumber,"  ",ce.vehicleType,"  cap ",Be||"N/A"]},ce.id)})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"transporter",children:"Transporter Name"}),t.jsx(Re,{id:"transporter",autoFocus:!0,value:Ue.transporterName,onChange:ce=>Nt({...Ue,transporterName:ce.target.value}),placeholder:"Enter transporter name"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"vehicle",children:"Vehicle Number"}),t.jsx(Re,{id:"vehicle",value:Ue.vehicleNo,onChange:ce=>Nt({...Ue,vehicleNo:ce.target.value}),placeholder:"Enter vehicle number"})]})]}),t.jsxs(yr,{className:"flex flex-col sm:flex-row gap-2",children:[t.jsx(pe,{variant:"outline",onClick:()=>{we(ce=>({...ce,assignVehicle:null})),Ye(null),Nt({transporterName:"",vehicleNo:""})},className:"w-full sm:w-auto",children:"Cancel"}),t.jsx(pe,{onClick:Vt,className:"w-full sm:w-auto",children:"Assign Vehicle"})]})]})]}),["assigned","in_transit"].includes(L.status)&&t.jsxs(mr,{open:Dt.updateStatus===L.transportJobId,onOpenChange:ce=>{if(ce){we(Pt=>({...Pt,updateStatus:L.transportJobId})),Ye(L);const Be=L.status==="assigned"?"in_transit":L.status==="in_transit"?"delivered":"in_transit";Bt({status:Be,location:"",remarks:""})}else we(Be=>({...Be,updateStatus:null})),Ye(null),Bt({status:"",location:"",remarks:""})},children:[t.jsx(qo,{asChild:!0,children:t.jsxs(pe,{size:"sm",variant:"outline",className:"text-xs sm:text-sm",onClick:()=>{we(ce=>({...ce,updateStatus:L.transportJobId})),Ye(L)},children:[t.jsx("span",{className:"hidden sm:inline",children:"Update Status"}),t.jsx("span",{className:"sm:hidden",children:"Update"})]})}),t.jsxs(fr,{children:[t.jsxs(xr,{children:[t.jsx(pr,{children:"Update Delivery Status"}),t.jsx(Ar,{children:"Update the current status and location"})]}),t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"status",children:"Status"}),t.jsxs(ai,{className:"z-[9999]",value:qe.status,onChange:ce=>{const Be=typeof ce=="string"?ce:ce?.target?.value;Bt({...qe,status:Be})},children:[t.jsx("option",{value:"",children:"Select status"}),t.jsx("option",{value:"assigned",children:"Assigned"}),t.jsx("option",{value:"in_transit",children:"In Transit"}),t.jsx("option",{value:"delivered",children:"Delivered"}),t.jsx("option",{value:"failed",children:"Delivery Failed"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"location",children:"Location"}),t.jsx(Re,{id:"location",autoFocus:!0,value:qe.location,onChange:ce=>Bt({...qe,location:ce.target.value}),placeholder:"Current location"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"remarks",children:"Remarks"}),t.jsx(vr,{id:"remarks",value:qe.remarks,onChange:ce=>Bt({...qe,remarks:ce.target.value}),placeholder:"Additional remarks"})]})]}),t.jsxs(yr,{className:"flex flex-col sm:flex-row gap-2",children:[t.jsx(pe,{variant:"outline",onClick:()=>{we(ce=>({...ce,updateStatus:null})),Ye(null),Bt({status:"",location:"",remarks:""})},className:"w-full sm:w-auto",children:"Cancel"}),t.jsx(pe,{onClick:qt,className:"w-full sm:w-auto",children:"Update Status"})]})]})]})]})})]},L.transportJobId))})]})})})]})}),t.jsx(Ut,{value:"vehicles",className:"space-y-4",children:t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx(at,{className:"text-lg sm:text-xl text-gray-800",children:"Fleet Management"}),t.jsx(gr,{className:"text-sm text-gray-600",children:"Manage your vehicle fleet and drivers"})]}),t.jsx("div",{className:"flex gap-2",children:t.jsxs(mr,{open:Dt.addVehicle,onOpenChange:L=>{we(ce=>({...ce,addVehicle:L})),L||Ze({license_plate:"",vehicle_type:"",capacity:"",driver_name:"",driver_phone:""})},children:[t.jsx(qo,{children:t.jsx(pe,{className:"w-full sm:w-auto",onClick:()=>we(L=>({...L,addVehicle:!0})),children:"Add Vehicle"})}),t.jsxs(fr,{className:"w-full max-w-md mx-auto",children:[t.jsxs(xr,{children:[t.jsx(pr,{children:"Add New Vehicle"}),t.jsx(Ar,{children:"Register a new vehicle in the fleet"})]}),t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"plate",children:"License Plate"}),t.jsx(Re,{id:"plate",name:"license_plate",autoFocus:!0,value:jt.license_plate,onChange:L=>Ze({...jt,license_plate:L.target.value}),placeholder:"Enter license plate"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"type",children:"Vehicle Type"}),t.jsxs(ai,{id:"type",name:"vehicle_type",value:jt.vehicle_type,onChange:L=>{const ce=typeof L=="string"?L:L?.target?.value;Ze({...jt,vehicle_type:ce})},children:[t.jsx("option",{value:"",children:"Select type"}),t.jsx("option",{value:"truck",children:"Truck"}),t.jsx("option",{value:"van",children:"Van"}),t.jsx("option",{value:"motorcycle",children:"Motorcycle"}),t.jsx("option",{value:"pickup",children:"Pickup"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"capacity",children:"Capacity (kg)"}),t.jsx(Re,{id:"capacity",type:"number",name:"capacity",value:jt.capacity,onChange:L=>Ze({...jt,capacity:L.target.value}),placeholder:"Enter capacity"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"driver_name",children:"Driver Name"}),t.jsx(Re,{id:"driver_name",name:"driver_name",value:jt.driver_name,onChange:L=>Ze({...jt,driver_name:L.target.value}),placeholder:"Enter driver name"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"driver_phone",children:"Driver Phone"}),t.jsx(Re,{id:"driver_phone",type:"number",name:"driver_phone",value:jt.driver_phone,onChange:L=>Ze({...jt,driver_phone:L.target.value}),placeholder:"Enter driver phone"})]})]}),t.jsxs(yr,{children:[t.jsx(pe,{variant:"outline",onClick:()=>we(L=>({...L,addVehicle:!1})),children:"Close"}),t.jsx(pe,{onClick:ls,className:"w-full sm:w-auto",children:"Add Vehicle"})]})]})]})}),t.jsx("div",{className:"flex gap-0 w-full sm:w-auto",children:t.jsxs(mr,{open:Dt.manageVehicles,onOpenChange:L=>we(ce=>({...ce,manageVehicles:L})),children:[t.jsx(qo,{children:t.jsx(pe,{className:"w-full sm:w-auto ml-1",onClick:()=>we(L=>({...L,manageVehicles:!0})),children:"Manage Vehicles"})}),t.jsxs(fr,{className:"w-full max-w-2xl mx-auto",children:[t.jsxs(xr,{children:[t.jsx(pr,{children:"Manage Vehicles"}),t.jsx(Ar,{children:"Edit, delete, or mark drivers as reached"})]}),t.jsx("div",{className:"max-h-[60vh] overflow-auto",children:t.jsxs(zr,{children:[t.jsx(Kr,{children:t.jsxs(At,{children:[t.jsx(Pe,{children:"Plate"}),t.jsx(Pe,{children:"Type"}),t.jsx(Pe,{children:"Driver"}),t.jsx(Pe,{children:"Status"}),t.jsx(Pe,{children:"Actions"})]})}),t.jsx(Xr,{children:d.map(L=>t.jsxs(At,{children:[t.jsx(be,{children:L.vehicleNumber}),t.jsx(be,{children:L.vehicleType}),t.jsx(be,{children:L.driverName}),t.jsx(be,{children:vt(L.status)}),t.jsxs(be,{className:"flex gap-2",children:[t.jsx(pe,{size:"sm",variant:"outline",onClick:()=>Oe(L),children:"Edit"}),L.status==="returning"&&t.jsxs(t.Fragment,{children:[t.jsx(pe,{size:"sm",variant:"outline",onClick:async()=>{const ce=await fetch(`${Fe}/fleet/${L.id}/reached`,{method:"POST"});if(ce.ok)n({title:"Driver reached",description:`${L.vehicleNumber} is now available`}),Ft();else{const Be=await ce.json().catch(()=>({}));n({title:"Failed",description:Be.error||"Try again",variant:"destructive"})}},children:"Mark Reached"}),t.jsx(pe,{size:"sm",className:"ml-2",onClick:async()=>{if(!(m.includes(L.id)||p[L.id]))try{g(Pt=>({...Pt,[L.id]:!0}));const ce=await fetch(`${Fe}/fleet/${L.id}/intimate-watchman`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({note:`Vehicle ${L.vehicleNumber} returning`})}),Be=await ce.json().catch(()=>({}));ce.ok?(n({title:"Notified",description:"Watchman has been intimated"}),f(Pt=>[...Pt,L.id])):n({title:"Failed to notify",description:Be.error||"Try again",variant:"destructive"})}catch(ce){console.error("Error intimating watchman",ce),n({title:"Error",description:"Failed to notify watchman",variant:"destructive"})}finally{g(ce=>({...ce,[L.id]:!1}))}},disabled:m.includes(L.id)||!!p[L.id],children:p[L.id]?"Sending...":m.includes(L.id)?"Intimation Sent":"Send Intimation"})]}),t.jsx(mr,{open:Xt.open&&Xt.vehicle?.id===L.id,onOpenChange:ce=>{ce||ze({open:!1,vehicle:null})},children:t.jsxs(fr,{className:"w-full max-w-2xl mx-auto",children:[t.jsxs(xr,{children:[t.jsx(pr,{children:"Edit Vehicle"}),t.jsx(Ar,{children:"Update vehicle details"})]}),t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"edit_vehicle_type",children:"Vehicle Type"}),t.jsxs(ai,{id:"edit_vehicle_type",name:"vehicle_type",value:ht.vehicle_type,onChange:ce=>{const Be=typeof ce=="string"?ce:ce?.target?.value;nt({...ht,vehicle_type:Be})},children:[t.jsx("option",{value:"",children:"Select vehicle type"}),t.jsx("option",{value:"truck",children:"Truck"}),t.jsx("option",{value:"van",children:"Van"}),t.jsx("option",{value:"motorcycle",children:"Motorcycle"}),t.jsx("option",{value:"pickup",children:"Pickup"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"edit_capacity",children:"Capacity (kg)"}),t.jsx(Re,{id:"edit_capacity",name:"capacity",value:ht.capacity,onChange:ce=>nt({...ht,capacity:ce.target.value}),placeholder:"e.g. 1500"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"edit_driver_name",children:"Driver Name"}),t.jsx(Re,{id:"edit_driver_name",name:"driver_name",value:ht.driver_name,onChange:ce=>nt({...ht,driver_name:ce.target.value}),placeholder:"Enter driver name"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"edit_driver_phone",children:"Driver Phone"}),t.jsx(Re,{id:"edit_driver_phone",name:"driver_phone",value:ht.driver_phone,onChange:ce=>nt({...ht,driver_phone:ce.target.value}),placeholder:"Enter phone number"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"edit_status",children:"Status"}),t.jsxs(ai,{id:"edit_status",name:"status",value:ht.status,onChange:ce=>{const Be=typeof ce=="string"?ce:ce?.target?.value;nt({...ht,status:Be})},children:[t.jsx("option",{value:"available",children:"Available"}),t.jsx("option",{value:"assigned",children:"Assigned"}),t.jsx("option",{value:"maintenance",children:"Maintenance"}),t.jsx("option",{value:"out_of_service",children:"Out of Service"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"edit_current_location",children:"Current Location"}),t.jsx(Re,{id:"edit_current_location",name:"current_location",value:ht.current_location,onChange:ce=>nt({...ht,current_location:ce.target.value}),placeholder:"Enter current location"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"edit_notes",children:"Notes"}),t.jsx(vr,{id:"edit_notes",name:"notes",value:ht.notes,onChange:ce=>nt({...ht,notes:ce.target.value}),className:"min-h-[80px] resize-none",placeholder:"Additional notes about the vehicle..."})]})]}),t.jsxs(yr,{children:[t.jsx(pe,{variant:"outline",onClick:()=>ze({open:!1,vehicle:null}),children:"Cancel"}),t.jsx(pe,{onClick:U,children:"Save Changes"})]})]})}),t.jsx(pe,{size:"sm",variant:"destructive",onClick:()=>ve(L.id),children:"Delete"})]})]},L.id))})]})}),t.jsx(yr,{children:t.jsx(pe,{variant:"outline",onClick:()=>we(L=>({...L,manageVehicles:!1})),children:"Close"})})]})]})})]}),t.jsx(Ve,{children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs(zr,{children:[t.jsx(Kr,{children:t.jsxs(At,{children:[t.jsx(Pe,{className:"min-w-[120px] text-black",children:"License Plate"}),t.jsx(Pe,{className:"min-w-[80px] text-black",children:"Type"}),t.jsx(Pe,{className:"min-w-[80px] hidden sm:table-cell text-black",children:"Capacity"}),t.jsx(Pe,{className:"min-w-[100px] text-black",children:"Driver"}),t.jsx(Pe,{className:"min-w-[120px] hidden md:table-cell text-black",children:"Phone"}),t.jsx(Pe,{className:"min-w-[80px] text-black",children:"Status"})]})}),t.jsx(Xr,{children:d.length===0?t.jsx(At,{children:t.jsx(be,{colSpan:6,className:"text-center py-8 text-gray-600",children:'No vehicles registered yet. Click "Add Vehicle" to get started.'})}):d.map(L=>t.jsxs(At,{children:[t.jsx(be,{className:"font-medium text-xs sm:text-sm text-gray-800",children:L.vehicleNumber}),t.jsx(be,{className:"text-xs sm:text-sm text-gray-800",children:L.vehicleType}),t.jsx(be,{className:"hidden sm:table-cell text-xs sm:text-sm text-gray-800",children:L.capacity}),t.jsx(be,{className:"text-xs sm:text-sm text-gray-800",children:L.driverName}),t.jsx(be,{className:"hidden md:table-cell text-xs sm:text-sm text-gray-800",children:L.driverContact}),t.jsx(be,{className:"flex items-center gap-2",children:vt(L.status)})]},L.id))})]})})})]})}),t.jsx(Ut,{value:"cost-estimation",className:"space-y-4",children:t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsxs(rt,{children:[t.jsx(at,{className:"text-gray-800",children:"Transport Cost Estimation"}),t.jsx(gr,{className:"text-gray-600",children:"Calculate transport costs for deliveries"})]}),t.jsx(Ve,{children:t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(Q,{htmlFor:"transport-origin",className:"text-sm text-gray-800",children:"Origin"}),t.jsx(Re,{id:"transport-origin",value:Ot.origin,onChange:L=>lt(ce=>({...ce,origin:L.target.value})),placeholder:"Pickup location",className:"border border-gray-300 bg-white text-gray-800 text-sm placeholder-gray-500"})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(Q,{htmlFor:"transport-destination",className:"text-sm text-gray-800",children:"Destination"}),t.jsx(Re,{id:"transport-destination",value:Ot.destination,onChange:L=>lt(ce=>({...ce,destination:L.target.value})),placeholder:"Delivery location",className:"border border-gray-300 bg-white text-gray-800 text-sm placeholder-gray-500"})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(Q,{htmlFor:"transport-distance",className:"text-sm text-gray-800",children:"Distance (km)"}),t.jsx(Re,{id:"transport-distance",type:"number",value:Ot.distance,onChange:L=>lt(ce=>({...ce,distance:L.target.value})),placeholder:"km",className:"border border-gray-300 bg-white text-gray-800 text-sm placeholder-gray-500"})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(Q,{htmlFor:"transport-weight",className:"text-sm text-gray-800",children:"Weight (kg)"}),t.jsx(Re,{id:"transport-weight",type:"number",value:Ot.weight,onChange:L=>lt(ce=>({...ce,weight:L.target.value})),placeholder:"kg",className:"border border-gray-300 bg-white text-gray-800 text-sm placeholder-gray-500"})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(Q,{htmlFor:"transport-vehicle-type",className:"text-sm text-gray-800",children:"Vehicle Type"}),t.jsxs(ai,{id:"transport-vehicle-type",value:Ot.vehicleType,onChange:L=>{const ce=typeof L=="string"?L:L?.target?.value;lt(Be=>({...Be,vehicleType:ce}))},className:"border border-gray-300 bg-white text-gray-800 text-sm placeholder-gray-500",children:[t.jsx("option",{value:"",children:"Select"}),t.jsx("option",{value:"truck",children:"Truck (20/km)"}),t.jsx("option",{value:"van",children:"Van (14/km)"}),t.jsx("option",{value:"motorcycle",children:"Motorcycle (10/km)"}),t.jsx("option",{value:"pickup",children:"Pickup (7/km)"})]})]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(pe,{size:"sm",onClick:()=>{const L={truck:20,van:14,motorcycle:10,pickup:7},ce=parseFloat(Ot.distance)||0,Be=parseFloat(Ot.weight)||0,Pt=L[Ot.vehicleType]||0,ar=ce*Pt,$r=Be*5,ws=ar+$r,O=ws*.3,J=ws+O;lt(K=>({...K,baseCost:0,distanceCost:ar,weightCost:$r,fuelSurcharge:O,totalCost:J}))},children:"Calculate Cost"}),t.jsx(pe,{variant:"outline",size:"sm",className:"bg-gray-600 hover:bg-gray-700 text-white",onClick:()=>{lt({origin:"",destination:"",distance:"",weight:"",vehicleType:"",baseCost:0,distanceCost:0,weightCost:0,fuelSurcharge:0,totalCost:0})},children:"Reset"})]}),t.jsxs(He,{className:"bg-white border border-gray-300 shadow-sm",children:[t.jsx(rt,{className:"pb-2",children:t.jsx(at,{className:"text-base text-gray-800",children:"Cost Breakdown"})}),t.jsx(Ve,{className:"pt-2",children:t.jsxs("div",{className:"space-y-2 text-gray-800 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Distance Cost:"}),t.jsxs("span",{className:"font-medium",children:["",Ot.distanceCost.toFixed(2)]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Weight Cost:"}),t.jsxs("span",{className:"font-medium",children:["",Ot.weightCost.toFixed(2)]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Fuel Surcharge:"}),t.jsxs("span",{className:"font-medium",children:["",Ot.fuelSurcharge.toFixed(2)]})]}),t.jsx("hr",{className:"my-2 border-white/20"}),t.jsxs("div",{className:"flex justify-between text-base font-semibold",children:[t.jsx("span",{children:"Total Cost:"}),t.jsxs("span",{children:["",Ot.totalCost.toFixed(2)]})]})]})})]})]})})]})})]})}),t.jsx("div",{className:"mt-12 bg-white border-2 border-gray-200 rounded-lg p-6 shadow-sm",children:t.jsxs("div",{className:"text-center text-gray-600",children:[t.jsx("p",{className:"font-medium",children:" Transport Management System"}),t.jsx("p",{className:"text-sm mt-1",children:"For technical support, contact IT Department"})]})})]})]})," ",t.jsx(mr,{open:Me,onOpenChange:Ee,children:t.jsxs(fr,{className:"max-w-md max-h-[85vh] overflow-y-auto",children:[t.jsxs(xr,{children:[t.jsx(pr,{children:ye==="approve"?"Approve Order":"Reject Order"}),t.jsx(Ar,{children:ye==="approve"?`Approve transport order ${G?.orderNumber}?`:`Reject transport order ${G?.orderNumber} and specify demand amount`})]}),ye==="reject"&&t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"transport-demand-amount",children:"Demand Amount ()"}),t.jsx(Re,{id:"transport-demand-amount",type:"number",value:We.demandAmount,onChange:L=>Y(ce=>({...ce,demandAmount:L.target.value})),placeholder:"Enter demand amount",className:"w-full"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"notes",children:"Notes"}),t.jsx(vr,{id:"notes",name:"notes",value:We.notes,onChange:L=>Y(ce=>({...ce,notes:L.target.value})),placeholder:"Enter rejection reason and notes",className:"w-full",rows:3})]})]}),t.jsxs(yr,{className:"flex flex-col sm:flex-row gap-2",children:[t.jsx(pe,{variant:"outline",onClick:()=>{Ee(!1),ie(null),je("approve"),Y({demandAmount:"",notes:""})},className:"w-full sm:w-auto",children:"Cancel"}),t.jsx(pe,{onClick:$t,className:`w-full sm:w-auto ${ye==="approve"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"}`,children:ye==="approve"?"Approve Order":"Reject Order"})]})]})}),t.jsx(mr,{open:X,onOpenChange:oe,children:t.jsxs(fr,{className:"max-w-md",children:[t.jsxs(xr,{children:[t.jsx(pr,{children:"Fill Driver Details"}),t.jsxs(Ar,{children:["Enter driver and vehicle details for part load order #",ue?.orderNumber]})]}),t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"transport-driver-name",children:"Driver Name"}),t.jsx(Re,{id:"transport-driver-name",name:"driverName",value:F.driverName,onChange:L=>ee(ce=>({...ce,driverName:L.target.value})),placeholder:"Enter driver name",className:"w-full"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"transport-driver-number",children:"Driver Number"}),t.jsx(Re,{id:"transport-driver-number",name:"driverNumber",value:F.driverNumber,onChange:L=>ee(ce=>({...ce,driverNumber:L.target.value})),placeholder:"Enter driver phone number",className:"w-full"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"transport-vehicle-number",children:"Vehicle Number"}),t.jsx(Re,{id:"transport-vehicle-number",name:"vehicleNumber",value:F.vehicleNumber,onChange:L=>ee(ce=>({...ce,vehicleNumber:L.target.value})),placeholder:"Enter vehicle number",className:"w-full"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"transport-company-name",children:"Company Name"}),t.jsx(Re,{id:"transport-company-name",name:"companyName",value:F.companyName,onChange:L=>ee(ce=>({...ce,companyName:L.target.value})),placeholder:"Enter company name",className:"w-full"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"transport-expected-delivery",children:"Expected Delivery Date"}),t.jsx(Re,{id:"transport-expected-delivery",name:"expectedDeliveryDate",type:"date",value:F.expectedDeliveryDate,onChange:L=>ee(ce=>({...ce,expectedDeliveryDate:L.target.value})),className:"w-full"})]}),t.jsxs(yr,{children:[t.jsx(pe,{variant:"outline",onClick:()=>{oe(!1),I(null),ee({driverName:"",driverNumber:"",vehicleNumber:"",companyName:"",expectedDeliveryDate:""})},children:"Cancel"}),t.jsx(pe,{onClick:wt,className:"bg-blue-600 hover:bg-blue-700",children:"Submit to Watchman"})]})]})}),t.jsx(mr,{open:xe,onOpenChange:L=>{L||(he(!1),_({lrNumber:"",loadingDate:"",unloadingDate:"",deliveryDate:""}))},children:t.jsxs(fr,{className:"max-w-md",children:[t.jsxs(xr,{children:[t.jsx(pr,{className:"text-xl font-semibold text-gray-900",children:"After Delivery Details"}),t.jsxs(Ar,{className:"text-gray-600",children:["Enter after delivery details for part load order #",ue?.orderNumber]})]}),ue?t.jsxs("form",{onSubmit:mt,children:[t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"lr-number",className:"text-sm font-medium text-white",children:"LR Number"}),t.jsx(Re,{id:"lr-number",value:M.lrNumber,onChange:L=>_(ce=>({...ce,lrNumber:L.target.value})),placeholder:"Enter LR number",className:"w-full bg-white border border-gray-300 rounded-md text-gray-900",required:!0})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"loading-date",className:"text-sm font-medium text-white",children:"Loading Date"}),t.jsx(Re,{id:"loading-date",type:"date",value:M.loadingDate,onChange:L=>_(ce=>({...ce,loadingDate:L.target.value})),className:"w-full bg-white border border-gray-300 rounded-md text-gray-900 px-3 py-2 [&::-webkit-calendar-picker-indicator]:invert [&::-webkit-calendar-picker-indicator]:bg-white [&::-webkit-calendar-picker-indicator]:p-1 [&::-webkit-calendar-picker-indicator]:rounded",required:!0,max:M.unloadingDate||M.deliveryDate||"2025-12-31"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"unloading-date",className:"text-sm font-medium text-white",children:"Unloading Date"}),t.jsx(Re,{id:"unloading-date",type:"date",value:M.unloadingDate,onChange:L=>_(ce=>({...ce,unloadingDate:L.target.value})),className:"w-full bg-white border border-gray-300 rounded-md text-gray-900 px-3 py-2 [&::-webkit-calendar-picker-indicator]:invert [&::-webkit-calendar-picker-indicator]:bg-white [&::-webkit-calendar-picker-indicator]:p-1 [&::-webkit-calendar-picker-indicator]:rounded",required:!0,min:M.loadingDate,max:M.deliveryDate||"2025-12-31"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"delivery-date",className:"text-sm font-medium text-white",children:"Delivery Date"}),t.jsx(Re,{id:"delivery-date",type:"date",value:M.deliveryDate,onChange:L=>_(ce=>({...ce,deliveryDate:L.target.value})),className:"w-full bg-white border border-gray-300 rounded-md text-gray-900 px-3 py-2 [&::-webkit-calendar-picker-indicator]:invert [&::-webkit-calendar-picker-indicator]:bg-white [&::-webkit-calendar-picker-indicator]:p-1 [&::-webkit-calendar-picker-indicator]:rounded",required:!0,min:M.unloadingDate||M.loadingDate})]})]}),t.jsxs(yr,{className:"mt-6",children:[t.jsx(pe,{type:"button",variant:"outline",onClick:()=>{he(!1),_({lrNumber:"",loadingDate:"",unloadingDate:"",deliveryDate:""})},children:"Cancel"}),t.jsx(pe,{type:"submit",className:"bg-green-600 hover:bg-green-700",children:"Submit"})]})]}):t.jsx("div",{className:"py-4 text-center text-gray-600",children:"No part load order selected. Please select an order first."})]})})]})},tE=()=>{const e=Ls(),{user:r}=Ns(),[s,a]=T.useState("dashboard"),[n,o]=T.useState([]),[c,d]=T.useState(null),[h,m]=T.useState([]),[f,p]=T.useState([]),[g,N]=T.useState([]),[y,w]=T.useState([]),[b,C]=T.useState([]),[A,E]=T.useState([]),[R,V]=T.useState([]),[P,k]=T.useState([]),[z,W]=T.useState(!1),[te,de]=T.useState(null),[H,ue]=T.useState(!1),[I,X]=T.useState(""),[oe,xe]=T.useState(null),[he,F]=T.useState(""),[ee,M]=T.useState({}),[_,ne]=T.useState(""),[ae,G]=T.useState(""),{toast:ie}=Ni(),Me=(S={})=>{const re=S.firstName??S.first_name??"",Ne=S.lastName??S.last_name??"",Te=S.employeeId??S.employee_id??"",Qe=S.joiningDate??S.joining_date??"",St=S.managerId??S.manager_id??null,Yt=S.monthlySalary??S.salary??"",cr=S.salaryType??S.salary_type??"monthly",Yr=S.status??"active";return{...S,firstName:re,lastName:Ne,employeeId:Te,joiningDate:Qe,managerId:St,salary:Yt,salaryType:cr,status:Yr,fullName:(S.fullName||S.name||`${re} ${Ne}`).trim()}},[Ee,ye]=T.useState({employeeId:"",firstName:"",lastName:"",email:"",phone:"",dateOfBirth:"",gender:"",address:"",department:"",designation:"",joiningDate:"",salary:"",salaryType:"monthly",status:"active"}),[je,We]=T.useState({employeeId:"",date:"",checkInTime:"",checkOutTime:"",status:"present",notes:""}),[Y,Dt]=T.useState({employeeId:"",leaveType:"",startDate:"",endDate:"",reason:""}),[we,ot]=T.useState({employeeId:"",payPeriodStart:"",payPeriodEnd:"",basicSalary:"",salaryType:"monthly",allowances:"0",deductions:""}),[Ye,Ue]=T.useState(null),[Nt,qe]=T.useState("single"),[Bt,jt]=T.useState([]),[Ze,Xt]=T.useState({totalWorkingDays:0,attendedDays:0,absentDays:0,totalHours:0,loading:!1}),[ze,ht]=T.useState({title:"",department:"",location:"",employmentType:"",experienceLevel:"",salaryRange:"",description:"",applicationUrl:"",requirements:"",responsibilities:""}),[nt,Ot]=T.useState({jobPostingId:"",candidateName:"",email:"",phone:"",experience:"",currentCompany:"",currentPosition:"",expectedSalary:"",noticePeriod:"",resumeUrl:"",coverLetter:"",skills:""}),[lt,Jt]=T.useState({applicationId:"",candidateName:"",jobTitle:"",scheduledDate:"",scheduledTime:"",interviewType:"",interviewers:"",interviewerId:"",location:"",notes:"",decision:"",rating:"",feedback:""}),[et,Ft]=T.useState(null),[kt,er]=T.useState(null),B=(S,re=null)=>{if(X(S),xe(re),(S==="editEmployee"||S==="viewEmployee")&&re){const Ne=Me(re),Te={firstName:Ne.firstName,lastName:Ne.lastName,email:Ne.email||"",phone:Ne.phone||"",designation:Ne.designation||"",department:Ne.department||"",joiningDate:Ne.joiningDate||"",address:Ne.address||"",salary:Ne.salary||"",salaryType:Ne.salaryType||"monthly",employeeId:Ne.employeeId||"",status:Ne.status||"active",dateOfBirth:Ne.dateOfBirth||Ne.date_of_birth||"",gender:Ne.gender||"",managerId:Ne.managerId?Ne.managerId.toString():null};M(Te)}else S==="jobPosting"||S==="editJobPosting"||S==="viewJobPosting"?ht(re?{id:re.id,title:re.title||"",department:re.department||"",location:re.location||"",employmentType:re.employmentType||"",experienceLevel:re.experienceLevel||"",salaryRange:re.salaryRange||"",description:re.description||"",applicationUrl:re.applicationUrl||"",requirements:re.requirements||"",responsibilities:re.responsibilities||"",postedDate:re.postedDate||"",status:re.status||"open"}:{id:"",title:"",department:"",location:"",employmentType:"",experienceLevel:"",salaryRange:"",description:"",applicationUrl:"",requirements:"",responsibilities:"",postedDate:new Date().toISOString().split("T")[0],status:"open"}):M({firstName:"",lastName:"",email:"",phone:"",designation:"",department:"",joiningDate:"",address:"",salary:"",salaryType:"monthly",employeeId:"",status:"active",dateOfBirth:"",gender:"",managerId:null});ue(!0)},me=()=>{ue(!1),X(""),xe(null),M({})},Je=async()=>{switch(I){case"addEmployee":case"editEmployee":if(!ee.firstName||!ee.lastName||!ee.email||!ee.department||!ee.designation||!ee.joiningDate){ie({title:"Missing Information",description:"First name, last name, email, department, designation, and joining date are required.",variant:"destructive"});return}try{const S={firstName:ee.firstName,lastName:ee.lastName,email:ee.email,phone:ee.phone,designation:ee.designation,department:ee.department,joiningDate:ee.joiningDate,address:ee.address,salary:ee.salary,salaryType:ee.salaryType,status:ee.status,dateOfBirth:ee.dateOfBirth,gender:ee.gender};ee.managerId!==null&&ee.managerId!==""&&(S.managerId=ee.managerId);const re=I==="addEmployee"?`${Fe}/hr/employees`:`${Fe}/hr/employees/${oe.id}`,Ne=I==="addEmployee"?"POST":"PUT";if(!(await fetch(re,{method:Ne,headers:{"Content-Type":"application/json"},body:JSON.stringify(S)})).ok)throw new Error("Failed to save employee");if(Ne==="PUT"){const Qe=Me({...oe,...S,id:oe.id});o(St=>St.map(Yt=>Yt.id===Qe.id?Qe:Yt))}ie({title:"Success",description:`Employee ${I==="addEmployee"?"added":"updated"} successfully`}),me(),ws()}catch(S){ie({title:"Error",description:S.message,variant:"destructive"})}break;case"jobPosting":if(!ze.title||!ze.department||!ze.employmentType||!ze.description){ie({title:"Missing Information",description:"Title, department, employment type, and description are required.",variant:"destructive"});return}try{const S={title:ze.title,department:ze.department,location:ze.location,employmentType:ze.employmentType,experienceLevel:ze.experienceLevel,salaryRange:ze.salaryRange,description:ze.description,applicationUrl:ze.applicationUrl||null,requirements:ze.requirements,responsibilities:ze.responsibilities,postedDate:new Date().toISOString().split("T")[0]};if(!(await fetch(`${Fe}/hr/job-postings`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)})).ok)throw new Error("Failed to create job posting");ie({title:"Success",description:"Job posting created successfully"}),me(),K(),ht({title:"",department:"",location:"",employmentType:"",experienceLevel:"",salaryRange:"",description:"",applicationUrl:"",requirements:"",responsibilities:""})}catch(S){ie({title:"Error",description:S.message,variant:"destructive"})}break;case"editJobPosting":if(!ze.title||!ze.department||!ze.employmentType||!ze.description){ie({title:"Missing Information",description:"Title, department, employment type, and description are required.",variant:"destructive"});return}try{const S={title:ze.title,department:ze.department,location:ze.location,employmentType:ze.employmentType,experienceLevel:ze.experienceLevel,salaryRange:ze.salaryRange,description:ze.description,requirements:ze.requirements,responsibilities:ze.responsibilities,status:ze.status};if(!(await fetch(`${Fe}/hr/job-postings/${ze.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)})).ok)throw new Error("Failed to update job posting");ie({title:"Success",description:"Job posting updated successfully"}),me(),K()}catch(S){ie({title:"Error",description:S.message,variant:"destructive"})}break;case"addApplication":if(!nt.jobPostingId||!nt.candidateName||!nt.email||!nt.phone){ie({title:"Missing Information",description:"Job posting, name, email, and phone are required.",variant:"destructive"});return}try{const S={jobPostingId:nt.jobPostingId,candidateName:nt.candidateName,email:nt.email,phone:nt.phone,experience:nt.experience,currentCompany:nt.currentCompany,currentPosition:nt.currentPosition,expectedSalary:nt.expectedSalary,noticePeriod:nt.noticePeriod,resumeUrl:nt.resumeUrl,coverLetter:nt.coverLetter,skills:nt.skills,status:"pending"};if(!(await fetch(`${Fe}/hr/job-applications`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)})).ok)throw new Error("Failed to submit application");ie({title:"Success",description:"Application submitted successfully"}),me(),q(),Ot({jobPostingId:"",candidateName:"",email:"",phone:"",experience:"",currentCompany:"",currentPosition:"",expectedSalary:"",noticePeriod:"",resumeUrl:"",coverLetter:"",skills:""})}catch(S){ie({title:"Error",description:S.message,variant:"destructive"})}break;case"scheduleInterview":if(!lt.applicationId||!lt.scheduledDate||!lt.scheduledTime||!lt.interviewType){ie({title:"Missing Information",description:"Application, date, time, and interview type are required.",variant:"destructive"});return}try{const S={applicationId:lt.applicationId,scheduledDate:lt.scheduledDate,scheduledTime:lt.scheduledTime,interviewType:lt.interviewType,duration_minutes:lt.duration_minutes||60,interviewers:lt.interviewers,location:lt.location,notes:lt.notes},re=await fetch(`${Fe}/hr/interviews`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)});if(!re.ok){const Ne=await re.json();throw new Error(Ne.error||"Failed to schedule interview")}ie({title:"Success",description:"Interview scheduled successfully"}),me(),Z(),q(),Jt({applicationId:"",candidateName:"",jobTitle:"",scheduledDate:"",scheduledTime:"",interviewType:"",interviewers:"",interviewerId:"",location:"",notes:"",decision:"",rating:"",feedback:""})}catch(S){ie({title:"Error",description:S.message,variant:"destructive"})}break;case"screenApplication":if(!nt.screeningDecision){ie({title:"Missing Information",description:"Please select a screening decision.",variant:"destructive"});return}try{if(!(await fetch(`${Fe}/hr/job-applications/${et.id}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:nt.screeningDecision==="pass"?"screening_passed":"rejected",screeningNotes:nt.screeningNotes,reviewerId:r?.id||1})})).ok)throw new Error("Failed to update screening status");ie({title:"Success",description:"Screening status updated successfully"}),me(),q()}catch(S){ie({title:"Error",description:S.message,variant:"destructive"})}break;case"updateInterviewResult":if(!lt.decision){ie({title:"Missing Information",description:"Please select an interview decision.",variant:"destructive"});return}try{await Be(kt.id,"completed",lt.feedback,lt.rating?parseFloat(lt.rating):null,lt.decision)}catch(S){ie({title:"Error",description:S.message,variant:"destructive"})}break;case"setJoining":if(!nt.joiningDate){ie({title:"Missing Information",description:"Please select a joining date.",variant:"destructive"});return}try{await Pt(et.id,nt.joiningDate,nt.documentsSubmitted)}catch(S){ie({title:"Error",description:S.message,variant:"destructive"})}break}},mt=async()=>{try{if(Nt==="single"&&!we.employeeId){ie({title:"Error",description:"Please select an employee",variant:"destructive"});return}if(!we.payPeriodStart||!we.payPeriodEnd){ie({title:"Error",description:"Please select pay period dates",variant:"destructive"});return}if(!we.allowances||parseFloat(we.allowances)<0){ie({title:"Error",description:"Please enter a valid allowances amount",variant:"destructive"});return}if(Nt==="bulk"){const S=n.filter(Te=>Te.status==="active");let re=0,Ne=0;for(const Te of S)try{const Qe=n.find(Yt=>Yt.id===Te.id);(await fetch(`${Fe}/hr/employees/${Te.id}/payrolls`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({startDate:we.payPeriodStart,endDate:we.payPeriodEnd,allowances:parseFloat(we.allowances),totalWorkingDays:22,attendedDays:22,salaryType:Qe?.salaryType||"monthly",totalHours:0})})).ok?re++:Ne++}catch{Ne++}ie({title:"Bulk Payroll Generated",description:`Successfully generated: ${re}, Failed: ${Ne}`}),J(),me()}else{if(!(await fetch(`${Fe}/hr/employees/${we.employeeId}/payrolls`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({startDate:we.payPeriodStart,endDate:we.payPeriodEnd,allowances:parseFloat(we.allowances),totalWorkingDays:Ze.totalWorkingDays,attendedDays:Ze.attendedDays,salaryType:we.salaryType,totalHours:Ze.totalHours})})).ok)throw new Error("Failed to generate payroll");ie({title:"Success",description:"Payroll generated successfully"}),J(),me()}}catch(S){ie({title:"Error",description:S.message,variant:"destructive"})}},wt=async S=>{try{if(!(await fetch(`${Fe}/hr/payrolls/${S}/process`,{method:"PUT",headers:{"Content-Type":"application/json"}})).ok)throw new Error("Failed to process payroll");ie({title:"Success",description:"Payroll marked as processed"}),J()}catch(re){ie({title:"Error",description:re.message,variant:"destructive"})}},Et=async S=>{try{const re=await fetch(`${Fe}/hr/payrolls/${S}/payslip`,{method:"GET"});if(!re.ok)throw new Error("Failed to download payslip");const Ne=re.headers.get("Content-Disposition");let Te=`payslip_${S}.html`;if(Ne){const Yr=Ne.match(/filename="(.+)"/);Yr&&(Te=Yr[1])}const Qe=await re.text(),St=new Blob([Qe],{type:"text/html"}),Yt=window.URL.createObjectURL(St),cr=document.createElement("a");cr.href=Yt,cr.download=Te,document.body.appendChild(cr),cr.click(),window.URL.revokeObjectURL(Yt),document.body.removeChild(cr),ie({title:"Success",description:"Payslip downloaded successfully. Open the HTML file in your browser and use Ctrl+P to print/save as PDF."})}catch(re){ie({title:"Error",description:re.message,variant:"destructive"})}},$t=async S=>{if(window.confirm("Are you sure you want to delete this payroll? This action cannot be undone."))try{if(!(await fetch(`${Fe}/hr/payrolls/${S}`,{method:"DELETE"})).ok)throw new Error("Failed to delete payroll");ie({title:"Success",description:"Payroll deleted successfully"}),J()}catch(re){ie({title:"Error",description:re.message,variant:"destructive"})}},Vt=S=>{const re=n.find(Ne=>Ne.id===S.employeeId);Ue(S),ot({employeeId:S.employeeId,payPeriodStart:S.payPeriodStart,payPeriodEnd:S.payPeriodEnd,basicSalary:S.monthlySalary||"",salaryType:re?.salaryType||"monthly",allowances:S.allowances||"0",deductions:S.deductions||""}),Ae(S.employeeId,S.payPeriodStart,S.payPeriodEnd),X("editPayroll"),ue(!0)},qt=async()=>{if(!we.allowances||parseFloat(we.allowances)<0){ie({title:"Error",description:"Please enter a valid allowances amount",variant:"destructive"});return}const S=Ye.id;try{if(!(await fetch(`${Fe}/hr/payrolls/${S}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({startDate:we.payPeriodStart,endDate:we.payPeriodEnd,allowances:parseFloat(we.allowances),totalWorkingDays:Ze.totalWorkingDays,attendedDays:Ze.attendedDays,salaryType:we.salaryType,totalHours:Ze.totalHours})})).ok)throw new Error("Failed to update payroll");ie({title:"Success",description:"Payroll updated successfully"}),me(),J()}catch(re){ie({title:"Error",description:re.message,variant:"destructive"})}},ls=async()=>{try{const S=await fetch(`${Fe}/hr/payrolls/export`,{method:"GET"});if(!S.ok)throw new Error("Failed to export payroll report");const re=await S.blob(),Ne=window.URL.createObjectURL(re),Te=document.createElement("a");Te.href=Ne,Te.download="payroll_report.xlsx",document.body.appendChild(Te),Te.click(),window.URL.revokeObjectURL(Ne),document.body.removeChild(Te),ie({title:"Success",description:"Payroll report exported successfully."})}catch(S){ie({title:"Error",description:S.message,variant:"destructive"})}},Oe=S=>{Ue(S),X("viewPayroll"),ue(!0)},U=()=>{X("generatePayroll"),qe("single");const S=new Date,re=new Date(S.getFullYear(),S.getMonth(),1),Ne=new Date(S.getFullYear(),S.getMonth()+1,0);ot({employeeId:"",payPeriodStart:re.toISOString().split("T")[0],payPeriodEnd:Ne.toISOString().split("T")[0],basicSalary:"",salaryType:"monthly",allowances:"0",deductions:""}),ue(!0)},ve=async()=>{try{if(!je.employeeId){ie({title:"Error",description:"Please select an employee",variant:"destructive"});return}if(!je.date){ie({title:"Error",description:"Please select a date",variant:"destructive"});return}if(!(await fetch(`${Fe}/hr/employees/${je.employeeId}/attendance`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:je.date,checkInTime:je.checkInTime||null,checkOutTime:je.checkOutTime||null,status:je.status,notes:je.notes||""})})).ok)throw new Error("Failed to mark attendance");ie({title:"Success",description:"Attendance marked successfully"}),me(),O(),We({employeeId:"",date:new Date().toISOString().split("T")[0],checkInTime:"",checkOutTime:"",status:"present",notes:""})}catch(S){ie({title:"Error",description:S.message,variant:"destructive"})}},ct=async()=>{try{if(!Y.employeeId||!Y.leaveType||!Y.startDate||!Y.endDate||!Y.reason){ie({title:"Missing Information",description:"All fields are required.",variant:"destructive"});return}if(!(await fetch(`${Fe}/hr/employees/${Y.employeeId}/leaves`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({leaveType:Y.leaveType,startDate:Y.startDate,endDate:Y.endDate,reason:Y.reason})})).ok)throw new Error("Failed to submit leave request");ie({title:"Success",description:"Leave request submitted successfully"}),me(),O(),Dt({employeeId:"",leaveType:"",startDate:"",endDate:"",reason:""})}catch(S){ie({title:"Error",description:S.message,variant:"destructive"})}},vt=async(S,re)=>{try{if(!(await fetch(`${Fe}/hr/leaves/${S}/approve`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({approved:re,approverId:r?.id||1})})).ok)throw new Error("Failed to process leave request");ie({title:"Success",description:`Leave request ${re?"approved":"rejected"} successfully`}),O()}catch(Ne){ie({title:"Error",description:Ne.message,variant:"destructive"})}},L=()=>{X("markAttendance"),We({employeeId:"",date:new Date().toISOString().split("T")[0],checkInTime:"",checkOutTime:"",status:"present",notes:""}),ue(!0)},ce=async(S,re,Ne="")=>{try{if(!(await fetch(`${Fe}/hr/job-applications/${S}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:re,reviewerId:r?.id||1,reviewerNotes:Ne})})).ok)throw new Error("Failed to update application status");ie({title:"Success",description:`Application ${re==="screening_passed"?"passed screening":re==="screening_failed"?"failed screening":"updated"} successfully`}),q(),me()}catch(Te){ie({title:"Error",description:Te.message,variant:"destructive"})}},Be=async(S,re,Ne,Te,Qe)=>{try{if(!(await fetch(`${Fe}/hr/interviews/${S}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:re,feedback:Ne,rating:Te,decision:Qe,interviewerId:Number(lt.interviewerId||r?.id||1)})})).ok)throw new Error("Failed to update interview result");ie({title:"Success",description:"Interview result updated successfully"}),Z(),q(),me()}catch(St){ie({title:"Error",description:St.message,variant:"destructive"})}},Pt=async(S,re,Ne)=>{try{if(!(await fetch(`${Fe}/hr/job-applications/${S}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"hired",joiningDate:re,documentsSubmitted:Ne,reviewerId:r?.id||1})})).ok)throw new Error("Failed to set joining details");ie({title:"Success",description:"Joining details set successfully"}),q(),me()}catch(Te){ie({title:"Error",description:Te.message,variant:"destructive"})}};T.useEffect(()=>{ar()},[s]);const ar=async()=>{W(!0),de(null);try{switch(s){case"dashboard":await $r();break;case"employees":await ws();break;case"attendance":await O();break;case"payroll":await ws(),await J();break;case"recruitment":await K(),await q(),await Z(),await se();break}}catch(S){de(S.message),console.error("Error fetching data:",S),ie({title:"Error",description:"Failed to fetch data",variant:"destructive"})}finally{W(!1)}},$r=async()=>{const S=await fetch(`${Fe}/hr/dashboard`);if(!S.ok)throw new Error("Failed to fetch dashboard data");const re=await S.json();d(re),await ws()},ws=async()=>{const S=await fetch(`${Fe}/hr/employees`);if(!S.ok)throw new Error("Failed to fetch employees");const Ne=(await S.json()).map(Te=>Me(Te));o(Ne)},O=async()=>{const[S,re,Ne]=await Promise.all([fetch(`${Fe}/hr/attendance`),fetch(`${Fe}/hr/leaves`),fetch(`${Fe}/hr/employees`)]);if(!S.ok||!re.ok||!Ne.ok)throw new Error("Failed to fetch attendance data");const Te=await S.json(),Qe=await re.json(),St=await Ne.json();m(Te),p(Qe),o(St.map(ur=>Me(ur)));const Yt=St.map(ur=>fetch(`${Fe}/hr/employees/${ur.id}/leave-balance`)),cr=await Promise.all(Yt),Yr=await Promise.all(cr.map(ur=>ur.ok?ur.json():Promise.resolve(null)));N(Yr.filter(ur=>ur!==null))},J=async()=>{const S=await fetch(`${Fe}/hr/payrolls`);if(!S.ok)throw new Error("Failed to fetch payrolls");const re=await S.json();w(re)},K=async()=>{const S=await fetch(`${Fe}/hr/job-postings`);if(!S.ok)throw new Error("Failed to fetch job postings");const re=await S.json();C(re)},q=async()=>{const S=await fetch(`${Fe}/hr/job-applications`);if(!S.ok)throw new Error("Failed to fetch job applications");const re=await S.json();E(re)},Z=async()=>{const S=await fetch(`${Fe}/hr/interviews`);if(!S.ok)throw new Error("Failed to fetch interviews");const re=await S.json();V(re)},se=async()=>{const S=await fetch(`${Fe}/hr/candidates`);if(!S.ok)throw new Error("Failed to fetch candidates");const re=await S.json();k(re)},Ae=async(S,re,Ne)=>{if(!(!S||!re||!Ne)){Xt(Te=>({...Te,loading:!0}));try{const Te=await fetch(`${Fe}/hr/employees/${S}/attendance?startDate=${re}&endDate=${Ne}`);if(!Te.ok)throw new Error("Failed to fetch attendance data");const Qe=await Te.json();console.log("Attendance Records:",Qe),console.log("Hours worked per record:",Qe.map(cr=>({date:cr.date,hoursWorked:cr.hoursWorked})));const St=n.find(cr=>cr.id===parseInt(S)),Yt=St?.salaryType||"monthly";if(console.log("Employee found:",St),console.log("Employee salary type:",Yt),Yt==="hourly"){const cr=Qe.reduce((Yr,ur)=>(console.log(`Adding hours: ${ur.hoursWorked||0} from date ${ur.date}`),Yr+(ur.hoursWorked||0)),0);console.log("Total hours calculated:",cr),Xt({totalWorkingDays:0,attendedDays:0,absentDays:0,totalHours:cr,loading:!1})}else{const cr=new Date(re),Yr=new Date(Ne);let ur=0,ut=0;for(let nr=new Date(cr);nr<=Yr;nr.setDate(nr.getDate()+1))if(nr.getDay()!==0){ur++;const Dn=Qe.find(ji=>ji.date===nr.toISOString().split("T")[0]);Dn&&(Dn.status==="present"||Dn.status==="half_day")&&(ut+=Dn.status==="half_day"?.5:1)}const Ir=ur-ut;Xt({totalWorkingDays:ur,attendedDays:ut,absentDays:Ir,totalHours:0,loading:!1})}}catch(Te){console.error("Error fetching attendance for payroll:",Te),Xt(Qe=>({...Qe,loading:!1})),ie({title:"Error",description:"Failed to fetch attendance data",variant:"destructive"})}}},Le=()=>t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Employee Management"}),t.jsxs("button",{onClick:()=>B("addEmployee"),className:"bg-blue-100 text-gray-900 px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-blue-200",children:[t.jsx(ri,{className:"h-4 w-4"}),"Add Employee"]})]}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[t.jsx("div",{className:"p-4 border-b border-gray-200",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h3",{className:"text-black font-semibold",children:"Employees"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",placeholder:"Search employees...",value:he,onChange:S=>F(S.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),t.jsxs("select",{className:"px-3 py-2 border border-gray-300 rounded-lg text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[t.jsx("option",{value:"",children:"All Departments"}),t.jsx("option",{value:"IT",children:"IT"}),t.jsx("option",{value:"HR",children:"HR"}),t.jsx("option",{value:"Sales",children:"Sales"}),t.jsx("option",{value:"Marketing",children:"Marketing"}),t.jsx("option",{value:"Finance",children:"Finance"})]})]})]})}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee ID"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Designation"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Salary Type"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(()=>{const S=n.filter(re=>(re.fullName||`${re.firstName??""} ${re.lastName??""}`.trim()).toLowerCase().includes(he.toLowerCase())||(re.email||"").toLowerCase().includes(he.toLowerCase()));return S.length>0?S.map(re=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:re.employeeId}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:re.fullName||`${re.firstName??""} ${re.lastName??""}`.trim()}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:re.email}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:re.department}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:re.designation}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 capitalize",children:re.salaryType||"monthly"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${re.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:re.status})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("button",{onClick:()=>{xe(re),B("viewEmployee",re)},className:"text-blue-600 hover:text-blue-900",title:"View Employee",children:t.jsx(ni,{className:"h-4 w-4"})}),t.jsx("button",{onClick:()=>{xe(re),B("editEmployee",re)},className:"text-yellow-600 hover:text-yellow-900",children:t.jsx(zi,{className:"h-4 w-4"})}),t.jsx("button",{onClick:async()=>{if(window.confirm("Are you sure you want to delete this employee?"))try{if(!(await fetch(`${Fe}/hr/employees/${re.id}`,{method:"DELETE"})).ok)throw new Error("Failed to delete employee");ie({title:"Success",description:"Employee deleted successfully"}),ws()}catch(Ne){ie({title:"Error",description:Ne.message,variant:"destructive"})}},className:"text-red-600 hover:text-red-900",children:t.jsx(jf,{className:"h-4 w-4"})})]})})]},re.id)):t.jsx("tr",{children:t.jsx("td",{colSpan:"8",className:"px-6 py-4 text-center text-gray-500",children:he?"No employees matching the search":"No employees available"})})})()})]})})]})]}),Ce=({employees:S=[]})=>{const re=T.useMemo(()=>{const Ne={};return S.forEach(Te=>{Te.department&&(Ne[Te.department]=(Ne[Te.department]||0)+1)}),Ne},[S]);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"HR Dashboard"}),t.jsxs("button",{className:"bg-blue-100 text-gray-900 px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-blue-200",children:[t.jsx(Cr,{className:"h-4 w-4"}),"Refresh"]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[t.jsx("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(Nr,{className:"h-8 w-8 text-blue-600"}),t.jsxs("div",{className:"ml-4",children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Employees"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900",children:S.length})]})]})}),t.jsx("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(tn,{className:"h-8 w-8 text-green-600"}),t.jsxs("div",{className:"ml-4",children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Present Today"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"0"})]})]})}),t.jsx("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(An,{className:"h-8 w-8 text-yellow-600"}),t.jsxs("div",{className:"ml-4",children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Monthly Payroll"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"0"})]})]})}),t.jsx("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx(pu,{className:"h-8 w-8 text-purple-600"}),t.jsxs("div",{className:"ml-4",children:[t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"New Hires"}),t.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"0"})]})]})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[t.jsx("h3",{className:"text-black font-semibold mb-4",children:"Department Distribution"}),t.jsx("div",{className:"space-y-3",children:Object.entries(re).map(([Ne,Te])=>t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:Ne}),t.jsx("span",{className:"text-gray-600 font-medium",children:Te})]},Ne))})]}),t.jsx("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:t.jsx("h3",{className:"text-black font-semibold mb-4",children:"Recent Activities"})})]})]})},_e=()=>{const S=new Date().toISOString().split("T")[0],re=h.filter(ut=>ut.date===S),Ne=re.filter(ut=>ut.status==="present").length;re.filter(ut=>ut.status==="absent").length,re.filter(ut=>ut.status==="late").length,re.filter(ut=>ut.status==="half_day").length;const Te=f.filter(ut=>ut.status==="pending").length,Qe=f.filter(ut=>ut.status==="approved").length,St=f.filter(ut=>ut.status==="rejected").length,Yt=f.filter(ut=>{if(!_.trim())return!0;const Ir=_.toLowerCase().trim().split(/\s+/),nr=(ut.employeeName||"").toLowerCase();return Ir.every(dl=>nr.includes(dl))}),cr=g.filter(ut=>{if(!ae.trim())return!0;const Ir=n.find(ji=>ji.id===ut.employeeId),nr=Ir?Ir.name||`${Ir.firstName} ${Ir.lastName}`:"",dl=ae.toLowerCase().trim().split(/\s+/),Dn=nr.toLowerCase();return dl.every(ji=>Dn.includes(ji))}),Yr=()=>{window.confirm("Are you sure you want to reset all leave requests from view?")&&p([])},ur=()=>{window.confirm("Are you sure you want to reset all leave balances to 0?")&&N(ut=>ut.map(Ir=>({...Ir,casualLeave:{...Ir.casualLeave,used:0},sickLeave:{...Ir.sickLeave,used:0},earnedLeave:{...Ir.earnedLeave,used:0}})))};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Attendance & Leave Management"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:L,className:"bg-green-100 text-gray-900 px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-green-200",children:[t.jsx(Ka,{className:"h-4 w-4"}),"Mark Attendance"]}),t.jsxs("button",{onClick:()=>B("leaveRequest"),className:"bg-blue-100 text-gray-900 px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-blue-200",children:[t.jsx(ri,{className:"h-4 w-4"}),"New Leave Request"]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[t.jsx("h3",{className:"text-black font-semibold mb-4",children:"Today's Attendance"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Present:"}),t.jsx("span",{className:"font-medium text-green-600",children:Ne})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Absent:"}),t.jsx("span",{className:"font-medium text-red-600",children:n.length-Ne})]})]})]}),t.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[t.jsx("h3",{className:"text-black font-semibold mb-4",children:"Leave Requests"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Pending:"}),t.jsx("span",{className:"font-medium text-yellow-600",children:Te})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Approved:"}),t.jsx("span",{className:"font-medium text-green-600",children:Qe})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Rejected:"}),t.jsx("span",{className:"font-medium text-red-600",children:St})]})]})]}),t.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[t.jsx("h3",{className:"text-black font-semibold mb-4",children:"Total Records"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Attendance:"}),t.jsx("span",{className:"font-medium text-green-600",children:h.length})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Employees:"}),t.jsx("span",{className:"font-medium text-green-600",children:n.length})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Active:"}),t.jsx("span",{className:"font-medium text-green-600",children:n.filter(ut=>ut.status==="active").length})]})]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[t.jsxs("div",{className:"p-4 border-b border-gray-200 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[t.jsx("h3",{className:"text-black font-semibold",children:"Recent Leave Requests"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"text",placeholder:"Search by name...",value:_,onChange:ut=>ne(ut.target.value),className:"border border-gray-300 rounded px-3 py-1 text-sm text-gray-900 focus:outline-none focus:ring-1 focus:ring-blue-500"}),t.jsx("button",{onClick:Yr,className:"text-sm text-red-600 hover:text-red-800 border border-red-600 hover:border-red-800 px-3 py-1 rounded transition",children:"Reset"})]})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Request Date"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Leave Type"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date Range"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Duration"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reason"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.length>0?Yt.map(ut=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:ut.employeeName||"Unknown"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ut.createdAt?new Date(ut.createdAt).toLocaleDateString():"-"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ut.leaveType}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ut.startDate&&ut.endDate?`${new Date(ut.startDate).toLocaleDateString()} - ${new Date(ut.endDate).toLocaleDateString()}`:"-"}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[Math.ceil((new Date(ut.endDate)-new Date(ut.startDate))/(1e3*60*60*24))+1," days"]}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ut.reason}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${ut.status==="approved"?"bg-green-100 text-green-800":ut.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:ut.status||"Pending"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:ut.status==="pending"?t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("button",{onClick:()=>vt(ut.id,!0),className:"text-green-600 hover:text-green-900",title:"Approve Leave",children:t.jsx(dr,{className:"h-4 w-4"})}),t.jsx("button",{onClick:()=>vt(ut.id,!1),className:"text-red-600 hover:text-red-900",title:"Reject Leave",children:t.jsx(en,{className:"h-4 w-4"})})]}):null})]},ut.id)):t.jsx("tr",{children:t.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center text-gray-500",children:"No leave requests available"})})})]})})]}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[t.jsxs("div",{className:"p-4 border-b border-gray-200 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[t.jsx("h3",{className:"text-black font-semibold",children:"Employee Leave Balances"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"text",placeholder:"Search by name...",value:ae,onChange:ut=>G(ut.target.value),className:"border border-gray-300 rounded px-3 py-1 text-sm text-gray-900 focus:outline-none focus:ring-1 focus:ring-blue-500"}),t.jsx("button",{onClick:ur,className:"text-sm text-red-600 hover:text-red-800 border border-red-600 hover:border-red-800 px-3 py-1 rounded transition",children:"Reset"})]})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Casual Leave"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sick Leave"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Earned Leave"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Used"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:g.length>0?cr.map(ut=>{const Ir=n.find(nr=>nr.id===ut.employeeId);return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:Ir?Ir.name||`${Ir.firstName} ${Ir.lastName}`:"Unknown"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ut.casualLeave?.used||0}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ut.sickLeave?.used||0}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ut.earnedLeave?.used||0}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(ut.casualLeave?.used||0)+(ut.sickLeave?.used||0)+(ut.earnedLeave?.used||0)})]},ut.employeeId)}):t.jsx("tr",{children:t.jsx("td",{colSpan:"5",className:"px-6 py-4 text-center text-gray-500",children:"No leave balance data available"})})})]})})]})]})},De=()=>{const S=y.reduce((Qe,St)=>Qe+(St.monthlySalary||0),0),re=y.reduce((Qe,St)=>Qe+(St.deductions||0),0),Ne=y.reduce((Qe,St)=>Qe+(St.netSalary||0),0),Te=y.filter(Qe=>Qe.status==="processed"||Qe.status==="paid").length;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Payroll Management"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:U,className:"bg-green-100 text-gray-900 px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-green-200",children:[t.jsx(ri,{className:"h-4 w-4"}),"Generate Payroll"]}),t.jsxs("button",{onClick:ls,className:"bg-blue-100 text-gray-900 px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-blue-200",children:[t.jsx(Vi,{className:"h-4 w-4"}),"Export Report"]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[t.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"Total Monthly Salary"}),t.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["",S.toLocaleString()]})]}),t.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"Deductions"}),t.jsxs("p",{className:"text-2xl font-bold text-red-600",children:["",re.toLocaleString()]})]}),t.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"Net Salary"}),t.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["",Ne.toLocaleString()]})]}),t.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:"Processed"}),t.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[Te,"/",n.length]})]})]}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[t.jsx("div",{className:"p-4 border-b border-gray-200",children:t.jsx("h3",{className:"text-black font-semibold mb-4",children:"Employee Salary Details"})}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pay Period"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Salary Type"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Monthly Salary"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Allowances"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deductions"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gross Salary"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Net Salary"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.length>0?y.map(Qe=>{const St=n.find(cr=>cr.id===Qe.employeeId),Yt=Qe.salaryType==="hourly"?Qe.monthlySalaryDisplay||`${(Qe.monthlySalary||0).toFixed(0)}/hr`:`${(Qe.monthlySalary||0).toLocaleString()}`;return t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:Qe.employeeName||(St?St.name:"Unknown")}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Qe.payPeriodStart&&Qe.payPeriodEnd?`${new Date(Qe.payPeriodStart).toLocaleDateString()} - ${new Date(Qe.payPeriodEnd).toLocaleDateString()}`:"N/A"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800 capitalize",children:Qe.salaryType||"monthly"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Yt}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["",(Qe.allowances||0).toLocaleString()]}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["",(Qe.deductions||0).toLocaleString()]}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["",(Qe.grossSalary||0).toLocaleString()]}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-green-600",children:["",(Qe.netSalary||0).toLocaleString()]}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${Qe.status==="processed"||Qe.status==="paid"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:Qe.status||"pending"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("button",{onClick:()=>Oe(Qe),className:"text-blue-600 hover:text-blue-900",title:"View Details",children:t.jsx(ni,{className:"h-4 w-4"})}),Qe.status==="pending"&&t.jsx("button",{onClick:()=>wt(Qe.id),className:"text-green-600 hover:text-green-900",title:"Mark as Processed",children:t.jsx(dr,{className:"h-4 w-4"})}),t.jsx("button",{onClick:()=>Et(Qe.id),className:"text-purple-600 hover:text-purple-900",title:"Download Payslip",children:t.jsx(Vi,{className:"h-4 w-4"})}),Qe.status==="pending"&&t.jsx("button",{onClick:()=>Vt(Qe),className:"text-yellow-600 hover:text-yellow-900",title:"Edit Payroll",children:t.jsx(zi,{className:"h-4 w-4"})}),t.jsx("button",{onClick:()=>$t(Qe.id),className:"text-red-600 hover:text-red-900",title:"Delete Payroll",children:t.jsx(Ef,{className:"h-4 w-4"})})]})})]},Qe.id)}):t.jsx("tr",{children:t.jsx("td",{colSpan:"10",className:"px-6 py-4 text-center text-gray-500",children:"No payroll data available"})})})]})})]})]})},Ke=()=>{const S=b.length,re=A.length,Ne=R.length;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Recruitment Management"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:()=>{X("addApplication"),Ot({jobPostingId:"",candidateName:"",email:"",phone:"",experience:"",currentCompany:"",currentPosition:"",expectedSalary:"",noticePeriod:"",resumeUrl:"",coverLetter:"",skills:""}),ue(!0)},className:"bg-green-100 text-gray-900 px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-green-200",children:[t.jsx(pu,{className:"h-4 w-4"}),"Add Application"]}),t.jsxs("button",{onClick:()=>B("jobPosting"),className:"bg-blue-100 text-gray-900 px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-blue-200",children:[t.jsx(ri,{className:"h-4 w-4"}),"New Job Posting"]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[t.jsx("h3",{className:"text-black font-semibold mb-4",children:"Job Openings"}),t.jsx("p",{className:"text-3xl font-bold text-blue-600",children:S}),t.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Active positions"})]}),t.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[t.jsx("h3",{className:"text-black font-semibold mb-4",children:"Applications"}),t.jsx("p",{className:"text-3xl font-bold text-green-600",children:re}),t.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Total received"})]}),t.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[t.jsx("h3",{className:"text-black font-semibold mb-4",children:"Interviews"}),t.jsx("p",{className:"text-3xl font-bold text-yellow-600",children:Ne}),t.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Scheduled"})]})]}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[t.jsx("div",{className:"p-4 border-b border-gray-200",children:t.jsx("h3",{className:"text-black font-semibold",children:"Active Job Postings"})}),t.jsx("div",{className:"p-6 space-y-4",children:b.length>0?b.map(Te=>t.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:Te.title}),t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${Te.status==="open"?"bg-green-100 text-green-800":Te.status==="closed"?"bg-red-100 text-red-800":Te.status==="filled"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:Te.status?.toUpperCase()})]}),t.jsxs("p",{className:"text-gray-600",children:["Department: ",Te.department]}),t.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Posted: ",Te.createdAt?new Date(Te.createdAt).toLocaleDateString():"N/A","  Applications: ",Te.applications||0]})]}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("button",{onClick:()=>{xe(Te),B("viewJobPosting",Te)},className:"text-blue-600 hover:text-blue-900",title:"View Job Posting",children:t.jsx(ni,{className:"h-4 w-4"})}),t.jsx("button",{onClick:()=>{xe(Te),B("editJobPosting",Te)},className:"text-yellow-600 hover:text-yellow-900",title:"Edit Job Posting",children:t.jsx(zi,{className:"h-4 w-4"})})]})]})},Te.id)):t.jsx("p",{className:"text-gray-500 text-center",children:"No active job postings"})})]}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[t.jsx("div",{className:"p-4 border-b border-gray-200",children:t.jsx("h3",{className:"text-black font-semibold",children:"Applications Management"})}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Applicant Name"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Job Title"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Applied Date"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:A.length>0?A.map(Te=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:Te.candidateName||Te.applicantName}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Te.jobTitle}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(Te.appliedDate||Te.createdAt).toLocaleDateString()}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${Te.status==="pending"?"bg-yellow-100 text-yellow-800":Te.status==="screening_passed"?"bg-blue-100 text-blue-800":Te.status==="screening_failed"?"bg-red-100 text-red-800":Te.status==="interview_scheduled"?"bg-purple-100 text-purple-800":Te.status==="selected"?"bg-green-100 text-green-800":Te.status==="hired"?"bg-green-200 text-green-900":Te.status==="rejected"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:Te.status?.replace(/_/g," ")})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>{Ft(Te),X("viewApplication"),ue(!0)},className:"text-blue-600 hover:text-blue-900",title:"View Details",children:t.jsx(ni,{className:"h-4 w-4"})}),Te.status==="pending"&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>{Ft(Te),X("screenApplication"),ue(!0)},className:"text-green-600 hover:text-green-900",title:"Screen Application",children:t.jsx(dr,{className:"h-4 w-4"})}),t.jsx("button",{onClick:()=>ce(Te.id,"screening_failed","Did not meet requirements"),className:"text-red-600 hover:text-red-900",title:"Reject Application",children:t.jsx(en,{className:"h-4 w-4"})})]}),Te.status==="screening_passed"&&t.jsx("button",{onClick:()=>{Ft(Te),Jt({applicationId:Te.id,candidateName:Te.candidateName||Te.applicantName,jobTitle:Te.jobTitle,scheduledDate:"",scheduledTime:"",interviewType:"",interviewers:"",interviewerId:"",location:"",notes:""}),X("scheduleInterview"),ue(!0)},className:"text-purple-600 hover:text-purple-900",title:"Schedule Interview",children:t.jsx(tn,{className:"h-4 w-4"})}),Te.status==="selected"&&t.jsx("button",{onClick:()=>{Ft(Te),X("setJoining"),ue(!0)},className:"text-green-600 hover:text-green-900",title:"Set Joining Details",children:t.jsx(Ga,{className:"h-4 w-4"})})]})})]},Te.id)):t.jsx("tr",{children:t.jsx("td",{colSpan:"5",className:"px-6 py-4 text-center text-gray-500",children:"No applications available"})})})]})})]}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[t.jsxs("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:[t.jsx("h3",{className:"text-black font-semibold",children:"Interview Management"}),t.jsxs(pe,{onClick:()=>{Jt({applicationId:"",candidateName:"",jobTitle:"",scheduledDate:"",scheduledTime:"",interviewType:"",interviewers:"",interviewerId:r?.id||"",location:"",notes:"",decision:"",rating:"",feedback:""}),X("scheduleInterview"),ue(!0)},className:"bg-purple-600 hover:bg-purple-700",children:[t.jsx(tn,{className:"h-4 w-4 mr-2"}),"Schedule Interview"]})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Candidate"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Job Title"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Interview Date"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Decision"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:R.length>0?R.map(Te=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:Te.applicantName||Te.candidateName}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Te.jobTitle}),t.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[new Date(Te.scheduledDate).toLocaleDateString(),Te.scheduledTime&&` ${Te.scheduledTime}`]}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 capitalize",children:Te.interviewType||"N/A"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${Te.status==="scheduled"?"bg-blue-100 text-blue-800":Te.status==="completed"?"bg-green-100 text-green-800":Te.status==="cancelled"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:Te.status})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Te.decision?t.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full capitalize ${Te.decision==="selected"?"bg-green-100 text-green-800":Te.decision==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:Te.decision.replace(/_/g," ")}):t.jsx("span",{className:"text-gray-400 text-xs",children:"Pending"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>{er(Te),X("viewInterview"),ue(!0)},className:"text-blue-600 hover:text-blue-900",title:"View Details",children:t.jsx(ni,{className:"h-4 w-4"})}),(Te.status==="scheduled"||Te.decision==="on_hold")&&Te.decision!=="selected"&&Te.decision!=="rejected"&&t.jsx("button",{onClick:()=>{er(Te),Jt({...lt,decision:"",rating:"",feedback:"",interviewerId:r?.id||""}),X("updateInterviewResult"),ue(!0)},className:"text-green-600 hover:text-green-900",title:"Complete Interview",children:t.jsx(dr,{className:"h-4 w-4"})})]})})]},Te.id)):t.jsx("tr",{children:t.jsx("td",{colSpan:"7",className:"px-6 py-4 text-center text-gray-500",children:"No interviews scheduled"})})})]})})]})]})},it=()=>{switch(s){case"dashboard":return t.jsx(Ce,{employees:n});case"employees":return t.jsx(Le,{});case"attendance":return t.jsx(_e,{});case"payroll":return t.jsx(De,{});case"recruitment":return t.jsx(Ke,{});default:return t.jsx(Ce,{employees:n})}};return t.jsxs("div",{className:"min-h-screen bg-gray-100",children:[t.jsx("div",{className:"max-w-7xl mx-auto bg-white shadow-md border-b-4 border-blue-800 rounded-b-lg",children:t.jsx("div",{className:"px-4 sm:px-6 py-4 sm:py-6",children:t.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:justify-between sm:items-center sm:space-y-0",children:[t.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4",children:[t.jsxs(pe,{onClick:()=>e(r.department==="admin"?"/dashboard/admin":"/dashboard"),variant:"outline",className:"border border-gray-300 bg-white text-gray-800 text-sm placeholder-gray-500 w-full sm:w-auto",children:[t.jsx(qs,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-600 to-blue-800 rounded-lg flex items-center justify-center shadow-lg",children:t.jsx(wf,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Human Resource Management System"}),t.jsx("p",{className:"text-gray-600 text-sm sm:text-base font-medium",children:"Complete employee lifecycle management"})]})]})]}),t.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 px-4 py-4 sm:px-6 rounded-lg shadow-sm w-full sm:w-auto",children:t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(Nr,{className:"w-5 h-5 text-blue-600"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 text-xs font-medium",children:"HR Team"}),t.jsx("p",{className:"text-blue-600 text-xs font-medium",children:"Employees Management"})]})]})})]})})}),t.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8"}),t.jsxs(an,{value:s,onValueChange:a,className:"overflow-x-auto",children:[t.jsxs(ma,{className:"flex md:grid md:grid-cols-5 w-full overflow-x-auto overflow-y-hidden md:overflow-x-hidden whitespace-nowrap bg-gray-100 border border-gray-300 pl-0",children:[t.jsx(xt,{value:"dashboard",className:"text-gray-800",children:"Dashboard"}),t.jsx(xt,{value:"employees",className:"text-gray-800",children:"Employees"}),t.jsx(xt,{value:"attendance",className:"text-gray-800",children:"Attendance & Leave"}),t.jsx(xt,{value:"payroll",className:"text-gray-800",children:"Payroll"}),t.jsx(xt,{value:"recruitment",className:"text-gray-800",children:"Recruitment"})]}),t.jsx("div",{className:"p-6",children:it()})]}),H&&t.jsx(mr,{open:H,onOpenChange:me,children:t.jsxs(fr,{className:"max-w-2xl max-h-[90vh] flex flex-col bg-white border-gray-200 text-gray-900",children:[t.jsx(xr,{className:"flex-shrink-0",children:t.jsxs(pr,{className:"text-gray-900",children:[I==="addEmployee"&&"Add New Employee",I==="editEmployee"&&"Edit Employee",I==="viewEmployee"&&"Employee Details",I==="markAttendance"&&"Mark Attendance",I==="leaveRequest"&&"Request Leave",I==="viewJobPosting"&&"Job Posting Details",I==="editJobPosting"&&"Edit Job Posting",I==="generatePayroll"&&"Generate Payroll",I==="viewPayroll"&&"Payroll Details",I==="addApplication"&&"Submit Job Application",I==="viewApplication"&&"Application Details",I==="screenApplication"&&"Screen Application",I==="scheduleInterview"&&(et?`Schedule Interview  ${et.candidateName||et.applicantName}`:"Schedule Interview"),I==="viewInterview"&&"Interview Details",I==="updateInterviewResult"&&(kt?`Update Interview Result  ${kt.candidateName}`:"Update Interview Result"),I==="setJoining"&&"Set Joining Details"]})}),t.jsxs("div",{className:"overflow-y-auto flex-1 px-4 py-2",children:[I==="viewEmployee"&&oe&&t.jsx("div",{className:"space-y-6",children:t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Q,{children:"Employee ID"}),t.jsx("p",{className:"text-sm text-gray-600",children:ee.employeeId||""})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Status"}),t.jsx("p",{className:"text-sm text-gray-600 capitalize",children:ee.status||"active"})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Name"}),t.jsx("p",{className:"text-sm text-gray-600",children:`${ee.firstName??""} ${ee.lastName??""}`.trim()||""})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Email"}),t.jsx("p",{className:"text-sm text-gray-600",children:ee.email||""})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Phone"}),t.jsx("p",{className:"text-sm text-gray-600",children:ee.phone||"N/A"})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Department"}),t.jsx("p",{className:"text-sm text-gray-600",children:ee.department||""})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Designation"}),t.jsx("p",{className:"text-sm text-gray-600",children:ee.designation||""})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Joining Date"}),t.jsx("p",{className:"text-sm text-gray-600",children:ee.joiningDate||""})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Salary"}),t.jsx("p",{className:"text-sm text-gray-600",children:ee.salary!==void 0&&ee.salary!==""?`${Number(ee.salary).toLocaleString()}`:""})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Salary Type"}),t.jsx("p",{className:"text-sm text-gray-600 capitalize",children:ee.salaryType||"monthly"})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx(Q,{children:"Address"}),t.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-line",children:ee.address||""})]})]})}),(I==="addEmployee"||I==="editEmployee")&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"firstName",children:"First Name"}),t.jsx(Re,{id:"firstName",value:ee.firstName||"",className:"bg-white text-gray-900 border-gray-300",onChange:S=>M({...ee,firstName:S.target.value})})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"lastName",children:"Last Name"}),t.jsx(Re,{id:"lastName",value:ee.lastName||"",className:"bg-white text-gray-900 border-gray-300",onChange:S=>M({...ee,lastName:S.target.value})})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"email",children:"Email"}),t.jsx(Re,{id:"email",type:"email",value:ee.email||"",className:"bg-white text-gray-900 border-gray-300",onChange:S=>M({...ee,email:S.target.value})})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"phone",children:"Phone"}),t.jsx(Re,{id:"phone",value:ee.phone||"",className:"bg-white text-gray-900 border-gray-300",onChange:S=>M({...ee,phone:S.target.value})})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"department",children:"Department"}),t.jsxs(br,{value:ee.department||"",onValueChange:S=>M({...ee,department:S}),children:[t.jsx(jr,{className:"bg-white text-gray-900 border-gray-300",children:t.jsx(Er,{placeholder:"Select department"})}),t.jsxs(Tr,{children:[t.jsx(st,{value:"IT",children:"IT"}),t.jsx(st,{value:"HR",children:"HR"}),t.jsx(st,{value:"Sales",children:"Sales"}),t.jsx(st,{value:"Marketing",children:"Marketing"}),t.jsx(st,{value:"Finance",children:"Finance"})]})]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"designation",children:"Designation"}),t.jsx(Re,{id:"designation",value:ee.designation||"",className:"bg-white text-gray-900 border-gray-300",onChange:S=>M({...ee,designation:S.target.value})})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"joiningDate",children:"Joining Date"}),t.jsx(Re,{id:"joiningDate",type:"date",value:ee.joiningDate||"",className:"bg-white text-gray-900 border-gray-300",onChange:S=>M({...ee,joiningDate:S.target.value})})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"salaryType",children:"Salary Type"}),t.jsxs(br,{value:ee.salaryType||"monthly",onValueChange:S=>M({...ee,salaryType:S}),children:[t.jsx(jr,{className:"bg-white text-gray-900 border-gray-300",children:t.jsx(Er,{placeholder:"Select salary type"})}),t.jsxs(Tr,{children:[t.jsx(st,{value:"monthly",children:"Monthly"}),t.jsx(st,{value:"daily",children:"Daily"}),t.jsx(st,{value:"hourly",children:"Hourly"})]})]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"salary",children:"Salary"}),t.jsx(Re,{id:"salary",type:"number",value:ee.salary||"",className:"bg-white text-gray-900 border-gray-300",onChange:S=>M({...ee,salary:S.target.value})})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"status",children:"Status"}),t.jsxs(br,{value:ee.status||"active",onValueChange:S=>M({...ee,status:S}),children:[t.jsx(jr,{className:"bg-white text-gray-900 border-gray-300",children:t.jsx(Er,{placeholder:"Select status"})}),t.jsxs(Tr,{children:[t.jsx(st,{value:"active",children:"Active"}),t.jsx(st,{value:"inactive",children:"Inactive"})]})]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"dateOfBirth",children:"Date of Birth"}),t.jsx(Re,{id:"dateOfBirth",type:"date",value:ee.dateOfBirth||"",className:"bg-white text-gray-900 border-gray-300",onChange:S=>M({...ee,dateOfBirth:S.target.value})})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"gender",children:"Gender"}),t.jsxs(br,{value:ee.gender||"",onValueChange:S=>M({...ee,gender:S}),children:[t.jsx(jr,{className:"bg-white text-gray-900 border-gray-300",children:t.jsx(Er,{placeholder:"Select gender"})}),t.jsxs(Tr,{children:[t.jsx(st,{value:"male",children:"Male"}),t.jsx(st,{value:"female",children:"Female"}),t.jsx(st,{value:"non_binary",children:"Non-binary"}),t.jsx(st,{value:"prefer_not_to_say",children:"Prefer not to say"})]})]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"managerId",children:"Manager"}),t.jsxs(br,{value:ee.managerId||"",onValueChange:S=>M({...ee,managerId:S===""?null:S}),children:[t.jsx(jr,{className:"bg-white text-gray-900 border-gray-300",children:t.jsx(Er,{placeholder:"Select manager"})}),t.jsxs(Tr,{children:[t.jsx(st,{value:"",children:"No Manager"}),n.filter(S=>S.id!==oe?.id).map(S=>t.jsx(st,{value:S.id.toString(),children:S.fullName||S.name||`${S.firstName??""} ${S.lastName??""}`.trim()},S.id))]})]})]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"address",children:"Address"}),t.jsx(vr,{id:"address",value:ee.address||"",className:"bg-white text-gray-900 border-gray-300",onChange:S=>M({...ee,address:S.target.value})})]})]}),I==="leaveRequest"&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"leaveEmployee",children:"Select Employee *"}),t.jsxs(br,{value:Y.employeeId,onValueChange:S=>Dt({...Y,employeeId:S}),children:[t.jsx(jr,{className:"bg-white text-gray-900 border-gray-300",children:t.jsx(Er,{placeholder:"Choose an employee"})}),t.jsx(Tr,{children:n.filter(S=>S.status==="active").map(S=>t.jsxs(st,{value:S.id.toString(),children:[S.name||`${S.firstName} ${S.lastName}`," - ",S.department]},S.id))})]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"leaveType",children:"Leave Type *"}),t.jsxs(br,{value:Y.leaveType,onValueChange:S=>Dt({...Y,leaveType:S}),children:[t.jsx(jr,{className:"bg-white text-gray-900 border-gray-300",children:t.jsx(Er,{placeholder:"Select leave type"})}),t.jsxs(Tr,{children:[t.jsx(st,{value:"CASUAL",children:"Casual Leave"}),t.jsx(st,{value:"SICK",children:"Sick Leave"}),t.jsx(st,{value:"EARNED",children:"Earned Leave"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"startDate",children:"Start Date *"}),t.jsx(Re,{id:"startDate",type:"date",value:Y.startDate,className:"bg-white text-gray-900 border-gray-300",onChange:S=>Dt({...Y,startDate:S.target.value})})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"endDate",children:"End Date *"}),t.jsx(Re,{id:"endDate",type:"date",value:Y.endDate,className:"bg-white text-gray-900 border-gray-300",onChange:S=>Dt({...Y,endDate:S.target.value})})]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"reason",children:"Reason *"}),t.jsx(vr,{id:"reason",placeholder:"Enter the reason for leave...",value:Y.reason,className:"bg-white text-gray-900 border-gray-300",onChange:S=>Dt({...Y,reason:S.target.value}),rows:3})]}),t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:t.jsxs("p",{className:"text-xs text-blue-700",children:[t.jsx("strong",{children:"Note:"})," Leave requests will be reviewed and approved by HR. Please ensure the dates are accurate and provide a valid reason."]})})]}),I==="markAttendance"&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"attendanceEmployee",children:"Select Employee *"}),t.jsxs(br,{value:je.employeeId,onValueChange:S=>We({...je,employeeId:S}),children:[t.jsx(jr,{className:"bg-white text-gray-900 border-gray-300",children:t.jsx(Er,{placeholder:"Choose an employee"})}),t.jsx(Tr,{children:n.filter(S=>S.status==="active").map(S=>t.jsxs(st,{value:S.id.toString(),children:[S.name||`${S.firstName} ${S.lastName}`," - ",S.department]},S.id))})]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"attendanceDate",children:"Date *"}),t.jsx(Re,{id:"attendanceDate",type:"date",value:je.date,className:"bg-white text-gray-900 border-gray-300",onChange:S=>We({...je,date:S.target.value})})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"attendanceStatus",children:"Status *"}),t.jsxs(br,{value:je.status,onValueChange:S=>We({...je,status:S}),children:[t.jsx(jr,{className:"bg-white text-gray-900 border-gray-300",children:t.jsx(Er,{placeholder:"Select status"})}),t.jsxs(Tr,{children:[t.jsx(st,{value:"present",children:"Present"}),t.jsx(st,{value:"absent",children:"Absent"}),t.jsx(st,{value:"late",children:"Late"}),t.jsx(st,{value:"half_day",children:"Half Day"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"checkInTime",children:"Check In Time"}),t.jsx(Re,{id:"checkInTime",type:"time",value:je.checkInTime,className:"bg-white text-gray-900 border-gray-300",onChange:S=>We({...je,checkInTime:S.target.value})})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"checkOutTime",children:"Check Out Time"}),t.jsx(Re,{id:"checkOutTime",type:"time",value:je.checkOutTime,className:"bg-white text-gray-900 border-gray-300",onChange:S=>We({...je,checkOutTime:S.target.value})})]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"attendanceNotes",children:"Notes (Optional)"}),t.jsx(vr,{id:"attendanceNotes",placeholder:"Add any notes about this attendance record...",value:je.notes,className:"bg-white text-gray-900 border-gray-300",onChange:S=>We({...je,notes:S.target.value}),rows:3})]}),t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:t.jsxs("p",{className:"text-xs text-blue-700",children:[t.jsx("strong",{children:"Note:"})," Attendance records are used for payroll calculation. Present/Late = 1 day, Half Day = 0.5 days, Absent = 0 days."]})})]}),I==="jobPosting"&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"jobTitle",children:"Job Title *"}),t.jsx(Re,{id:"jobTitle",value:ze.title,className:"bg-white text-gray-900 border-gray-300",onChange:S=>ht({...ze,title:S.target.value}),placeholder:"e.g., Senior Software Engineer"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"jobDepartment",children:"Department *"}),t.jsxs(br,{value:ze.department,onValueChange:S=>ht({...ze,department:S}),children:[t.jsx(jr,{className:"bg-white text-gray-900 border-gray-300",children:t.jsx(Er,{placeholder:"Select department"})}),t.jsxs(Tr,{children:[t.jsx(st,{value:"IT",children:"IT"}),t.jsx(st,{value:"HR",children:"HR"}),t.jsx(st,{value:"Sales",children:"Sales"}),t.jsx(st,{value:"Marketing",children:"Marketing"}),t.jsx(st,{value:"Finance",children:"Finance"}),t.jsx(st,{value:"Operations",children:"Operations"})]})]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"jobLocation",children:"Location"}),t.jsx(Re,{id:"jobLocation",value:ze.location,className:"bg-white text-gray-900 border-gray-300",onChange:S=>ht({...ze,location:S.target.value}),placeholder:"e.g., Mumbai, India"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"employmentType",children:"Employment Type *"}),t.jsxs(br,{value:ze.employmentType,onValueChange:S=>ht({...ze,employmentType:S}),children:[t.jsx(jr,{className:"bg-white text-gray-900 border-gray-300",children:t.jsx(Er,{placeholder:"Select type"})}),t.jsxs(Tr,{children:[t.jsx(st,{value:"full-time",children:"Full-time"}),t.jsx(st,{value:"part-time",children:"Part-time"}),t.jsx(st,{value:"contract",children:"Contract"}),t.jsx(st,{value:"internship",children:"Internship"})]})]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"experienceLevel",children:"Experience Level"}),t.jsxs(br,{value:ze.experienceLevel,onValueChange:S=>ht({...ze,experienceLevel:S}),children:[t.jsx(jr,{className:"bg-white text-gray-900 border-gray-300",children:t.jsx(Er,{placeholder:"Select level"})}),t.jsxs(Tr,{children:[t.jsx(st,{value:"entry",children:"Entry Level"}),t.jsx(st,{value:"mid",children:"Mid Level"}),t.jsx(st,{value:"senior",children:"Senior Level"}),t.jsx(st,{value:"lead",children:"Lead/Manager"})]})]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"salaryRange",children:"Salary Range"}),t.jsx(Re,{id:"salaryRange",value:ze.salaryRange,className:"bg-white text-gray-900 border-gray-300",onChange:S=>ht({...ze,salaryRange:S.target.value}),placeholder:"e.g., 8-12 LPA"})]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"jobDescription",children:"Job Description *"}),t.jsx(vr,{id:"jobDescription",value:ze.description,className:"bg-white text-gray-900 border-gray-300",onChange:S=>ht({...ze,description:S.target.value}),placeholder:"Describe the role and responsibilities...",rows:4})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"requirements",children:"Requirements"}),t.jsx(vr,{id:"requirements",value:ze.requirements,className:"bg-white text-gray-900 border-gray-300",onChange:S=>ht({...ze,requirements:S.target.value}),placeholder:"List the required skills and qualifications...",rows:3})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"responsibilities",children:"Responsibilities"}),t.jsx(vr,{id:"responsibilities",value:ze.responsibilities,className:"bg-white text-gray-900 border-gray-300",onChange:S=>ht({...ze,responsibilities:S.target.value}),placeholder:"List the key responsibilities...",rows:3})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"applicationUrl",children:"Application URL (Optional)"}),t.jsx(Re,{id:"applicationUrl",value:ze.applicationUrl,className:"bg-white text-gray-900 border-gray-300",onChange:S=>ht({...ze,applicationUrl:S.target.value}),placeholder:"https://careers.company.com/apply"})]})]}),I==="viewJobPosting"&&oe&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Q,{children:"Job Title"}),t.jsx("p",{className:"text-gray-900 font-medium mt-1",children:oe.title})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Department"}),t.jsx("p",{className:"text-gray-900 font-medium mt-1",children:oe.department})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Location"}),t.jsx("p",{className:"text-gray-900 font-medium mt-1",children:oe.location||"Not specified"})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Employment Type"}),t.jsx("p",{className:"text-gray-900 font-medium mt-1 capitalize",children:oe.employmentType?.replace("-"," ")||"Not specified"})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Experience Level"}),t.jsx("p",{className:"text-gray-900 font-medium mt-1 capitalize",children:oe.experienceLevel||"Not specified"})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Salary Range"}),t.jsx("p",{className:"text-gray-900 font-medium mt-1",children:oe.salaryRange||"Not specified"})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Status"}),t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full mt-1 ${oe.status==="open"?"bg-green-100 text-green-800":oe.status==="closed"?"bg-red-100 text-red-800":oe.status==="filled"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:oe.status?.toUpperCase()})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Posted Date"}),t.jsx("p",{className:"text-gray-900 font-medium mt-1",children:oe.createdAt?new Date(oe.createdAt).toLocaleDateString():"N/A"})]})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Job Description"}),t.jsx("p",{className:"text-gray-900 mt-1 whitespace-pre-wrap",children:oe.description})]}),oe.requirements&&t.jsxs("div",{children:[t.jsx(Q,{children:"Requirements"}),t.jsx("p",{className:"text-gray-900 mt-1 whitespace-pre-wrap",children:oe.requirements})]}),oe.responsibilities&&t.jsxs("div",{children:[t.jsx(Q,{children:"Responsibilities"}),t.jsx("p",{className:"text-gray-900 mt-1 whitespace-pre-wrap",children:oe.responsibilities})]}),oe.applicationDeadline&&t.jsxs("div",{children:[t.jsx(Q,{children:"Application Deadline"}),t.jsx("p",{className:"text-gray-900 font-medium mt-1",children:new Date(oe.applicationDeadline).toLocaleDateString()})]})]}),I==="editJobPosting"&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"jobTitle",children:"Job Title *"}),t.jsx(Re,{id:"jobTitle",value:ze.title,className:"bg-white text-gray-900 border-gray-300",onChange:S=>ht({...ze,title:S.target.value}),placeholder:"e.g., Senior Software Engineer"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"jobDepartment",children:"Department *"}),t.jsxs(br,{value:ze.department,onValueChange:S=>ht({...ze,department:S}),children:[t.jsx(jr,{className:"bg-white text-gray-900 border-gray-300",children:t.jsx(Er,{placeholder:"Select department"})}),t.jsxs(Tr,{children:[t.jsx(st,{value:"IT",children:"IT"}),t.jsx(st,{value:"HR",children:"HR"}),t.jsx(st,{value:"Sales",children:"Sales"}),t.jsx(st,{value:"Marketing",children:"Marketing"}),t.jsx(st,{value:"Finance",children:"Finance"}),t.jsx(st,{value:"Operations",children:"Operations"})]})]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"jobLocation",children:"Location"}),t.jsx(Re,{id:"jobLocation",value:ze.location,className:"bg-white text-gray-900 border-gray-300",onChange:S=>ht({...ze,location:S.target.value}),placeholder:"e.g., Mumbai, India"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"employmentType",children:"Employment Type *"}),t.jsxs(br,{value:ze.employmentType,onValueChange:S=>ht({...ze,employmentType:S}),children:[t.jsx(jr,{className:"bg-white text-gray-900 border-gray-300",children:t.jsx(Er,{placeholder:"Select type"})}),t.jsxs(Tr,{children:[t.jsx(st,{value:"full-time",children:"Full-time"}),t.jsx(st,{value:"part-time",children:"Part-time"}),t.jsx(st,{value:"contract",children:"Contract"}),t.jsx(st,{value:"internship",children:"Internship"})]})]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"experienceLevel",children:"Experience Level"}),t.jsxs(br,{value:ze.experienceLevel,onValueChange:S=>ht({...ze,experienceLevel:S}),children:[t.jsx(jr,{className:"bg-white text-gray-900 border-gray-300",children:t.jsx(Er,{placeholder:"Select level"})}),t.jsxs(Tr,{children:[t.jsx(st,{value:"entry",children:"Entry Level"}),t.jsx(st,{value:"mid",children:"Mid Level"}),t.jsx(st,{value:"senior",children:"Senior Level"}),t.jsx(st,{value:"lead",children:"Lead/Manager"})]})]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"salaryRange",children:"Salary Range"}),t.jsx(Re,{id:"salaryRange",value:ze.salaryRange,className:"bg-white text-gray-900 border-gray-300",onChange:S=>ht({...ze,salaryRange:S.target.value}),placeholder:"e.g., 8-12 LPA"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"jobStatus",children:"Status *"}),t.jsxs(br,{value:ze.status,onValueChange:S=>ht({...ze,status:S}),children:[t.jsx(jr,{className:"bg-white text-gray-900 border-gray-300",children:t.jsx(Er,{placeholder:"Select status"})}),t.jsxs(Tr,{children:[t.jsx(st,{value:"open",children:"Open"}),t.jsx(st,{value:"closed",children:"Closed"}),t.jsx(st,{value:"filled",children:"Filled"})]})]})]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"jobDescription",children:"Job Description *"}),t.jsx(vr,{id:"jobDescription",value:ze.description,className:"bg-white text-gray-900 border-gray-300",onChange:S=>ht({...ze,description:S.target.value}),placeholder:"Describe the role and responsibilities...",rows:4})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"requirements",children:"Requirements"}),t.jsx(vr,{id:"requirements",value:ze.requirements,className:"bg-white text-gray-900 border-gray-300",onChange:S=>ht({...ze,requirements:S.target.value}),placeholder:"List the required skills and qualifications...",rows:3})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"responsibilities",children:"Responsibilities"}),t.jsx(vr,{id:"responsibilities",value:ze.responsibilities,className:"bg-white text-gray-900 border-gray-300",onChange:S=>ht({...ze,responsibilities:S.target.value}),placeholder:"List the key responsibilities...",rows:3})]})]}),I==="addApplication"&&t.jsx("div",{className:"space-y-4",children:t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"jobPostingId",children:"Job Posting"}),t.jsxs(br,{value:nt.jobPostingId,onValueChange:S=>{const re=b.find(Ne=>Ne.id===parseInt(S));Ot({...nt,jobPostingId:S,jobTitle:re?.title||""})},children:[t.jsx(jr,{className:"bg-white text-gray-900 border-gray-300",children:t.jsx(Er,{placeholder:"Select job posting"})}),t.jsx(Tr,{children:b.filter(S=>S.status==="open").map(S=>t.jsxs(st,{value:S.id.toString(),children:[S.title," - ",S.department]},S.id))})]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"candidateName",children:"Candidate Name"}),t.jsx(Re,{id:"candidateName",value:nt.candidateName,className:"bg-white text-gray-900 border-gray-300",onChange:S=>Ot({...nt,candidateName:S.target.value}),placeholder:"Full name"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"email",children:"Email"}),t.jsx(Re,{id:"email",type:"email",value:nt.email,className:"bg-white text-gray-900 border-gray-300",onChange:S=>Ot({...nt,email:S.target.value}),placeholder:"candidate@email.com"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"phone",children:"Phone"}),t.jsx(Re,{id:"phone",value:nt.phone,className:"bg-white text-gray-900 border-gray-300",onChange:S=>Ot({...nt,phone:S.target.value}),placeholder:"+91 1234567890"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"experience",children:"Experience (Years)"}),t.jsx(Re,{id:"experience",type:"number",value:nt.experience,className:"bg-white text-gray-900 border-gray-300",onChange:S=>Ot({...nt,experience:S.target.value}),placeholder:"5"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"currentCompany",children:"Current Company"}),t.jsx(Re,{id:"currentCompany",value:nt.currentCompany,className:"bg-white text-gray-900 border-gray-300",onChange:S=>Ot({...nt,currentCompany:S.target.value}),placeholder:"Company name"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"currentPosition",children:"Current Position"}),t.jsx(Re,{id:"currentPosition",value:nt.currentPosition,className:"bg-white text-gray-900 border-gray-300",onChange:S=>Ot({...nt,currentPosition:S.target.value}),placeholder:"Current role"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"expectedSalary",children:"Expected Salary"}),t.jsx(Re,{id:"expectedSalary",type:"number",value:nt.expectedSalary,className:"bg-white text-gray-900 border-gray-300",onChange:S=>Ot({...nt,expectedSalary:S.target.value}),placeholder:"500000"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"noticePeriod",children:"Notice Period (Days)"}),t.jsx(Re,{id:"noticePeriod",type:"number",value:nt.noticePeriod,className:"bg-white text-gray-900 border-gray-300",onChange:S=>Ot({...nt,noticePeriod:S.target.value}),placeholder:"30"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"resumeUrl",children:"Resume URL"}),t.jsx(Re,{id:"resumeUrl",value:nt.resumeUrl,className:"bg-white text-gray-900 border-gray-300",onChange:S=>Ot({...nt,resumeUrl:S.target.value}),placeholder:"https://drive.google.com/..."})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx(Q,{htmlFor:"skills",children:"Skills (comma separated)"}),t.jsx(Re,{id:"skills",value:nt.skills,className:"bg-white text-gray-900 border-gray-300",onChange:S=>Ot({...nt,skills:S.target.value}),placeholder:"React, Node.js, Python"})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx(Q,{htmlFor:"coverLetter",children:"Cover Letter"}),t.jsx(vr,{id:"coverLetter",value:nt.coverLetter,className:"bg-white text-gray-900 border-gray-300",onChange:S=>Ot({...nt,coverLetter:S.target.value}),placeholder:"Why are you interested in this position?",rows:4})]})]})}),I==="viewApplication"&&et&&t.jsx("div",{className:"space-y-4",children:t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Q,{children:"Candidate Name"}),t.jsx("p",{className:"text-sm text-gray-600",children:et.candidateName||et.applicantName})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Job Title"}),t.jsx("p",{className:"text-sm text-gray-600",children:et.jobTitle})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Email"}),t.jsx("p",{className:"text-sm text-gray-600",children:et.email})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Phone"}),t.jsx("p",{className:"text-sm text-gray-600",children:et.phone})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Experience"}),t.jsxs("p",{className:"text-sm text-gray-600",children:[et.experience," years"]})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Current Company"}),t.jsx("p",{className:"text-sm text-gray-600",children:et.currentCompany||"N/A"})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Current Position"}),t.jsx("p",{className:"text-sm text-gray-600",children:et.currentPosition||"N/A"})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Expected Salary"}),t.jsxs("p",{className:"text-sm text-gray-600",children:["",Number(et.expectedSalary||0).toLocaleString()]})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Notice Period"}),t.jsxs("p",{className:"text-sm text-gray-600",children:[et.noticePeriod," days"]})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Status"}),t.jsx("p",{className:"text-sm text-gray-600 capitalize",children:et.status?.replace(/_/g," ")})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx(Q,{children:"Skills"}),t.jsx("p",{className:"text-sm text-gray-600",children:et.skills||"N/A"})]}),et.resumeUrl&&t.jsxs("div",{className:"col-span-2",children:[t.jsx(Q,{children:"Resume"}),t.jsx("a",{href:et.resumeUrl,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline",children:"View Resume"})]}),et.coverLetter&&t.jsxs("div",{className:"col-span-2",children:[t.jsx(Q,{children:"Cover Letter"}),t.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-line",children:et.coverLetter})]})]})}),I==="screenApplication"&&et&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[t.jsxs("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:["Candidate: ",et.candidateName||et.applicantName]}),t.jsxs("p",{className:"text-xs text-blue-700",children:["Job: ",et.jobTitle]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"screeningDecision",children:"Screening Decision"}),t.jsxs(br,{value:nt.screeningDecision||"",onValueChange:S=>Ot({...nt,screeningDecision:S}),children:[t.jsx(jr,{className:"bg-white text-gray-900 border-gray-300",children:t.jsx(Er,{placeholder:"Select decision"})}),t.jsxs(Tr,{children:[t.jsx(st,{value:"screening_passed",children:"Pass - Move to Interview"}),t.jsx(st,{value:"screening_failed",children:"Fail - Reject"}),t.jsx(st,{value:"shortlisted",children:"Shortlist for Later"})]})]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"reviewerNotes",children:"Reviewer Notes"}),t.jsx(vr,{id:"reviewerNotes",value:nt.reviewerNotes||"",className:"bg-white text-gray-900 border-gray-300",onChange:S=>Ot({...nt,reviewerNotes:S.target.value}),placeholder:"Add your screening notes...",rows:4})]})]}),I==="scheduleInterview"&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"applicationId",children:"Select Candidate/Application *"}),t.jsxs(br,{value:lt.applicationId,onValueChange:S=>{const re=A.find(Ne=>Ne.id.toString()===S);re&&Jt({...lt,applicationId:S,candidateName:re.candidateName||re.applicantName||"",jobTitle:re.jobTitle||""})},children:[t.jsx(jr,{className:"bg-white text-gray-900 border-gray-300",children:t.jsx(Er,{placeholder:"Select a candidate"})}),t.jsx(Tr,{children:A&&A.length>0?A.filter(S=>["submitted","screening_passed","interviewed","shortlisted"].includes(S.status)).length>0?A.filter(S=>["submitted","screening_passed","interviewed","shortlisted"].includes(S.status)).map(S=>t.jsxs(st,{value:S.id.toString(),children:[S.candidateName||S.applicantName||"Unknown"," - ",S.jobTitle||"No Job Title"," (",S.status,")"]},S.id)):t.jsx("div",{className:"px-2 py-1.5 text-sm text-gray-500",children:"No eligible candidates. Applications must have status: screening_passed, interviewed, or shortlisted."}):t.jsx("div",{className:"px-2 py-1.5 text-sm text-gray-500",children:"No applications available"})})]}),A&&A.length>0&&t.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Total applications: ",A.length," | Eligible: ",A.filter(S=>["submitted","screening_passed","interviewed","shortlisted"].includes(S.status)).length]})]}),lt.candidateName&&t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[t.jsxs("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:["Candidate: ",lt.candidateName]}),t.jsxs("p",{className:"text-xs text-blue-700",children:["Job: ",lt.jobTitle]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"scheduledDate",children:"Interview Date *"}),t.jsx(Re,{id:"scheduledDate",type:"date",value:lt.scheduledDate,className:"bg-white text-gray-900 border-gray-300",onChange:S=>Jt({...lt,scheduledDate:S.target.value})})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"scheduledTime",children:"Interview Time *"}),t.jsx(Re,{id:"scheduledTime",type:"time",value:lt.scheduledTime,className:"bg-white text-gray-900 border-gray-300",onChange:S=>Jt({...lt,scheduledTime:S.target.value})})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"interviewType",children:"Interview Type *"}),t.jsxs(br,{value:lt.interviewType,onValueChange:S=>Jt({...lt,interviewType:S}),children:[t.jsx(jr,{className:"bg-white text-gray-900 border-gray-300",children:t.jsx(Er,{placeholder:"Select type"})}),t.jsxs(Tr,{children:[t.jsx(st,{value:"phone",children:"Phone Screening"}),t.jsx(st,{value:"video",children:"Video Interview"}),t.jsx(st,{value:"in-person",children:"In-Person"}),t.jsx(st,{value:"technical",children:"Technical Round"}),t.jsx(st,{value:"hr",children:"HR Round"}),t.jsx(st,{value:"managerial",children:"Managerial Round"}),t.jsx(st,{value:"final",children:"Final Round"})]})]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"duration",children:"Duration (minutes)"}),t.jsx(Re,{id:"duration",type:"number",value:lt.duration_minutes||60,className:"bg-white text-gray-900 border-gray-300",onChange:S=>Jt({...lt,duration_minutes:S.target.value}),placeholder:"60"})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx(Q,{htmlFor:"location",children:"Location/Platform"}),t.jsx(Re,{id:"location",value:lt.location,className:"bg-white text-gray-900 border-gray-300",onChange:S=>Jt({...lt,location:S.target.value}),placeholder:"Office/Zoom/Teams"})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx(Q,{htmlFor:"interviewers",children:"Interviewers (comma separated)"}),t.jsx(Re,{id:"interviewers",value:lt.interviewers,className:"bg-white text-gray-900 border-gray-300",onChange:S=>Jt({...lt,interviewers:S.target.value}),placeholder:"John Doe, Jane Smith"})]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx(Q,{htmlFor:"notes",children:"Notes"}),t.jsx(vr,{id:"notes",value:lt.notes,className:"bg-white text-gray-900 border-gray-300",onChange:S=>Jt({...lt,notes:S.target.value}),placeholder:"Additional notes for the interview...",rows:3})]})]})]}),I==="viewInterview"&&kt&&t.jsx("div",{className:"space-y-4",children:t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Q,{children:"Candidate Name"}),t.jsx("p",{className:"text-sm text-gray-600",children:kt.candidateName})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Job Title"}),t.jsx("p",{className:"text-sm text-gray-600",children:kt.jobTitle})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Interview Date"}),t.jsx("p",{className:"text-sm text-gray-600",children:new Date(kt.interviewDate).toLocaleDateString()})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Interview Time"}),t.jsx("p",{className:"text-sm text-gray-600",children:kt.interviewTime||"N/A"})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Interview Type"}),t.jsx("p",{className:"text-sm text-gray-600 capitalize",children:kt.interviewType})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Location"}),t.jsx("p",{className:"text-sm text-gray-600",children:kt.location||"N/A"})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Status"}),t.jsx("p",{className:"text-sm text-gray-600 capitalize",children:kt.status})]}),t.jsxs("div",{children:[t.jsx(Q,{children:"Interviewers"}),t.jsx("p",{className:"text-sm text-gray-600",children:kt.interviewers||"N/A"})]}),kt.notes&&t.jsxs("div",{className:"col-span-2",children:[t.jsx(Q,{children:"Notes"}),t.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-line",children:kt.notes})]}),kt.feedback&&t.jsxs("div",{className:"col-span-2",children:[t.jsx(Q,{children:"Feedback"}),t.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-line",children:kt.feedback})]}),kt.rating&&t.jsxs("div",{children:[t.jsx(Q,{children:"Rating"}),t.jsxs("p",{className:"text-sm text-gray-600",children:[kt.rating,"/10"]})]}),kt.decision&&t.jsxs("div",{children:[t.jsx(Q,{children:"Decision"}),t.jsx("p",{className:"text-sm text-gray-600 capitalize",children:kt.decision})]})]})}),I==="updateInterviewResult"&&kt&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[t.jsxs("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:["Candidate: ",kt.candidateName]}),t.jsxs("p",{className:"text-xs text-blue-700",children:["Job: ",kt.jobTitle]}),t.jsxs("p",{className:"text-xs text-blue-700",children:["Interview Date: ",new Date(kt.interviewDate).toLocaleDateString()]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"decision",children:"Interview Decision"}),t.jsxs(br,{value:lt.decision||"",onValueChange:S=>Jt({...lt,decision:S}),children:[t.jsx(jr,{className:"bg-white text-gray-900 border-gray-300",children:t.jsx(Er,{placeholder:"Select decision"})}),t.jsxs(Tr,{children:[t.jsx(st,{value:"selected",children:"Selected - Move to Offer"}),t.jsx(st,{value:"rejected",children:"Rejected"}),t.jsx(st,{value:"on_hold",children:"On Hold"})]})]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"rating",children:"Rating (1-10)"}),t.jsx(Re,{id:"rating",type:"number",min:"1",max:"10",value:lt.rating||"",className:"bg-white text-gray-900 border-gray-300",onChange:S=>Jt({...lt,rating:S.target.value}),placeholder:"8"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"feedback",children:"Interview Feedback"}),t.jsx(vr,{id:"feedback",value:lt.feedback||"",className:"bg-white text-gray-900 border-gray-300",onChange:S=>Jt({...lt,feedback:S.target.value}),placeholder:"Provide detailed feedback about the candidate's performance...",rows:5})]})]}),I==="setJoining"&&et&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[t.jsxs("h4",{className:"text-sm font-semibold text-green-900 mb-2",children:["Candidate: ",et.candidateName||et.applicantName]}),t.jsxs("p",{className:"text-xs text-green-700",children:["Job: ",et.jobTitle]}),t.jsx("p",{className:"text-xs text-green-700",children:"Status: Selected for Hiring"})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"joiningDate",children:"Joining Date"}),t.jsx(Re,{id:"joiningDate",type:"date",value:nt.joiningDate||"",className:"bg-white text-gray-900 border-gray-300",onChange:S=>Ot({...nt,joiningDate:S.target.value})})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"documentsSubmitted",children:"Documents Submitted"}),t.jsx(vr,{id:"documentsSubmitted",value:nt.documentsSubmitted||"",className:"bg-white text-gray-900 border-gray-300",onChange:S=>Ot({...nt,documentsSubmitted:S.target.value}),placeholder:"List documents submitted (e.g., Aadhar, PAN, Educational Certificates, Experience Letters, etc.)",rows:4})]}),t.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:t.jsxs("p",{className:"text-xs text-yellow-800",children:[t.jsx("strong",{children:"Note:"}),' Once joining details are set, the application status will be updated to "Hired".']})})]}),I==="generatePayroll"&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:t.jsxs("div",{className:"flex items-start",children:[t.jsx(Sr,{className:"h-5 w-5 text-blue-600 mt-0.5 mr-2"}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-semibold text-blue-900",children:"Attendance-Based Payroll"}),t.jsxs("p",{className:"text-xs text-blue-700 mt-1",children:[t.jsx("strong",{children:"Monthly Employees:"})," Salary = (Monthly Salary  Working Days)  Attended Days. Working days exclude Sundays.",t.jsx("br",{}),t.jsx("strong",{children:"Hourly Employees:"})," Salary = Hourly Rate  Total Hours Worked. Deduction: 5% of gross salary.",t.jsx("br",{}),t.jsx("strong",{children:"Monthly Deductions:"})," PF (12% of min(base, 15,000)), ESI (0.75% if gross < 21,000), PT (200 fixed), IT (5% if gross > 50,000)."]})]})]})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(Q,{children:"Generation Mode"}),t.jsxs("div",{className:"flex gap-4 mt-2",children:[t.jsxs("label",{className:"flex items-center",children:[t.jsx("input",{type:"radio",name:"payrollMode",value:"single",checked:Nt==="single",onChange:S=>qe(S.target.value),className:"mr-2"}),t.jsx("span",{className:"text-sm",children:"Single Employee"})]}),t.jsxs("label",{className:"flex items-center",children:[t.jsx("input",{type:"radio",name:"payrollMode",value:"bulk",checked:Nt==="bulk",onChange:S=>qe(S.target.value),className:"mr-2"}),t.jsx("span",{className:"text-sm",children:"All Active Employees"})]})]})]}),Nt==="single"&&t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"employeeSelect",children:"Select Employee"}),t.jsxs(br,{value:we.employeeId,onValueChange:S=>{const re=n.find(Te=>Te.id.toString()===S),Ne={...we,employeeId:S,basicSalary:re?.salary||0,salaryType:re?.salaryType||"monthly"};ot(Ne)},children:[t.jsx(jr,{className:"bg-white text-gray-900 border-gray-300",children:t.jsx(Er,{placeholder:"Choose an employee"})}),t.jsx(Tr,{children:n.filter(S=>S.status==="active").map(S=>t.jsxs(st,{value:S.id.toString(),children:[S.name||`${S.firstName} ${S.lastName}`," - ",S.department," (",S.salary?.toLocaleString(),")"]},S.id))})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"payPeriodStart",children:"Pay Period Start"}),t.jsx(Re,{id:"payPeriodStart",type:"date",value:we.payPeriodStart,className:"bg-white text-gray-900 border-gray-300",onChange:S=>{const re={...we,payPeriodStart:S.target.value};ot(re)}})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"payPeriodEnd",children:"Pay Period End"}),t.jsx(Re,{id:"payPeriodEnd",type:"date",value:we.payPeriodEnd,className:"bg-white text-gray-900 border-gray-300",onChange:S=>{const re={...we,payPeriodEnd:S.target.value};ot(re)}})]})]}),Nt==="single"&&t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"allowances",children:"Allowances ()"}),t.jsx(Re,{id:"allowances",type:"number",placeholder:"Enter allowances amount",value:we.allowances,className:"bg-white text-gray-900 border-gray-300",onChange:S=>ot({...we,allowances:S.target.value})}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter the total allowances for this pay period"})]}),Nt==="bulk"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"bulkAllowances",children:"Default Allowances for All ()"}),t.jsx(Re,{id:"bulkAllowances",type:"number",placeholder:"Enter default allowances",value:we.allowances,className:"bg-white text-gray-900 border-gray-300",onChange:S=>ot({...we,allowances:S.target.value})}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This amount will be applied to all employees"})]}),t.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:t.jsxs("p",{className:"text-sm text-yellow-800",children:[t.jsx("strong",{children:"Note:"})," This will generate payroll for ",n.filter(S=>S.status==="active").length," active employees."]})})]}),Nt==="single"&&we.employeeId&&we.payPeriodStart&&we.payPeriodEnd&&t.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[t.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:Ze.loading?"Loading Attendance...":"Salary Calculation Preview"}),!Ze.loading&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-3",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("h5",{className:"text-xs font-semibold text-blue-900",children:"Attendance Summary"}),t.jsx(pe,{type:"button",size:"sm",variant:"outline",onClick:()=>Ae(we.employeeId,we.payPeriodStart,we.payPeriodEnd),disabled:!we.employeeId||!we.payPeriodStart||!we.payPeriodEnd||Ze.loading,className:"text-xs h-6 px-2 bg-white text-gray-900 border-gray-300 hover:bg-gray-50 hover:text-gray-900",children:Ze.loading?t.jsxs(t.Fragment,{children:[t.jsx(Cr,{className:"h-3 w-3 mr-1 animate-spin"}),"Loading..."]}):t.jsxs(t.Fragment,{children:[t.jsx(Vi,{className:"h-3 w-3 mr-1"}),"Fetch Attendance"]})})]}),we.salaryType==="hourly"?t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"workingDays",className:"text-blue-600 block mb-1",children:"Working Days:"}),t.jsx("input",{id:"workingDays",type:"number",min:"0",className:"w-full rounded border border-blue-300 px-2 py-1 bg-white text-blue-900 font-bold",value:Ze.totalWorkingDays,onChange:S=>Xt(re=>({...re,totalWorkingDays:Number(S.target.value)}))})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"totalHours",className:"text-green-600 block mb-1",children:"Total Hours Worked:"}),t.jsx("input",{id:"totalHours",type:"number",min:"0",className:"w-full rounded border border-green-300 px-2 py-1 bg-white text-green-700 font-bold",value:Ze.totalHours,onChange:S=>Xt(re=>({...re,totalHours:Number(S.target.value)}))})]})]}):t.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"workingDays",className:"text-blue-600 block mb-1",children:"Working Days:"}),t.jsx("input",{id:"workingDays",type:"number",min:"0",className:"w-full rounded border border-blue-300 px-2 py-1 bg-white text-blue-900 font-bold",value:Ze.totalWorkingDays,onChange:S=>Xt(re=>({...re,totalWorkingDays:Number(S.target.value)}))})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"attendedDays",className:"text-green-600 block mb-1",children:"Attended:"}),t.jsx("input",{id:"attendedDays",type:"number",min:"0",className:"w-full rounded border border-green-300 px-2 py-1 bg-white text-green-700 font-bold",value:Ze.attendedDays,onChange:S=>{const re=Number(S.target.value);Xt(Ne=>({...Ne,attendedDays:re,absentDays:Ne.totalWorkingDays-re}))}})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"absentDays",className:"text-red-600 block mb-1",children:"Absent:"}),t.jsx("input",{id:"absentDays",type:"number",min:"0",className:"w-full rounded border border-red-300 px-2 py-1 bg-white text-red-700 font-bold",value:Ze.absentDays,onChange:S=>Xt(re=>({...re,absentDays:Number(S.target.value)}))})]})]})]}),we.salaryType==="hourly"?t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between text-xs text-gray-500 pb-2 border-b",children:[t.jsxs("span",{children:["Hourly Rate: ",parseFloat(we.basicSalary||0).toLocaleString()]}),t.jsxs("span",{children:["Total Hours: ",Ze.totalHours]})]}),t.jsxs("div",{className:"flex justify-between text-sm border-t pt-2",children:[t.jsx("span",{className:"text-gray-600",children:"Gross Salary (Rate  Hours):"}),t.jsxs("span",{className:"font-medium text-purple-600",children:["",(Ze.totalHours*parseFloat(we.basicSalary||0)).toLocaleString(void 0,{maximumFractionDigits:2})]})]}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600",children:"Deductions (5%):"}),t.jsxs("span",{className:"font-medium text-red-600",children:["- ",(Ze.totalHours*parseFloat(we.basicSalary||0)*.05).toLocaleString(void 0,{maximumFractionDigits:2})]})]}),t.jsxs("div",{className:"flex justify-between text-base font-bold border-t pt-2 bg-green-50 px-2 py-1 rounded",children:[t.jsx("span",{className:"text-gray-900",children:"Net Salary:"}),t.jsxs("span",{className:"text-green-600",children:["",(()=>{const S=Ze.totalHours*parseFloat(we.basicSalary||0),re=S*.05;return(S-re).toLocaleString(void 0,{maximumFractionDigits:2})})()]})]}),we.allowances&&parseFloat(we.allowances)>0&&t.jsx("div",{className:"flex justify-between text-xs text-gray-500 pt-2 border-t",children:t.jsxs("span",{children:["Note: Allowances (",parseFloat(we.allowances||0).toLocaleString(),") are tracked separately for hourly employees"]})})]}):t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between text-xs text-gray-500 pb-2 border-b",children:[t.jsxs("span",{children:["Monthly Salary: ",parseFloat(we.basicSalary||0).toLocaleString()]}),t.jsxs("span",{children:["Daily Rate: ",Ze.totalWorkingDays>0?(parseFloat(we.basicSalary||0)/Ze.totalWorkingDays).toFixed(2):"0"]})]}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600",children:"Base Salary (Attendance-based):"}),t.jsxs("span",{className:"font-medium text-blue-600",children:["",Ze.totalWorkingDays>0?(parseFloat(we.basicSalary||0)/Ze.totalWorkingDays*Ze.attendedDays).toLocaleString(void 0,{maximumFractionDigits:2}):"0"]})]}),we.allowances&&t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600",children:"Allowances:"}),t.jsxs("span",{className:"font-medium text-green-600",children:["+ ",parseFloat(we.allowances||0).toLocaleString()]})]}),t.jsxs("div",{className:"flex justify-between text-sm border-t pt-2",children:[t.jsx("span",{className:"text-gray-600",children:"Gross Salary:"}),t.jsxs("span",{className:"font-medium text-purple-600",children:["",Ze.totalWorkingDays>0?(parseFloat(we.basicSalary||0)/Ze.totalWorkingDays*Ze.attendedDays+parseFloat(we.allowances||0)).toLocaleString(void 0,{maximumFractionDigits:2}):"0"]})]}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600",children:"Deductions:"}),t.jsxs("span",{className:"font-medium text-red-600",children:["- ",Ze.totalWorkingDays>0?(()=>{const S=parseFloat(we.basicSalary||0)/Ze.totalWorkingDays*Ze.attendedDays,re=S+parseFloat(we.allowances||0),Ne=Math.min(S,15e3)*.12,Te=re<21e3?re*.0075:0,Qe=200,St=re>5e4?re*.05:0;return(Ne+Te+Qe+St).toLocaleString(void 0,{maximumFractionDigits:2})})():"0"]})]}),t.jsxs("div",{className:"flex justify-between text-base font-bold border-t pt-2 bg-green-50 px-2 py-1 rounded",children:[t.jsx("span",{className:"text-gray-900",children:"Net Salary:"}),t.jsxs("span",{className:"text-green-600",children:["",Ze.totalWorkingDays>0?(()=>{const S=parseFloat(we.basicSalary||0)/Ze.totalWorkingDays*Ze.attendedDays,re=S+parseFloat(we.allowances||0),Ne=S*.05;return(re-Ne).toLocaleString(void 0,{maximumFractionDigits:2})})():"0"]})]})]})]})]})]})]}),I==="editPayroll"&&Ye&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:t.jsxs("div",{className:"flex items-start",children:[t.jsx(Sr,{className:"h-5 w-5 text-blue-600 mt-0.5 mr-2"}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-semibold text-blue-900",children:"Edit Payroll"}),t.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Update allowances or pay period dates. Salary is calculated based on attendance: (Monthly Salary  Working Days)  Attended Days. Working days exclude Sundays. Deductions include PF (12% of min(base, 15000)), ESI (0.75% if gross < 21000), PT (200), IT (5% if gross > 50000)."})]})]})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx(Q,{children:"Employee"}),t.jsx("p",{className:"text-sm text-gray-900 font-medium",children:n.find(S=>S.id===Ye.employeeId)?.name||Ye.employeeName||"Unknown"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"editPayPeriodStart",children:"Pay Period Start"}),t.jsx(Re,{id:"editPayPeriodStart",type:"date",value:we.payPeriodStart,className:"bg-white text-gray-900 border-gray-300",onChange:S=>{const re={...we,payPeriodStart:S.target.value};ot(re),we.payPeriodEnd&&Ae(Ye.employeeId,S.target.value,we.payPeriodEnd)}})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"editPayPeriodEnd",children:"Pay Period End"}),t.jsx(Re,{id:"editPayPeriodEnd",type:"date",value:we.payPeriodEnd,className:"bg-white text-gray-900 border-gray-300",onChange:S=>{const re={...we,payPeriodEnd:S.target.value};ot(re),we.payPeriodStart&&Ae(Ye.employeeId,we.payPeriodStart,S.target.value)}})]})]}),t.jsxs("div",{children:[t.jsx(Q,{htmlFor:"editAllowances",children:"Allowances ()"}),t.jsx(Re,{id:"editAllowances",type:"number",placeholder:"Enter allowances amount",value:we.allowances,className:"bg-white text-gray-900 border-gray-300",onChange:S=>ot({...we,allowances:S.target.value})}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter the total allowances for this pay period"})]}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("h5",{className:"text-xs font-semibold text-blue-900",children:"Attendance Summary"}),t.jsx(pe,{type:"button",size:"sm",variant:"outline",onClick:()=>Ae(Ye.employeeId,we.payPeriodStart,we.payPeriodEnd),disabled:!Ye.employeeId||!we.payPeriodStart||!we.payPeriodEnd||Ze.loading,className:"text-xs h-6 px-2 bg-white text-gray-900 border-gray-300 hover:bg-gray-50 hover:text-gray-900",children:Ze.loading?t.jsxs(t.Fragment,{children:[t.jsx(Cr,{className:"h-3 w-3 mr-1 animate-spin"}),"Loading..."]}):t.jsxs(t.Fragment,{children:[t.jsx(Vi,{className:"h-3 w-3 mr-1"}),"Fetch Attendance"]})})]}),we.salaryType==="hourly"?t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"editWorkingDays",className:"text-blue-600 block mb-1",children:"Working Days:"}),t.jsx("input",{id:"editWorkingDays",type:"number",min:"0",className:"w-full rounded border border-blue-300 px-2 py-1 bg-white text-blue-900 font-bold",value:Ze.totalWorkingDays,onChange:S=>Xt(re=>({...re,totalWorkingDays:Number(S.target.value)}))})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"editTotalHours",className:"text-green-600 block mb-1",children:"Total Hours Worked:"}),t.jsx("input",{id:"editTotalHours",type:"number",min:"0",className:"w-full rounded border border-green-300 px-2 py-1 bg-white text-green-700 font-bold",value:Ze.totalHours,onChange:S=>Xt(re=>({...re,totalHours:Number(S.target.value)}))})]})]}):t.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"editWorkingDays",className:"text-blue-600 block mb-1",children:"Working Days:"}),t.jsx("input",{id:"editWorkingDays",type:"number",min:"0",className:"w-full rounded border border-blue-300 px-2 py-1 bg-white text-blue-900 font-bold",value:Ze.totalWorkingDays,onChange:S=>Xt(re=>({...re,totalWorkingDays:Number(S.target.value)}))})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"editAttendedDays",className:"text-green-600 block mb-1",children:"Attended:"}),t.jsx("input",{id:"editAttendedDays",type:"number",min:"0",className:"w-full rounded border border-green-300 px-2 py-1 bg-white text-green-700 font-bold",value:Ze.attendedDays,onChange:S=>{const re=Number(S.target.value);Xt(Ne=>({...Ne,attendedDays:re,absentDays:Ne.totalWorkingDays-re}))}})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"editAbsentDays",className:"text-red-600 block mb-1",children:"Absent:"}),t.jsx("input",{id:"editAbsentDays",type:"number",min:"0",className:"w-full rounded border border-red-300 px-2 py-1 bg-white text-red-700 font-bold",value:Ze.absentDays,onChange:S=>Xt(re=>({...re,absentDays:Number(S.target.value)}))})]})]})]}),t.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[t.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:Ze.loading?"Loading Salary Preview...":"Salary Calculation Preview"}),!Ze.loading&&t.jsx(t.Fragment,{children:we.salaryType==="hourly"?t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between text-xs text-gray-500 pb-2 border-b",children:[t.jsxs("span",{children:["Hourly Rate: ",parseFloat(we.basicSalary||0).toLocaleString()]}),t.jsxs("span",{children:["Total Hours: ",Ze.totalHours]})]}),t.jsxs("div",{className:"flex justify-between text-sm border-t pt-2",children:[t.jsx("span",{className:"text-gray-600",children:"Gross Salary (Rate  Hours):"}),t.jsxs("span",{className:"font-medium text-purple-600",children:["",(Ze.totalHours*parseFloat(we.basicSalary||0)).toLocaleString(void 0,{maximumFractionDigits:2})]})]}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600",children:"Deductions (5%):"}),t.jsxs("span",{className:"font-medium text-red-600",children:["- ",(Ze.totalHours*parseFloat(we.basicSalary||0)*.05).toLocaleString(void 0,{maximumFractionDigits:2})]})]}),t.jsxs("div",{className:"flex justify-between text-base font-bold border-t pt-2 bg-green-50 px-2 py-1 rounded",children:[t.jsx("span",{className:"text-gray-900",children:"Net Salary:"}),t.jsxs("span",{className:"text-green-600",children:["",(()=>{const S=Ze.totalHours*parseFloat(we.basicSalary||0),re=S*.05;return(S-re).toLocaleString(void 0,{maximumFractionDigits:2})})()]})]}),we.allowances&&parseFloat(we.allowances)>0&&t.jsx("div",{className:"flex justify-between text-xs text-gray-500 pt-2 border-t",children:t.jsxs("span",{children:["Note: Allowances (",parseFloat(we.allowances||0).toLocaleString(),") are tracked separately for hourly employees"]})})]}):t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between text-xs text-gray-500 pb-2 border-b",children:[t.jsxs("span",{children:["Monthly Salary: ",parseFloat(we.basicSalary||0).toLocaleString()]}),t.jsxs("span",{children:["Daily Rate: ",Ze.totalWorkingDays>0?(parseFloat(we.basicSalary||0)/Ze.totalWorkingDays).toFixed(2):"0"]})]}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600",children:"Base Salary (Attendance-based):"}),t.jsxs("span",{className:"font-medium text-blue-600",children:["",Ze.totalWorkingDays>0?(parseFloat(we.basicSalary||0)/Ze.totalWorkingDays*Ze.attendedDays).toLocaleString(void 0,{maximumFractionDigits:2}):"0"]})]}),we.allowances&&t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600",children:"Allowances:"}),t.jsxs("span",{className:"font-medium text-green-600",children:["+ ",parseFloat(we.allowances||0).toLocaleString()]})]}),t.jsxs("div",{className:"flex justify-between text-sm border-t pt-2",children:[t.jsx("span",{className:"text-gray-600",children:"Gross Salary:"}),t.jsxs("span",{className:"font-medium text-purple-600",children:["",Ze.totalWorkingDays>0?(parseFloat(we.basicSalary||0)/Ze.totalWorkingDays*Ze.attendedDays+parseFloat(we.allowances||0)).toLocaleString(void 0,{maximumFractionDigits:2}):"0"]})]}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600",children:"Deductions:"}),t.jsxs("span",{className:"font-medium text-red-600",children:["- ",Ze.totalWorkingDays>0?(()=>{const S=parseFloat(we.basicSalary||0)/Ze.totalWorkingDays*Ze.attendedDays,re=S+parseFloat(we.allowances||0),Ne=Math.min(S,15e3)*.12,Te=re<21e3?re*.0075:0,Qe=200,St=re>5e4?re*.05:0;return(Ne+Te+Qe+St).toLocaleString(void 0,{maximumFractionDigits:2})})():"0"]})]}),t.jsxs("div",{className:"flex justify-between text-base font-bold border-t pt-2 bg-green-50 px-2 py-1 rounded",children:[t.jsx("span",{className:"text-gray-900",children:"Net Salary:"}),t.jsxs("span",{className:"text-green-600",children:["",Ze.totalWorkingDays>0?(()=>{const S=parseFloat(we.basicSalary||0)/Ze.totalWorkingDays*Ze.attendedDays,re=S+parseFloat(we.allowances||0),Ne=S*.05;return(re-Ne).toLocaleString(void 0,{maximumFractionDigits:2})})():"0"]})]})]})})]})]})]}),I==="viewPayroll"&&Ye&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx(Q,{className:"text-gray-700",children:"Employee Name"}),t.jsx("p",{className:"text-sm text-gray-900 font-medium",children:Ye.employeeName})]}),t.jsxs("div",{children:[t.jsx(Q,{className:"text-gray-700",children:"Status"}),t.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${Ye.status==="processed"||Ye.status==="paid"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:Ye.status||"pending"})]}),t.jsxs("div",{children:[t.jsx(Q,{className:"text-gray-700",children:"Pay Period Start"}),t.jsx("p",{className:"text-sm text-gray-600",children:Ye.payPeriodStart?new Date(Ye.payPeriodStart).toLocaleDateString():"N/A"})]}),t.jsxs("div",{children:[t.jsx(Q,{className:"text-gray-700",children:"Pay Period End"}),t.jsx("p",{className:"text-sm text-gray-600",children:Ye.payPeriodEnd?new Date(Ye.payPeriodEnd).toLocaleDateString():"N/A"})]})]}),t.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[t.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Salary Breakdown"}),t.jsxs("div",{className:"space-y-2 bg-white rounded-lg p-3 border border-gray-200",children:[t.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-200",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Monthly Salary"}),t.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["",(Ye.monthlySalary||0).toLocaleString()]})]}),t.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-200",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Allowances"}),t.jsxs("span",{className:"text-sm font-medium text-green-600",children:["+ ",(Ye.allowances||0).toLocaleString()]})]}),t.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-200",children:[t.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Gross Salary"}),t.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:["",(Ye.grossSalary||0).toLocaleString()]})]}),t.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-200",children:[t.jsx("span",{className:"text-sm text-gray-700",children:"Deductions"}),t.jsxs("span",{className:"text-sm font-medium text-red-600",children:["- ",(Ye.deductions||0).toLocaleString()]})]}),t.jsxs("div",{className:"flex justify-between py-3 bg-green-50 border border-green-200 px-3 rounded-lg mt-2",children:[t.jsx("span",{className:"text-base font-bold text-gray-900",children:"Net Salary"}),t.jsxs("span",{className:"text-base font-bold text-green-600",children:["",(Ye.netSalary||0).toLocaleString()]})]})]})]}),Ye.paymentDate&&t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:t.jsxs("p",{className:"text-sm text-blue-800",children:[t.jsx("strong",{children:"Payment Date:"})," ",new Date(Ye.paymentDate).toLocaleDateString()]})})]})]}),t.jsxs(yr,{className:"flex-shrink-0 border-t border-gray-200 pt-4 mt-2 bg-gray-50",children:[t.jsx(pe,{variant:"outline",onClick:me,className:"text-gray-700 border-gray-300 hover:bg-gray-100 hover:text-gray-900",children:I==="viewPayroll"?"Close":"Cancel"}),I==="generatePayroll"&&t.jsxs(pe,{onClick:mt,children:[t.jsx(ri,{className:"h-4 w-4 mr-2"}),"Generate Payroll"]}),I==="markAttendance"&&t.jsxs(pe,{onClick:ve,children:[t.jsx(Ka,{className:"h-4 w-4 mr-2"}),"Mark Attendance"]}),I==="leaveRequest"&&t.jsxs(pe,{onClick:ct,children:[t.jsx(ri,{className:"h-4 w-4 mr-2"}),"Submit Leave Request"]}),I==="editPayroll"&&t.jsxs(pe,{onClick:qt,children:[t.jsx(bf,{className:"h-4 w-4 mr-2"}),"Update Payroll"]}),I!=="viewEmployee"&&I!=="viewPayroll"&&I!=="generatePayroll"&&I!=="markAttendance"&&I!=="editPayroll"&&t.jsx(pe,{onClick:Je,children:I==="addEmployee"?"Add":"Save"})]})]})}),t.jsxs("div",{className:"mt-12 bg-white border-2 border-gray-200 rounded-lg p-6 shadow-sm text-center text-gray-600",children:[t.jsx("p",{className:"font-medium",children:" Human Resource Management System"}),t.jsx("p",{className:"text-sm mt-1",children:"For technical support, contact IT Department"})]})]})]})},R5=()=>{const{toast:e}=Ni(),[r,s]=T.useState([]),[a,n]=T.useState([]),[o,c]=T.useState([]),[d,h]=T.useState(!0),[m,f]=T.useState(""),[p,g]=T.useState("set-target"),[N,y]=T.useState(!1),[w,b]=T.useState(null),[C,A]=T.useState({salesPerson:"",year:new Date().getFullYear(),month:new Date().getMonth()+1,targetAmount:"",assignedBy:"admin",notes:""});T.useEffect(()=>{E(),R()},[]),T.useEffect(()=>{if(m.trim()==="")n(r);else{const W=r.filter(te=>te.name.toLowerCase().includes(m.toLowerCase())||te.email.toLowerCase().includes(m.toLowerCase()));n(W)}},[m,r]);const E=async()=>{try{const W=await fetch(`${Fe}/auth/users`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(W.ok){const te=await W.json(),de=(te.users||te||[]).filter(H=>H.department==="sales").map(H=>({id:H.id,name:H.fullName||H.full_name||H.username,email:H.email,department:H.department,username:H.username}));s(de),n(de)}}catch(W){console.error("Error loading sales persons:",W),e({title:"Error",description:"Failed to load sales persons",variant:"destructive"})}},R=async()=>{try{h(!0),c([])}catch(W){console.error("Error loading targets:",W)}finally{h(!1)}},V=W=>{const{name:te,value:de}=W.target;A(H=>({...H,[te]:te==="targetAmount"||te==="year"||te==="month"?de?Number(de):"":de}))},P=async W=>{if(W.preventDefault(),!C.salesPerson||!C.targetAmount){e({title:"Validation Error",description:"Please select a salesperson and enter target amount",variant:"destructive"});return}if(C.targetAmount<=0){e({title:"Validation Error",description:"Target amount must be greater than 0",variant:"destructive"});return}try{const te=await fetch(`${Fe}/sales/targets`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({salesPerson:C.salesPerson,year:C.year,month:C.month,targetAmount:C.targetAmount,assignedBy:C.assignedBy,notes:C.notes})});if(te.ok||te.status===201){const de=await te.json();e({title:"Success",description:`Target set successfully for ${C.salesPerson}`}),A({salesPerson:"",year:new Date().getFullYear(),month:new Date().getMonth()+1,targetAmount:"",assignedBy:"admin",notes:""}),y(!1),b(null),R()}else{const de=await te.json();throw new Error(de.error||"Failed to set target")}}catch(te){console.error("Error setting target:",te),e({title:"Error",description:te.message||"Failed to set target",variant:"destructive"})}},k=async W=>{if(!W||W<=0){e({title:"Validation Error",description:"Please enter a valid target amount",variant:"destructive"});return}try{let te=0,de=0;for(const H of a)try{const ue=await fetch(`${Fe}/sales/targets`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({salesPerson:H.username,year:C.year,month:C.month,targetAmount:Number(W),assignedBy:"admin",notes:"Bulk assignment"})});ue.ok||ue.status===201?te++:de++}catch{de++}e({title:"Bulk Assignment Complete",description:`${te} targets set, ${de} failed`}),R()}catch(te){console.error("Error in bulk set targets:",te),e({title:"Error",description:"Bulk assignment failed",variant:"destructive"})}},z=()=>{y(!1),b(null),A({salesPerson:"",year:new Date().getFullYear(),month:new Date().getMonth()+1,targetAmount:"",assignedBy:"admin",notes:""})};return t.jsxs("div",{className:"space-y-6",children:[t.jsx(He,{className:"bg-gradient-to-r from-blue-600 to-purple-600 border-0",children:t.jsx(rt,{className:"text-white",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Yo,{className:"w-8 h-8"}),t.jsxs("div",{children:[t.jsx(at,{className:"text-2xl text-white",children:"Sales Target Management"}),t.jsx(gr,{className:"text-blue-100",children:"Set and manage monthly sales targets for salespeople"})]})]}),t.jsx(Cn,{className:"w-16 h-16 opacity-30"})]})})}),t.jsxs(an,{value:p,onValueChange:g,className:"w-full",children:[t.jsxs(ma,{className:"grid w-full grid-cols-2",children:[t.jsx(xt,{value:"set-target",children:"Set Individual Target"}),t.jsx(xt,{value:"bulk-assign",children:"Bulk Assign Targets"})]}),t.jsx(Ut,{value:"set-target",className:"space-y-6",children:t.jsxs(He,{className:"bg-white border-2 border-gray-200 shadow-lg",children:[t.jsxs(rt,{className:"bg-gradient-to-r from-blue-500 to-indigo-500 text-white",children:[t.jsxs(at,{className:"flex items-center gap-2 text-white",children:[t.jsx(Yo,{className:"w-5 h-5"}),"Set Target for Salesperson"]}),t.jsx(gr,{className:"text-blue-100",children:"Select a salesperson and set their monthly sales target"})]}),t.jsxs(Ve,{className:"p-6",children:[t.jsxs("div",{className:"mb-6 relative",children:[t.jsx(fi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),t.jsx("input",{type:"text",placeholder:"Search salespeople by name or email...",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:m,onChange:W=>f(W.target.value)})]}),t.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg mb-6",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{className:"border-b border-gray-200",children:[t.jsx("th",{className:"px-6 py-3 text-left text-sm font-bold text-gray-900",children:"Name"}),t.jsx("th",{className:"px-6 py-3 text-left text-sm font-bold text-gray-900",children:"Email"}),t.jsx("th",{className:"px-6 py-3 text-left text-sm font-bold text-gray-900",children:"Username"}),t.jsx("th",{className:"px-6 py-3 text-center text-sm font-bold text-gray-900",children:"Action"})]})}),t.jsx("tbody",{className:"bg-white",children:a.length===0?t.jsx("tr",{children:t.jsxs("td",{colSpan:"4",className:"px-6 py-8 text-center text-gray-500",children:[t.jsx(Sr,{className:"w-10 h-10 mx-auto mb-2 text-gray-400"}),t.jsx("p",{className:"font-medium",children:"No salespeople found"})]})}):a.map(W=>t.jsxs("tr",{className:"border-b border-gray-100 hover:bg-blue-50",children:[t.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:W.name}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:W.email}),t.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:W.username}),t.jsx("td",{className:"px-6 py-4 text-center",children:t.jsxs(mr,{open:N&&C.salesPerson===W.username,onOpenChange:y,children:[t.jsx(qo,{asChild:!0,children:t.jsxs(pe,{onClick:()=>{A(te=>({...te,salesPerson:W.username})),y(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white",size:"sm",children:[t.jsx(Yo,{className:"w-4 h-4 mr-1"}),"Set Target"]})}),t.jsxs(fr,{children:[t.jsxs(xr,{children:[t.jsxs(pr,{children:["Set Target for ",W.name," (",W.username,")"]}),t.jsx(Ar,{children:"Enter the monthly sales target for this salesperson"})]}),t.jsxs("form",{onSubmit:P,className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"year",children:"Year"}),t.jsx(Re,{id:"year",name:"year",type:"number",min:"2020",max:"2099",value:C.year,onChange:V,required:!0})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"month",children:"Month"}),t.jsx("select",{id:"month",name:"month",value:C.month,onChange:V,className:"w-full bg-gray-800 text-white border border-gray-600 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200",required:!0,children:Array.from({length:12},(te,de)=>de+1).map(te=>t.jsx("option",{value:te,children:new Date(2024,te-1).toLocaleString("default",{month:"long"})},te))})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"targetAmount",children:"Target Amount ()"}),t.jsx(Re,{id:"targetAmount",name:"targetAmount",type:"number",min:"0",step:"1000",placeholder:"Enter target amount",value:C.targetAmount,onChange:V,required:!0})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(Q,{htmlFor:"notes",children:"Notes (Optional)"}),t.jsx(vr,{id:"notes",name:"notes",placeholder:"Add any notes...",value:C.notes,onChange:V,rows:"3"})]}),t.jsxs(yr,{children:[t.jsx(pe,{type:"button",variant:"outline",onClick:z,children:"Cancel"}),t.jsx(pe,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:"Set Target"})]})]})]})]})})]},W.id))})]})})]})]})}),t.jsx(Ut,{value:"bulk-assign",className:"space-y-6",children:t.jsxs(He,{className:"bg-white border-2 border-gray-200 shadow-lg",children:[t.jsxs(rt,{className:"bg-gradient-to-r from-purple-500 to-pink-500 text-white",children:[t.jsxs(at,{className:"flex items-center gap-2 text-white",children:[t.jsx(JC,{className:"w-5 h-5"}),"Bulk Assign Targets"]}),t.jsx(gr,{className:"text-purple-100",children:"Assign the same target to multiple salespeople at once"})]}),t.jsx(Ve,{className:"p-6",children:t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-purple-50 p-6 rounded-lg border-2 border-purple-200",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:"font-bold text-gray-900",children:t.jsx(Q,{htmlFor:"bulk-year",children:"Year"})}),t.jsx(Re,{id:"bulk-year",type:"number",min:"2020",max:"2099",value:C.year,onChange:W=>A(te=>({...te,year:Number(W.target.value)}))})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:"font-bold text-gray-900",children:t.jsx(Q,{htmlFor:"bulk-month",children:"Month"})}),t.jsx("select",{id:"bulk-month",value:C.month,onChange:W=>A(te=>({...te,month:Number(W.target.value)})),className:"w-full bg-gray-800 text-white border border-gray-600 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200",children:Array.from({length:12},(W,te)=>te+1).map(W=>t.jsx("option",{value:W,children:new Date(2024,W-1).toLocaleString("default",{month:"long"})},W))})]})]}),t.jsxs("div",{className:"mt-6 space-y-2",children:[t.jsxs("div",{className:"font-bold text-gray-900",children:[t.jsx(Q,{htmlFor:"bulk-target",children:"Target Amount for All ()"})," "]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx(Re,{id:"bulk-target",type:"number",min:"0",step:"1000",placeholder:"Enter target amount",onKeyPress:W=>{W.key==="Enter"&&k(W.target.value)}}),t.jsx(pe,{onClick:W=>{const te=document.getElementById("bulk-target");k(te.value)},className:"bg-purple-600 hover:bg-purple-700 text-white whitespace-nowrap",children:"Apply to All"})]})]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("h3",{className:"font-bold text-gray-900",children:["Salespeople to be assigned (",a.length,"):"]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 max-h-96 overflow-y-auto",children:a.length===0?t.jsxs("div",{className:"col-span-full text-center py-8 text-gray-500",children:[t.jsx(Sr,{className:"w-10 h-10 mx-auto mb-2 text-gray-400"}),"No salespeople found"]}):a.map(W=>t.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-200 hover:bg-purple-50",children:[t.jsx("p",{className:"font-medium text-gray-900",children:W.name}),t.jsx("p",{className:"text-sm text-gray-600",children:W.email})]},W.id))})]})]})})]})})]})]})},_5=()=>{const{getAllUsers:e,updateUserDepartment:r,deleteUser:s}=Ns(),[a,n]=T.useState([]),[o,c]=T.useState([]),[d,h]=T.useState(""),[m,f]=T.useState(!0),[p,g]=T.useState([]);T.useEffect(()=>{(async()=>{try{const C=await fetch(`${Fe}/auth/departments`);if(C.ok){const A=await C.json();g(A.departments||[])}else g([])}catch(C){console.error("Failed to fetch departments:",C),g([])}})(),N()},[]),T.useEffect(()=>{if(d.trim()==="")c(a);else{const b=a.filter(C=>(C.fullName||C.full_name||"").toLowerCase().includes(d.toLowerCase())||C.username.toLowerCase().includes(d.toLowerCase())||C.department.toLowerCase().includes(d.toLowerCase()));c(b)}},[d,a]);const N=async()=>{f(!0);try{const b=await e();n(b),c(b)}catch(b){console.error("Error fetching users:",b)}finally{f(!1)}},y=async(b,C)=>{try{await r(b,C),dt({title:"Department Updated",description:"User department has been successfully updated."}),N()}catch(A){dt({title:"Update Failed",description:A.message||"An error occurred while updating the department.",variant:"destructive"})}},w=async b=>{if(window.confirm("Are you sure you want to delete this user? This action cannot be undone."))try{await s(b),dt({title:"User Deleted",description:"The user has been successfully deleted."}),N()}catch(C){dt({title:"Delete Failed",description:C.message||"An error occurred while deleting the user.",variant:"destructive"})}};return t.jsxs(He,{className:"bg-white border-2 border-gray-200 shadow-lg mt-6",children:[t.jsxs(rt,{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white",children:[t.jsxs(at,{className:"text-white text-xl font-bold flex items-center",children:[t.jsx(Nr,{className:"mr-3 h-6 w-6"})," User Management"]}),t.jsx("p",{className:"text-blue-100 text-sm font-medium mt-1",children:"Manage system users and their departments"})]}),t.jsxs(Ve,{className:"p-6",children:[t.jsxs("div",{className:"mb-6 relative",children:[t.jsx(fi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),t.jsx("input",{type:"text",placeholder:"Search users by name, username, or department...",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:d,onChange:b=>h(b.target.value)})]}),m?t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx(Cr,{className:"w-12 h-12 animate-spin mx-auto mb-4 text-blue-600"}),t.jsx("p",{className:"text-gray-800 text-lg font-medium",children:"Loading Users..."})]})}):o.length===0?t.jsxs("div",{className:"text-center p-12 bg-gray-50 border border-gray-200 rounded-lg",children:[t.jsx(Sr,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"No Users Found"}),t.jsx("p",{className:"text-gray-600 font-medium",children:d?"No users match your search criteria.":"No users are registered in the system."})]}):t.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:t.jsxs("table",{className:"w-full text-left",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{className:"border-b border-gray-200",children:[t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Full Name"}),t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Username"}),t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Email"}),t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Department"}),t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Status"}),t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white",children:o.map(b=>t.jsxs(ds.tr,{className:"border-b border-gray-100 hover:bg-gray-50",initial:{opacity:0},animate:{opacity:1},children:[t.jsx("td",{className:"p-4 text-gray-900 font-medium",children:b.fullName||b.full_name}),t.jsx("td",{className:"p-4 text-gray-900 font-medium",children:b.username}),t.jsx("td",{className:"p-4 text-gray-900 font-medium",children:b.email}),t.jsx("td",{className:"p-4",children:t.jsx("select",{value:b.department,onChange:C=>y(b.id,C.target.value),className:`px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent capitalize font-medium text-xs ${b.department==="admin"?"bg-purple-100 text-purple-800 border-purple-300":b.department==="finance"?"bg-green-100 text-green-800 border-green-300":b.department==="sales"?"bg-blue-100 text-blue-800 border-blue-300":b.department==="dispatch"?"bg-orange-100 text-orange-800 border-orange-300":b.department==="production"?"bg-indigo-100 text-indigo-800 border-indigo-300":"bg-gray-100 text-gray-800 border-gray-300"}`,children:p.map(C=>t.jsx("option",{value:C,className:"capitalize bg-white text-gray-900",children:C},C))})}),t.jsx("td",{className:"p-4",children:t.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${b.status==="APPROVED"?"bg-green-100 text-green-800":b.status==="PENDING"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:b.status||"APPROVED"})}),t.jsx("td",{className:"p-4",children:t.jsx(pe,{onClick:()=>w(b.id),className:"bg-red-600 hover:bg-red-700 text-white font-medium",size:"sm",children:"Delete"})})]},b.id))})]})})]})]})},D5=()=>{const{users:e,getPendingUsers:r,approveUser:s,rejectUser:a}=Ns(),[n,o]=T.useState([]),[c,d]=T.useState([]),[h,m]=T.useState(!0),[f,p]=T.useState(!0),[g,N]=T.useState("users"),[y,w]=T.useState({pendingUsers:0,pendingOrderBypass:0,pendingFreeDelivery:0});T.useEffect(()=>{b(),C()},[]),T.useEffect(()=>{w({pendingUsers:n.length,pendingOrderBypass:c.filter(P=>P.requestType==="coupon_applied").length,pendingFreeDelivery:c.filter(P=>P.requestType==="free_delivery").length})},[n,c]);const b=async()=>{m(!0);try{const P=await r();o(P)}catch(P){console.error("Error fetching pending users:",P);const k=e.filter(z=>z.status==="PENDING");o(k)}finally{m(!1)}},C=async()=>{p(!0);try{console.log("Fetching order approvals from:",`${Fe}/approval/pending`);const P=await fetch(`${Fe}/approval/pending`);if(console.log("Response status:",P.status),P.ok){const k=await P.json();console.log("Approval data received:",k),d(k.approvals||[])}else console.error("Failed to fetch approvals:",P.status)}catch(P){console.error("Error fetching order approvals:",P)}finally{p(!1)}},A=async P=>{try{await s(P),dt({title:"User Approved",description:"The user can now log in to the system."}),b()}catch(k){dt({title:"Approval Failed",description:k.message||"An error occurred while approving the user.",variant:"destructive"})}},E=async P=>{try{await a(P),dt({title:"User Rejected",description:"The user has been rejected and cannot log in."}),b()}catch(k){dt({title:"Rejection Failed",description:k.message||"An error occurred while rejecting the user.",variant:"destructive"})}},R=async P=>{try{console.log("Approving order with ID:",P);const k=await fetch(`${Fe}/approval/approve/${P}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({approvedBy:"admin"})});console.log("Approval response status:",k.status);const z=await k.json().catch(()=>({}));if(console.log("Approval response data:",z),k.ok)dt({title:"Order Approved",description:"The coupon bypass request has been approved."}),C();else throw new Error(z.error||`HTTP ${k.status}: Failed to approve order`)}catch(k){console.error("Approval error:",k),dt({title:"Approval Failed",description:k.message||"An error occurred while approving the order.",variant:"destructive"})}},V=async P=>{try{if((await fetch(`${Fe}/approval/reject/${P}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rejectedBy:"admin"})})).ok)dt({title:"Order Rejected",description:"The coupon bypass request has been rejected."}),C();else throw new Error("Failed to reject order")}catch(k){dt({title:"Rejection Failed",description:k.message||"An error occurred while rejecting the order.",variant:"destructive"})}};return t.jsx("div",{className:"space-y-6",children:t.jsxs(an,{value:g,onValueChange:N,className:"w-full",children:[t.jsxs(ma,{className:"hidden md:grid w-full grid-cols-3 overflow-hidden",children:[t.jsxs(xt,{value:"users",className:"relative whitespace-nowrap",children:["User Approvals",y.pendingUsers>0&&t.jsx("div",{className:"absolute -top-2 -right-2 flex items-center justify-center rounded-full bg-red-500 text-white text-xs font-bold min-w-[1.25rem] h-5 px-1",children:y.pendingUsers})]}),t.jsxs(xt,{value:"orders",className:"relative whitespace-nowrap",children:["Order Bypass Approvals",y.pendingOrderBypass>0&&t.jsx("div",{className:"absolute -top-2 -right-2 flex items-center justify-center rounded-full bg-red-500 text-white text-xs font-bold min-w-[1.25rem] h-5 px-1",children:y.pendingOrderBypass})]}),t.jsxs(xt,{value:"freedelivery",className:"relative whitespace-nowrap",children:["Free Delivery Approval",y.pendingFreeDelivery>0&&t.jsx("div",{className:"absolute -top-2 -right-2 flex items-center justify-center rounded-full bg-red-500 text-white text-xs font-bold min-w-[1.25rem] h-5 px-1",children:y.pendingFreeDelivery})]})]}),t.jsx("div",{className:"overflow-x-auto md:hidden",children:t.jsxs(ma,{className:"flex w-max overflow-y-hidden no-scrollbar",children:[t.jsxs(xt,{value:"users",className:"relative whitespace-nowrap px-4 py-2 min-w-[8rem] text-sm",children:["User Approvals",y.pendingUsers>0&&t.jsx("div",{className:"absolute -top-2 -right-2 flex items-center justify-center rounded-full bg-red-500 text-white text-xs font-bold min-w-[1.25rem] h-5 px-1",children:y.pendingUsers})]}),t.jsxs(xt,{value:"orders",className:"relative whitespace-nowrap px-4 py-2 min-w-[8rem] text-sm",children:["Order Bypass Approvals",y.pendingOrderBypass>0&&t.jsx("div",{className:"absolute -top-2 -right-2 flex items-center justify-center rounded-full bg-red-500 text-white text-xs font-bold min-w-[1.25rem] h-5 px-1",children:y.pendingOrderBypass})]}),t.jsxs(xt,{value:"freedelivery",className:"relative whitespace-nowrap px-4 py-2 min-w-[8rem] text-sm",children:["Free Delivery Approval",y.pendingFreeDelivery>0&&t.jsx("div",{className:"absolute -top-2 -right-2 flex items-center justify-center rounded-full bg-red-500 text-white text-xs font-bold min-w-[1.25rem] h-5 px-1",children:y.pendingFreeDelivery})]})]})}),t.jsx(Ut,{value:"users",children:t.jsxs(He,{className:"bg-white border-2 border-gray-200 shadow-lg mt-6",children:[t.jsxs(rt,{className:"bg-gradient-to-r from-amber-600 to-orange-600 text-white",children:[t.jsxs(at,{className:"text-white text-xl font-bold flex items-center",children:[t.jsx(pu,{className:"mr-3 h-6 w-6"})," Pending User Approvals"]}),t.jsx("p",{className:"text-amber-100 text-sm font-medium mt-1",children:"Review and approve new user registrations"})]}),t.jsx(Ve,{className:"p-6",children:h?t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx(Cr,{className:"w-12 h-12 animate-spin mx-auto mb-4 text-blue-600"}),t.jsx("p",{className:"text-gray-800 text-lg font-medium",children:"Loading Pending Approvals..."})]})}):n.length===0?t.jsxs("div",{className:"text-center p-12 bg-gray-50 border border-gray-200 rounded-lg",children:[t.jsx(Sr,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"No Pending Approvals"}),t.jsx("p",{className:"text-gray-600 font-medium",children:"All user registrations have been processed."})]}):t.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:t.jsxs("table",{className:"w-full text-left",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{className:"border-b border-gray-200",children:[t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Full Name"}),t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Username"}),t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Email"}),t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Department"}),t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white",children:n.map(P=>t.jsxs(ds.tr,{className:"border-b border-gray-100 hover:bg-gray-50",initial:{opacity:0},animate:{opacity:1},children:[t.jsx("td",{className:"p-4 text-gray-900 font-medium",children:P.fullName||P.full_name}),t.jsx("td",{className:"p-4 text-gray-900 font-medium",children:P.username}),t.jsx("td",{className:"p-4 text-gray-900 font-medium",children:P.email}),t.jsx("td",{className:"p-4 text-gray-900 font-medium capitalize",children:P.department}),t.jsxs("td",{className:"p-4 flex space-x-3",children:[t.jsxs(pe,{onClick:()=>A(P.id),className:"bg-green-600 hover:bg-green-700 text-white font-medium",size:"sm",children:[t.jsx($o,{className:"w-4 h-4 mr-1"}),"Approve"]}),t.jsxs(pe,{onClick:()=>E(P.id),className:"bg-red-600 hover:bg-red-700 text-white font-medium",size:"sm",children:[t.jsx(Bm,{className:"w-4 h-4 mr-1"}),"Reject"]})]})]},P.id))})]})})})]})}),t.jsx(Ut,{value:"orders",children:t.jsxs(He,{className:"bg-white border-2 border-gray-200 shadow-lg mt-6",children:[t.jsxs(rt,{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white",children:[t.jsxs(at,{className:"text-white text-xl font-bold flex items-center",children:[t.jsx(Ga,{className:"mr-3 h-6 w-6"})," Order Bypass Approvals"]}),t.jsx("p",{className:"text-blue-100 text-sm font-medium mt-1",children:"Review and approve coupon bypass requests"})]}),t.jsx(Ve,{className:"p-6",children:f?t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx(Cr,{className:"w-12 h-12 animate-spin mx-auto mb-4 text-blue-600"}),t.jsx("p",{className:"text-gray-800 text-lg font-medium",children:"Loading Order Approvals..."})]})}):c.length===0?t.jsxs("div",{className:"text-center p-12 bg-gray-50 border border-gray-200 rounded-lg",children:[t.jsx(Sr,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"No Pending Order Approvals"}),t.jsx("p",{className:"text-gray-600 font-medium",children:"All coupon bypass requests have been processed."})]}):t.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:t.jsxs("table",{className:"w-full text-left",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{className:"border-b border-gray-200",children:[t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Order ID"}),t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Customer"}),t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Product"}),t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Quantity"}),t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Amount"}),t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Coupon Code"}),t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Reason"}),t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white",children:c.filter(P=>P.requestType==="coupon_applied").map(P=>t.jsxs(ds.tr,{className:"border-b border-gray-100 hover:bg-gray-50",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:[t.jsxs("td",{className:"p-4 text-gray-800 font-medium",children:["#",P.orderNumber]}),t.jsx("td",{className:"p-4 text-gray-700",children:P.customerName}),t.jsx("td",{className:"p-4 text-gray-700",children:P.productName}),t.jsx("td",{className:"p-4 text-gray-700",children:P.quantity||1}),t.jsxs("td",{className:"p-4 text-gray-700",children:["",P.finalAmount]}),t.jsx("td",{className:"p-4 text-gray-700",children:P.coupon_code}),t.jsx("td",{className:"p-4 text-gray-700",children:P.requestDetails}),t.jsx("td",{className:"p-4",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(pe,{size:"sm",className:"bg-green-600 hover:bg-green-700 text-white",onClick:()=>R(P.id,P.requestType),children:" Approve"}),t.jsx(pe,{size:"sm",className:"bg-red-600 hover:bg-red-700 text-white",onClick:()=>V(P.id),children:" Reject"})]})})]},P.id))})]})})})]})}),t.jsx(Ut,{value:"freedelivery",children:t.jsxs(He,{className:"bg-white border-2 border-gray-200 shadow-lg mt-6",children:[t.jsxs(rt,{className:"bg-gradient-to-r from-green-600 to-teal-600 text-white",children:[t.jsxs(at,{className:"text-white text-xl font-bold flex items-center",children:[t.jsx(Ga,{className:"mr-3 h-6 w-6"})," Free Delivery Approvals"]}),t.jsx("p",{className:"text-green-100 text-sm font-medium mt-1",children:"Review and approve free delivery requests"})]}),t.jsx(Ve,{className:"p-6",children:f?t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx(Cr,{className:"w-12 h-12 animate-spin mx-auto mb-4 text-blue-600"}),t.jsx("p",{className:"text-gray-800 text-lg font-medium",children:"Loading Free Delivery Approvals..."})]})}):c.filter(P=>P.requestType==="free_delivery").length===0?t.jsxs("div",{className:"text-center p-12 bg-gray-50 border border-gray-200 rounded-lg",children:[t.jsx(Sr,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"No Pending Free Delivery Approvals"}),t.jsx("p",{className:"text-gray-600 font-medium",children:"All free delivery requests have been processed."})]}):t.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:t.jsxs("table",{className:"w-full text-left",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{className:"border-b border-gray-200",children:[t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Order ID"}),t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Customer"}),t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Product"}),t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Quantity"}),t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Amount"}),t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Requested By"}),t.jsx("th",{className:"p-4 text-gray-900 font-bold",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white",children:c.filter(P=>P.requestType==="free_delivery").map(P=>t.jsxs(ds.tr,{className:"border-b border-gray-100 hover:bg-gray-50",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:[t.jsxs("td",{className:"p-4 text-gray-800 font-medium",children:["#",P.orderNumber]}),t.jsx("td",{className:"p-4 text-gray-700",children:P.customerName}),t.jsx("td",{className:"p-4 text-gray-700",children:P.productName}),t.jsx("td",{className:"p-4 text-gray-700",children:P.quantity||1}),t.jsxs("td",{className:"p-4 text-gray-700",children:["",P.finalAmount]}),t.jsx("td",{className:"p-4 text-gray-700",children:P.requestedBy}),t.jsx("td",{className:"p-4",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(pe,{size:"sm",className:"bg-green-600 hover:bg-green-700 text-white",onClick:()=>R(P.id),children:" Approve"}),t.jsx(pe,{size:"sm",className:"bg-red-600 hover:bg-red-700 text-white",onClick:()=>V(P.id),children:" Reject"})]})})]},P.id))})]})})})]})})]})})},O5=()=>{const{user:e,logout:r}=Ns(),s=Ls(),a=()=>{r(),s("/auth")};return t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50",children:[t.jsx("div",{className:"bg-white shadow-md border-b-4 border-blue-800",children:t.jsxs("div",{className:"max-w-7xl mx-auto",children:[t.jsx("div",{className:"bg-blue-800 text-white px-6 py-2 text-sm",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx(zN,{className:"w-4 h-4"}),t.jsx("span",{className:"font-medium",children:"Administrative Control"})]}),t.jsx("div",{className:"text-blue-100",children:new Date().toLocaleDateString("en-IN",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]})}),t.jsx("div",{className:"px-6 py-4",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:"bg-blue-600 p-3 rounded-lg",children:t.jsx(yn,{className:"w-8 h-8 text-white"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Administrative Control Panel"}),t.jsxs("p",{className:"text-gray-600",children:["System Administrator: ",t.jsx("span",{className:"font-medium",children:e?.username||"admin"})]})]})]}),t.jsxs(pe,{onClick:a,className:"bg-red-600 hover:bg-red-700 text-white font-medium flex items-center space-x-2",children:[t.jsx(xu,{className:"w-4 h-4"}),t.jsx("span",{children:"Logout"})]})]})})]})}),t.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:t.jsxs(an,{defaultValue:"overview",className:"w-full",children:[t.jsx("div",{className:"overflow-x-auto hidden md:block",children:t.jsxs(ma,{className:"flex w-full bg-white border-2 border-gray-300 shadow-sm overflow-hidden",children:[t.jsx(xt,{value:"overview",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap flex-1 px-2 py-2 text-xs lg:text-sm",children:"Overview"}),t.jsx(xt,{value:"approvals",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap flex-1 px-2 py-2 text-xs lg:text-sm",children:"Approvals"}),t.jsx(xt,{value:"production",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap flex-1 px-2 py-2 text-xs lg:text-sm",children:"Production"}),t.jsx(xt,{value:"purchase",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap flex-1 px-2 py-2 text-xs lg:text-sm",children:"Purchase"}),t.jsx(xt,{value:"store",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap flex-1 px-2 py-2 text-xs lg:text-sm",children:"Store"}),t.jsx(xt,{value:"assembly",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap flex-1 px-2 py-2 text-xs lg:text-sm",children:"Assembly"}),t.jsx(xt,{value:"finance",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap flex-1 px-2 py-2 text-xs lg:text-sm",children:"Finance"}),t.jsx(xt,{value:"showroom",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap flex-1 px-2 py-2 text-xs lg:text-sm",children:"Showroom"}),t.jsx(xt,{value:"sales",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap flex-1 px-2 py-2 text-xs lg:text-sm",children:"Sales"}),t.jsx(xt,{value:"dispatch",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap flex-1 px-2 py-2 text-xs lg:text-sm",children:"Dispatch"}),t.jsx(xt,{value:"transport",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap flex-1 px-2 py-2 text-xs lg:text-sm",children:"Transport"}),t.jsx(xt,{value:"hr",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap flex-1 px-2 py-2 text-xs lg:text-sm",children:"HR"}),t.jsx(xt,{value:"watchman",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap flex-1 px-2 py-2 text-xs lg:text-sm",children:"Security"})]})}),t.jsx("div",{className:"overflow-x-auto md:hidden",children:t.jsxs(ma,{className:"flex w-max bg-white border-2 border-gray-300 shadow-sm overflow-y-hidden no-scrollbar",children:[t.jsx(xt,{value:"overview",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap px-4 py-2 min-w-[5rem] text-sm",children:"Overview"}),t.jsx(xt,{value:"approvals",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap px-4 py-2 min-w-[5rem] text-sm",children:"Approvals"}),t.jsx(xt,{value:"production",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap px-4 py-2 min-w-[5rem] text-sm",children:"Production"}),t.jsx(xt,{value:"purchase",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap px-4 py-2 min-w-[5rem] text-sm",children:"Purchase"}),t.jsx(xt,{value:"store",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap px-4 py-2 min-w-[5rem] text-sm",children:"Store"}),t.jsx(xt,{value:"assembly",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap px-4 py-2 min-w-[5rem] text-sm",children:"Assembly"}),t.jsx(xt,{value:"finance",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap px-4 py-2 min-w-[5rem] text-sm",children:"Finance"}),t.jsx(xt,{value:"showroom",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap px-4 py-2 min-w-[5rem] text-sm",children:"Showroom"}),t.jsx(xt,{value:"sales",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap px-4 py-2 min-w-[5rem] text-sm",children:"Sales"}),t.jsx(xt,{value:"dispatch",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap px-4 py-2 min-w-[5rem] text-sm",children:"Dispatch"}),t.jsx(xt,{value:"transport",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap px-4 py-2 min-w-[5rem] text-sm",children:"Transport"}),t.jsx(xt,{value:"hr",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap px-4 py-2 min-w-[5rem] text-sm",children:"HR"}),t.jsx(xt,{value:"watchman",className:"text-gray-700 font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white whitespace-nowrap px-4 py-2 min-w-[5rem] text-sm",children:"Security"})]})}),t.jsx(Ut,{value:"overview",children:t.jsxs(an,{defaultValue:"users",className:"w-full",children:[t.jsxs(ma,{className:"grid w-full grid-cols-3 mb-6",children:[t.jsx(xt,{value:"users",children:"User Management"}),t.jsx(xt,{value:"sales-targets",children:"Set Sales Target"}),t.jsx(xt,{value:"performance",children:"Sales Performance"})]}),t.jsx(Ut,{value:"users",children:t.jsx(_5,{})}),t.jsx(Ut,{value:"sales-targets",children:t.jsx(R5,{})}),t.jsx(Ut,{value:"performance",children:t.jsx(Y2,{isAdmin:!0})})]})}),t.jsx(Ut,{value:"approvals",children:t.jsx(D5,{})}),t.jsx(Ut,{value:"production",children:t.jsx(Wb,{})}),t.jsx(Ut,{value:"purchase",children:t.jsx(zb,{})}),t.jsx(Ut,{value:"store",children:t.jsx(A2,{})}),t.jsx(Ut,{value:"assembly",children:t.jsx(R2,{})}),t.jsx(Ut,{value:"finance",children:t.jsx(_2,{})}),t.jsx(Ut,{value:"showroom",children:t.jsx(q2,{})}),t.jsx(Ut,{value:"sales",children:t.jsx(J2,{})}),t.jsx(Ut,{value:"dispatch",children:t.jsx(Q2,{})}),t.jsx(Ut,{value:"transport",children:t.jsx(eE,{})}),t.jsx(Ut,{value:"hr",children:t.jsx(tE,{})}),t.jsx(Ut,{value:"watchman",children:t.jsx(Z2,{})})]})})]})},Ba=({user:e,department:r,children:s})=>{const a=Jl();return e?e.department==="admin"?s:e.department!==r?t.jsx(vn,{to:"/dashboard",replace:!0}):s:t.jsx(vn,{to:"/auth",state:{from:a},replace:!0})},F5=({user:e,children:r})=>{const s=Jl();return e?e.department!=="admin"?t.jsx(vn,{to:"/dashboard",replace:!0}):r:t.jsx(vn,{to:"/auth",state:{from:s},replace:!0})};function I5(){const{user:e,loading:r}=Ns();if(r)return t.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white"});const a=e?e.department==="admin"?"/dashboard/admin":e.department?`/dashboard/${e.department}`:"/dashboard":"/auth";return t.jsxs(VS,{children:[t.jsxs(km,{children:[t.jsx("title",{children:"ERP Management System"}),t.jsx("meta",{name:"description",content:"Comprehensive ERP system for production, inventory, and department management"}),t.jsx("meta",{property:"og:title",content:"ERP Management System"}),t.jsx("meta",{property:"og:description",content:"Streamline your business operations with our advanced ERP solution"})]}),t.jsxs("div",{className:"min-h-screen",children:[t.jsxs(MS,{children:[t.jsx(gs,{path:"/auth",element:e?t.jsx(vn,{to:a,replace:!0}):t.jsx($3,{})}),t.jsx(gs,{path:"/reset-password",element:t.jsx(G3,{})}),t.jsx(gs,{path:"/dashboard",element:e?e.department==="admin"?t.jsx(vn,{to:"/dashboard/admin",replace:!0}):t.jsx(W3,{}):t.jsx(vn,{to:"/auth",replace:!0})}),t.jsx(gs,{path:"/dashboard/admin",element:t.jsx(F5,{user:e,children:t.jsx(O5,{})})}),t.jsx(gs,{path:"/dashboard/production",element:t.jsx(Ba,{user:e,department:"production",children:t.jsx(Wb,{})})}),t.jsx(gs,{path:"/dashboard/purchase",element:t.jsx(Ba,{user:e,department:"purchase",children:t.jsx(zb,{})})}),t.jsx(gs,{path:"/dashboard/store",element:t.jsx(Ba,{user:e,department:"store",children:t.jsx(A2,{})})}),t.jsx(gs,{path:"/dashboard/assembly",element:t.jsx(Ba,{user:e,department:"assembly",children:t.jsx(R2,{})})}),t.jsx(gs,{path:"/dashboard/finance",element:t.jsx(Ba,{user:e,department:"finance",children:t.jsx(_2,{})})}),t.jsx(gs,{path:"/dashboard/showroom",element:t.jsx(Ba,{user:e,department:"showroom",children:t.jsx(q2,{})})}),t.jsx(gs,{path:"/dashboard/sales",element:t.jsx(Ba,{user:e,department:"sales",children:t.jsx(J2,{})})}),t.jsx(gs,{path:"/dashboard/dispatch",element:t.jsx(Ba,{user:e,department:"dispatch",children:t.jsx(Q2,{})})}),t.jsx(gs,{path:"/dashboard/watchman",element:t.jsx(Ba,{user:e,department:"watchman",children:t.jsx(Z2,{})})}),t.jsx(gs,{path:"/dashboard/transport",element:t.jsx(Ba,{user:e,department:"transport",children:t.jsx(eE,{})})}),t.jsx(gs,{path:"/dashboard/hr",element:t.jsx(Ba,{user:e,department:"hr",children:t.jsx(tE,{})})}),t.jsx(gs,{path:"/",element:t.jsx(vn,{to:a,replace:!0})}),t.jsx(gs,{path:"*",element:t.jsx(vn,{to:a,replace:!0})})]}),t.jsx(dk,{})]})]})}zT.createRoot(document.getElementById("root")).render(t.jsx(Kt.StrictMode,{children:t.jsx(U3,{children:t.jsx(I5,{})})}));
